<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Biostatistiques | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</title>
  <meta name="description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Biostatistiques | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Biostatistiques | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  
  <meta name="twitter:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

<meta name="author" content="Serge-√âtienne Parent" />


<meta name="date" content="2020-06-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapitre-git.html"/>
<link rel="next" href="chapitre-biostats-bayes.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#d√©finitions"><i class="fa fa-check"></i><b>1.1</b> D√©finitions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#√†-qui-sadresse-ce-manuel"><i class="fa fa-check"></i><b>1.2</b> √Ä qui s‚Äôadresse ce manuel?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#les-logiciels-libres"><i class="fa fa-check"></i><b>1.3</b> Les logiciels libres</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#langage-de-programmation"><i class="fa fa-check"></i><b>1.4</b> Langage de programmation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.4.1</b> R</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#pourquoi-pas-python"><i class="fa fa-check"></i><b>1.4.2</b> Pourquoi pas Python?</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#pourquoi-pas-matlab"><i class="fa fa-check"></i><b>1.4.3</b> Pourquoi pas Matlab?</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#et-sas"><i class="fa fa-check"></i><b>1.4.4</b> Et‚Ä¶ SAS?</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#mais-pourquoi-pas-______"><i class="fa fa-check"></i><b>1.4.5</b> Mais pourquoi pas ______ ?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#contenu-du-manuel"><i class="fa fa-check"></i><b>1.5</b> Contenu du manuel</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#objectifs-g√©n√©raux"><i class="fa fa-check"></i><b>1.6</b> Objectifs g√©n√©raux</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#lectures-compl√©mentaires"><i class="fa fa-check"></i><b>1.7</b> Lectures compl√©mentaires</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#√©cologie-math√©matique"><i class="fa fa-check"></i><b>1.7.1</b> √âcologie math√©matique</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#programmation"><i class="fa fa-check"></i><b>1.7.2</b> Programmation</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#divers"><i class="fa fa-check"></i><b>1.7.3</b> Divers</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#besoin-daide"><i class="fa fa-check"></i><b>1.8</b> Besoin d‚Äôaide?</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#√†-propos-de-lauteur"><i class="fa fa-check"></i><b>1.9</b> √Ä propos de l‚Äôauteur</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#un-cours-compl√©mentaire-√†-dautres-cours"><i class="fa fa-check"></i><b>1.10</b> Un cours compl√©mentaire √† d‚Äôautres cours</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#contribuer-au-manuel"><i class="fa fa-check"></i><b>1.11</b> Contribuer au manuel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html"><i class="fa fa-check"></i><b>2</b> La science des donn√©es avec R</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#statistiques-ou-science-des-donn√©es"><i class="fa fa-check"></i><b>2.1</b> Statistiques ou science des donn√©es?</a></li>
<li class="chapter" data-level="2.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#d√©buter-en-r"><i class="fa fa-check"></i><b>2.2</b> D√©buter en R</a></li>
<li class="chapter" data-level="2.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#pr√©parer-son-flux-de-travail"><i class="fa fa-check"></i><b>2.3</b> Pr√©parer son flux de travail</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-classique"><i class="fa fa-check"></i><b>2.3.1</b> Installation classique</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-avec-anaconda"><i class="fa fa-check"></i><b>2.3.2</b> Installation avec Anaconda</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#utilisation-infonuagique"><i class="fa fa-check"></i><b>2.3.3</b> Utilisation infonuagique</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#premiers-pas-avec-r"><i class="fa fa-check"></i><b>2.4</b> Premiers pas avec R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#types-de-donn√©es"><i class="fa fa-check"></i><b>2.4.1</b> Types de donn√©es</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-collections-de-donn√©es"><i class="fa fa-check"></i><b>2.4.2</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-fonctions"><i class="fa fa-check"></i><b>2.4.3</b> Les fonctions</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-boucles"><i class="fa fa-check"></i><b>2.4.4</b> Les boucles</a></li>
<li class="chapter" data-level="2.4.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#conditions-if-else-if-else"><i class="fa fa-check"></i><b>2.4.5</b> Conditions: <code>if</code>, <code>else if</code>, <code>else</code></a></li>
<li class="chapter" data-level="2.4.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installer-et-charger-un-module"><i class="fa fa-check"></i><b>2.4.6</b> Installer et charger un module</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#enfin"><i class="fa fa-check"></i><b>2.5</b> Enfin‚Ä¶</a></li>
<li class="chapter" data-level="2.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#petit-truc"><i class="fa fa-check"></i><b>2.6</b> Petit truc!</a></li>
<li class="chapter" data-level="2.7" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#extra-jupyter"><i class="fa fa-check"></i><b>2.7</b> Extra: Utiliser R avec Jupyter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html"><i class="fa fa-check"></i><b>3</b> Organisation des donn√©es et op√©rations sur des tableaux</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#les-collections-de-donn√©es-1"><i class="fa fa-check"></i><b>3.1</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#organiser-un-tableau-de-donn√©es"><i class="fa fa-check"></i><b>3.2</b> Organiser un tableau de donn√©es</a></li>
<li class="chapter" data-level="3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#formats-de-tableau"><i class="fa fa-check"></i><b>3.3</b> Formats de tableau</a><ul>
<li class="chapter" data-level="3.3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#xls-ou-xlsx"><i class="fa fa-check"></i><b>3.3.1</b> <em>xls</em> ou <em>xlsx</em></a></li>
<li class="chapter" data-level="3.3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#csv"><i class="fa fa-check"></i><b>3.3.2</b> <em>csv</em></a></li>
<li class="chapter" data-level="3.3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#json"><i class="fa fa-check"></i><b>3.3.3</b> <em>json</em></a></li>
<li class="chapter" data-level="3.3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#sqlite"><i class="fa fa-check"></i><b>3.3.4</b> SQLite</a></li>
<li class="chapter" data-level="3.3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#suggestion"><i class="fa fa-check"></i><b>3.3.5</b> Suggestion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#entreposer-ses-donn√©es"><i class="fa fa-check"></i><b>3.4</b> Entreposer ses donn√©es</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#manipuler-des-donn√©es-en-mode-tidyverse"><i class="fa fa-check"></i><b>3.5</b> Manipuler des donn√©es en mode tidyverse</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#importer-vos-donn√©es-dans-votre-session-de-travail"><i class="fa fa-check"></i><b>3.5.1</b> Importer vos donn√©es dans votre session de travail</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#comment-s√©lectionner-et-filtrer-des-donn√©es"><i class="fa fa-check"></i><b>3.5.2</b> Comment s√©lectionner et filtrer des donn√©es ?</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#le-format-long-et-le-format-large"><i class="fa fa-check"></i><b>3.5.3</b> Le format long et le format large</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#combiner-des-tableaux"><i class="fa fa-check"></i><b>3.5.4</b> Combiner des tableaux</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#op√©rations-sur-les-tableaux"><i class="fa fa-check"></i><b>3.5.5</b> Op√©rations sur les tableaux</a></li>
<li class="chapter" data-level="3.5.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exemple-difficile"><i class="fa fa-check"></i><b>3.5.6</b> Exemple (difficile)</a></li>
<li class="chapter" data-level="3.5.7" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exporter-un-tableau"><i class="fa fa-check"></i><b>3.5.7</b> Exporter un tableau</a></li>
<li class="chapter" data-level="3.5.8" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#aller-plus-loin-dans-le-tidyverse"><i class="fa fa-check"></i><b>3.5.8</b> Aller plus loin dans le tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#r√©f√©rences"><i class="fa fa-check"></i><b>3.6</b> R√©f√©rences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html"><i class="fa fa-check"></i><b>4</b> Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#pourquoi-explorer-graphiquement"><i class="fa fa-check"></i><b>4.1</b> Pourquoi explorer graphiquement?</a></li>
<li class="chapter" data-level="4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publier-un-graphique"><i class="fa fa-check"></i><b>4.2</b> Publier un graphique</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#cinq-qualit√©s-dun-bon-graphique"><i class="fa fa-check"></i><b>4.2.1</b> Cinq qualit√©s d‚Äôun bon graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-le-type-de-graphique-le-plus-appropri√©"><i class="fa fa-check"></i><b>4.3</b> Choisir le type de graphique le plus appropri√©</a></li>
<li class="chapter" data-level="4.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-son-outil-de-visualisation"><i class="fa fa-check"></i><b>4.4</b> Choisir son outil de visualisation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-imp√©rative"><i class="fa fa-check"></i><b>4.4.1</b> Approche imp√©rative</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-d√©clarative"><i class="fa fa-check"></i><b>4.4.2</b> Approche d√©clarative</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visualisation-en-r"><i class="fa fa-check"></i><b>4.5</b> Visualisation en R</a></li>
<li class="chapter" data-level="4.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#module-de-base-pour-les-graphiques"><i class="fa fa-check"></i><b>4.6</b> Module de base pour les graphiques</a></li>
<li class="chapter" data-level="4.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#la-grammaire-graphique-ggplot2"><i class="fa fa-check"></i><b>4.7</b> La grammaire graphique <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#mon-premier-ggplot"><i class="fa fa-check"></i><b>4.8</b> Mon premier ggplot</a><ul>
<li class="chapter" data-level="4.8.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#plusieurs-sources-de-donn√©es"><i class="fa fa-check"></i><b>4.8.1</b> Plusieurs sources de donn√©es</a></li>
<li class="chapter" data-level="4.8.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-avec-style"><i class="fa fa-check"></i><b>4.8.2</b> Exporter avec style</a></li>
<li class="chapter" data-level="4.8.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#nuages-de-points"><i class="fa fa-check"></i><b>4.8.3</b> Nuages de points</a></li>
<li class="chapter" data-level="4.8.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#diagrammes-en-lignes"><i class="fa fa-check"></i><b>4.8.4</b> Diagrammes en lignes</a></li>
<li class="chapter" data-level="4.8.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-histogrammes"><i class="fa fa-check"></i><b>4.8.5</b> Les histogrammes</a></li>
<li class="chapter" data-level="4.8.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#boxplots"><i class="fa fa-check"></i><b>4.8.6</b> Boxplots</a></li>
<li class="chapter" data-level="4.8.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-diagrammes-en-barre"><i class="fa fa-check"></i><b>4.8.7</b> Les diagrammes en barre</a></li>
<li class="chapter" data-level="4.8.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-un-graphique"><i class="fa fa-check"></i><b>4.8.8</b> Exporter un graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-graphiques-comme-outil-dexploration-des-donn√©es"><i class="fa fa-check"></i><b>4.9</b> Les graphiques comme outil d‚Äôexploration des donn√©es</a><ul>
<li class="chapter" data-level="4.9.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-graphiques-interactifs"><i class="fa fa-check"></i><b>4.9.1</b> Des graphiques interactifs!</a></li>
<li class="chapter" data-level="4.9.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-extensions-de-ggplot2"><i class="fa fa-check"></i><b>4.9.2</b> Des extensions de <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.9.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#aller-plus-loin-avec-ggplot2"><i class="fa fa-check"></i><b>4.9.3</b> Aller plus loin avec <strong><code>ggplot2</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#extra-r√®gles-particuli√®res"><i class="fa fa-check"></i><b>4.10</b> Extra: R√®gles particuli√®res</a><ul>
<li class="chapter" data-level="4.10.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#ne-tronquez-pas-inutilement-laxe-des-y"><i class="fa fa-check"></i><b>4.10.1</b> Ne tronquez pas inutilement l‚Äôaxe des <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="4.10.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#utilisez-un-encrage-proportionnel"><i class="fa fa-check"></i><b>4.10.2</b> Utilisez un encrage proportionnel</a></li>
<li class="chapter" data-level="4.10.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publiez-vos-donn√©es"><i class="fa fa-check"></i><b>4.10.3</b> Publiez vos donn√©es</a></li>
<li class="chapter" data-level="4.10.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visitez-www.junkcharts.typepad.com-de-temps-√†-autre"><i class="fa fa-check"></i><b>4.10.4</b> Visitez www.junkcharts.typepad.com de temps √† autre</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapitre-git.html"><a href="chapitre-git.html"><i class="fa fa-check"></i><b>5</b> Science ouverte et reproductibilit√©</a><ul>
<li class="chapter" data-level="5.1" data-path="chapitre-git.html"><a href="chapitre-git.html#un-code-reproductible"><i class="fa fa-check"></i><b>5.1</b> Un code reproductible</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chapitre-git.html"><a href="chapitre-git.html#structure-dun-projet"><i class="fa fa-check"></i><b>5.1.1</b> Structure d‚Äôun projet</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapitre-git.html"><a href="chapitre-git.html#le-format-r-markdown"><i class="fa fa-check"></i><b>5.1.2</b> Le format <span>R markdown</span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-github"><i class="fa fa-check"></i><b>5.2</b> Introduction √† GitHub</a></li>
<li class="chapter" data-level="5.3" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-pakrat"><i class="fa fa-check"></i><b>5.3</b> Introduction √† Pakrat üì¶üêÄ</a></li>
<li class="chapter" data-level="5.4" data-path="chapitre-git.html"><a href="chapitre-git.html#pour-terminer-le-reprex"><i class="fa fa-check"></i><b>5.4</b> Pour terminer, le <strong>reprex</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html"><i class="fa fa-check"></i><b>6</b> Biostatistiques</a><ul>
<li class="chapter" data-level="6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#populations-et-√©chantillons"><i class="fa fa-check"></i><b>6.1</b> Populations et √©chantillons</a></li>
<li class="chapter" data-level="6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-variables"><i class="fa fa-check"></i><b>6.2</b> Les variables</a><ul>
<li class="chapter" data-level="6.2.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-quantitatives"><i class="fa fa-check"></i><b>6.2.1</b> Variables quantitatives</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-qualitatives"><i class="fa fa-check"></i><b>6.2.2</b> Variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-probabilit√©s"><i class="fa fa-check"></i><b>6.3</b> Les probabilit√©s</a></li>
<li class="chapter" data-level="6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-distributions"><i class="fa fa-check"></i><b>6.4</b> Les distributions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-binomiale"><i class="fa fa-check"></i><b>6.4.1</b> Distribution binomiale</a></li>
<li class="chapter" data-level="6.4.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-de-poisson"><i class="fa fa-check"></i><b>6.4.2</b> Distribution de Poisson</a></li>
<li class="chapter" data-level="6.4.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-uniforme"><i class="fa fa-check"></i><b>6.4.3</b> Distribution uniforme</a></li>
<li class="chapter" data-level="6.4.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-normale"><i class="fa fa-check"></i><b>6.4.4</b> Distribution normale</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#statistiques-descriptives"><i class="fa fa-check"></i><b>6.5</b> Statistiques descriptives</a></li>
<li class="chapter" data-level="6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-dhypoth√®ses-√†-un-et-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6</b> Tests d‚Äôhypoth√®ses √† un et deux √©chantillons</a><ul>
<li class="chapter" data-level="6.6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-t-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.1</b> Test de t √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#attention-mauvaises-interpr√©tations-des-p-values"><i class="fa fa-check"></i><b>6.6.2</b> Attention: mauvaises interpr√©tations des <em>p-values</em></a></li>
<li class="chapter" data-level="6.6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-wilcoxon-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.3</b> Test de Wilcoxon √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-t-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.4</b> Tests de t √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#comparaison-des-variances"><i class="fa fa-check"></i><b>6.6.5</b> Comparaison des variances</a></li>
<li class="chapter" data-level="6.6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-wilcoxon-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.6</b> Tests de Wilcoxon √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-tests-pair√©s"><i class="fa fa-check"></i><b>6.6.7</b> Les tests pair√©s</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#lanalyse-de-variance"><i class="fa fa-check"></i><b>6.7</b> L‚Äôanalyse de variance</a></li>
<li class="chapter" data-level="6.8" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-mod√®les-statistiques"><i class="fa fa-check"></i><b>6.8</b> Les mod√®les statistiques</a><ul>
<li class="chapter" data-level="6.8.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-fixes"><i class="fa fa-check"></i><b>6.8.1</b> Mod√®les √† effets fixes</a></li>
<li class="chapter" data-level="6.8.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-mixtes"><i class="fa fa-check"></i><b>6.8.2</b> Mod√®les √† effets mixtes</a></li>
<li class="chapter" data-level="6.8.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#aller-plus-loin"><i class="fa fa-check"></i><b>6.8.3</b> Aller plus loin</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html"><i class="fa fa-check"></i><b>7</b> Introduction √† l‚Äôanalyse bay√©sienne en √©cologie</a><ul>
<li class="chapter" data-level="7.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#quest-ce-que-cest"><i class="fa fa-check"></i><b>7.1</b> Qu‚Äôest-ce que c‚Äôest?</a></li>
<li class="chapter" data-level="7.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pourquoi-lutiliser"><i class="fa fa-check"></i><b>7.2</b> Pourquoi l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.3" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#comment-lutiliser"><i class="fa fa-check"></i><b>7.3</b> Comment l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.4" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#faucons-p√©lerins"><i class="fa fa-check"></i><b>7.4</b> Faucons p√©lerins</a></li>
<li class="chapter" data-level="7.5" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#statistiques-dune-population"><i class="fa fa-check"></i><b>7.5</b> Statistiques d‚Äôune population</a><ul>
<li class="chapter" data-level="7.5.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#calcul-analytique"><i class="fa fa-check"></i><b>7.5.1</b> Calcul analytique</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#greta"><i class="fa fa-check"></i><b>7.5.2</b> greta</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#test-de-t-diff√©rence-entre-des-groupes"><i class="fa fa-check"></i><b>7.6</b> Test de t: Diff√©rence entre des groupes</a></li>
<li class="chapter" data-level="7.7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#mod√©lisation-multiniveau"><i class="fa fa-check"></i><b>7.7</b> Mod√©lisation multiniveau</a></li>
<li class="chapter" data-level="7.8" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>7.8</b> Pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html"><i class="fa fa-check"></i><b>8</b> Explorer R</a><ul>
<li class="chapter" data-level="8.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-sur-le-web"><i class="fa fa-check"></i><b>8.1</b> R sur le web</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#github"><i class="fa fa-check"></i><b>8.1.1</b> GitHub</a></li>
<li class="chapter" data-level="8.1.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#twitter"><i class="fa fa-check"></i><b>8.1.2</b> Twitter</a></li>
<li class="chapter" data-level="8.1.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#nouvelles"><i class="fa fa-check"></i><b>8.1.3</b> Nouvelles</a></li>
<li class="chapter" data-level="8.1.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#des-questions"><i class="fa fa-check"></i><b>8.1.4</b> Des questions?</a></li>
<li class="chapter" data-level="8.1.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#participer"><i class="fa fa-check"></i><b>8.1.5</b> Participer</a></li>
<li class="chapter" data-level="8.1.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#mise-en-garde"><i class="fa fa-check"></i><b>8.1.6</b> Mise en garde</a></li>
<li class="chapter" data-level="8.1.7" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#prendre-tout-√ßa-en-note"><i class="fa fa-check"></i><b>8.1.7</b> Prendre tout √ßa en note</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-en-chaire-et-en-os"><i class="fa fa-check"></i><b>8.2</b> R en chaire et en os</a></li>
<li class="chapter" data-level="8.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#quelques-outils-en-√©cologie-math√©matique-avec-r"><i class="fa fa-check"></i><b>8.3</b> Quelques outils en √©cologie math√©matique avec R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#pr√©traitement-des-donn√©es"><i class="fa fa-check"></i><b>8.3.1</b> Pr√©traitement des donn√©es</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#acqu√©rir-des-donn√©es-m√©t√©o"><i class="fa fa-check"></i><b>8.3.2</b> Acqu√©rir des donn√©es m√©t√©o</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#p√©dom√©trie-avec-r"><i class="fa fa-check"></i><b>8.3.3</b> P√©dom√©trie avec R</a></li>
<li class="chapter" data-level="8.3.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#m√©ta-analyses-en-r"><i class="fa fa-check"></i><b>8.3.4</b> M√©ta-analyses en R</a></li>
<li class="chapter" data-level="8.3.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#cr√©er-des-applications-avec-r"><i class="fa fa-check"></i><b>8.3.5</b> Cr√©er des applications avec R</a></li>
<li class="chapter" data-level="8.3.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#travailler-en-python"><i class="fa fa-check"></i><b>8.3.6</b> Travailler en Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html"><i class="fa fa-check"></i><b>9</b> Association, partitionnement et ordination</a><ul>
<li class="chapter" data-level="9.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#espaces-danalyse"><i class="fa fa-check"></i><b>9.1</b> Espaces d‚Äôanalyse</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#abondance-et-occurence"><i class="fa fa-check"></i><b>9.1.1</b> Abondance et occurence</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#environnement"><i class="fa fa-check"></i><b>9.1.2</b> Environnement</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#analyse-dassociation"><i class="fa fa-check"></i><b>9.2</b> Analyse d‚Äôassociation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#association-entre-objets-mode-q"><i class="fa fa-check"></i><b>9.2.1</b> Association entre objets (mode Q)</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#associations-entre-variables-mode-r"><i class="fa fa-check"></i><b>9.2.2</b> Associations entre variables (mode R)</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-les-associations"><i class="fa fa-check"></i><b>9.2.3</b> Conclusion sur les associations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement"><i class="fa fa-check"></i><b>9.3</b> Partitionnement</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#√©valuation-dun-partitionnement"><i class="fa fa-check"></i><b>9.3.1</b> √âvaluation d‚Äôun partitionnement</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-non-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.2</b> Partitionnement non hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.3</b> Partitionnement hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique-bas√©e-sur-la-densit√©-des-points"><i class="fa fa-check"></i><b>9.3.4</b> Partitionnement hi√©rarchique bas√©e sur la densit√© des points</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-le-partitionnement"><i class="fa fa-check"></i><b>9.3.5</b> Conclusion sur le partitionnement</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination"><i class="fa fa-check"></i><b>9.4</b> Ordination</a><ul>
<li class="chapter" data-level="9.4.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-non-contraignante"><i class="fa fa-check"></i><b>9.4.1</b> Ordination non contraignante</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-contraignante"><i class="fa fa-check"></i><b>9.4.2</b> Ordination contraignante</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html"><i class="fa fa-check"></i><b>10</b> D√©tection de valeurs aberrantes et imputation de donn√©es manquantes</a><ul>
<li class="chapter" data-level="10.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#donn√©es-manquantes-d√©finition-origine-typologie-et-traitement"><i class="fa fa-check"></i><b>10.1</b> Donn√©es manquantes: d√©finition, origine, typologie et traitement</a><ul>
<li class="chapter" data-level="10.1.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finition"><i class="fa fa-check"></i><b>10.1.1</b> D√©finition</a></li>
<li class="chapter" data-level="10.1.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.2</b> Origines des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#profils-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.3</b> Profils des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#traitement-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.4</b> Traitement des donn√©es manquantes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#valeurs-et-√©chantillons-aberrants-d√©finition-origines-m√©thodes-de-d√©tection-et-traitement"><i class="fa fa-check"></i><b>10.2</b> Valeurs et √©chantillons aberrants: d√©finition, origines, m√©thodes de d√©tection et traitement</a><ul>
<li class="chapter" data-level="10.2.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finitions-1"><i class="fa fa-check"></i><b>10.2.1</b> D√©finitions</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines"><i class="fa fa-check"></i><b>10.2.2</b> Origines</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-valeurs-aberrantes-univari√©s"><i class="fa fa-check"></i><b>10.2.3</b> D√©tection et traitement des valeurs aberrantes univari√©s</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-√©chantillons-aberrants-multivari√©s"><i class="fa fa-check"></i><b>10.2.4</b> D√©tection et traitement des √©chantillons aberrants multivari√©s</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapitre-ml.html"><a href="chapitre-ml.html"><i class="fa fa-check"></i><b>11</b> Introduction √† l‚Äôautoapprentissage</a><ul>
<li class="chapter" data-level="11.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lexique"><i class="fa fa-check"></i><b>11.1</b> Lexique</a></li>
<li class="chapter" data-level="11.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©marche"><i class="fa fa-check"></i><b>11.2</b> D√©marche</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#pr√©traitement"><i class="fa fa-check"></i><b>11.2.1</b> Pr√©traitement</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#entra√Ænement-et-test"><i class="fa fa-check"></i><b>11.2.2</b> Entra√Ænement et test</a></li>
<li class="chapter" data-level="11.2.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#sousapprentissage-et-surapprentissage"><i class="fa fa-check"></i><b>11.2.3</b> Sousapprentissage et surapprentissage</a></li>
<li class="chapter" data-level="11.2.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#validation-crois√©e"><i class="fa fa-check"></i><b>11.2.4</b> Validation crois√©e</a></li>
<li class="chapter" data-level="11.2.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#choix-de-lalgorithme-dapprentissage"><i class="fa fa-check"></i><b>11.2.5</b> Choix de l‚Äôalgorithme d‚Äôapprentissage</a></li>
<li class="chapter" data-level="11.2.6" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©ploiement"><i class="fa fa-check"></i><b>11.2.6</b> D√©ploiement</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lautoapprentissage-en-r"><i class="fa fa-check"></i><b>11.3</b> L‚Äôautoapprentissage en R</a></li>
<li class="chapter" data-level="11.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#algorithmes"><i class="fa fa-check"></i><b>11.4</b> Algorithmes</a><ul>
<li class="chapter" data-level="11.4.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-k-plus-proches-voisins"><i class="fa fa-check"></i><b>11.4.1</b> Les <em>k</em> plus proches voisins</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-arbres-d√©cisionnels"><i class="fa fa-check"></i><b>11.4.2</b> Les arbres d√©cisionnels</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-r√©seaux-neuronaux"><i class="fa fa-check"></i><b>11.4.3</b> Les r√©seaux neuronaux</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens"><i class="fa fa-check"></i><b>11.4.4</b> Les processus gaussiens</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens-en-r"><i class="fa fa-check"></i><b>11.4.5</b> Les processus gaussiens en <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapitre-temps.html"><a href="chapitre-temps.html"><i class="fa fa-check"></i><b>12</b> Les s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#op√©rations-sur-les-donn√©es-temporelles"><i class="fa fa-check"></i><b>12.1</b> Op√©rations sur les donn√©es temporelles</a></li>
<li class="chapter" data-level="12.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#analyse-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2</b> Analyse de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.2.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#cr√©er-et-visualiser-des-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.1</b> Cr√©er et visualiser des s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#structures-dans-les-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.2</b> Structures dans les s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#lautocorr√©lation"><i class="fa fa-check"></i><b>12.2.3</b> L‚Äôautocorr√©lation</a></li>
<li class="chapter" data-level="12.2.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#signification-statistique-dune-s√©rie-temporelle"><i class="fa fa-check"></i><b>12.2.4</b> Signification statistique d‚Äôune s√©rie temporelle</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#mod√©lisation-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.3</b> Mod√©lisation de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.3.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-na√Øve"><i class="fa fa-check"></i><b>12.3.1</b> M√©thode na√Øve</a></li>
<li class="chapter" data-level="12.3.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-ses"><i class="fa fa-check"></i><b>12.3.2</b> M√©thode SES</a></li>
<li class="chapter" data-level="12.3.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#la-m√©thode-arima"><i class="fa fa-check"></i><b>12.3.3</b> La m√©thode ARIMA</a></li>
<li class="chapter" data-level="12.3.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-dynamiques"><i class="fa fa-check"></i><b>12.3.4</b> Les mod√®les dynamiques</a></li>
<li class="chapter" data-level="12.3.5" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-tbats"><i class="fa fa-check"></i><b>12.3.5</b> Les mod√®les TBATS</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#pour-terminer"><i class="fa fa-check"></i><b>12.4</b> Pour terminer‚Ä¶</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapitre-geo.html"><a href="chapitre-geo.html"><i class="fa fa-check"></i><b>13</b> Les donn√©es g√©ospatiales</a><ul>
<li class="chapter" data-level="13.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.1</b> Les donn√©es spatiales</a></li>
<li class="chapter" data-level="13.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#cartographier-avec-le-module-ggmap"><i class="fa fa-check"></i><b>13.2</b> Cartographier avec le module <strong><code>ggmap</code></strong></a></li>
<li class="chapter" data-level="13.3" data-path="chapitre-geo.html"><a href="chapitre-geo.html#types-g√©n√©riques-de-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.3</b> Types g√©n√©riques de donn√©es spatiales</a></li>
<li class="chapter" data-level="13.4" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-choropl√®the"><i class="fa fa-check"></i><b>13.4</b> Les choropl√®the</a></li>
<li class="chapter" data-level="13.5" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-rasters"><i class="fa fa-check"></i><b>13.5</b> Les rasters</a></li>
<li class="chapter" data-level="13.6" data-path="chapitre-geo.html"><a href="chapitre-geo.html#autoapprentissage-spatial"><i class="fa fa-check"></i><b>13.6</b> Autoapprentissage spatial</a></li>
<li class="chapter" data-level="13.7" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-objets-spatialis√©s-en-r"><i class="fa fa-check"></i><b>13.7</b> Les objets spatialis√©s en R</a><ul>
<li class="chapter" data-level="13.7.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-vectorielles-points-lignes-et-polygones"><i class="fa fa-check"></i><b>13.7.1</b> Donn√©es vectorielles (points, lignes et polygones)</a></li>
<li class="chapter" data-level="13.7.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-raster"><i class="fa fa-check"></i><b>13.7.2</b> Donn√©es raster</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="chapitre-geo.html"><a href="chapitre-geo.html#section-systeme-coord"><i class="fa fa-check"></i><b>13.8</b> Les syst√®mes de coordonn√©es</a></li>
<li class="chapter" data-level="13.9" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-tableaux-sf"><i class="fa fa-check"></i><b>13.9</b> Manipuler des tableaux <code>sf</code></a></li>
<li class="chapter" data-level="13.10" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-objets-raster"><i class="fa fa-check"></i><b>13.10</b> Manipuler des objets raster</a></li>
<li class="chapter" data-level="13.11" data-path="chapitre-geo.html"><a href="chapitre-geo.html#graphiques-dobjets-spatialis√©s"><i class="fa fa-check"></i><b>13.11</b> Graphiques d‚Äôobjets spatialis√©s</a></li>
<li class="chapter" data-level="13.12" data-path="chapitre-geo.html"><a href="chapitre-geo.html#ressources-compl√©mentaires"><i class="fa fa-check"></i><b>13.12</b> Ressources compl√©mentaires</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chapitre-ode.html"><a href="chapitre-ode.html"><i class="fa fa-check"></i><b>14</b> Mod√©lisation de m√©canismes √©cologiques</a><ul>
<li class="chapter" data-level="14.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©quations-diff√©rentielles"><i class="fa fa-check"></i><b>14.1</b> √âquations diff√©rentielles</a></li>
<li class="chapter" data-level="14.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#les-√©quations-diff√©rentielles-ordinaires-en-mod√©lisation-√©cologique"><i class="fa fa-check"></i><b>14.2</b> Les √©quations diff√©rentielles ordinaires en mod√©lisation √©cologique</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©volution-dune-seule-population-en-fonction-du-temps"><i class="fa fa-check"></i><b>14.2.1</b> √âvolution d‚Äôune seule population en fonction du temps</a></li>
<li class="chapter" data-level="14.2.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#population-exploit√©e"><i class="fa fa-check"></i><b>14.2.2</b> Population exploit√©e</a></li>
<li class="chapter" data-level="14.2.3" data-path="chapitre-ode.html"><a href="chapitre-ode.html#interactions-biologiques"><i class="fa fa-check"></i><b>14.2.3</b> Interactions biologiques</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre-biostats" class="section level1">
<h1><span class="header-section-number">6</span> Biostatistiques</h1>
<hr />
<p>Ô∏è¬†<strong>Objectifs sp√©cifiques</strong>:</p>
<p>√Ä la fin de ce chapitre, vous</p>
<ul>
<li>serez en mesure de d√©finir les concepts de base en statistique: population, √©chantillon, variable, probabilit√© et distribution</li>
<li>serez en mesure de calculer des statistiques descriptives de base: moyenne et √©cart-type, quartiles, maximum et minimum</li>
<li>comprendrez les notions de test d‚Äôhypoth√®se, d‚Äôeffet et de p-value, ainsi qu‚Äô√©viter les erreurs communes dans leur interpr√©tation</li>
<li>saurez effectuer une mod√©lisation statistique lin√©aire simple, multiple et mixte, entre autre sur des cat√©gories</li>
<li>saurez effectuer une mod√©lisation statistique non lin√©aire simple, multiple et mixte</li>
</ul>
<hr />
<p>Aux chapitres pr√©c√©dents, nous avons vu comment visualiser, organiser et manipuler des tableaux de donn√©es. La statistique est une collection de disciplines li√©es √† la collecte, l‚Äôorganisation, l‚Äôanalyse, l‚Äôinterpr√©tation et la pr√©sentation de donn√©es. Les biostatistiques sont des applications de ces disciplines √† la biosph√®re.</p>
<p>Dans <a href="https://www.amazon.com/Principles-Procedures-Statistics-Biometrical-Approach/dp/0070610282"><em>Principles and procedures of statistics: A biometrical approach</em></a>, Steel, Torie et Dickey (1997) d√©finissent les statistiques ainsi:</p>
<blockquote>
<p>Les statistiques forment la science, pure et appliqu√©e, de la cr√©ation, du d√©veloppement, et de l‚Äôapplication de techniques par lesquelles l‚Äôincertitude de l‚Äôinduction inf√©rentielle peut √™tre √©valu√©e. (ma traduction)</p>
</blockquote>
<p>Alors que l‚Äô<strong>inf√©rence</strong> consiste √† g√©n√©raliser des √©chantillons √† l‚Äôensemble d‚Äôune population, l‚Äô<strong>induction</strong> est un type de raisonnement qui permet de g√©n√©raliser des observations sous forme de th√©ories. En d‚Äôautres mots, les statistiques permettent d‚Äô√©valuer l‚Äôincertitude sur des processus, de passer par infrence de l‚Äô√©chantillon √† la population, puis par induction de passer de cette repr√©sentation d‚Äôune population en lois g√©n√©rales la concernant.</p>
<p>La d√©finition de Whitlock et Schuluter (2015), dans <a href="http://whitlockschluter.zoology.ubc.ca/">The Analysis of Biological Data</a>, est plus simple et n‚Äôinsiste que sur l‚Äôinf√©rence:</p>
<blockquote>
<p>La statistique est l‚Äô√©tude des m√©thodes pour mesurer des aspects de populations √† partir d‚Äô√©chantillons et pour quantifier l‚Äôincertitude des mesures. (ma traduction)</p>
</blockquote>
<p>Les statistiques consistent √† <em>faire du sens</em> (anglicisme assum√©) avec des observations dans l‚Äôobjectif de r√©pondre √† une question que vous aurez formul√©e clairement, pr√©alablement √† votre exp√©rience.</p>
<blockquote class="twitter-tweet" data-lang="fr">
<p lang="en" dir="ltr">
The more time I spend as The Statistician in the room, the more I think the best skill you can cultivate is the ability to remain calm and repeatedly ask ‚ÄúWhat question are you trying to answer?‚Äù
</p>
‚Äî Bryan Howie (<span class="citation">@bryan_howie</span>) <a href="https://twitter.com/bryan_howie/status/1073054519808876544?ref_src=twsrc%5Etfw">13 d√©cembre 2018</a>
</blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
<p>Le flux de travail conventionnel en statistiques consiste √† collecter des √©chantillons, transformer (pr√©traiter) les donn√©es, effectuer des tests, analyser les r√©sultats, les interpr√©ter et les visualiser.</p>
<p><span class="math display">\[Collecte \rightarrow Pr√©traitement \rightarrow Tests~statistiques \rightarrow Analyse \rightarrow Interpr√©tation \rightarrow Visualisation \]</span></p>
<p>Ce chapitre √† lui seul est trop court pour permettre d‚Äôint√©grer toutes les connaissances n√©cessaires √† une utilisation raisonn√©e des statistiques, mais fourni les bases pour aller plus loin. Notez que les erreurs d‚Äôinterpr√©tation statistiques sont courantes et la consultation de sp√©cialistes n‚Äôest souvent pas un luxe. Mais bien que les statistiques soient complexes, <em>la plupart des op√©rations statistiques peuvent √™tre effectu√©es sans l‚Äôassistance de statisticien.ne.s</em>‚Ä¶ √† condition de comprendre suffisamment les concepts utilis√©s.</p>
<p>Dans ce chapitre, nous verrons comment r√©pondre correctement √† une question valide et ad√©quate avec l‚Äôaide d‚Äôoutils de calcul scientifique. Nous couvrirons les notions de bases des distributions et des variables al√©atoires qui nous permettront d‚Äôeffectuer des tests statistiques communs avec R. Nous couvrirons aussi les erreurs commun√©ment commises en recherche acad√©mique et les moyens simples de les √©viter.</p>
<p>En plus des modules de base de R nous utiliserons</p>
<ul>
<li>les modules de la <strong><code>tidyverse</code></strong>,</li>
<li>le module de donn√©es agricoles <strong><code>agridat</code></strong>, ainsi que</li>
<li>le module <strong><code>nlme</code></strong> sp√©cialis√© pour la mod√©lisation mixte.</li>
</ul>
<p>Avant de survoler les applications statistiques avec R, je vais rapidement pr√©senter quelques notions importantes en statistiques : populations et √©chantillons, variables, probabilit√©s et distributions. Puis nous allons effectuer des tests d‚Äôhypoth√®se univari√©s (notamment les tests de <em>t</em> et les analyses de variance) et d√©tailler la notion controvers√©e de <em>p-value</em>. Je vais m‚Äôattarder plus longuement aux mod√®les lin√©aires g√©n√©ralis√©s, incluant en particulier des effets fixes et al√©atoires (mod√®les mixtes), qui fournissent une trousse d‚Äôanalyse polyvalente en analyse multivari√©e. Je terminerai avec les perspectives multivari√©es que sont les matrices de covariance et de corr√©lation.</p>
<div id="populations-et-√©chantillons" class="section level2">
<h2><span class="header-section-number">6.1</span> Populations et √©chantillons</h2>
<p>Le principe d‚Äôinf√©rence consiste √† g√©n√©raliser des conclusions √† l‚Äô√©chelle d‚Äôune population √† partir d‚Äô√©chantillons issus de cette population. Alors qu‚Äôune <strong>population</strong> contient tous les √©l√©ments √©tudi√©s, un <strong>√©chantillon</strong> d‚Äôune population est une observation unique. Une exp√©rience bien con√ßue fera en sorte que les √©chantillons soient repr√©sentatifs de la population qui, la plupart du temps, ne peut √™tre observ√©e enti√®rement pour des raisons pratiques.</p>
<p>Les principes d‚Äôexp√©rimentation servant de base √† la conception d‚Äôune bonne m√©thodologie sont pr√©sent√©s dans le cours <a href="https://www.ulaval.ca/les-etudes/cours/repertoire/detailsCours/bvg-7002-dispositifs-experimentaux.html"><em>Dispositifs exp√©rimentaux (BVG-7002)</em></a>. √âgalement, je recommande le livre <em>Principes d‚Äôexp√©rimentation: planification des exp√©riences et analyse de leurs r√©sultats</em> de Pierre Dagnelie (2012), <a href="http://www.dagnelie.be/docpdf/ex2012.pdf">disponible en ligne en format PDF</a>. Un bon aper√ßu des dispositifs exp√©rimentaux est aussi pr√©sent√© dans <a href="https://www.springer.com/us/book/9780387790534"><em>Introductory Statistics with R</em></a>, de Peter Dalgaard (2008), que vous pouvez t√©l√©charger <a href="https://ariane25.bibl.ulaval.ca/ariane/wicket/detail?c=ariane&amp;m=S&amp;rq.ct=PE&amp;rq.fa=false&amp;rq.r.esc=false&amp;rq.r.l%5B0%5D.c=*&amp;rq.r.l%5B0%5D.ex=false&amp;rq.r.l%5B0%5D.op=AND&amp;rq.r.l%5B0%5D.v=introductory+statistics+with+R&amp;rq.r.la=*&amp;rq.r.loc=*&amp;rq.r.pft=false&amp;rq.r.ta=*&amp;rq.r.td=*&amp;rq.rows=15&amp;rq.st=0">du site de la biblioth√®que de l‚ÄôUniversit√© Laval</a> vous avez un identifiant autoris√©.</p>
<p>Une population est √©chantillonn√©e pour induire des <strong>param√®tres</strong>: un rendement typique dans des conditions m√©t√©orologiques, √©daphiques et manag√©riales donn√©es, la masse typique des faucons p√®lerins, m√¢les et femelles, le microbiome typique d‚Äôun sol agricole ou forestier, etc. Une <strong>statistique</strong> est une estimation d‚Äôun param√®tre calcul√©e √† partir des donn√©es, par exemple une moyenne et un √©cart-type, ou un intercept et une pente.</p>
<p>Par exemple, la moyenne (<span class="math inline">\(\mu\)</span>) et l‚Äô√©cart-type (<span class="math inline">\(\sigma\)</span>) d‚Äôune population sont estim√©s par les moyennes (<span class="math inline">\(\bar{x}\)</span>) et √©carts-types (<span class="math inline">\(s\)</span>) calcul√©s sur les donn√©es issues de l‚Äô√©chantillonnage.</p>
<p>Chaque param√®tre est li√©e √† une perspective que l‚Äôon d√©sire conna√Ætre chez une population. Ces angles d‚Äôobservations sont les <strong>variables</strong>.</p>
</div>
<div id="les-variables" class="section level2">
<h2><span class="header-section-number">6.2</span> Les variables</h2>
<p>Nous avons abord√© au chapitre <a href="chapitre-tableaux.html#chapitre-tableaux">3</a> la notion de <em>variable</em> par l‚Äôinterm√©diaire d‚Äôune donn√©e. Une variable est l‚Äôobservation d‚Äôune caract√©ristique d√©crivant un √©chantillon. Si la charact√©ristique varie d‚Äôun √©chantillon √† un autre sans que vous en expliquiez la raison (i.e.¬†si identifier la source de la variabilit√© ne fait pas partie de votre exp√©rience), on parlera de variable al√©atoire. M√™me le hasard est r√©gi par certaines lois: ce qui est al√©atoire dans une variable peut √™tre d√©crit par des <strong>lois de probabilit√©</strong>, que nous verrons plus bas.</p>
<p>Mais restons aux variables pour l‚Äôinstant. Par convention, on peut attribuer aux variables un symbole math√©matique. Par exemple, on peut donner √† la masse volumique d‚Äôun sol (qui est le r√©sultat d‚Äôune m√©thodologie pr√©cise) le symbole <span class="math inline">\(\rho\)</span>. Lorsque l‚Äôon attribue une valeur √† <span class="math inline">\(\rho\)</span>, on parle d‚Äôune donn√©e. Chaque donn√©e d‚Äôune observation a un indice qui lui est propre, que l‚Äôon d√©signe souvent par <span class="math inline">\(i\)</span>, que l‚Äôon place en indice <span class="math inline">\(\rho_i\)</span>. Pour la premi√®re donn√©e, on a <span class="math inline">\(i=1\)</span>, donc <span class="math inline">\(\rho_1\)</span>. Pour un nombre <span class="math inline">\(n\)</span> d‚Äô√©chantillons, on aura <span class="math inline">\(\rho_1\)</span>, <span class="math inline">\(\rho_2\)</span>, <span class="math inline">\(\rho_3\)</span>, ‚Ä¶, <span class="math inline">\(\rho_n\)</span>, formant le vecteur <span class="math inline">\(\rho = \left[\rho_1, \rho_2, \rho_3, ..., \rho_n \right]\)</span>.</p>
<p>En R, une variable est associ√©e √† un vecteur ou une colonne d‚Äôun tableau.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapitre-biostats.html#cb1-1"></a>rho &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">1.34</span>, <span class="fl">1.52</span>, <span class="fl">1.26</span>, <span class="fl">1.43</span>, <span class="fl">1.39</span>) <span class="co"># matrice 1D</span></span>
<span id="cb1-2"><a href="chapitre-biostats.html#cb1-2"></a>data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">rho =</span> rho) <span class="co"># tableau</span></span>
<span id="cb1-3"><a href="chapitre-biostats.html#cb1-3"></a>data</span></code></pre></div>
<pre><code>##    rho
## 1 1.34
## 2 1.52
## 3 1.26
## 4 1.43
## 5 1.39</code></pre>
<p>Il existe plusieurs types de variables, qui se regroupe en deux grandes cat√©gories: les <strong>variables quantitatives</strong> et les <strong>variables qualitatives</strong>.</p>
<div id="variables-quantitatives" class="section level3">
<h3><span class="header-section-number">6.2.1</span> Variables quantitatives</h3>
<p>Ces variables peuvent √™tre continues dans un espace √©chantillonnal r√©el ou discr√®tes dans un espace √©chantillonnal ne consid√©rant que des valeurs fixes. Notons que la notion de nombre r√©el est toujours une approximation en sciences exp√©rimentales comme en calcul num√©rique, √©tant donn√©e que l‚Äôon est limit√© par la pr√©cision des appareils comme par le nombre d‚Äôoctets √† utiliser. Bien que les valeurs fixes des distributions discr√®tes ne soient pas toujours des valeurs enti√®res, c‚Äôest bien souvent le cas en biostatistiques comme en d√©mographie, o√π les d√©comptes d‚Äôindividus sont souvent pr√©sents (et o√π la notion de fraction d‚Äôindividus n‚Äôest pas accept√©e).</p>
</div>
<div id="variables-qualitatives" class="section level3">
<h3><span class="header-section-number">6.2.2</span> Variables qualitatives</h3>
<p>On exprime parfois qu‚Äôune variable qualitative est une variable impossible √† mesurer num√©riquement: une couleur, l‚Äôappartenance √† esp√®ce ou √† une s√©rie de sol. Pourtant, dans bien des cas, les variables qualitatives peut √™tre encod√©es en variables quantitatives. Par exemple, on peut accoler des pourcentages de sable, limon et argile √† un loam sableux, qui autrement est d√©crit par la classe texturale d‚Äôun sol. Pour une couleur, on peut lui associer une longueur d‚Äôonde ou des pourcentages de rouge, vert et bleu, ainsi qu‚Äôun ton. En ce qui a trait aux variables ordonn√©es, il est possible de supposer un √©talement. Par exemple, une variable d‚Äôintensit√© faible-moyenne-forte peut √™tre transform√©e lin√©airement en valeurs quantitatives -1, 0 et 1. Attention toutefois, l‚Äô√©talement peut parfois √™tre quadratique ou logarithmique. Les s√©ries de sol peuvent √™tre encod√©es par la proportion de gleyfication (<a href="https://www.frontiersin.org/articles/10.3389/fenvs.2017.00081/full#B4">Parent et al., 2017</a>). Quant aux cat√©gories difficilement transformables en quantit√©s, on pourra passer par l‚Äô<strong>encodage cat√©goriel</strong>, souvent appel√© <em>dummyfication</em>, qui nous verrons plus loin. L‚Äôanalyse qualitative consiste en l‚Äôanalyse de verbatims, essentiellement utile en sciences sociales: nous n‚Äôen n‚Äôaurons pas besoin ici. Nous consid√©rerons les variables qualitatives comme des variables quantitatives qui n‚Äôont pas subi de pr√©traitement.</p>
</div>
</div>
<div id="les-probabilit√©s" class="section level2">
<h2><span class="header-section-number">6.3</span> Les probabilit√©s</h2>
<blockquote>
<p>¬´ Nous sommes si √©loign√©s de conna√Ætre tous les agens de la nature, et leurs divers modes d‚Äôaction ; qu‚Äôil ne serait pas philosophique de nier les ph√©nom√®nes, uniquement parce qu‚Äôils sont inexplicables dans l‚Äô√©tat actuel de nos connaissances. Seulement, nous devons les examiner avec une attention d‚Äôautant plus scrupuleuse, qu‚Äôil para√Æt plus difficile de les admettre ; et c‚Äôest ici que le calcul des probabilit√©s devient indispensable, pour d√©terminer jusqu‚Äô√† quel point il faut multiplier les observations ou les exp√©riences, afin d‚Äôobtenir en faveur des agens qu‚Äôelles indiquent, une probabilit√© sup√©rieure aux raisons que l‚Äôon peut avoir d‚Äôailleurs, de ne pas les admettre. ¬ª ‚Äî Pierre-Simon de Laplace</p>
</blockquote>
<p>Une probabilit√© est la vraisemblance qu‚Äôun √©v√®nement se r√©alise chez un √©chantillon. Les probabilit√©s forment le cadre des syst√®mes stochastiques, c‚Äôest-√†-dire des syst√®mes trop complexes pour en conna√Ætre exactement les aboutissants, auxquels on attribue une part de hasard. Ces syst√®mes sont pr√©dominants dans les processus vivants.</p>
<p>On peut d√©gager deux perspectives sur les probabilit√©s: l‚Äôune passe par une interpr√©tation fr√©quentielle, l‚Äôautre bay√©sienne.</p>
<ul>
<li>L‚Äôinterpr√©tation <strong>fr√©quentielle</strong> repr√©sente la fr√©quence des occurrences apr√®s un nombre infini d‚Äô√©v√®nements. Par exemple, si vous jouez √† pile ou face un grand nombre de fois, le nombre de pile sera √©gal √† la moiti√© du nombre de lanc√©s. <em>L‚Äôapproche fr√©quentielle teste si les donn√©es concordent avec un mod√®le du r√©el</em>. Il s‚Äôagit de l‚Äôinterpr√©tation commun√©ment utilis√©e.</li>
<li>L‚Äôinterpr√©tation <strong>bay√©sienne</strong> vise √† quantifier l‚Äôincertitude des ph√©nom√®nes. Dans cette perspective, plus l‚Äôinformation s‚Äôaccumule, plus l‚Äôincertitude diminue. Cette approche gagne en notori√©t√© notamment parce qu‚Äôelle permet de d√©crire des ph√©nom√®nes qui, intrins√®quement, ne peuvent √™tre r√©p√©t√©s infiniment (absence d‚Äôasymptote), comme celles qui sont bien d√©finis dans le temps ou sur des populations limit√©s. <em>L‚Äôapproche bay√©sienne √©value la probabilit√© que le mod√®le soit r√©el</em>.</li>
</ul>
<p>Une erreur courante consiste √† aborder des statistiques fr√©quentielles comme des statistiques bay√©siennes. Par exemple, si l‚Äôon d√©sire √©valuer la probabilit√© de l‚Äôexistence de vie sur Mars, on devra passer par le bay√©sien, car avec les stats fr√©quentielles, l‚Äôon devra plut√¥t conclure si les donn√©es sont conformes ou non avec l‚Äôhypoth√®se de la vie sur Mars (exemple tir√©e du blogue <a href="https://dynamicecology.wordpress.com/2011/10/11/frequentist-vs-bayesian-statistics-resources-to-help-you-choose/">Dynamic Ecology</a>).</p>
<p>Des rivalit√©s factices s‚Äôinstallent enter les tenants des diff√©rentes approches, dont chacune, en r√©alit√©, r√©pond √† des questions diff√©rentes dont il convient r√©fl√©chir sur les limitations. Bien que les statistiques bay√©siennes soient de plus en plus utilis√©es, nous ne couvrirons dans ce chapitre que l‚Äôapproche fr√©quentielle. L‚Äôapproche bay√©sienne est n√©anmoins trait√©e dans le chapitre <a href="chapitre-biostats-bayes.html#chapitre-biostats-bayes">7</a>, qui est facultatif au cours.</p>
</div>
<div id="les-distributions" class="section level2">
<h2><span class="header-section-number">6.4</span> Les distributions</h2>
<p>Une variable al√©atoire peut prendre des valeurs selon des mod√®les de distribution des probabilit√©s. Une distribution est une fonction math√©matique d√©crivant la probabilit√© d‚Äôobserver une s√©rie d‚Äô√©v√®nements. Ces √©v√®nements peuvent √™tre des valeurs continues, des nombres entiers, des cat√©gories, des valeurs bool√©ennes (Vrai/Faux), etc. D√©pendemment du type de valeur et des observations obtenues, on peut associer des variables √† diff√©rentes lois de probabilit√©. Toujours, l‚Äôaire sous la courbe d‚Äôune distribution de probabilit√© est √©gale √† 1.</p>
<p>En statistiques inf√©rentielles, les distributions sont les mod√®les, comprenant certains param√®tres comme la moyenne et la variance pour les distributions normales, √† partir desquelles les donn√©es sont g√©n√©r√©es.</p>
<p>Il existe deux grandes familles de distribution: <strong>discr√®tes</strong> et <strong>continues</strong>. Les distributions discr√®tes sont contraintes √† des valeurs pr√©d√©finies (finies ou infinies), alors que les distributions continues prennent n√©cessairement un nombre infini de valeur, dont la probabilit√© ne peut pas √™tre √©valu√©e ponctuellement, mais sur un intervalle.</p>
<p>L‚Äô<strong>esp√©rance</strong> math√©matique est une fonction de tendance centrale, souvent d√©crite par un param√®tre. Il s‚Äôagit de la moyenne d‚Äôune population pour une distribution normale. La <strong>variance</strong>, quant √† elle, d√©crit la variabilit√© d‚Äôune population, i.e.¬†son √©talement autour de l‚Äôesp√©rance. Pour une distribution normale, la variance d‚Äôune population est aussi appel√©e variance, souvent pr√©sent√©e par l‚Äô√©cart-type (√©gal √† la racine carr√©e de la variance).</p>
<div id="distribution-binomiale" class="section level3">
<h3><span class="header-section-number">6.4.1</span> Distribution binomiale</h3>
<p>En tant que sc√©nario √† deux issues possibles, des tirages √† pile ou face suivent une loi binomiale, comme toute variable bool√©enne prenant une valeur vraie ou fausse. En biostatistiques, les cas communs sont la pr√©sence/absence d‚Äôune esp√®ce, d‚Äôune maladie, d‚Äôun trait phylog√©n√©tique, ainsi que les cat√©gories encod√©es. Lorsque l‚Äôop√©ration ne comprend qu‚Äôun seul √©chantillon (i.e.¬†un seul tirage √† pile ou face), il s‚Äôagit d‚Äôun cas particulier d‚Äôune loi binomiale que l‚Äôon nomme une loi de <em>Bernouilli</em>.</p>
<p>Pour 25 tirages √† pile ou face ind√©pendants (i.e.¬†dont l‚Äôordre des tirages ne compte pas), on peut dessiner une courbe de distribution dont la somme des probabilit√©s est de 1. La fonction <code>dbinom</code> est une fonction de distribution de probabilit√©s. Les fonctions de distribution de probabilit√©s discr√®tes sont appel√©es des fonctions de masse.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="chapitre-biostats.html#cb3-1"></a><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<pre><code>## -- Attaching packages ----------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.0     v purrr   0.3.4
## v tibble  3.0.1     v dplyr   0.8.5
## v tidyr   1.1.0     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts -------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapitre-biostats.html#cb7-1"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">25</span></span>
<span id="cb7-2"><a href="chapitre-biostats.html#cb7-2"></a>y &lt;-<span class="st"> </span><span class="kw">dbinom</span>(<span class="dt">x =</span> x, <span class="dt">size =</span> <span class="dv">25</span>, <span class="dt">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb7-3"><a href="chapitre-biostats.html#cb7-3"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;La somme des probabilit√©s est de&#39;</span>, <span class="kw">sum</span>(y)))</span></code></pre></div>
<pre><code>## [1] &quot;La somme des probabilit√©s est de 1&quot;</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapitre-biostats.html#cb9-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(x, y), <span class="dt">mapping =</span> <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb9-2"><a href="chapitre-biostats.html#cb9-2"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> x, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> y), <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></span>
<span id="cb9-3"><a href="chapitre-biostats.html#cb9-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-binom-1.png" width="672" /></p>
</div>
<div id="distribution-de-poisson" class="section level3">
<h3><span class="header-section-number">6.4.2</span> Distribution de Poisson</h3>
<p>La loi de Poisson (avec un P majuscule, introduite par le math√©maticien fran√ßais Sim√©on Denis Poisson et non pas l‚Äôanimal) d√©crit des distributions discr√®tes de probabilit√© d‚Äôun nombre d‚Äô√©v√®nements se produisant dans l‚Äôespace ou dans le temps. Les distributions de Poisson d√©crivent ce qui tient du d√©compte. Il peut s‚Äôagir du nombre de grenouilles traversant une rue quotidiennement, du nombre de plants d‚Äôascl√©piades se trouvant sur une terre cultiv√©e, ou du nombre d‚Äô√©v√®nements de pr√©cipitation au mois de juin, etc. La distribution de Poisson n‚Äôa qu‚Äôun seul param√®tre, <span class="math inline">\(\lambda\)</span>, qui d√©crit tant la moyenne des d√©comptes.</p>
<p>Par exemple, en un mois de 30 jours, et une moyenne de 8 √©v√®nements de pr√©cipitation pour ce mois, on obtient la distribution suivante.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapitre-biostats.html#cb10-1"></a>x &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">30</span></span>
<span id="cb10-2"><a href="chapitre-biostats.html#cb10-2"></a>y &lt;-<span class="st"> </span><span class="kw">dpois</span>(x, <span class="dt">lambda =</span> <span class="dv">8</span>)</span>
<span id="cb10-3"><a href="chapitre-biostats.html#cb10-3"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;La somme des probabilit√©s est de&#39;</span>, <span class="kw">sum</span>(y)))</span></code></pre></div>
<pre><code>## [1] &quot;La somme des probabilit√©s est de 0.999664536835124&quot;</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="chapitre-biostats.html#cb12-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(x, y), <span class="dt">mapping =</span> <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb12-2"><a href="chapitre-biostats.html#cb12-2"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">xend =</span> x, <span class="dt">y =</span> <span class="dv">0</span>, <span class="dt">yend =</span> y), <span class="dt">color =</span> <span class="st">&quot;grey50&quot;</span>) <span class="op">+</span></span>
<span id="cb12-3"><a href="chapitre-biostats.html#cb12-3"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-poisson-1.png" width="672" /></p>
</div>
<div id="distribution-uniforme" class="section level3">
<h3><span class="header-section-number">6.4.3</span> Distribution uniforme</h3>
<p>La distribution la plus simple est probablement la distribution uniforme. Si la variable est discr√®te, chaque cat√©gorie est associ√©e √† une probabilit√© √©gale. Si la variable est continue, la probabilit√© est directement proportionnelle √† la largeur de l‚Äôintervalle. On utilise rarement la distribution uniforme en biostatistiques, sinon pour d√©crire des <em>a priori</em> vagues pour l‚Äôanalyse bay√©sienne (ce sujet est trait√© dans le chapitre <a href="chapitre-biostats-bayes.html#chapitre-biostats-bayes">7</a>). Nous utilisons la fonction <code>dunif</code>. √Ä la diff√©rence des distributions discr√®tes, les fonctions de distribution de probabilit√©s continues sont appel√©es des fonctions de densit√© d‚Äôune loi de probabilit√© (<em>probability density function</em>).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="chapitre-biostats.html#cb13-1"></a>increment &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb13-2"><a href="chapitre-biostats.html#cb13-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">by =</span> increment)</span>
<span id="cb13-3"><a href="chapitre-biostats.html#cb13-3"></a>y1 &lt;-<span class="st"> </span><span class="kw">dunif</span>(x, <span class="dt">min =</span> <span class="dv">-3</span>, <span class="dt">max =</span> <span class="dv">3</span>)</span>
<span id="cb13-4"><a href="chapitre-biostats.html#cb13-4"></a>y2 &lt;-<span class="st"> </span><span class="kw">dunif</span>(x, <span class="dt">min =</span> <span class="dv">-2</span>, <span class="dt">max =</span> <span class="dv">2</span>)</span>
<span id="cb13-5"><a href="chapitre-biostats.html#cb13-5"></a>y3 &lt;-<span class="st"> </span><span class="kw">dunif</span>(x, <span class="dt">min =</span> <span class="dv">-1</span>, <span class="dt">max =</span> <span class="dv">1</span>)</span>
<span id="cb13-6"><a href="chapitre-biostats.html#cb13-6"></a></span>
<span id="cb13-7"><a href="chapitre-biostats.html#cb13-7"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;La somme des probabilit√©s est de&#39;</span>, <span class="kw">sum</span>(y3 <span class="op">*</span><span class="st"> </span>increment)))</span></code></pre></div>
<pre><code>## [1] &quot;La somme des probabilit√©s est de 1.005&quot;</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="chapitre-biostats.html#cb15-1"></a>gg_unif &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y1, y2, y3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>x)</span>
<span id="cb15-2"><a href="chapitre-biostats.html#cb15-2"></a></span>
<span id="cb15-3"><a href="chapitre-biostats.html#cb15-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> gg_unif, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb15-4"><a href="chapitre-biostats.html#cb15-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> variable))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-unif-1.png" width="672" /></p>
</div>
<div id="distribution-normale" class="section level3">
<h3><span class="header-section-number">6.4.4</span> Distribution normale</h3>
<p>La plus r√©pandue de ces lois est probablement la loi normale, parfois nomm√©e loi gaussienne et plus rarement loi laplacienne. Il s‚Äôagit de la distribution classique en forme de cloche.</p>
<p>La loi normale est d√©crite par une moyenne, qui d√©signe la tendance centrale, et une variance, qui d√©signe l‚Äô√©talement des probabilit√©s autour de la moyenne. La racine carr√©e de la variance est l‚Äô√©cart-type.</p>
<p>Les distributions de mesures exclusivement positives (comme le poids ou la taille) sont parfois avantageusement approxim√©es par une loi <strong>log-normale</strong>, qui est une loi normale sur le logarithme des valeurs: la moyenne d‚Äôune loi log-normale est la moyenne g√©om√©trique.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="chapitre-biostats.html#cb16-1"></a>increment &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb16-2"><a href="chapitre-biostats.html#cb16-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="dt">by =</span> increment)</span>
<span id="cb16-3"><a href="chapitre-biostats.html#cb16-3"></a>y1 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb16-4"><a href="chapitre-biostats.html#cb16-4"></a>y2 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">2</span>)</span>
<span id="cb16-5"><a href="chapitre-biostats.html#cb16-5"></a>y3 &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">3</span>)</span>
<span id="cb16-6"><a href="chapitre-biostats.html#cb16-6"></a></span>
<span id="cb16-7"><a href="chapitre-biostats.html#cb16-7"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&#39;La somme des probabilit√©s est de&#39;</span>, <span class="kw">sum</span>(y3 <span class="op">*</span><span class="st"> </span>increment)))</span></code></pre></div>
<pre><code>## [1] &quot;La somme des probabilit√©s est de 0.999147010743368&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="chapitre-biostats.html#cb18-1"></a>gg_norm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y1, y2, y3) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>x)</span>
<span id="cb18-2"><a href="chapitre-biostats.html#cb18-2"></a></span>
<span id="cb18-3"><a href="chapitre-biostats.html#cb18-3"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> gg_norm, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> value)) <span class="op">+</span></span>
<span id="cb18-4"><a href="chapitre-biostats.html#cb18-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> variable))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-norm-1.png" width="672" /></p>
<p>Quelle est la probabilit√© d‚Äôobtenir le nombre 0 chez une observation continue distribu√©e normalement dont la moyenne est 0 et l‚Äô√©cart-type est de 1? R√©ponse: 0. La loi normale √©tant une distribution continue, les probabilit√©s non-nulles ne peuvent √™tre calcul√©s que sur des intervalles. Par exemple, la probabilit√© de retrouver une valeur dans l‚Äôintervalle entre -1 et 2 est calcul√©e en soustrayant la probabilit√© cumul√©e √† -1 de la probabilit√© cumul√©e √† 2.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapitre-biostats.html#cb19-1"></a>increment &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb19-2"><a href="chapitre-biostats.html#cb19-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">by =</span> increment)</span>
<span id="cb19-3"><a href="chapitre-biostats.html#cb19-3"></a>y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb19-4"><a href="chapitre-biostats.html#cb19-4"></a></span>
<span id="cb19-5"><a href="chapitre-biostats.html#cb19-5"></a>prob_between &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb19-6"><a href="chapitre-biostats.html#cb19-6"></a></span>
<span id="cb19-7"><a href="chapitre-biostats.html#cb19-7"></a>gg_norm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb19-8"><a href="chapitre-biostats.html#cb19-8"></a>gg_auc &lt;-<span class="st"> </span>gg_norm <span class="op">%&gt;%</span></span>
<span id="cb19-9"><a href="chapitre-biostats.html#cb19-9"></a><span class="st">  </span><span class="kw">filter</span>(x <span class="op">&gt;</span><span class="st"> </span>prob_between[<span class="dv">1</span>], x <span class="op">&lt;</span><span class="st"> </span>prob_between[<span class="dv">2</span>]) <span class="op">%&gt;%</span></span>
<span id="cb19-10"><a href="chapitre-biostats.html#cb19-10"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="kw">c</span>(prob_between[<span class="dv">2</span>], <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb19-11"><a href="chapitre-biostats.html#cb19-11"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="kw">c</span>(prob_between[<span class="dv">1</span>], <span class="dv">0</span>))</span>
<span id="cb19-12"><a href="chapitre-biostats.html#cb19-12"></a></span>
<span id="cb19-13"><a href="chapitre-biostats.html#cb19-13"></a><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(x, y), <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb19-14"><a href="chapitre-biostats.html#cb19-14"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> gg_auc, <span class="dt">fill =</span> <span class="st">&#39;#71ad50&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># #71ad50 est un code de couleur format hexad√©cimal</span></span>
<span id="cb19-15"><a href="chapitre-biostats.html#cb19-15"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-norm-prob-1.png" width="672" /></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="chapitre-biostats.html#cb20-1"></a>prob_norm_between &lt;-<span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> prob_between[<span class="dv">2</span>], <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>) <span class="op">-</span><span class="st"> </span><span class="kw">pnorm</span>(<span class="dt">q =</span> prob_between[<span class="dv">1</span>], <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb20-2"><a href="chapitre-biostats.html#cb20-2"></a><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;La probabilit√© d&#39;obtenir un nombre entre&quot;</span>,</span>
<span id="cb20-3"><a href="chapitre-biostats.html#cb20-3"></a>            prob_between[<span class="dv">1</span>], <span class="st">&quot;et&quot;</span>,</span>
<span id="cb20-4"><a href="chapitre-biostats.html#cb20-4"></a>            prob_between[<span class="dv">2</span>], <span class="st">&quot;est d&#39;environ&quot;</span>,</span>
<span id="cb20-5"><a href="chapitre-biostats.html#cb20-5"></a>            <span class="kw">round</span>(prob_norm_between, <span class="dv">2</span>) <span class="op">*</span><span class="st"> </span><span class="dv">100</span>, <span class="st">&quot;%&quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;La probabilit√© d&#39;obtenir un nombre entre -1 et 2 est d&#39;environ 82 %&quot;</code></pre>
<p>La courbe normale peut √™tre utile pour √©valuer la distribution d‚Äôune population. Par exemple, on peut calculer les limites de r√©gion sur la courbe normale qui contient 95% des valeurs possibles en tranchant 2.5% de part et d‚Äôautre de la moyenne. Il s‚Äôagit ainsi de l‚Äôintervalle de confiance sur la d√©viation de la distribution.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="chapitre-biostats.html#cb22-1"></a>increment &lt;-<span class="st"> </span><span class="fl">0.01</span></span>
<span id="cb22-2"><a href="chapitre-biostats.html#cb22-2"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="op">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">by =</span> increment)</span>
<span id="cb22-3"><a href="chapitre-biostats.html#cb22-3"></a>y &lt;-<span class="st"> </span><span class="kw">dnorm</span>(x, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb22-4"><a href="chapitre-biostats.html#cb22-4"></a></span>
<span id="cb22-5"><a href="chapitre-biostats.html#cb22-5"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb22-6"><a href="chapitre-biostats.html#cb22-6"></a>prob_between &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">qnorm</span>(<span class="dt">p =</span> alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>),</span>
<span id="cb22-7"><a href="chapitre-biostats.html#cb22-7"></a>                  <span class="kw">qnorm</span>(<span class="dt">p =</span> <span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>))</span>
<span id="cb22-8"><a href="chapitre-biostats.html#cb22-8"></a></span>
<span id="cb22-9"><a href="chapitre-biostats.html#cb22-9"></a>gg_norm &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x, y)</span>
<span id="cb22-10"><a href="chapitre-biostats.html#cb22-10"></a>gg_auc &lt;-<span class="st"> </span>gg_norm <span class="op">%&gt;%</span></span>
<span id="cb22-11"><a href="chapitre-biostats.html#cb22-11"></a><span class="st">  </span><span class="kw">filter</span>(x <span class="op">&gt;</span><span class="st"> </span>prob_between[<span class="dv">1</span>], x <span class="op">&lt;</span><span class="st"> </span>prob_between[<span class="dv">2</span>]) <span class="op">%&gt;%</span></span>
<span id="cb22-12"><a href="chapitre-biostats.html#cb22-12"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="kw">c</span>(prob_between[<span class="dv">2</span>], <span class="dv">0</span>)) <span class="op">%&gt;%</span></span>
<span id="cb22-13"><a href="chapitre-biostats.html#cb22-13"></a><span class="st">  </span><span class="kw">rbind</span>(<span class="kw">c</span>(prob_between[<span class="dv">1</span>], <span class="dv">0</span>))</span>
<span id="cb22-14"><a href="chapitre-biostats.html#cb22-14"></a></span>
<span id="cb22-15"><a href="chapitre-biostats.html#cb22-15"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(x, y), <span class="dt">mapping =</span> <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb22-16"><a href="chapitre-biostats.html#cb22-16"></a><span class="st">  </span><span class="kw">geom_polygon</span>(<span class="dt">data =</span> gg_auc, <span class="dt">fill =</span> <span class="st">&#39;#71ad50&#39;</span>) <span class="op">+</span><span class="st"> </span><span class="co"># #71ad50 est un code de couleur format hexad√©cimal</span></span>
<span id="cb22-17"><a href="chapitre-biostats.html#cb22-17"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb22-18"><a href="chapitre-biostats.html#cb22-18"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">data =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> prob_between,</span>
<span id="cb22-19"><a href="chapitre-biostats.html#cb22-19"></a>                              <span class="dt">y =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb22-20"><a href="chapitre-biostats.html#cb22-20"></a>                              <span class="dt">labels =</span> <span class="kw">round</span>(prob_between, <span class="dv">2</span>)),</span>
<span id="cb22-21"><a href="chapitre-biostats.html#cb22-21"></a>            <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">label =</span> labels))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-norm-ci-1.png" width="672" /></p>
<p>On pourrait aussi √™tre int√©ress√© √† l‚Äôintervalle de confiance sur la moyenne. En effet, la moyenne suit aussi une distribution normale, dont la tendance centrale est la moyenne de la distribution, et dont l‚Äô√©cart-type est not√© <em>erreur standard</em>. On calcule cette erreur en divisant la variance par le nombre d‚Äôobservation, ou en divisant l‚Äô√©cart-type par la racine carr√©e du nombre d‚Äôobservations. Ainsi, pour 10 √©chantillons:</p>
<pre class="{rbiostats-norm-mean-ci}"><code>increment &lt;- 0.01
x &lt;- seq(-5, 5, by = increment)
y &lt;- dnorm(x, mean = 0, sd = 1)

alpha &lt;- 0.05
prob_between &lt;- c(qnorm(p = alpha/2, mean = 0, sd = 1) / sqrt(10),
                  qnorm(p = 1 - alpha/2, mean = 0, sd = 1) / sqrt(10))

gg_norm &lt;- data.frame(x, y)
gg_auc &lt;- gg_norm %&gt;%
  filter(x &gt; prob_between[1], x &lt; prob_between[2]) %&gt;%
  rbind(c(prob_between[2], 0)) %&gt;%
  rbind(c(prob_between[1], 0))

ggplot(data = data.frame(x, y), mapping = aes(x, y)) +
  geom_polygon(data = gg_auc, fill = &#39;#71ad50&#39;) + # #71ad50 est un code de couleur format hexad√©cimal
  geom_line() +
  geom_text(data = data.frame(x = prob_between,
                              y = c(0, 0),
                              labels = round(prob_between, 2)),
            mapping = aes(label = labels))</code></pre>
</div>
</div>
<div id="statistiques-descriptives" class="section level2">
<h2><span class="header-section-number">6.5</span> Statistiques descriptives</h2>
<p>On a vu comment g√©n√©rer des statistiques sommaires en R avec la fonction <code>summary()</code>. Reprenons les donn√©es d‚Äôiris.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="chapitre-biostats.html#cb24-1"></a><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</span>
<span id="cb24-2"><a href="chapitre-biostats.html#cb24-2"></a><span class="kw">summary</span>(iris)</span></code></pre></div>
<pre><code>##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## </code></pre>
<p>Pour pr√©cis√©ment effectuer une moyenne et un √©cart-type sur un vecteur, passons par les fonctions <code>mean()</code> et <code>sd()</code>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="chapitre-biostats.html#cb26-1"></a><span class="kw">mean</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] 5.843333</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapitre-biostats.html#cb28-1"></a><span class="kw">sd</span>(iris<span class="op">$</span>Sepal.Length)</span></code></pre></div>
<pre><code>## [1] 0.8280661</code></pre>
<p>Pour effectuer un sommaire de tableau pilot√© par une fonction, nous passons par la gamme de fonctions <code>summarise()</code>, de dplyr. Dans ce cas, avec <code>group_by()</code>, nous fragmentons le tableau par esp√®ce pour effectuer un sommaire sur toutes les variables.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="chapitre-biostats.html#cb30-1"></a>iris <span class="op">%&gt;%</span></span>
<span id="cb30-2"><a href="chapitre-biostats.html#cb30-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></span>
<span id="cb30-3"><a href="chapitre-biostats.html#cb30-3"></a><span class="st">  </span><span class="kw">summarise_all</span>(mean)</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   Species    Sepal.Length Sepal.Width Petal.Length Petal.Width
##   &lt;fct&gt;             &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1 setosa             5.01        3.43         1.46       0.246
## 2 versicolor         5.94        2.77         4.26       1.33 
## 3 virginica          6.59        2.97         5.55       2.03</code></pre>
<p>Vous pourriez √™tre int√©ress√© par les quartiles √† 25, 50 et 75%. Mais la fonction <code>summarise()</code> n‚Äôautorise que les fonctions dont la sortie est d‚Äôun seul objet, alors faisons sorte que l‚Äôobjet soit une liste - lorsque l‚Äôon imbrique une fonction <code>funs</code>, le tableau √† ins√©rer dans la fonction est indiqu√© par un <code>.</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="chapitre-biostats.html#cb32-1"></a>iris <span class="op">%&gt;%</span></span>
<span id="cb32-2"><a href="chapitre-biostats.html#cb32-2"></a><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></span>
<span id="cb32-3"><a href="chapitre-biostats.html#cb32-3"></a><span class="st">  </span><span class="kw">summarise_all</span>(<span class="kw">list</span>(<span class="dt">q25 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.25</span>),</span>
<span id="cb32-4"><a href="chapitre-biostats.html#cb32-4"></a>                     <span class="dt">q50 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.50</span>),</span>
<span id="cb32-5"><a href="chapitre-biostats.html#cb32-5"></a>                     <span class="dt">q75 =</span> <span class="op">~</span><span class="st"> </span><span class="kw">quantile</span>(., <span class="dt">probs =</span> <span class="fl">0.75</span>)))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 13
##   Species Sepal.Length_q25 Sepal.Width_q25 Petal.Length_q25 Petal.Width_q25
##   &lt;fct&gt;              &lt;dbl&gt;           &lt;dbl&gt;            &lt;dbl&gt;           &lt;dbl&gt;
## 1 setosa              4.8             3.2               1.4             0.2
## 2 versic~             5.6             2.52              4               1.2
## 3 virgin~             6.22            2.8               5.1             1.8
## # ... with 8 more variables: Sepal.Length_q50 &lt;dbl&gt;, Sepal.Width_q50 &lt;dbl&gt;,
## #   Petal.Length_q50 &lt;dbl&gt;, Petal.Width_q50 &lt;dbl&gt;, Sepal.Length_q75 &lt;dbl&gt;,
## #   Sepal.Width_q75 &lt;dbl&gt;, Petal.Length_q75 &lt;dbl&gt;, Petal.Width_q75 &lt;dbl&gt;</code></pre>
<p>En mode programmation classique de R, on pourra g√©n√©rer les quartiles √† la pi√®ce.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="chapitre-biostats.html#cb34-1"></a><span class="kw">quantile</span>(iris<span class="op">$</span>Sepal.Length[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;setosa&#39;</span>])</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##  4.3  4.8  5.0  5.2  5.8</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="chapitre-biostats.html#cb36-1"></a><span class="kw">quantile</span>(iris<span class="op">$</span>Sepal.Length[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;versicolor&#39;</span>])</span></code></pre></div>
<pre><code>##   0%  25%  50%  75% 100% 
##  4.9  5.6  5.9  6.3  7.0</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="chapitre-biostats.html#cb38-1"></a><span class="kw">quantile</span>(iris<span class="op">$</span>Sepal.Length[iris<span class="op">$</span>Species <span class="op">==</span><span class="st"> &#39;virginica&#39;</span>])</span></code></pre></div>
<pre><code>##    0%   25%   50%   75%  100% 
## 4.900 6.225 6.500 6.900 7.900</code></pre>
<p>La fonction <code>table()</code> permettra d‚Äôobtenir des d√©comptes par cat√©gorie, ici par plages de longueurs de s√©pales. Pour obtenir les proportions du nombre total, il s‚Äôagit d‚Äôencapsuler le tableau crois√© dans la fonction <code>prop.table()</code>.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="chapitre-biostats.html#cb40-1"></a>tableau_croise &lt;-<span class="st"> </span><span class="kw">table</span>(iris<span class="op">$</span>Species,</span>
<span id="cb40-2"><a href="chapitre-biostats.html#cb40-2"></a>                        <span class="kw">cut</span>(iris<span class="op">$</span>Sepal.Length, <span class="dt">breaks =</span> <span class="kw">quantile</span>(iris<span class="op">$</span>Sepal.Length)))</span>
<span id="cb40-3"><a href="chapitre-biostats.html#cb40-3"></a>tableau_croise</span></code></pre></div>
<pre><code>##             
##              (4.3,5.1] (5.1,5.8] (5.8,6.4] (6.4,7.9]
##   setosa            35        14         0         0
##   versicolor         4        20        17         9
##   virginica          1         5        18        26</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapitre-biostats.html#cb42-1"></a><span class="kw">prop.table</span>(tableau_croise)</span></code></pre></div>
<pre><code>##             
##                (4.3,5.1]   (5.1,5.8]   (5.8,6.4]   (6.4,7.9]
##   setosa     0.234899329 0.093959732 0.000000000 0.000000000
##   versicolor 0.026845638 0.134228188 0.114093960 0.060402685
##   virginica  0.006711409 0.033557047 0.120805369 0.174496644</code></pre>
</div>
<div id="tests-dhypoth√®ses-√†-un-et-deux-√©chantillons" class="section level2">
<h2><span class="header-section-number">6.6</span> Tests d‚Äôhypoth√®ses √† un et deux √©chantillons</h2>
<p>Un test d‚Äôhypoth√®se permet de d√©cider si une hypoth√®se est confirm√©e ou rejet√©e √† un seuil de probabilit√© pr√©d√©termin√©.</p>
<p>Cette section est inspir√©e du chapitre 5 de <a href="https://www.springer.com/us/book/9780387790534">Dalgaard, 2008</a>.</p>
<hr />
<p><strong>Information: l‚Äôhypoth√®se nulle</strong>. Les tests d‚Äôhypoth√®se √©valuent des <em>effets</em> statistiques (qui ne sont pas n√©cessairement des effets de causalit√©). L‚Äôeffet √† √©valuer peut √™tre celui d‚Äôun traitement, d‚Äôindicateurs m√©t√©orologiques (e.g.¬†pr√©cipitations totales, degr√©-jour, etc.), de techniques de gestion des paysages, etc. Une recherche est men√©e pour √©valuer l‚Äôhypoth√®se que l‚Äôon retrouve des diff√©rences entre des unit√©s exp√©rimentales. Par convention, l‚Äô<strong>hypoth√®se nulle</strong> (√©crite <span class="math inline">\(H_0\)</span>) est l‚Äôhypoth√®se qu‚Äôil n‚Äôy ait pas d‚Äôeffet (c‚Äôest l‚Äôhypoth√®se de l‚Äôavocat du diable üòà) √† l‚Äô√©chelle de la population (et non pas √† l‚Äô√©chelle de l‚Äô√©chantillon). √Ä l‚Äôinverse, l‚Äô<strong>hypoth√®se alternative</strong> (√©crite <span class="math inline">\(H_1\)</span>) est l‚Äôhypoth√®se qu‚Äôil y ait un effet √† l‚Äô√©chelle de la population.</p>
<hr />
<p>√Ä titre d‚Äôexercice en stats, on d√©bute souvent par en testant si deux vecteurs de valeurs continues proviennent de populations √† moyennes diff√©rentes ou si un vecteur de valeurs a √©t√© g√©n√©r√© √† partir d‚Äôune population ayant une moyenne donner. Dans cette section, nous utiliserons la fonction <code>t.test()</code> pour les tests de t et la fonction <code>wilcox.test()</code> pour les tests de Wilcoxon (aussi appel√© de Mann-Whitney).</p>
<div id="test-de-t-√†-un-seul-√©chantillon" class="section level3">
<h3><span class="header-section-number">6.6.1</span> Test de t √† un seul √©chantillon</h3>
<p>Nous devons assumer, pour ce test, que l‚Äô√©chantillon est recueillit d‚Äôune population dont la distribution est normale, <span class="math inline">\(\mathcal{N} \sim \left( \mu, \sigma^2 \right)\)</span>, et que chaque √©chantillon est ind√©pendant l‚Äôun de l‚Äôautre. L‚Äôhypoth√®se nulle est souvent celle de l‚Äôavocat du diable, que la moyenne soit √©gale √† une valeur donn√©e (donc la diff√©rence entre la moyenne de la population et une moyenne donn√©e est de z√©ro): ici, que <span class="math inline">\(\mu = \bar{x}\)</span>. L‚Äôerreur standard sur la moyenne (ESM) de l‚Äô√©chantillon, <span class="math inline">\(\bar{x}\)</span> est calcul√©e comme suit.</p>
<p><span class="math display">\[ESM = \frac{s}{\sqrt{n}}\]</span></p>
<p>o√π <span class="math inline">\(s\)</span> est l‚Äô√©cart-type de l‚Äô√©chantillon et <span class="math inline">\(n\)</span> est le nombre d‚Äô√©chantillons.</p>
<p>Pour tester l‚Äôintervalle de confiance de l‚Äô√©chantillon, on multiplie l‚ÄôESM par l‚Äôaire sous la courbe de densit√© couvrant une certaine proportion de part et d‚Äôautre de l‚Äô√©chantillon. Pour un niveau de confiance de 95%, on retranche 2.5% de part et d‚Äôautre.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="chapitre-biostats.html#cb44-1"></a><span class="kw">set.seed</span>(<span class="dv">33746</span>)</span>
<span id="cb44-2"><a href="chapitre-biostats.html#cb44-2"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">16</span>, <span class="dv">4</span>)</span>
<span id="cb44-3"><a href="chapitre-biostats.html#cb44-3"></a></span>
<span id="cb44-4"><a href="chapitre-biostats.html#cb44-4"></a>level &lt;-<span class="st">  </span><span class="fl">0.95</span></span>
<span id="cb44-5"><a href="chapitre-biostats.html#cb44-5"></a>alpha &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>level</span>
<span id="cb44-6"><a href="chapitre-biostats.html#cb44-6"></a></span>
<span id="cb44-7"><a href="chapitre-biostats.html#cb44-7"></a>x_bar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb44-8"><a href="chapitre-biostats.html#cb44-8"></a>s &lt;-<span class="st"> </span><span class="kw">sd</span>(x)</span>
<span id="cb44-9"><a href="chapitre-biostats.html#cb44-9"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(x)</span>
<span id="cb44-10"><a href="chapitre-biostats.html#cb44-10"></a></span>
<span id="cb44-11"><a href="chapitre-biostats.html#cb44-11"></a>error &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>) <span class="op">*</span><span class="st"> </span>s <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb44-12"><a href="chapitre-biostats.html#cb44-12"></a>error</span></code></pre></div>
<pre><code>## [1] 1.483253</code></pre>
<p>intervalle de confiance est l‚Äôerreur de par et d‚Äôautre de la moyenne.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapitre-biostats.html#cb46-1"></a><span class="kw">c</span>(x_bar <span class="op">-</span><span class="st"> </span>error, x_bar <span class="op">+</span><span class="st"> </span>error)</span></code></pre></div>
<pre><code>## [1] 14.35630 17.32281</code></pre>
<p>Si la moyenne de la population est de 16, un nombre qui se situe dans l‚Äôintervalle de confiance on accepte l‚Äôhypoth√®se nulle au seuil 0.05. Si le nombre d‚Äô√©chantillon est r√©duit (g√©n√©ralement &lt; 30), on passera plut√¥t par une distribution de t, avec <span class="math inline">\(n-1\)</span> degr√©s de libert√©.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="chapitre-biostats.html#cb48-1"></a>error &lt;-<span class="st"> </span><span class="kw">qt</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>alpha<span class="op">/</span><span class="dv">2</span>, n<span class="dv">-1</span>) <span class="op">*</span><span class="st"> </span>s <span class="op">/</span><span class="st"> </span><span class="kw">sqrt</span>(n)</span>
<span id="cb48-2"><a href="chapitre-biostats.html#cb48-2"></a><span class="kw">c</span>(x_bar <span class="op">-</span><span class="st"> </span>error, x_bar <span class="op">+</span><span class="st"> </span>error)</span></code></pre></div>
<pre><code>## [1] 14.25561 17.42351</code></pre>
<p>Plus simplement, on pourra utiliser la fonction <code>t.test()</code> en sp√©cifiant la moyenne de la population. Nous avons g√©n√©r√© 20 donn√©es avec une moyenne de 16 et un √©cart-type de 4. Nous savons donc que la vraie moyenne de l‚Äô√©chantillon est de 16. Mais disons que nous testons l‚Äôhypoth√®se que ces donn√©es sont tir√©es d‚Äôune population dont la moyenne est 18 (et implicitement que sont √©cart-type est de 4).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapitre-biostats.html#cb50-1"></a><span class="kw">t.test</span>(x, <span class="dt">mu =</span> <span class="dv">18</span>)</span></code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  x
## t = -2.8548, df = 19, p-value = 0.01014
## alternative hypothesis: true mean is not equal to 18
## 95 percent confidence interval:
##  14.25561 17.42351
## sample estimates:
## mean of x 
##  15.83956</code></pre>
<p>La fonction retourne la valeur de t (<em>t-value</em>), le nombre de degr√©s de libert√© (<span class="math inline">\(n-1 = 19\)</span>), une description de l‚Äôhypoth√®se alternative (<code>alternative hypothesis: true mean is not equal to 18</code>), ainsi que l‚Äôintervalle de confiance au niveau de 95%. Le test contient aussi la <em>p-value</em>. Bien que la <em>p-value</em> soit largement utilis√©e en science</p>
<hr />
<div id="information-la-p-value" class="section level4">
<h4><span class="header-section-number">6.6.1.1</span> Information: la <em>p-value</em></h4>
<p>La <em>p-value</em>, ou valeur-p ou p-valeur, est utilis√©e pour trancher si, oui ou non, un r√©sultat est <strong>significatif</strong>. En langage scientifique, le mot significatif ne devrait √™tre utilis√© <em>que</em> lorsque l‚Äôon r√©f√®re √† un test d‚Äôhypoth√®se statistique. Vous retrouverez des <em>p-values</em> partout en stats. Les <em>p-values</em> indiquent la probabilit√© que les donn√©es ait √©t√© √©chantillonn√©es d‚Äôune population o√π un effet est observable selon le mod√®le statistique utilis√©.</p>
<blockquote>
<p>La p-value est la probabilit√© que les donn√©es aient √©t√© g√©n√©r√©es pour obtenir un effet √©quivalent ou plus prononc√© si l‚Äôhypoth√®se nulle est vraie.</p>
</blockquote>
<p>Une <em>p-value</em> √©lev√©e indique que le mod√®le appliqu√© √† vos donn√©es concorde avec la conclusion que l‚Äôhypoth√®se nulle est vraie, et inversement si la <em>p-value</em> est faible. Le seuil arbitraire utilis√©e en √©cologie et en agriculture, comme dans plusieurs domaines, est de 0.05. L‚Äôutilisation d‚Äôun seuil est toutefois contest√©e <strong>√† raison</strong>. Une enqu√™te men√©e dans la litt√©rature scientifiques a r√©v√©l√© que 49% des 791 articles √©tudi√©s interpr√©taient un effet non significatif comme un effet nul (<a href="https://www.nature.com/articles/d41586-019-00857-9">Amrhein et al., 2019</a>). En effet, une cat√©gorisation de la p-value avec un seuil de significativit√© brouille le jugement sur l‚Äôimportance des effets et de leur incertitude. Les six principes de l‚Äô<a href="https://phys.org/news/2016-03-american-statistical-association-statement-significance.html">American Statistical Association</a> guident l‚Äôinterpr√©tation des <em>p-values</em>. [ma traduction]</p>
<ol style="list-style-type: decimal">
<li>Les <em>p-values</em> indique l‚Äôampleur de l‚Äôincompatibilit√© des donn√©es avec le mod√®le statistique</li>
<li>Les <em>p-values</em> ne mesurent pas la probabilit√© que l‚Äôhypoth√®se √©tudi√©e soit vraie, ni la probabilit√© que les donn√©es ont √©t√© g√©n√©r√©es uniquement par la chance.</li>
<li>Les conclusions scientifiques et d√©cisions d‚Äôaffaire ou politiques ne devraient pas √™tre bas√©es sur l‚Äôatteinte d‚Äôune <em>p-value</em> √† un seuil sp√©cifique.</li>
<li>Une inf√©rence appropri√©e demande un rapport complet et transparent.</li>
<li>Une <em>p-value</em>, ou une signification statistique, ne mesure pas l‚Äôampleur d‚Äôun effet ou l‚Äôimportance d‚Äôun r√©sultat.</li>
<li>En tant que tel, une <em>p-value</em> n‚Äôoffre pas une bonne mesure des √©vidences d‚Äôun mod√®le ou d‚Äôune hypoth√®se.</li>
</ol>
<hr />
<p>Dans le cas pr√©c√©dent, la <em>p-value</em> √©tait de 0.01014. Pour aider notre interpr√©tation, prenons l‚Äôhypoth√®se alternative: <code>true mean is not equal to 18</code>. L‚Äôhypoth√®se nulle √©tait bien que <em>la vraie moyenne est √©gale √† 18</em>. Ins√©rons la <em>p-value</em> dans la d√©finition: la probabilit√© que les donn√©es aient √©t√© g√©n√©r√©es pour obtenir un effet √©quivalent ou plus prononc√© si l‚Äôhypoth√®se nulle est vraie est de 0.01014. Il est donc tr√®s peu probable que les donn√©es soient tir√©es d‚Äôun √©chantillon dont la moyenne est de 18. Au seuil de signification de 0.05, on rejette l‚Äôhypoth√®se nulle et l‚Äôon conclut qu‚Äô√† ce seuil de confiance, l‚Äô√©chantillon ne provient pas d‚Äôune population ayant une moyenne de 18.</p>
</div>
</div>
<div id="attention-mauvaises-interpr√©tations-des-p-values" class="section level3">
<h3><span class="header-section-number">6.6.2</span> Attention: mauvaises interpr√©tations des <em>p-values</em></h3>
<blockquote>
<p>‚ÄúLa p-value n‚Äôa jamais √©t√© con√ßue comme substitut au raisonnement scientifique‚Äù <a href="https://phys.org/news/2016-03-american-statistical-association-statement-significance.html">Ron Wasserstein, directeur de l‚ÄôAmerican Statistical Association</a> [ma traduction].</p>
</blockquote>
<p><strong>Un r√©sultat montrant une p-value plus √©lev√©e que 0.05 est-il pertinent?</strong></p>
<p>Lors d‚Äôune conf√©rence, Dr Evil ne pr√©sentent que les r√©sultats significatifs de ses essais au seuil de 0.05. Certains essais ne sont pas significatifs, mais bon, ceux-ci ne sont pas importants‚Ä¶ En √©cartant ces r√©sultats, Dr Evil commet 3 erreurs:</p>
<ol style="list-style-type: decimal">
<li>La <em>p-value</em> n‚Äôest pas un bon indicateur de l‚Äôimportance d‚Äôun test statistique. L‚Äôimportance d‚Äôune variable dans un mod√®le devrait √™tre √©valu√©e par la valeur de son coefficient. Son incertitude devrait √™tre √©valu√©e par sa variance. Une mani√®re d‚Äô√©valuer plus intuitive la variance est l‚Äô√©cart-type ou l‚Äôintervalle de confiance. √Ä un certain seuil d‚Äôintervalle de confiance, la p-value traduira la probabilit√© qu‚Äôun coefficient soit r√©ellement nul ait pu g√©n√©rer des donn√©es d√©montrant un coefficient √©gal ou sup√©rieur.</li>
<li>Il est tout aussi important de savoir que le traitement fonctionne que de savoir qu‚Äôil ne fonctionne pas. Les r√©sultats d√©montrant des effets sont malheureusement davantage soumis aux journaux et davantage publi√©s que ceux ne d√©montrant pas d‚Äôeffets (<a href="https://doi.org/10.1136/bmj.38488.385995.8F">Decullier et al., 2005</a>).</li>
<li>Le seuil de 0.05 est arbitraire.</li>
</ol>
<hr />
<div id="attention-au-p-hacking" class="section level4">
<h4><span class="header-section-number">6.6.2.1</span> Attention au <em>p-hacking</em></h4>
<p>Le <em>p-hacking</em> (ou <em>data dredging</em>) consiste √† manipuler les donn√©es et les mod√®les pour faire en sorte d‚Äôobtenir des <em>p-values</em> favorables √† l‚Äôhypoth√®se test√©e et, √©ventuellement, aux conclusions recherch√©es. <strong>√Ä √©viter dans tous les cas. Toujours. Toujours. Toujours.</strong></p>
<div class="figure" style="text-align: center"><span id="fig:biostats-johnoliver"></span>
<img src="images/05_p-hacking.png" alt="Un sketch humoristique de John Oliver sur le *p-hacking*, [Last week tonight, 2016](https://youtu.be/0Rnq1NpHdmw) (en anglais)" width="456" />
<p class="caption">
Figure 6.1: Un sketch humoristique de John Oliver sur le <em>p-hacking</em>, <a href="https://youtu.be/0Rnq1NpHdmw">Last week tonight, 2016</a> (en anglais)
</p>
</div>
<hr />
</div>
</div>
<div id="test-de-wilcoxon-√†-un-seul-√©chantillon" class="section level3">
<h3><span class="header-section-number">6.6.3</span> Test de Wilcoxon √† un seul √©chantillon</h3>
<p>Le test de t suppose que la distribution des donn√©es est normale‚Ä¶ ce qui est rarement le cas, surtout lorsque les √©chantillons sont peu nombreux. Le test de Wilcoxon ne demande aucune supposition sur la distribution: c‚Äôest un test non-param√©trique bas√© sur le tri des valeurs.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="chapitre-biostats.html#cb52-1"></a><span class="kw">wilcox.test</span>(x, <span class="dt">mu =</span> <span class="dv">18</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon signed rank exact test
## 
## data:  x
## V = 39, p-value = 0.01208
## alternative hypothesis: true location is not equal to 18</code></pre>
<p>Le <code>V</code> est la somme des rangs positifs. Dans ce cas, la <em>p-value</em> est semblable √† celle du test de t, et les m√™mes conclusions s‚Äôappliquent.</p>
</div>
<div id="tests-de-t-√†-deux-√©chantillons" class="section level3">
<h3><span class="header-section-number">6.6.4</span> Tests de t √† deux √©chantillons</h3>
<p>Les tests √† un √©chantillon servent plut√¥t √† s‚Äôexercer: rarement en aura-t-on besoin en recherche, o√π plus souvent, on voudra comparer les moyennes de deux unit√©s exp√©rimentales. L‚Äôexp√©rience comprend donc deux s√©ries de donn√©es continues, <span class="math inline">\(x_1\)</span> et <span class="math inline">\(x_2\)</span>, issus de lois de distribution normale <span class="math inline">\(\mathcal{N} \left( \mu_1, \sigma_1^2 \right)\)</span> et <span class="math inline">\(\mathcal{N} \left( \mu_2, \sigma_2^2 \right)\)</span>, et nous testons l‚Äôhypoth√®se nulle que <span class="math inline">\(\mu_1 = \mu_2\)</span>. La statistique t est calcul√©e comme suit.</p>
<p><span class="math display">\[t = \frac{\bar{x_1} - \bar{x_2}}{ESDM}\]</span></p>
<p>L‚ÄôESDM est l‚Äôerreur standard de la diff√©rence des moyennes:</p>
<p><span class="math display">\[ESDM = \sqrt{ESM_1^2 + ESM_2^2}\]</span></p>
<p>Si vous supposez que les variances sont identiques, l‚Äôerreur standard (s) est calcul√©e pour les √©chantillons des deux groupes, puis ins√©r√©e dans le calcul des ESM. La statistique t sera alors √©valu√©e √† <span class="math inline">\(n_1 + n_2 - 2\)</span> degr√©s de libert√©. Si vous supposez que la variance est diff√©rente (<em>proc√©dure de Welch</em>), vous calculez les ESM avec les erreurs standards respectives, et la statistique t devient une approximation de la distribution de t avec un nombre de degr√©s de libert√© calcul√© √† partir des erreurs standards et du nombre d‚Äô√©chantillon dans les groupes: cette proc√©dure est consid√©r√©e comme plus prudente (<a href="https://www.springer.com/us/book/9780387790534">Dalgaard, 2008</a>, page 101).</p>
<p>Prenons les donn√©es d‚Äôiris pour l‚Äôexemple en excluant l‚Äôiris setosa √©tant donn√©e que les tests de t se restreignent √† deux groupes. Nous allons tester la longueur des p√©tales.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="chapitre-biostats.html#cb54-1"></a>iris_pl &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></span>
<span id="cb54-2"><a href="chapitre-biostats.html#cb54-2"></a><span class="st">    </span><span class="kw">filter</span>(Species <span class="op">!=</span><span class="st"> &quot;setosa&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb54-3"><a href="chapitre-biostats.html#cb54-3"></a><span class="st">    </span><span class="kw">select</span>(Species, Petal.Length)</span>
<span id="cb54-4"><a href="chapitre-biostats.html#cb54-4"></a><span class="kw">sample_n</span>(iris_pl, <span class="dv">5</span>)</span></code></pre></div>
<pre><code>##      Species Petal.Length
## 1  virginica          5.1
## 2 versicolor          4.0
## 3  virginica          5.0
## 4 versicolor          4.6
## 5 versicolor          4.1</code></pre>
<p>Dans la prochaine cellule, nous introduisons l‚Äô<em>interface-formule</em> de R, o√π l‚Äôon retrouve typiquement le <code>~</code>, entre les variables de sortie √† gauche et les variables d‚Äôentr√©e √† droite. Dans notre cas, la variable de sortie est la variable test√©e, <code>Petal.Length</code>, qui varie en fonction du groupe <code>Species</code>, qui est la variable d‚Äôentr√©e (variable explicative) - nous verrons les types de variables plus en d√©tails dans la section <a href="#Les-mod%C3%A8les-statistiques">Les mod√®les statistiques</a>, plus bas.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="chapitre-biostats.html#cb56-1"></a><span class="kw">t.test</span>(<span class="dt">formula =</span> Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb56-2"><a href="chapitre-biostats.html#cb56-2"></a>       <span class="dt">data =</span> iris_pl, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  Petal.Length by Species
## t = -12.604, df = 95.57, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -1.49549 -1.08851
## sample estimates:
## mean in group versicolor  mean in group virginica 
##                    4.260                    5.552</code></pre>
<p>Nous obtenons une sortie similaire aux pr√©c√©dentes. L‚Äôintervalle de confiance √† 95% exclu le z√©ro, ce qui est coh√©rent avec la p-value tr√®s faible, qui nous indique le rejet de l‚Äôhypoth√®se nulle au seuil 0.05. Les donn√©es montrent que les groupes ont des moyennes de longueurs de p√©tale diff√©rentes.</p>
<hr />
<div id="enregistrer-les-r√©sultats-dun-test" class="section level4">
<h4><span class="header-section-number">6.6.4.1</span> Enregistrer les r√©sultats d‚Äôun test</h4>
<p>Il est possible d‚Äôenregistrer un test dans un objet.</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chapitre-biostats.html#cb58-1"></a>tt_pl &lt;-<span class="st"> </span><span class="kw">t.test</span>(<span class="dt">formula =</span> Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb58-2"><a href="chapitre-biostats.html#cb58-2"></a>                <span class="dt">data =</span> iris_pl, <span class="dt">var.equal =</span> <span class="ot">FALSE</span>)</span>
<span id="cb58-3"><a href="chapitre-biostats.html#cb58-3"></a><span class="kw">summary</span>(tt_pl)</span></code></pre></div>
<pre><code>##             Length Class  Mode     
## statistic   1      -none- numeric  
## parameter   1      -none- numeric  
## p.value     1      -none- numeric  
## conf.int    2      -none- numeric  
## estimate    2      -none- numeric  
## null.value  1      -none- numeric  
## stderr      1      -none- numeric  
## alternative 1      -none- character
## method      1      -none- character
## data.name   1      -none- character</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chapitre-biostats.html#cb60-1"></a><span class="kw">str</span>(tt_pl)</span></code></pre></div>
<pre><code>## List of 10
##  $ statistic  : Named num -12.6
##   ..- attr(*, &quot;names&quot;)= chr &quot;t&quot;
##  $ parameter  : Named num 95.6
##   ..- attr(*, &quot;names&quot;)= chr &quot;df&quot;
##  $ p.value    : num 4.9e-22
##  $ conf.int   : num [1:2] -1.5 -1.09
##   ..- attr(*, &quot;conf.level&quot;)= num 0.95
##  $ estimate   : Named num [1:2] 4.26 5.55
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean in group versicolor&quot; &quot;mean in group virginica&quot;
##  $ null.value : Named num 0
##   ..- attr(*, &quot;names&quot;)= chr &quot;difference in means&quot;
##  $ stderr     : num 0.103
##  $ alternative: chr &quot;two.sided&quot;
##  $ method     : chr &quot;Welch Two Sample t-test&quot;
##  $ data.name  : chr &quot;Petal.Length by Species&quot;
##  - attr(*, &quot;class&quot;)= chr &quot;htest&quot;</code></pre>
<hr />
</div>
</div>
<div id="comparaison-des-variances" class="section level3">
<h3><span class="header-section-number">6.6.5</span> Comparaison des variances</h3>
<p>Pour comparer les variances, on a recours au test de F (F pour Fisher).</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chapitre-biostats.html#cb62-1"></a><span class="kw">var.test</span>(<span class="dt">formula =</span> Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb62-2"><a href="chapitre-biostats.html#cb62-2"></a>         <span class="dt">data =</span> iris_pl)</span></code></pre></div>
<pre><code>## 
##  F test to compare two variances
## 
## data:  Petal.Length by Species
## F = 0.72497, num df = 49, denom df = 49, p-value = 0.2637
## alternative hypothesis: true ratio of variances is not equal to 1
## 95 percent confidence interval:
##  0.411402 1.277530
## sample estimates:
## ratio of variances 
##          0.7249678</code></pre>
<p>Il semble que l‚Äôon pourrait relancer le test de <em>t</em> sans la proc√©dure Welch, avec <code>var.equal = TRUE</code>.</p>
</div>
<div id="tests-de-wilcoxon-√†-deux-√©chantillons" class="section level3">
<h3><span class="header-section-number">6.6.6</span> Tests de Wilcoxon √† deux √©chantillons</h3>
<p>Cela ressemble au test de t!</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chapitre-biostats.html#cb64-1"></a><span class="kw">wilcox.test</span>(<span class="dt">formula =</span> Petal.Length <span class="op">~</span><span class="st"> </span>Species,</span>
<span id="cb64-2"><a href="chapitre-biostats.html#cb64-2"></a>       <span class="dt">data =</span> iris_pl, <span class="dt">var.equal =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum test with continuity correction
## 
## data:  Petal.Length by Species
## W = 44.5, p-value &lt; 2.2e-16
## alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
<div id="les-tests-pair√©s" class="section level3">
<h3><span class="header-section-number">6.6.7</span> Les tests pair√©s</h3>
<p>Les tests pair√©s sont utilis√©s lorsque deux √©chantillons proviennent d‚Äôune m√™me unit√© exp√©rimentale: il s‚Äôagit en fait de tests sur la diff√©rence entre deux observations.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="chapitre-biostats.html#cb66-1"></a><span class="kw">set.seed</span>(<span class="dv">2555</span>)</span>
<span id="cb66-2"><a href="chapitre-biostats.html#cb66-2"></a></span>
<span id="cb66-3"><a href="chapitre-biostats.html#cb66-3"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb66-4"><a href="chapitre-biostats.html#cb66-4"></a>avant &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">16</span>, <span class="dv">4</span>)</span>
<span id="cb66-5"><a href="chapitre-biostats.html#cb66-5"></a>apres &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">18</span>, <span class="dv">3</span>)</span></code></pre></div>
<p>Il est important de sp√©cifier que le test est pair√©, la valeur par d√©faut de <code>paired</code> √©tant <code>FALSE</code>.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chapitre-biostats.html#cb67-1"></a><span class="kw">t.test</span>(avant, apres, <span class="dt">paired =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<pre><code>## 
##  Paired t-test
## 
## data:  avant and apres
## t = -1.5168, df = 19, p-value = 0.1458
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -4.5804586  0.7311427
## sample estimates:
## mean of the differences 
##               -1.924658</code></pre>
<p>L‚Äôhypoth√®se nulle qu‚Äôil n‚Äôy ait pas de diff√©rence entre l‚Äôavant et l‚Äôapr√®s traitement est accept√©e au seuil 0.05.</p>
<p><strong>Exercice</strong>. Effectuer un test de Wilcoxon pair√©.</p>
</div>
</div>
<div id="lanalyse-de-variance" class="section level2">
<h2><span class="header-section-number">6.7</span> L‚Äôanalyse de variance</h2>
<p>L‚Äôanalyse de variance consiste √† comparer des moyennes de plusieurs groupe distribu√©s normalement et de m√™me variance. Cette section sera √©labor√©e prochainement plus en profondeur. Consid√©rons-la pour le moment comme une r√©gression sur une variable cat√©gorielle.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="chapitre-biostats.html#cb69-1"></a>pl_aov &lt;-<span class="st"> </span><span class="kw">aov</span>(Petal.Length <span class="op">~</span><span class="st"> </span>Species, iris)</span>
<span id="cb69-2"><a href="chapitre-biostats.html#cb69-2"></a><span class="kw">summary</span>(pl_aov)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value Pr(&gt;F)    
## Species       2  437.1  218.55    1180 &lt;2e-16 ***
## Residuals   147   27.2    0.19                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La prochaine section, justement, est vou√©e aux mod√®les statistiques explicatifs, qui incluent la r√©gression.</p>
</div>
<div id="les-mod√®les-statistiques" class="section level2">
<h2><span class="header-section-number">6.8</span> Les mod√®les statistiques</h2>
<p>La mod√©lisation statistique consiste √† lier de mani√®re explicite des variables de sortie <span class="math inline">\(y\)</span> (ou variables-r√©ponse ou variables d√©pendantes) √† des variables explicatives <span class="math inline">\(x\)</span> (ou variables pr√©dictives / ind√©pendantes / covariables). Les variables-r√©ponse sont mod√©lis√©es par une fonction des variables explicatives ou pr√©dictives.</p>
<p>Pourquoi garder les termes <em>explicatives</em> et <em>pr√©dictives</em>? Parce que les mod√®les statistiques (bas√©s sur des donn√©es et non pas sur des m√©canismes) sont de deux ordres. D‚Äôabord, les mod√®les <strong>pr√©dictifs</strong> sont con√ßus pour pr√©dire de mani√®re fiable une ou plusieurs variables-r√©ponse √† partir des informations contenues dans les variables qui sont, dans ce cas, pr√©dictives. Ces mod√®les sont couverts dans le chapitre 11 de ce manuel (en d√©veloppement). Lorsque l‚Äôon d√©sire tester des hypoth√®ses pour √©valuer quelles variables expliquent la r√©ponse, on parlera de mod√©lisation (et de variables) <strong>explicatives</strong>. En inf√©rence statistique, on √©valuera les <em>corr√©lations</em> entre les variables explicatives et les variables-r√©ponse. Un lien de corr√©lation n‚Äôest pas un lien de causalit√©. L‚Äôinf√©rence causale peut en revanche √™tre √©valu√©e par des <a href="https://www.amazon.com/Cause-Correlation-Biology-Structural-Equations/dp/1107442591"><em>mod√®les d‚Äô√©quations structurelles</em></a>, sujet qui fera √©ventuellement partie de ce cours.</p>
<p>Cette section couvre la mod√©lisation explicative. Les variables qui contribuent √† cr√©er les mod√®les peuvent √™tre de diff√©rentes natures et distribu√©es selon diff√©rentes lois de probabilit√©. Alors que les mod√®les lin√©aires simples (<em>lm</em>) impliquent une variable-r√©ponse distribu√©e de mani√®re continue, les mod√®les lin√©aires g√©n√©ralis√©s peuvent aussi expliquer des variables de sorties discr√®tes.</p>
<p>Dans les deux cas, on distinguera les variables fixes et les variables al√©atoires. Les <strong>variables fixes</strong> sont les variables test√©es lors de l‚Äôexp√©rience: dose du traitement, esp√®ce/cultivar, m√©t√©o, etc. Les <strong>variables al√©atoires</strong> sont les sources de variation qui g√©n√®rent du bruit dans le mod√®le: les unit√©s exp√©rimentales ou le temps lors de mesures r√©p√©t√©es. Les mod√®les incluant des effets fixes seulement sont des mod√®les √† effets fixes. G√©n√©ralement, les mod√®les incluant des variables al√©atoires incluent aussi des variables fixes: on parlera alors de mod√®les mixtes. Nous couvrirons ces deux types de mod√®le.</p>
<div id="mod√®les-√†-effets-fixes" class="section level3">
<h3><span class="header-section-number">6.8.1</span> Mod√®les √† effets fixes</h3>
<p>Les tests de t et de Wilcoxon, explor√©s pr√©c√©demment, sont des mod√®les statistiques √† une seule variable. Nous avons vu dans l‚Äô<em>interface-formule</em> qu‚Äôune variable-r√©ponse peut √™tre li√©e √† une variable explicative avec le tilde <code>~</code>. En particulier, le test de t est r√©gression lin√©aire univari√©e (√† une seule variable explicative) dont la variable explicative comprend deux cat√©gories. De m√™me, l‚Äôanova est une r√©gression lin√©aire univari√©e dont la variable explicative comprend plusieurs cat√©gories. Or l‚Äôinterface-formule peut √™tre utilis√© dans plusieurs circonstances, notamment pour ajouter plusieurs variables de diff√©rents types: on parlera de r√©gression multivari√©e.</p>
<p>La plupart des mod√®les statistiques peuvent √™tre approxim√©s comme une combinaison lin√©aire de variables: ce sont des mod√®les lin√©aires. Les mod√®les non-lin√©aires impliquent des strat√©gies computationnelles complexes qui rendent leur utilisation plus difficile √† man≈ìuvrer.</p>
<p>Un mod√®le lin√©aire univari√© prendra la forme <span class="math inline">\(y = \beta_0 + \beta_1 x + \epsilon\)</span>, o√π <span class="math inline">\(\beta_0\)</span> est l‚Äôintercept et <span class="math inline">\(\beta_1\)</span> est la pente et <span class="math inline">\(\epsilon\)</span> est l‚Äôerreur.</p>
<p>Vous verrez parfois la notation <span class="math inline">\(\hat{y} = \beta_0 + \beta_1 x\)</span>. La notation avec le chapeau <span class="math inline">\(\hat{y}\)</span> exprime qu‚Äôil s‚Äôagit des valeurs g√©n√©r√©es par le mod√®le. En fait, <span class="math inline">\(y = \hat{y} - \epsilon\)</span>.</p>
<div id="mod√®le-lin√©aire-univari√©-avec-variable-continue" class="section level4">
<h4><span class="header-section-number">6.8.1.1</span> Mod√®le lin√©aire univari√© avec variable continue</h4>
<p>Prenons les donn√©es <a href="https://rdrr.io/cran/agridat/man/lasrosas.corn.html"><code>lasrosas.corn</code></a> incluses dans le module <code>agridat</code>, o√π l‚Äôon retrouve le rendement d‚Äôune production de ma√Øs √† dose d‚Äôazote variable, en Argentine.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="chapitre-biostats.html#cb71-1"></a><span class="kw">library</span>(<span class="st">&quot;agridat&quot;</span>)</span>
<span id="cb71-2"><a href="chapitre-biostats.html#cb71-2"></a><span class="kw">data</span>(<span class="st">&quot;lasrosas.corn&quot;</span>)</span>
<span id="cb71-3"><a href="chapitre-biostats.html#cb71-3"></a><span class="kw">sample_n</span>(lasrosas.corn, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    year       lat      long yield nitro topo     bv rep nf
## 1  1999 -33.05207 -63.84230 69.57   0.0   LO 185.67  R1 N0
## 2  1999 -33.05137 -63.84383 67.41  53.0    E 175.12  R2 N2
## 3  1999 -33.05104 -63.84323 68.33  29.0   LO 168.70  R3 N1
## 4  1999 -33.05162 -63.84456 68.06  53.0    E 171.71  R1 N2
## 5  1999 -33.05180 -63.84386 63.99   0.0   LO 172.46  R1 N0
## 6  2001 -33.05065 -63.84578 35.85  50.6   HT 194.85  R1 N2
## 7  1999 -33.05170 -63.84553 58.89 131.5   HT 187.98  R1 N5
## 8  2001 -33.05077 -63.84502 50.95 124.6   HT 184.66  R2 N5
## 9  1999 -33.05181 -63.84202 78.75 106.0   LO 169.25  R2 N4
## 10 1999 -33.05154 -63.84468 68.58  29.0    E 169.35  R1 N1</code></pre>
<p>Ces donn√©es comprennent plusieurs variables. Prenons le rendement (<code>yield</code>) comme variable de sortie et, pour le moment, ne retenons que la dose d‚Äôazote (<code>nitro</code>) comme variable explicative: il s‚Äôagit d‚Äôune r√©gression univari√©e. Les deux variables sont continues. Explorons d‚Äôabord le nuage de points de l‚Äôune et l‚Äôautre.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="chapitre-biostats.html#cb73-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> lasrosas.corn, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb73-2"><a href="chapitre-biostats.html#cb73-2"></a><span class="st">    </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-plot-nitro-agridat-1.png" width="672" /></p>
<p>L‚Äôhypoth√®se nulle est que la dose d‚Äôazote n‚Äôaffecte pas le rendement, c‚Äôest √† dire que le coefficient de pente et nul. Une autre hypoth√®se est que l‚Äôintercept est nul: donc qu‚Äô√† dose de 0, rendement de 0. Un mod√®le lin√©aire √† variable de sortie continue est cr√©√© avec la fonction <code>lm()</code>, pour <em>linear model</em>.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="chapitre-biostats.html#cb74-1"></a>modlin_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>nitro, <span class="dt">data =</span> lasrosas.corn)</span>
<span id="cb74-2"><a href="chapitre-biostats.html#cb74-2"></a><span class="kw">summary</span>(modlin_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ nitro, data = lasrosas.corn)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -53.183 -15.341  -3.079  13.725  45.897 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 65.843213   0.608573 108.193  &lt; 2e-16 ***
## nitro        0.061717   0.007868   7.845 5.75e-15 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 19.66 on 3441 degrees of freedom
## Multiple R-squared:  0.01757,    Adjusted R-squared:  0.01728 
## F-statistic: 61.54 on 1 and 3441 DF,  p-value: 5.754e-15</code></pre>
<p>Le diagnostic du mod√®le comprend plusieurs informations. D‚Äôabord la formule utilis√©e, affich√©e pour la tra√ßabilit√©. Viens ensuite un aper√ßu de la distribution des r√©sidus. La m√©diane devrait s‚Äôapprocher de la moyenne des r√©sidus (qui est toujours de 0). Bien que le -3.079 peut sembler important, il faut prendre en consid√©ration de l‚Äô√©chelle de y, et ce -3.079 est exprim√© en terme de rendement, ici en quintaux (i.e.¬†100 kg) par hectare. La distribution des r√©sidus m√©rite d‚Äô√™tre davantage investigu√©e. Nous verrons cela un peu plus tard.</p>
<p>Les coefficients apparaissent ensuite. Les estim√©s sont les valeurs des effets. R fournit aussi l‚Äôerreur standard associ√©e, la valeur de t ainsi que la p-value (la probabilit√© d‚Äôobtenir cet effet ou un effet plus extr√™me si en r√©alit√© il y avait absence d‚Äôeffet). L‚Äôintercept est bien s√ªr plus √©lev√© que 0 (√† dose nulle, on obtient 65.8 quintaux par hectare en moyenne). La pente de la variable <code>nitro</code> est de ~0.06: pour chaque augmentation d‚Äôun kg/ha de dose, on a obtenu ~0.06 quintaux/ha de plus de ma√Øs. Donc pour 100 kg/ha de N, on a obtenu un rendement moyen de 6 quintaux de plus que l‚Äôintercept. Soulignons que l‚Äôampleur du coefficient est tr√®s important pour guider la fertilisation: ne rapporter que la p-value, ou ne rapporter que le fait qu‚Äôelle est inf√©rieure √† 0.05 (ce qui arrive souvent dans la litt√©rature), serait tr√®s insuffisant pour l‚Äôinterpr√©tation des statistiques. La p-value nous indique n√©anmoins qu‚Äôil serait tr√®s improbable qu‚Äôune telle pente ait √©t√© g√©n√©r√©e alors que celle-ci est nulle en r√©alit√©. Les √©toiles √† c√¥t√© des p-values indiquent l‚Äôampleur selon l‚Äô√©chelle <code>Signif. codes</code> indiqu√©e en-dessous du tableau des coefficients.</p>
<p>Sous ce tableau, R offre d‚Äôautres statistiques. En outre, les R¬≤ et R¬≤ ajust√©s indiquent si la r√©gression passe effectivement par les points. Le R¬≤ prend un maximum de 1 lorsque la droite passe exactement sur les points.</p>
<p>Enfin, le test de F g√©n√®re une p-value indiquant la probabilit√© que les coefficients de pente ait √©t√© g√©n√©r√©s si les vrais coefficients √©taient nuls. Dans le cas d‚Äôune r√©gression univari√©e, cela r√©p√®te l‚Äôinformation sur l‚Äôunique coefficient.</p>
<p>On pourra √©galement obtenir les intervalles de confiance avec la fonction <code>confint()</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="chapitre-biostats.html#cb76-1"></a><span class="kw">confint</span>(modlin_<span class="dv">1</span>, <span class="dt">level =</span> <span class="fl">0.95</span>)</span></code></pre></div>
<pre><code>##                   2.5 %      97.5 %
## (Intercept) 64.65001137 67.03641474
## nitro        0.04629164  0.07714271</code></pre>
<p>Ou soutirer l‚Äôinformation de diff√©rentes mani√®res, comme avec la fonction <code>coefficients()</code>.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chapitre-biostats.html#cb78-1"></a><span class="kw">coefficients</span>(modlin_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## (Intercept)       nitro 
## 65.84321305  0.06171718</code></pre>
<p>√âgalement, on pourra ex√©cuter le mod√®le sur les donn√©es qui ont servi √† le g√©n√©rer:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="chapitre-biostats.html#cb80-1"></a><span class="kw">predict</span>(modlin_<span class="dv">1</span>)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##        1        2        3        4        5 
## 73.95902 73.95902 73.95902 73.95902 73.95902</code></pre>
<p>Ou sur des donn√©es externes.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chapitre-biostats.html#cb82-1"></a>nouvelles_donnees &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">nitro =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">100</span>, <span class="dt">by =</span> <span class="dv">5</span>))</span>
<span id="cb82-2"><a href="chapitre-biostats.html#cb82-2"></a><span class="kw">predict</span>(modlin_<span class="dv">1</span>, <span class="dt">newdata =</span> nouvelles_donnees)[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]</span></code></pre></div>
<pre><code>##        1        2        3        4        5 
## 65.84321 66.15180 66.46038 66.76897 67.07756</code></pre>
</div>
<div id="analyse-des-r√©sidus" class="section level4">
<h4><span class="header-section-number">6.8.1.2</span> Analyse des r√©sidus</h4>
<p>Les r√©sidus sont les erreurs du mod√®le. C‚Äôest le vecteur <span class="math inline">\(\epsilon\)</span>, qui est un d√©calage entre les donn√©es et le mod√®le. Le R¬≤ est un indicateur de l‚Äôampleur du d√©calage, mais une r√©gression lin√©aire explicative en bonne et due forme devrait √™tre accompagn√©e d‚Äôune analyse des r√©sidus. On peut les calculer par <span class="math inline">\(\epsilon = y - \hat{y}\)</span>, mais aussi bien utiliser la fonction <code>residuals()</code>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chapitre-biostats.html#cb84-1"></a>res_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">nitro =</span> lasrosas.corn<span class="op">$</span>nitro,</span>
<span id="cb84-2"><a href="chapitre-biostats.html#cb84-2"></a>                     <span class="dt">residus_lm =</span> <span class="kw">residuals</span>(modlin_<span class="dv">1</span>),</span>
<span id="cb84-3"><a href="chapitre-biostats.html#cb84-3"></a>                     <span class="dt">residus_calcul =</span> lasrosas.corn<span class="op">$</span>yield <span class="op">-</span><span class="st"> </span><span class="kw">predict</span>(modlin_<span class="dv">1</span>))</span>
<span id="cb84-4"><a href="chapitre-biostats.html#cb84-4"></a><span class="kw">sample_n</span>(res_df, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>##    nitro residus_lm residus_calcul
## 1  124.6  24.666827      24.666827
## 2  124.6  11.126827      11.126827
## 3   99.8  25.417413      25.417413
## 4   66.0 -11.636547     -11.636547
## 5  131.5  11.460978      11.460978
## 6   75.4 -18.686688     -18.686688
## 7   29.0  -1.763011      -1.763011
## 8  131.5 -11.289022     -11.289022
## 9  131.5  -5.639022      -5.639022
## 10 131.5 -13.129022     -13.129022</code></pre>
<p>Dans une bonne r√©gression lin√©aire, on ne retrouvera pas de structure identifiable dans les r√©sidus, c‚Äôest-√†-dire que les r√©sidus sont bien distribu√©s de part et d‚Äôautre du mod√®le de r√©gression.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="chapitre-biostats.html#cb86-1"></a><span class="kw">ggplot</span>(res_df, <span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> residus_lm)) <span class="op">+</span></span>
<span id="cb86-2"><a href="chapitre-biostats.html#cb86-2"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb86-3"><a href="chapitre-biostats.html#cb86-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Dose N&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;R√©sidus&quot;</span>) <span class="op">+</span></span>
<span id="cb86-4"><a href="chapitre-biostats.html#cb86-4"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-lm1-residuals-plot-1.png" width="672" /></p>
<p>Bien que le jugement soit subjectif, on peut dire avec confiance qu‚Äôil n‚Äôy a pas structure particuli√®re. En revanche, on pourrait g√©n√©rer un <span class="math inline">\(y\)</span> qui varie de mani√®re quadratique avec <span class="math inline">\(x\)</span>, un mod√®le lin√©aire montrera une structure √©vidente.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="chapitre-biostats.html#cb87-1"></a><span class="kw">set.seed</span>(<span class="dv">36164</span>)</span>
<span id="cb87-2"><a href="chapitre-biostats.html#cb87-2"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span></span>
<span id="cb87-3"><a href="chapitre-biostats.html#cb87-3"></a>y &lt;-<span class="st"> </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x<span class="op">*</span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span>x<span class="op">^</span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.05</span> <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(x), <span class="dv">0</span>, <span class="dv">50</span>)</span>
<span id="cb87-4"><a href="chapitre-biostats.html#cb87-4"></a>modlin_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb87-5"><a href="chapitre-biostats.html#cb87-5"></a><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(y, <span class="dt">residus =</span> <span class="kw">residuals</span>(modlin_<span class="dv">2</span>)),</span>
<span id="cb87-6"><a href="chapitre-biostats.html#cb87-6"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> residus)) <span class="op">+</span></span>
<span id="cb87-7"><a href="chapitre-biostats.html#cb87-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb87-8"><a href="chapitre-biostats.html#cb87-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;R√©sidus&quot;</span>) <span class="op">+</span></span>
<span id="cb87-9"><a href="chapitre-biostats.html#cb87-9"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-residuals-example-banana-1.png" width="672" />
De m√™me, les r√©sidus ne devraient pas cro√Ætre avec <span class="math inline">\(x\)</span>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chapitre-biostats.html#cb88-1"></a><span class="kw">set.seed</span>(<span class="dv">3984</span>)</span>
<span id="cb88-2"><a href="chapitre-biostats.html#cb88-2"></a>x &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">100</span></span>
<span id="cb88-3"><a href="chapitre-biostats.html#cb88-3"></a>y &lt;-<span class="st">  </span><span class="dv">10</span> <span class="op">+</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span>x <span class="op">*</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="kw">length</span>(x), <span class="dv">0</span>, <span class="dv">2</span>)</span>
<span id="cb88-4"><a href="chapitre-biostats.html#cb88-4"></a>modlin_<span class="dv">3</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb88-5"><a href="chapitre-biostats.html#cb88-5"></a><span class="kw">ggplot</span>(<span class="kw">data.frame</span>(x, <span class="dt">residus =</span> <span class="kw">residuals</span>(modlin_<span class="dv">3</span>)),</span>
<span id="cb88-6"><a href="chapitre-biostats.html#cb88-6"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> residus)) <span class="op">+</span></span>
<span id="cb88-7"><a href="chapitre-biostats.html#cb88-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb88-8"><a href="chapitre-biostats.html#cb88-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;R√©sidus&quot;</span>) <span class="op">+</span></span>
<span id="cb88-9"><a href="chapitre-biostats.html#cb88-9"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-residuals-example-expand-1.png" width="672" /></p>
<p>On pourra aussi inspecter les r√©sidus avec un graphique de leur distribution. Reprenons notre mod√®le de rendement du ma√Øs.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chapitre-biostats.html#cb89-1"></a><span class="kw">ggplot</span>(res_df, <span class="kw">aes</span>(<span class="dt">x =</span> residus_lm)) <span class="op">+</span></span>
<span id="cb89-2"><a href="chapitre-biostats.html#cb89-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth =</span> <span class="dv">2</span>, <span class="dt">color =</span> <span class="st">&quot;white&quot;</span>) <span class="op">+</span></span>
<span id="cb89-3"><a href="chapitre-biostats.html#cb89-3"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Residual&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-residuals-agridat-groups-1.png" width="672" /></p>
<p>L‚Äôhistogramme devrait pr√©senter une distribution normale. Les tests de normalit√© comme le test de Shapiro-Wilk peuvent aider, mais ils sont g√©n√©ralement tr√®s s√©v√®res.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="chapitre-biostats.html#cb90-1"></a><span class="kw">shapiro.test</span>(res_df<span class="op">$</span>residus_lm)</span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  res_df$residus_lm
## W = 0.94868, p-value &lt; 2.2e-16</code></pre>
<p>L‚Äôhypoth√®se nulle que la distribution est normale est rejet√©e au seuil 0.05. Dans notre cas, il est √©vident que la s√©v√©rit√© du test n‚Äôest pas en cause, car les r√©sidus semble g√©n√©rer trois ensembles. Ceci indique que les variables explicatives sont insuffisantes pour expliquer la variabilit√© de la variable-r√©ponse.</p>
</div>
<div id="r√©gression-multiple" class="section level4">
<h4><span class="header-section-number">6.8.1.3</span> R√©gression multiple</h4>
<p>Comme c‚Äôest le cas pour bien des ph√©nom√®nes en √©cologie, le rendement d‚Äôune culture n‚Äôest certainement pas expliqu√© seulement par la dose d‚Äôazote.</p>
<p>Lorsque l‚Äôon combine plusieurs variables explicatives, on cr√©e un mod√®le de r√©gression multivari√©e, ou une r√©gression multiple. Bien que les tendances puissent sembler non-lin√©aires, l‚Äôajout de variables et le calcul des coefficients associ√©s reste un probl√®me d‚Äôalg√®bre lin√©aire.</p>
<p>On pourra en effet g√©n√©raliser les mod√®les lin√©aires, univari√©s et multivari√©s, de la mani√®re suivante.</p>
<p><span class="math display">\[ y = X \beta + \epsilon \]</span></p>
<p>o√π:</p>
<p><span class="math inline">\(X\)</span> est la matrice du mod√®le √† <span class="math inline">\(n\)</span> observations et <span class="math inline">\(p\)</span> variables.</p>
<p><span class="math display">\[ X = \left( \begin{matrix}
1 &amp; x_{11} &amp; \cdots &amp; x_{1p}  \\
1 &amp; x_{21} &amp; \cdots &amp; x_{2p}  \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots  \\
1 &amp; x_{n1} &amp; \cdots &amp; x_{np}
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(\beta\)</span> est la matrice des <span class="math inline">\(p\)</span> coefficients, <span class="math inline">\(\beta_0\)</span> √©tant l‚Äôintercept qui multiplie la premi√®re colonne de la matrice <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[ \beta = \left( \begin{matrix}
\beta_0  \\
\beta_1  \\
\vdots \\
\beta_p
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(\epsilon\)</span> est l‚Äôerreur de chaque observation.</p>
<p><span class="math display">\[ \epsilon = \left( \begin{matrix}
\epsilon_0  \\
\epsilon_1  \\
\vdots \\
\epsilon_n
\end{matrix} \right) \]</span></p>
</div>
<div id="mod√®les-lin√©aires-univari√©s-avec-variable-cat√©gorielle-nominale" class="section level4">
<h4><span class="header-section-number">6.8.1.4</span> Mod√®les lin√©aires univari√©s avec variable cat√©gorielle <strong>nominale</strong></h4>
<p>Une variable cat√©gorielle nominale (non ordonn√©e) utilis√©e √† elle seule dans un mod√®le comme variable explicative, est un cas particulier de r√©gression multiple. En effet, l‚Äô<strong>encodage cat√©goriel</strong> (ou <em>dummyfication</em>) transforme une variable cat√©gorielle nominale en une matrice de mod√®le comprenant une colonne d√©signant l‚Äôintercept (une s√©rie de 1) d√©signant la cat√©gorie de r√©f√©rence, ainsi que des colonnes pour chacune des autres cat√©gories d√©signant l‚Äôappartenance (1) ou la non appartenance (0) de la cat√©gorie d√©sign√©e par la colonne.</p>
<div id="lencodage-cat√©goriel" class="section level5">
<h5><span class="header-section-number">6.8.1.4.1</span> L‚Äôencodage cat√©goriel</h5>
<p>Une variable √† <span class="math inline">\(C\)</span> cat√©gories pourra √™tre d√©clin√©e en <span class="math inline">\(C\)</span> variables dont chaque colonne d√©signe par un 1 l‚Äôappartenance au groupe de la colonne et par un 0 la non-appartenance. Pour l‚Äôexemple, cr√©ons un vecteur d√©signant le cultivar de pomme de terre.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="chapitre-biostats.html#cb92-1"></a>data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">cultivar =</span> <span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&#39;Superior&#39;</span>, <span class="st">&#39;Superior&#39;</span>, <span class="st">&#39;Superior&#39;</span>, <span class="st">&#39;Russet&#39;</span>, <span class="st">&#39;Kenebec&#39;</span>, <span class="st">&#39;Russet&#39;</span>)))</span>
<span id="cb92-2"><a href="chapitre-biostats.html#cb92-2"></a><span class="kw">model.matrix</span>(<span class="op">~</span>cultivar, data)</span></code></pre></div>
<pre><code>##   (Intercept) cultivarRusset cultivarSuperior
## 1           1              0                1
## 2           1              0                1
## 3           1              0                1
## 4           1              1                0
## 5           1              0                0
## 6           1              1                0
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$cultivar
## [1] &quot;contr.treatment&quot;</code></pre>
<p>Nous avons trois cat√©gories, encod√©es en trois colonnes. La premi√®re colonne est un intercept et les deux autres d√©crivent l‚Äôabsence (0) ou la pr√©sence (1) des cultivars Russet et Superior. Le cultivar Kenebec est absent du tableau. En effet, en partant du principe que l‚Äôappartenance √† une cat√©gorie est mutuellement exclusive, c‚Äôest-√†-dire qu‚Äôun √©chantillon ne peut √™tre assign√© qu‚Äô√† une seule cat√©gorie, on peut d√©duire une cat√©gorie √† partir de l‚Äôinformation sur toutes les autres. Par exemple, si <code>cultivar_Russet</code> et <code>cultivar_Superior</code> sont toutes deux √©gales √† <span class="math inline">\(0\)</span>, on conclura que <code>cultivar_Kenebec</code> est n√©cessairement √©gal √† <span class="math inline">\(1\)</span>. Et si l‚Äôun d‚Äôentre <code>cultivar_Russet</code> et <code>cultivar_Superior</code> est √©gal √† <span class="math inline">\(1\)</span>, <code>cultivar_Kenebec</code> est n√©cessairement √©gal √† <span class="math inline">\(0\)</span>. L‚Äôinformation contenue dans un nombre <span class="math inline">\(C\)</span> de cat√©gorie peut √™tre encod√©e dans un nombre <span class="math inline">\(C-1\)</span> de colonnes. C‚Äôest pourquoi, dans une analyse statistique, on d√©signera une cat√©gorie comme une r√©f√©rence, que l‚Äôon d√©tecte lorsque toutes les autres cat√©gories sont encod√©es avec des <span class="math inline">\(0\)</span>: cette r√©f√©rence sera incluse dans l‚Äôintercept. La cat√©gorie de r√©f√©rence par d√©faut en R est celle la premi√®re cat√©gorie dans l‚Äôordre alphab√©tique. On pourra modifier cette r√©f√©rence avec la fonction <code>relevel()</code>.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="chapitre-biostats.html#cb94-1"></a>data<span class="op">$</span>cultivar &lt;-<span class="st"> </span><span class="kw">relevel</span>(data<span class="op">$</span>cultivar, <span class="dt">ref =</span> <span class="st">&quot;Superior&quot;</span>)</span>
<span id="cb94-2"><a href="chapitre-biostats.html#cb94-2"></a><span class="kw">model.matrix</span>(<span class="op">~</span>cultivar, data)</span></code></pre></div>
<pre><code>##   (Intercept) cultivarKenebec cultivarRusset
## 1           1               0              0
## 2           1               0              0
## 3           1               0              0
## 4           1               0              1
## 5           1               1              0
## 6           1               0              1
## attr(,&quot;assign&quot;)
## [1] 0 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$cultivar
## [1] &quot;contr.treatment&quot;</code></pre>
<p>Pour certains mod√®les, vous devrez vous assurer vous-m√™me de l‚Äôencodage cat√©goriel. Pour d‚Äôautre, en particulier avec l‚Äô<em>interface par formule</em> de R, ce sera fait automatiquement.</p>
</div>
<div id="exemple-dapplication" class="section level5">
<h5><span class="header-section-number">6.8.1.4.2</span> Exemple d‚Äôapplication</h5>
<p>Prenons la topographie du terrain, qui peut prendre plusieurs niveaux.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chapitre-biostats.html#cb96-1"></a><span class="kw">levels</span>(lasrosas.corn<span class="op">$</span>topo)</span></code></pre></div>
<pre><code>## [1] &quot;E&quot;  &quot;HT&quot; &quot;LO&quot; &quot;W&quot;</code></pre>
<p>Explorons le rendement selon la topographie.</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="chapitre-biostats.html#cb98-1"></a><span class="kw">ggplot</span>(lasrosas.corn, <span class="kw">aes</span>(<span class="dt">x =</span> topo, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb98-2"><a href="chapitre-biostats.html#cb98-2"></a><span class="st">    </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-lasrosas-topo-boxplot-1.png" width="672" /></p>
<p>Les diff√©rences sont √©videntes, et la mod√©lisation devrait montrer des effets diff√©rents.</p>
<p>L‚Äôencodage cat√©goriel peut √™tre visualis√© en g√©n√©rant la matrice de mod√®le avec la fonction <code>model.matrix()</code> et l‚Äôinterface-formule - sans la variable-r√©ponse.</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="chapitre-biostats.html#cb99-1"></a><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>topo, <span class="dt">data =</span> lasrosas.corn) <span class="op">%&gt;%</span></span>
<span id="cb99-2"><a href="chapitre-biostats.html#cb99-2"></a><span class="st">    </span><span class="kw">tbl_df</span>() <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># tbl_df pour transformer la matrice en tableau</span></span>
<span id="cb99-3"><a href="chapitre-biostats.html#cb99-3"></a><span class="st">    </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 x 4
##    `(Intercept)` topoHT topoLO topoW
##            &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
##  1             1      0      0     0
##  2             1      0      1     0
##  3             1      0      0     1
##  4             1      0      0     1
##  5             1      0      1     0
##  6             1      0      0     1
##  7             1      1      0     0
##  8             1      0      1     0
##  9             1      0      0     1
## 10             1      0      0     0</code></pre>
<p>Dans le cas d‚Äôun mod√®le avec une variable cat√©gorielle nominale seule, l‚Äôintercept repr√©sente la cat√©gorie de r√©f√©rence, ici <code>E</code>. Les autres colonnes sp√©cifient l‚Äôappartenance (1) ou la non-appartenance (0) de la cat√©gorie pour chaque observation.</p>
<p>Cette matrice de mod√®le utilis√©e pour la r√©gression donnera un intercept, qui indiquera l‚Äôeffet de la cat√©gorie de r√©f√©rence, puis les diff√©rences entre les cat√©gories subs√©quentes et la cat√©gorie de r√©f√©rence.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="chapitre-biostats.html#cb101-1"></a>modlin_<span class="dv">4</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>topo, <span class="dt">data =</span> lasrosas.corn)</span>
<span id="cb101-2"><a href="chapitre-biostats.html#cb101-2"></a><span class="kw">summary</span>(modlin_<span class="dv">4</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ topo, data = lasrosas.corn)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.371 -11.933  -1.593  11.080  44.119 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  78.6653     0.5399 145.707   &lt;2e-16 ***
## topoHT      -30.0526     0.7500 -40.069   &lt;2e-16 ***
## topoLO        6.2832     0.7293   8.615   &lt;2e-16 ***
## topoW       -11.8841     0.7039 -16.883   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.59 on 3439 degrees of freedom
## Multiple R-squared:  0.4596, Adjusted R-squared:  0.4591 
## F-statistic:   975 on 3 and 3439 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Le mod√®le lin√©aire est √©quivalent √† l‚Äôanova, mais les r√©sultats de <code>lm</code> sont plus √©labor√©s.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapitre-biostats.html#cb103-1"></a><span class="kw">summary</span>(<span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>topo, <span class="dt">data =</span> lasrosas.corn))</span></code></pre></div>
<pre><code>##               Df Sum Sq Mean Sq F value Pr(&gt;F)    
## topo           3 622351  207450     975 &lt;2e-16 ***
## Residuals   3439 731746     213                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>L‚Äôanalyse de r√©sidus peut √™tre effectu√©e de la m√™me mani√®re.</p>
</div>
</div>
<div id="mod√®les-lin√©aires-univari√©s-avec-variable-cat√©gorielle-ordinale" class="section level4">
<h4><span class="header-section-number">6.8.1.5</span> Mod√®les lin√©aires univari√©s avec variable cat√©gorielle <strong>ordinale</strong></h4>
<p>Bien que j‚Äôintroduise la r√©gression sur variable cat√©gorielle ordinale √† la suite de la section sur les variables nominales, nous revenons dans ce cas √† une r√©gression simple, univari√©e. Voyons un cas √† 5 niveaux.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="chapitre-biostats.html#cb105-1"></a>statut &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Totalement en d√©saccord&quot;</span>,</span>
<span id="cb105-2"><a href="chapitre-biostats.html#cb105-2"></a>            <span class="st">&quot;En d√©saccord&quot;</span>,</span>
<span id="cb105-3"><a href="chapitre-biostats.html#cb105-3"></a>            <span class="st">&quot;Ni en accord, ni en d√©saccord&quot;</span>,</span>
<span id="cb105-4"><a href="chapitre-biostats.html#cb105-4"></a>            <span class="st">&quot;En accord&quot;</span>,</span>
<span id="cb105-5"><a href="chapitre-biostats.html#cb105-5"></a>            <span class="st">&quot;Totalement en accord&quot;</span>)</span>
<span id="cb105-6"><a href="chapitre-biostats.html#cb105-6"></a>statut_o &lt;-<span class="st"> </span><span class="kw">factor</span>(statut, <span class="dt">levels =</span> statut, <span class="dt">ordered=</span><span class="ot">TRUE</span>)</span>
<span id="cb105-7"><a href="chapitre-biostats.html#cb105-7"></a><span class="kw">model.matrix</span>(<span class="op">~</span>statut_o) <span class="co"># ou bien, sans passer par model.matrix, contr.poly(5) o√π 5 est le nombre de niveaux</span></span></code></pre></div>
<pre><code>##   (Intercept) statut_o.L statut_o.Q    statut_o.C statut_o^4
## 1           1 -0.6324555  0.5345225 -3.162278e-01  0.1195229
## 2           1 -0.3162278 -0.2672612  6.324555e-01 -0.4780914
## 3           1  0.0000000 -0.5345225 -4.095972e-16  0.7171372
## 4           1  0.3162278 -0.2672612 -6.324555e-01 -0.4780914
## 5           1  0.6324555  0.5345225  3.162278e-01  0.1195229
## attr(,&quot;assign&quot;)
## [1] 0 1 1 1 1
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$statut_o
## [1] &quot;contr.poly&quot;</code></pre>
<p>La matrice de mod√®le a 5 colonnes, soit le nombre de niveaux: un intercept, puis 4 autres d√©signant diff√©rentes valeurs que peuvent prendre les niveaux. Ces niveaux croient-ils lin√©airement? De mani√®re quadratique, cubique ou plus loin dans des distributions polynomiales?</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="chapitre-biostats.html#cb107-1"></a>modmat_tidy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(statut, <span class="kw">model.matrix</span>(<span class="op">~</span>statut_o)[, <span class="dv">-1</span>]) <span class="op">%&gt;%</span></span>
<span id="cb107-2"><a href="chapitre-biostats.html#cb107-2"></a><span class="st">    </span><span class="kw">gather</span>(variable, valeur, <span class="op">-</span>statut)</span>
<span id="cb107-3"><a href="chapitre-biostats.html#cb107-3"></a>modmat_tidy<span class="op">$</span>statut &lt;-<span class="st"> </span><span class="kw">factor</span>(modmat_tidy<span class="op">$</span>statut,</span>
<span id="cb107-4"><a href="chapitre-biostats.html#cb107-4"></a>                             <span class="dt">levels =</span> statut,</span>
<span id="cb107-5"><a href="chapitre-biostats.html#cb107-5"></a>                             <span class="dt">ordered=</span><span class="ot">TRUE</span>)</span>
<span id="cb107-6"><a href="chapitre-biostats.html#cb107-6"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> modmat_tidy, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> statut, <span class="dt">y =</span> valeur)) <span class="op">+</span></span>
<span id="cb107-7"><a href="chapitre-biostats.html#cb107-7"></a><span class="st">    </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>variable) <span class="op">+</span></span>
<span id="cb107-8"><a href="chapitre-biostats.html#cb107-8"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb107-9"><a href="chapitre-biostats.html#cb107-9"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-encoding-ordinal-plot-1.png" width="672" /></p>
<p>R√®gle g√©n√©rale, pour les variables ordinales, on pr√©f√©rera une distribution lin√©aire, et c‚Äôest l‚Äôoption par d√©faut de la fonction <code>lm()</code>. L‚Äôutilisation d‚Äôune autre distribution peut √™tre effectu√©e √† la mitaine en utilisant dans le mod√®le la colonne d√©sir√©e de la sortie de la fonction <code>model.matrix()</code>.</p>
</div>
<div id="r√©gression-multiple-√†-plusieurs-variables" class="section level4">
<h4><span class="header-section-number">6.8.1.6</span> R√©gression multiple √† plusieurs variables</h4>
<p>Reprenons le tableau de donn√©es du rendement de ma√Øs.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chapitre-biostats.html#cb108-1"></a><span class="kw">head</span>(lasrosas.corn)</span></code></pre></div>
<pre><code>##   year       lat      long yield nitro topo     bv rep nf
## 1 1999 -33.05113 -63.84886 72.14 131.5    W 162.60  R1 N5
## 2 1999 -33.05115 -63.84879 73.79 131.5    W 170.49  R1 N5
## 3 1999 -33.05116 -63.84872 77.25 131.5    W 168.39  R1 N5
## 4 1999 -33.05117 -63.84865 76.35 131.5    W 176.68  R1 N5
## 5 1999 -33.05118 -63.84858 75.55 131.5    W 171.46  R1 N5
## 6 1999 -33.05120 -63.84851 70.24 131.5    W 170.56  R1 N5</code></pre>
<p>Pour ajouter des variables au mod√®le dans l‚Äôinterface-formule, on additionne les noms de colonne. La variable <code>lat</code> d√©signe la latitude, la variable <code>long</code> d√©signe la latitude et la variable <code>bv</code> (<em>brightness value</em>) d√©signe la teneur en mati√®re organique du sol (plus <code>bv</code> est √©lev√©e, plus faible est la teneur en mati√®re organique).</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="chapitre-biostats.html#cb110-1"></a>modlin_<span class="dv">5</span> &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>long <span class="op">+</span><span class="st"> </span>nitro <span class="op">+</span><span class="st"> </span>topo <span class="op">+</span><span class="st"> </span>bv,</span>
<span id="cb110-2"><a href="chapitre-biostats.html#cb110-2"></a>               <span class="dt">data =</span> lasrosas.corn)</span>
<span id="cb110-3"><a href="chapitre-biostats.html#cb110-3"></a><span class="kw">summary</span>(modlin_<span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ lat + long + nitro + topo + bv, data = lasrosas.corn)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -48.405 -11.071  -1.251  10.592  40.078 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  1.946e+05  3.309e+04   5.882 4.45e-09 ***
## lat          5.541e+03  4.555e+02  12.163  &lt; 2e-16 ***
## long         1.776e+02  4.491e+02   0.395    0.693    
## nitro        6.867e-02  5.451e-03  12.597  &lt; 2e-16 ***
## topoHT      -2.665e+01  1.087e+00 -24.520  &lt; 2e-16 ***
## topoLO       5.565e+00  1.035e+00   5.378 8.03e-08 ***
## topoW       -1.465e+01  1.655e+00  -8.849  &lt; 2e-16 ***
## bv          -5.089e-01  3.069e-02 -16.578  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.47 on 3435 degrees of freedom
## Multiple R-squared:  0.5397, Adjusted R-squared:  0.5387 
## F-statistic: 575.3 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>L‚Äôampleur des coefficients est relatif √† l‚Äô√©chelle de la variable. En effet, un coefficient de 5541 sur la variable <code>lat</code> n‚Äôest pas comparable au coefficient de la variable <code>bv</code>, de -0.5089, √©tant donn√© que les variables ne sont pas exprim√©es avec la m√™me √©chelle. Pour les comparer sur une m√™me base, on peut centrer (soustraire la moyenne) et r√©duire (diviser par l‚Äô√©cart-type).</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="chapitre-biostats.html#cb112-1"></a>lasrosas.corn_sc &lt;-<span class="st"> </span>lasrosas.corn <span class="op">%&gt;%</span></span>
<span id="cb112-2"><a href="chapitre-biostats.html#cb112-2"></a><span class="st">    </span><span class="kw">mutate_at</span>(<span class="kw">c</span>(<span class="st">&quot;lat&quot;</span>, <span class="st">&quot;long&quot;</span>, <span class="st">&quot;nitro&quot;</span>, <span class="st">&quot;bv&quot;</span>), scale)</span>
<span id="cb112-3"><a href="chapitre-biostats.html#cb112-3"></a></span>
<span id="cb112-4"><a href="chapitre-biostats.html#cb112-4"></a>modlin_<span class="dv">5</span>_sc &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>long <span class="op">+</span><span class="st"> </span>nitro <span class="op">+</span><span class="st"> </span>topo <span class="op">+</span><span class="st"> </span>bv,</span>
<span id="cb112-5"><a href="chapitre-biostats.html#cb112-5"></a>               <span class="dt">data =</span> lasrosas.corn_sc)</span>
<span id="cb112-6"><a href="chapitre-biostats.html#cb112-6"></a><span class="kw">summary</span>(modlin_<span class="dv">5</span>_sc)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ lat + long + nitro + topo + bv, data = lasrosas.corn_sc)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -48.405 -11.071  -1.251  10.592  40.078 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)  78.9114     0.6666 118.376  &lt; 2e-16 ***
## lat           3.9201     0.3223  12.163  &lt; 2e-16 ***
## long          0.3479     0.8796   0.395    0.693    
## nitro         2.9252     0.2322  12.597  &lt; 2e-16 ***
## topoHT      -26.6487     1.0868 -24.520  &lt; 2e-16 ***
## topoLO        5.5647     1.0347   5.378 8.03e-08 ***
## topoW       -14.6487     1.6555  -8.849  &lt; 2e-16 ***
## bv           -4.9253     0.2971 -16.578  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 13.47 on 3435 degrees of freedom
## Multiple R-squared:  0.5397, Adjusted R-squared:  0.5387 
## F-statistic: 575.3 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Typiquement, les variables cat√©gorielles, qui ne sont pas mises √† l‚Äô√©chelle, donneront des coefficients plus √©lev√©es, et devrons √™tre √©valu√©es entre elles et non comparativement aux variables mises √† l‚Äô√©chelle. Une mani√®re conviviale de repr√©senter des coefficients consiste √† utiliser la fonction <code>tidy</code> du module <strong><code>broom</code></strong>, qui g√©n√®re un tableau contennt les coefficients ainsi que leurs intervalles de confiance, que nous pourrons ensuite porter graphiquement.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="chapitre-biostats.html#cb114-1"></a><span class="kw">library</span>(<span class="st">&quot;broom&quot;</span>) <span class="co"># ou bien charger le m√©ta-module tidymodels</span></span>
<span id="cb114-2"><a href="chapitre-biostats.html#cb114-2"></a>intervals &lt;-<span class="st"> </span><span class="kw">tidy</span>(modlin_<span class="dv">5</span>_sc, <span class="dt">conf.int =</span> <span class="ot">TRUE</span>, <span class="dt">conf.level =</span> <span class="fl">0.95</span>)</span>
<span id="cb114-3"><a href="chapitre-biostats.html#cb114-3"></a>intervals</span></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##   term        estimate std.error statistic   p.value conf.low conf.high
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
## 1 (Intercept)   78.9       0.667   118.    0.           77.6      80.2 
## 2 lat            3.92      0.322    12.2   2.34e- 33     3.29      4.55
## 3 long           0.348     0.880     0.395 6.93e-  1    -1.38      2.07
## 4 nitro          2.93      0.232    12.6   1.33e- 35     2.47      3.38
## 5 topoHT       -26.6       1.09    -24.5   1.74e-122   -28.8     -24.5 
## 6 topoLO         5.56      1.03      5.38  8.03e-  8     3.54      7.59
## 7 topoW        -14.6       1.66     -8.85  1.39e- 18   -17.9     -11.4 
## 8 bv            -4.93      0.297   -16.6   1.92e- 59    -5.51     -4.34</code></pre>
<p>La valeur par d√©faut de l‚Äôargument <code>conf.level</code> est de 0.95, mais je vous sugg√®re de toujours l‚Äô√©crire de mani√®re explicite, ne serait-ce que pour rappeler √† vous-m√™me ainsi qu‚Äô√† vos coll√®gues, que cette valeur est arbitraire: il s‚Äôagit d‚Äôune d√©cision d‚Äôanalyse, non pas d‚Äôune valeur √† utiliser par convention.</p>
<p>Pour le graphique, on aura avantage √† s√©parer les effets cat√©goriels aux effets num√©riques pour mieux interpr√©ter leurs effets entre eux. J‚Äôutilise la fonction <code>dplyr::case_when()</code> pour cr√©er une nouvelle colonne qui cat√©gorisera les termes de l‚Äô√©quation. Cette cat√©gorie me permettra d‚Äôeffectuer un <code>facet_wrap()</code>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="chapitre-biostats.html#cb116-1"></a>intervals <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb116-2"><a href="chapitre-biostats.html#cb116-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">type =</span> <span class="kw">case_when</span>(</span>
<span id="cb116-3"><a href="chapitre-biostats.html#cb116-3"></a>    term <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;topoHT&quot;</span>, <span class="st">&quot;topoLO&quot;</span>, <span class="st">&quot;topoW&quot;</span>) <span class="op">~</span><span class="st"> &quot;Cat√©gorie&quot;</span>, <span class="co"># condition ~ r√©sultat</span></span>
<span id="cb116-4"><a href="chapitre-biostats.html#cb116-4"></a>    term <span class="op">==</span><span class="st"> &quot;(Intercept)&quot;</span> <span class="op">~</span><span class="st"> &quot;Intercept&quot;</span>,  <span class="co"># condition ~ r√©sultat</span></span>
<span id="cb116-5"><a href="chapitre-biostats.html#cb116-5"></a>    <span class="ot">TRUE</span> <span class="op">~</span><span class="st"> &quot;num√©rique&quot;</span> <span class="co"># pour toute autre condition (TRUE) ~ r√©sultat</span></span>
<span id="cb116-6"><a href="chapitre-biostats.html#cb116-6"></a>  )) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb116-7"><a href="chapitre-biostats.html#cb116-7"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> estimate, <span class="dt">y =</span> term)) <span class="op">+</span></span>
<span id="cb116-8"><a href="chapitre-biostats.html#cb116-8"></a><span class="st">  </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb116-9"><a href="chapitre-biostats.html#cb116-9"></a><span class="st">  </span><span class="kw">geom_segment</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> conf.low, <span class="dt">xend =</span> conf.high, <span class="dt">yend =</span> term)) <span class="op">+</span></span>
<span id="cb116-10"><a href="chapitre-biostats.html#cb116-10"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb116-11"><a href="chapitre-biostats.html#cb116-11"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Coefficient standardis√©&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>) <span class="op">+</span></span>
<span id="cb116-12"><a href="chapitre-biostats.html#cb116-12"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>type, <span class="dt">scales =</span> <span class="st">&quot;free&quot;</span>, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">strip.position =</span> <span class="st">&quot;right&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-lm-ci-plot-1.png" width="672" /></p>
<p>On y voit qu‚Äô√† l‚Äôexception de la variable <code>long</code>, tous les coefficients sont √©loign√©s de 0. Le coefficient <code>bv</code> est n√©gatif, indiquant que plus la valeur de <code>bv</code> est √©lev√© (donc plus le sol est pauvre en mati√®re organique), plus le rendement est faible. Plus la latitude est √©lev√©e (plus on se dirige vers le Nord de l‚ÄôArgentine), plus le rendement est √©lev√©. La dose d‚Äôazote a aussi un effet statistique positif sur le rendement.</p>
<p>Quant aux cat√©gories topographiques, elles sont toutes √©loign√©es de la cat√©gorie <code>E</code>, plac√©e √† z√©ro. De plus, les intervalles de confiance √† 0.95 ne se chevauchant pas, on peut conclure que la variabilit√© du ph√©nom√®ne √©chantillonn√© n‚Äôest pas suffisante pour expliquer les diff√©rences importantes d‚Äôune √† l‚Äôautre.</p>
<p>On pourra retrouver des cas o√π l‚Äôeffet combin√© de plusieurs variables diff√®re de l‚Äôeffet des deux variables prises s√©par√©ment. Par exemple, on pourrait √©valuer l‚Äôeffet de l‚Äôazote et celui de la topographie dans un m√™me mod√®le, puis y ajouter une interaction entre l‚Äôazote et la topographie, qui d√©finira des effets suppl√©mentaires de l‚Äôazote selon chaque cat√©gorie topographique. C‚Äôest ce que l‚Äôon appelle une interaction.</p>
<p>Dans l‚Äôinterface-formule, l‚Äôinteraction entre l‚Äôazote et la topographie est not√©e <code>nitro:topo</code>. Pour ajouter cette interaction, la formule deviendra <code>yield ~ nitro + topo + nitro:topo</code>. Une approche √©quivalente est d‚Äôutiliser le raccourci <code>yield ~ nitro * topo</code>.</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="chapitre-biostats.html#cb117-1"></a>modlin_<span class="dv">5</span>_sc &lt;-<span class="st"> </span><span class="kw">lm</span>(yield <span class="op">~</span><span class="st"> </span>nitro <span class="op">*</span><span class="st"> </span>topo,</span>
<span id="cb117-2"><a href="chapitre-biostats.html#cb117-2"></a>               <span class="dt">data =</span> lasrosas.corn_sc)</span>
<span id="cb117-3"><a href="chapitre-biostats.html#cb117-3"></a><span class="kw">summary</span>(modlin_<span class="dv">5</span>_sc)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = yield ~ nitro * topo, data = lasrosas.corn_sc)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -47.984 -11.985  -1.388  10.339  40.636 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   78.6999     0.5322 147.870  &lt; 2e-16 ***
## nitro          1.8131     0.5351   3.388 0.000711 ***
## topoHT       -30.0052     0.7394 -40.578  &lt; 2e-16 ***
## topoLO         6.2026     0.7190   8.627  &lt; 2e-16 ***
## topoW        -11.9628     0.6939 -17.240  &lt; 2e-16 ***
## nitro:topoHT   1.2553     0.7461   1.682 0.092565 .  
## nitro:topoLO   0.5695     0.7186   0.792 0.428141    
## nitro:topoW    0.7702     0.6944   1.109 0.267460    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 14.38 on 3435 degrees of freedom
## Multiple R-squared:  0.4756, Adjusted R-squared:  0.4746 
## F-statistic: 445.1 on 7 and 3435 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Les r√©sultats montre des effets de l‚Äôazote et des cat√©gories topographiques, mais il y a davantage d‚Äôincertitude sur les interactions, indiquant que l‚Äôeffet statistique de l‚Äôazote est sensiblement le m√™me ind√©pendamment des niveaux topographiques.</p>
<p>Dans le cas des r√©gressions multiples, les r√©sidus ne peuvent pas √™tre pr√©sent√©s selon une variable explicative <span class="math inline">\(x\)</span>, puisqu‚Äôil y en a plusieurs. On fera l‚Äôanalyse des r√©sidus selon la variable r√©ponse <span class="math inline">\(y\)</span>.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="chapitre-biostats.html#cb119-1"></a><span class="kw">tibble</span>(</span>
<span id="cb119-2"><a href="chapitre-biostats.html#cb119-2"></a>  <span class="dt">y =</span> lasrosas.corn_sc<span class="op">$</span>yield,</span>
<span id="cb119-3"><a href="chapitre-biostats.html#cb119-3"></a>  <span class="dt">residus =</span> <span class="kw">residuals</span>(modlin_<span class="dv">5</span>_sc)</span>
<span id="cb119-4"><a href="chapitre-biostats.html#cb119-4"></a>) <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb119-5"><a href="chapitre-biostats.html#cb119-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> y, <span class="dt">y =</span> residus)) <span class="op">+</span></span>
<span id="cb119-6"><a href="chapitre-biostats.html#cb119-6"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb119-7"><a href="chapitre-biostats.html#cb119-7"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;R√©sidus&quot;</span>) <span class="op">+</span></span>
<span id="cb119-8"><a href="chapitre-biostats.html#cb119-8"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-residuals-mult-reg-1.png" width="672" />
Dans ce mod√®le, il y a clairement une structure qui nous √©chappe! L‚Äôajout de d‚Äôautres variables nous permettrait √©ventuellement d‚Äôobtenir une distribution qui s‚Äôapproche d‚Äôun bruit.</p>
</div>
<div id="les-interactions" class="section level4">
<h4><span class="header-section-number">6.8.1.7</span> Les interactions</h4>
<p>Une interaction est un effet suppl√©mentaire qui est investigu√© pour des combinaisons de variables. L‚Äôinteraction entre l‚Äôazote et la topographie est une nouvelle variable cr√©√©e par la multiplication de l‚Äôazote, une variable num√©rique, et de la topographie, qui ici est une variable cat√©gorielle.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="chapitre-biostats.html#cb120-1"></a><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span>nitro <span class="op">*</span><span class="st"> </span>topo, <span class="dt">data =</span> lasrosas.corn_sc) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>()</span></code></pre></div>
<pre><code>##   (Intercept)    nitro topoHT topoLO topoW nitro:topoHT nitro:topoLO
## 1           1 1.571194      0      0     1            0            0
## 2           1 1.571194      0      0     1            0            0
## 3           1 1.571194      0      0     1            0            0
## 4           1 1.571194      0      0     1            0            0
## 5           1 1.571194      0      0     1            0            0
## 6           1 1.571194      0      0     1            0            0
##   nitro:topoW
## 1    1.571194
## 2    1.571194
## 3    1.571194
## 4    1.571194
## 5    1.571194
## 6    1.571194</code></pre>
<p>L‚Äôent√™te de la matrice mod√®le montre que l‚Äôinteraction est l‚Äôaddition de trois variables, qui sont nulles si la cat√©gorie topographique est absente, mais qui prend la dose d‚Äôazote pour la cat√©gorie pr√©sente seulement.</p>
<p>L‚Äôinterpr√©tation d‚Äôune interaction est sp√©cifique au mod√®le utilis√©. Une mani√®re de l‚Äôinterpr√©ter est de se demander dans quelles unit√©s elle est exprim√©e. Dans notre exemple, il s‚Äôagit de kg/ha standardis√©s.</p>
<p>Prenons un autre exemple, cette fois-ci avec des donn√©es fictives. Une enqu√™te a √©t√© men√©e, o√π des personnes √©valuait le karma (√©chelle 0 √† 10) de pieds nus, en bas (chaussettes) et/ou en sandales.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="chapitre-biostats.html#cb122-1"></a>karma_df &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/karma_df.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   ID = col_double(),
##   sandales = col_double(),
##   bas = col_double(),
##   karma = col_double()
## )</code></pre>
<p>Nous d√©sirons savoir quelle est l‚Äôeffet des bas et des sandales sur le karma, donc üíñ ~ üë° + üß¶.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="chapitre-biostats.html#cb124-1"></a><span class="kw">tidy</span>(<span class="kw">lm</span>(karma <span class="op">~</span><span class="st"> </span>sandales <span class="op">+</span><span class="st"> </span>bas, karma_df))</span></code></pre></div>
<pre><code>## # A tibble: 3 x 5
##   term        estimate std.error statistic  p.value
##   &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)     3.67     0.147      25.0 1.11e-94
## 2 sandales        2.29     0.166      13.8 7.99e-38
## 3 bas             1.77     0.168      10.5 6.31e-24</code></pre>
<p>√Ä partir du sc√©nario √† pieds nus d‚Äôun karma de 3.67, les sandales ajoutent 2.29 de points de karma, alors que les bas en ajoutent 1.8. Mais ce mod√®le est incomplet, cas on n‚Äô√©value pas l‚Äôeffet des bas ET des sandales, donc üíñ ~ üë° * üß¶.</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="chapitre-biostats.html#cb126-1"></a><span class="kw">tidy</span>(<span class="kw">lm</span>(karma <span class="op">~</span><span class="st"> </span>sandales <span class="op">*</span><span class="st"> </span>bas, karma_df))</span></code></pre></div>
<pre><code>## # A tibble: 4 x 5
##   term         estimate std.error statistic  p.value
##   &lt;chr&gt;           &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
## 1 (Intercept)      2.68     0.134      20.0 2.22e-68
## 2 sandales         3.68     0.159      23.2 4.07e-85
## 3 bas              3.20     0.162      19.8 1.40e-67
## 4 sandales:bas    -5.25     0.309     -17.0 3.79e-53</code></pre>
<p>Le mod√®les est plus clair. Sans interaction, les effets sur le karma des bas et des sandales √©taient n√©gativement affect√©s par l‚Äôeffet d‚Äôinteraction <code>sandales:bas</code>, le karma √©tant pouss√© √† la baisse par le <a href="https://youtu.be/_whvVXX0hCk?t=86">bas blanc dans vos sandales</a>.</p>
<p>Il est possible d‚Äôajouter des interactions doubles, triples, quadruples, etc. Mais plus il y a d‚Äôinteractions, plus votre mod√®le comprendra de variables et vos tests d‚Äôhypoth√®se perdront en puissance statistique.</p>
</div>
<div id="les-mod√®les-lin√©aires-g√©n√©ralis√©s" class="section level4">
<h4><span class="header-section-number">6.8.1.8</span> Les mod√®les lin√©aires g√©n√©ralis√©s</h4>
<p>Dans un mod√®le lin√©aire ordinaire, un changement constant dans les variables explicatives r√©sulte en un changement constant de la variable-r√©ponse. Cette supposition ne serait pas ad√©quate si la variable-r√©ponse √©tait un d√©compte, si elle est bool√©enne ou si, de mani√®re g√©n√©rale, la variable-r√©ponse ne suivait pas une distribution continue. Ou, de mani√®re plus sp√©cifique, il n‚Äôy a pas moyen de retrouver une distribution normale des r√©sidus? On pourra bien s√ªr transformer les variables (sujet du chapitre 6, en d√©veloppement). Mais il pourrait s‚Äôav√©rer impossible, ou tout simplement non souhaitable de transformer les variables. Le mod√®le lin√©aire g√©n√©ralis√© (MLG, ou <em>generalized linear model</em> - GLM) est une g√©n√©ralisation du mod√®le lin√©aire ordinaire chez qui la variable-r√©ponse peut √™tre caract√©ris√© par une distribution de Poisson, de Bernouilli, etc.</p>
<p>Prenons d‚Äôabord cas d‚Äôun d√©compte de vers fil-de-fer (<code>worms</code>) retrouv√©s dans des parcelles sous diff√©rents traitements (<code>trt</code>). Les d√©comptes sont typiquement distribu√© selon une loi de Poisson.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="chapitre-biostats.html#cb128-1"></a>cochran.wireworms <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> worms)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">10</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-glm-hist-1.png" width="672" /></p>
<p>Explorons les d√©comptes selon les traitements.</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="chapitre-biostats.html#cb129-1"></a>cochran.wireworms <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> trt, <span class="dt">y =</span> worms)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-glm-boxplot-1.png" width="672" /></p>
<p>Les traitements semble √† premi√®re vue avoir un effet comparativement au contr√¥le. Lan√ßons un MLG avec la fonction <code>glm()</code>, et sp√©cifions que la sortie est une distribution de Poisson. Bien que la fonction de lien (<code>link = "log"</code>) soit explictement impos√©e, le log est la valeur par d√©faut pour les distributions de Poisson. Ainsi, les coefficients du mod√®les devront √™tre interpr√©t√©s selon un mod√®le <span class="math inline">\(log \left(worms \right) = intercept + pente \times coefficient\)</span>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="chapitre-biostats.html#cb130-1"></a>modglm_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(worms <span class="op">~</span><span class="st"> </span>trt, cochran.wireworms, <span class="dt">family =</span> stats<span class="op">::</span><span class="kw">poisson</span>(<span class="dt">link=</span><span class="st">&quot;log&quot;</span>))</span>
<span id="cb130-2"><a href="chapitre-biostats.html#cb130-2"></a><span class="kw">summary</span>(modglm_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = worms ~ trt, family = stats::poisson(link = &quot;log&quot;), 
##     data = cochran.wireworms)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8279  -0.9455  -0.2862   0.6916   3.1888  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   0.1823     0.4082   0.447 0.655160    
## trtM          1.6422     0.4460   3.682 0.000231 ***
## trtN          1.7636     0.4418   3.991 6.57e-05 ***
## trtO          1.5755     0.4485   3.513 0.000443 ***
## trtP          1.3437     0.4584   2.931 0.003375 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for poisson family taken to be 1)
## 
##     Null deviance: 64.555  on 24  degrees of freedom
## Residual deviance: 38.026  on 20  degrees of freedom
## AIC: 125.64
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>L‚Äôinterpr√©tation sp√©cifique des coefficients d‚Äôune r√©gression de Poisson doit passer par la fonction de lien <span class="math inline">\(log \left(worms \right) = intercept + pente \times coefficient\)</span>. Le traitement de r√©f√©rence (K), qui correspond √† l‚Äôintercept, sera accompagn√© d‚Äôun nombre de vers de <span class="math inline">\(exp \left(0.1823\right) = 1.20\)</span> vers, et le traitement M, √† <span class="math inline">\(exp \left(1.6422\right) = 5.17\)</span> vers. Cela correspond √† ce que l‚Äôon observe sur les boxplots plus haut.</p>
<p>Il est tr√®s probable (p-value de ~0.66) qu‚Äôun intercept (traitement K) de 0.18 ayant une erreur standard de 0.4082 ait √©t√© g√©n√©r√© depuis une population dont l‚Äôintercept est nul. Quant aux autres traitements, leurs effets sont tous significatifs au seuil 0.05, mais peuvent-ils √™tre consid√©r√©s comme √©quivalents?</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="chapitre-biostats.html#cb132-1"></a>intervals &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Estimate =</span> <span class="kw">coefficients</span>(modglm_<span class="dv">1</span>), <span class="co"># [-1] enlever l&#39;intercept</span></span>
<span id="cb132-2"><a href="chapitre-biostats.html#cb132-2"></a>                    <span class="dt">LL =</span> <span class="kw">confint</span>(modglm_<span class="dv">1</span>)[, <span class="dv">1</span>], <span class="co"># [-1, ] enlever la premi√®re ligne, celle de l&#39;intercept</span></span>
<span id="cb132-3"><a href="chapitre-biostats.html#cb132-3"></a>                    <span class="dt">UL =</span> <span class="kw">confint</span>(modglm_<span class="dv">1</span>)[, <span class="dv">2</span>],</span>
<span id="cb132-4"><a href="chapitre-biostats.html#cb132-4"></a>                    <span class="dt">variable =</span> <span class="kw">names</span>(<span class="kw">coefficients</span>(modglm_<span class="dv">1</span>)))</span></code></pre></div>
<pre><code>## Waiting for profiling to be done...
## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="chapitre-biostats.html#cb134-1"></a>intervals</span></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##   Estimate     LL    UL variable   
##      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      
## 1    0.182 -0.740 0.888 (Intercept)
## 2    1.64   0.840 2.62  trtM       
## 3    1.76   0.972 2.74  trtN       
## 4    1.58   0.766 2.56  trtO       
## 5    1.34   0.509 2.34  trtP</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="chapitre-biostats.html#cb136-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> intervals, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Estimate, <span class="dt">y =</span> variable)) <span class="op">+</span></span>
<span id="cb136-2"><a href="chapitre-biostats.html#cb136-2"></a><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb136-3"><a href="chapitre-biostats.html#cb136-3"></a><span class="st">    </span><span class="kw">geom_segment</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> LL, <span class="dt">xend =</span> UL,</span>
<span id="cb136-4"><a href="chapitre-biostats.html#cb136-4"></a>                               <span class="dt">y =</span> variable, <span class="dt">yend =</span> variable)) <span class="op">+</span></span>
<span id="cb136-5"><a href="chapitre-biostats.html#cb136-5"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb136-6"><a href="chapitre-biostats.html#cb136-6"></a><span class="st">    </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Coefficient&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-glm-plot-effects-1.png" width="672" /></p>
<p>Les intervalles de confiance se superposant, on ne peut pas conclure qu‚Äôun traitement est li√© √† une r√©duction plus importante de vers qu‚Äôun autre, au seuil 0.05.</p>
<p>Maintenant, √† d√©faut de trouver un tableau de donn√©es plus appropri√©, prenons le tableau <code>mtcars</code>, qui rassemble des donn√©es sur des mod√®les de voitures. La colonne <code>vs</code>, pour v-shaped, inscrit 0 si les pistons sont droit et 1 s‚Äôils sont plac√©s en V dans le moteur. Peut-on expliquer la forme des pistons selon le poids du v√©hicule (<code>wt</code>)?</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="chapitre-biostats.html#cb137-1"></a>mtcars <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">6</span>)</span></code></pre></div>
<pre><code>##    mpg cyl  disp  hp drat    wt  qsec vs am gear carb
## 1 32.4   4  78.7  66 4.08 2.200 19.47  1  1    4    1
## 2 21.4   4 121.0 109 4.11 2.780 18.60  1  1    4    2
## 3 21.4   6 258.0 110 3.08 3.215 19.44  1  0    3    1
## 4 14.7   8 440.0 230 3.23 5.345 17.42  0  0    3    4
## 5 22.8   4 108.0  93 3.85 2.320 18.61  1  1    4    1
## 6 17.3   8 275.8 180 3.07 3.730 17.60  0  0    3    3</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="chapitre-biostats.html#cb139-1"></a>mtcars <span class="op">%&gt;%</span></span>
<span id="cb139-2"><a href="chapitre-biostats.html#cb139-2"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> wt, <span class="dt">y =</span> vs)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-glm-cars-plot-1.png" width="672" /></p>
<p>Il semble y avoir une tendance: les v√©hicules plus lourds ont plut√¥t des pistons droits (<code>vs = 0</code>). V√©rifions cela.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="chapitre-biostats.html#cb140-1"></a>modglm_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">glm</span>(vs <span class="op">~</span><span class="st"> </span>wt, <span class="dt">data =</span> mtcars, <span class="dt">family =</span> stats<span class="op">::</span><span class="kw">binomial</span>())</span>
<span id="cb140-2"><a href="chapitre-biostats.html#cb140-2"></a><span class="kw">summary</span>(modglm_<span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
## Call:
## glm(formula = vs ~ wt, family = stats::binomial(), data = mtcars)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.9003  -0.7641  -0.1559   0.7223   1.5736  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)   5.7147     2.3014   2.483  0.01302 * 
## wt           -1.9105     0.7279  -2.625  0.00867 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 43.860  on 31  degrees of freedom
## Residual deviance: 31.367  on 30  degrees of freedom
## AIC: 35.367
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p><strong>Exercice</strong>. Analyser les r√©sultats.</p>
</div>
<div id="les-mod√®les-non-lin√©aires" class="section level4">
<h4><span class="header-section-number">6.8.1.9</span> Les mod√®les non-lin√©aires</h4>
<p>La hauteur d‚Äôun arbre en fonction du temps n‚Äôest typiquement pas lin√©aire. Elle tend √† cro√Ætre de plus en plus lentement jusqu‚Äô√† un plateau. De m√™me, le rendement d‚Äôune culture trait√© avec des doses croissantes de fertilisants tend √† atteindre un maximum, puis √† se stabiliser.</p>
<p>Ces ph√©nom√®nes ne peuvent pas √™tre approxim√©s par des mod√®les lin√©aires. Examinons les donn√©es du tableau <code>engelstad.nitro</code>.</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="chapitre-biostats.html#cb142-1"></a>engelstad.nitro <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">10</span>)</span></code></pre></div>
<pre><code>##          loc year nitro yield
## 1  Knoxville 1966     0  63.0
## 2  Knoxville 1965   335  61.2
## 3    Jackson 1965   335  73.0
## 4    Jackson 1966   201  61.3
## 5    Jackson 1966   335  59.8
## 6  Knoxville 1964     0  60.9
## 7  Knoxville 1964    67  75.9
## 8    Jackson 1966    67  45.2
## 9    Jackson 1962   201  73.1
## 10   Jackson 1964   335  67.8</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="chapitre-biostats.html#cb144-1"></a>engelstad.nitro <span class="op">%&gt;%</span></span>
<span id="cb144-2"><a href="chapitre-biostats.html#cb144-2"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb144-3"><a href="chapitre-biostats.html#cb144-3"></a><span class="st">        </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>loc) <span class="op">+</span></span>
<span id="cb144-4"><a href="chapitre-biostats.html#cb144-4"></a><span class="st">        </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb144-5"><a href="chapitre-biostats.html#cb144-5"></a><span class="st">        </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nls-plot-1.png" width="672" /></p>
<p>Le mod√®le de Mitscherlich pourrait √™tre utilis√©.</p>
<p><span class="math display">\[ y = A \left( 1 - e^{-R \left( E + x \right)} \right) \]</span></p>
<p>o√π <span class="math inline">\(y\)</span> est le rendement, <span class="math inline">\(x\)</span> est la dose, <span class="math inline">\(A\)</span> est l‚Äôasymptote vers laquelle la courbe converge √† dose croissante, <span class="math inline">\(E\)</span> est l‚Äô√©quivalent de dose fourni par l‚Äôenvironnement et <span class="math inline">\(R\)</span> est le taux de r√©ponse.</p>
<p>Explorons la fonction.</p>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="chapitre-biostats.html#cb145-1"></a>mitscherlich_f &lt;-<span class="st"> </span><span class="cf">function</span>(x, A, E, R) {</span>
<span id="cb145-2"><a href="chapitre-biostats.html#cb145-2"></a>    A <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>R<span class="op">*</span>(E <span class="op">+</span><span class="st"> </span>x)))</span>
<span id="cb145-3"><a href="chapitre-biostats.html#cb145-3"></a>}</span>
<span id="cb145-4"><a href="chapitre-biostats.html#cb145-4"></a></span>
<span id="cb145-5"><a href="chapitre-biostats.html#cb145-5"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">350</span>, <span class="dt">by =</span> <span class="dv">5</span>)</span>
<span id="cb145-6"><a href="chapitre-biostats.html#cb145-6"></a>y &lt;-<span class="st"> </span><span class="kw">mitscherlich_f</span>(x, <span class="dt">A =</span> <span class="dv">75</span>, <span class="dt">E =</span> <span class="dv">30</span>, <span class="dt">R =</span> <span class="fl">0.02</span>)</span>
<span id="cb145-7"><a href="chapitre-biostats.html#cb145-7"></a></span>
<span id="cb145-8"><a href="chapitre-biostats.html#cb145-8"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(x, y), <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb145-9"><a href="chapitre-biostats.html#cb145-9"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> engelstad.nitro, <span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb145-10"><a href="chapitre-biostats.html#cb145-10"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nls-miscth-explore-1.png" width="672" /></p>
<p><strong>Exercice</strong>. Changez les param√®tres pour visualiser comment la courbe r√©agit.</p>
<p>Nous pouvons d√©crire le mod√®le gr√¢ce √† l‚Äôinterface formule dans la fonction <code>nls()</code>. Notez que les mod√®les non-lin√©aires demandent des strat√©gies de calcul diff√©rentes de celles des mod√®les lin√©aires. En tout temps, nous devons identifier des valeurs de d√©part raisonnables pour les param√®tres dans l‚Äôargument <code>start</code>. Vous r√©ussirez rarement √† obtenir une convergence du premier coup avec vos param√®tres de d√©part. Le d√©fi est d‚Äôen trouver qui permettront au mod√®le de converger. Parfois, le mod√®le ne convergera jamais. D‚Äôautres fois, il convergera vers des solutions diff√©rentes selon les variables de d√©part choisies.</p>
<pre><code>modnl_1 &lt;- nls(yield ~ A * (1 - exp(-R*(E + nitro))),
                data = engelstad.nitro,
                start = list(A = 50, E = 10, R = 0.2))</code></pre>
<p>Le mod√®le ne converge pas (le bloc de calcul est d√©sactiv√©). Essayons les valeurs prises plus haut, lors de la cr√©ation du graphique, qui semblent bien s‚Äôajuster.</p>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="chapitre-biostats.html#cb147-1"></a>modnl_<span class="dv">1</span> &lt;-<span class="st">  </span><span class="kw">nls</span>(yield <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>R<span class="op">*</span>(E <span class="op">+</span><span class="st"> </span>nitro))),</span>
<span id="cb147-2"><a href="chapitre-biostats.html#cb147-2"></a>                <span class="dt">data =</span> engelstad.nitro,</span>
<span id="cb147-3"><a href="chapitre-biostats.html#cb147-3"></a>                <span class="dt">start =</span> <span class="kw">list</span>(<span class="dt">A =</span> <span class="dv">75</span>, <span class="dt">E =</span> <span class="dv">30</span>, <span class="dt">R =</span> <span class="fl">0.02</span>))</span></code></pre></div>
<p>Bingo! Voyons maintenant le sommaire.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="chapitre-biostats.html#cb148-1"></a><span class="kw">summary</span>(modnl_<span class="dv">1</span>)</span></code></pre></div>
<pre><code>## 
## Formula: yield ~ A * (1 - exp(-R * (E + nitro)))
## 
## Parameters:
##    Estimate Std. Error t value Pr(&gt;|t|)    
## A 75.023427   3.331860  22.517   &lt;2e-16 ***
## E 66.164110  27.251591   2.428   0.0184 *  
## R  0.012565   0.004881   2.574   0.0127 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 12.34 on 57 degrees of freedom
## 
## Number of iterations to convergence: 5 
## Achieved convergence tolerance: 8.067e-06</code></pre>
<p>Les param√®tres sont diff√©rents de z√©ro, et donnent la courbe suivante.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="chapitre-biostats.html#cb150-1"></a>x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">350</span>, <span class="dt">by =</span> <span class="dv">5</span>)</span>
<span id="cb150-2"><a href="chapitre-biostats.html#cb150-2"></a>y &lt;-<span class="st"> </span><span class="kw">mitscherlich_f</span>(x,</span>
<span id="cb150-3"><a href="chapitre-biostats.html#cb150-3"></a>                    <span class="dt">A =</span> <span class="kw">coefficients</span>(modnl_<span class="dv">1</span>)[<span class="dv">1</span>],</span>
<span id="cb150-4"><a href="chapitre-biostats.html#cb150-4"></a>                    <span class="dt">E =</span> <span class="kw">coefficients</span>(modnl_<span class="dv">1</span>)[<span class="dv">2</span>],</span>
<span id="cb150-5"><a href="chapitre-biostats.html#cb150-5"></a>                    <span class="dt">R =</span> <span class="kw">coefficients</span>(modnl_<span class="dv">1</span>)[<span class="dv">3</span>])</span>
<span id="cb150-6"><a href="chapitre-biostats.html#cb150-6"></a></span>
<span id="cb150-7"><a href="chapitre-biostats.html#cb150-7"></a><span class="kw">ggplot</span>(<span class="kw">tibble</span>(x, y), <span class="kw">aes</span>(x, y)) <span class="op">+</span></span>
<span id="cb150-8"><a href="chapitre-biostats.html#cb150-8"></a><span class="st">    </span><span class="kw">geom_point</span>(<span class="dt">data =</span> engelstad.nitro, <span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb150-9"><a href="chapitre-biostats.html#cb150-9"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">100</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nls-resultat-plot-1.png" width="672" /></p>
<p>Et les r√©sidus‚Ä¶</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="chapitre-biostats.html#cb151-1"></a><span class="kw">tibble</span>(<span class="dt">res =</span> <span class="kw">residuals</span>(modnl_<span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb151-2"><a href="chapitre-biostats.html#cb151-2"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> res)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_histogram</span>(<span class="dt">bins =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nls-residuals-1.png" width="672" /></p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="chapitre-biostats.html#cb152-1"></a><span class="kw">tibble</span>(<span class="dt">nitro =</span> engelstad.nitro<span class="op">$</span>nitro, <span class="dt">res =</span> <span class="kw">residuals</span>(modnl_<span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb152-2"><a href="chapitre-biostats.html#cb152-2"></a><span class="st">    </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> res)) <span class="op">+</span></span>
<span id="cb152-3"><a href="chapitre-biostats.html#cb152-3"></a><span class="st">        </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb152-4"><a href="chapitre-biostats.html#cb152-4"></a><span class="st">        </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>, <span class="dt">colour =</span> <span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nls-residuals2-1.png" width="672" /></p>
<p>Les r√©sidus ne sont pas distribu√©s normalement, mais semble bien partag√©s de part et d‚Äôautre de la courbe.</p>
</div>
</div>
<div id="mod√®les-√†-effets-mixtes" class="section level3">
<h3><span class="header-section-number">6.8.2</span> Mod√®les √† effets mixtes</h3>
<p>Lorsque l‚Äôon combine des variables fixes (test√©es lors de l‚Äôexp√©rience) et des variables al√©atoire (variation des unit√©s exp√©rimentales), on obtient un mod√®le mixte. Les mod√®les mixtes peuvent √™tre univari√©s, multivari√©s, lin√©aires ordinaires ou g√©n√©ralis√©s ou non lin√©aires.</p>
<p>√Ä la diff√©rence d‚Äôun effet fixe, un effet al√©atoire sera toujours distribu√© normalement avec une moyenne de 0 et une certaine variance. Dans un mod√®le lin√©aire o√π l‚Äôeffet al√©atoire est un d√©calage d‚Äôintercept, cet effet s‚Äôadditionne aux effets fixes:</p>
<p><span class="math display">\[ y = X \beta + Z b + \epsilon \]</span></p>
<p>o√π:</p>
<p><span class="math inline">\(Z\)</span> est la matrice du mod√®le √† <span class="math inline">\(n\)</span> observations et <span class="math inline">\(p\)</span> variables al√©atoires. Les variables al√©atoires sont souvent des variables nominales qui subissent un encodage cat√©goriel.</p>
<p><span class="math display">\[ Z = \left( \begin{matrix}
z_{11} &amp; \cdots &amp; z_{1p}  \\
z_{21} &amp; \cdots &amp; z_{2p}  \\
\vdots &amp; \ddots &amp; \vdots  \\
z_{n1} &amp; \cdots &amp; z_{np}
\end{matrix} \right) \]</span></p>
<p><span class="math inline">\(b\)</span> est la matrice des <span class="math inline">\(p\)</span> coefficients al√©atoires.</p>
<p><span class="math display">\[ b = \left( \begin{matrix}
b_0  \\
b_1  \\
\vdots \\
b_p
\end{matrix} \right) \]</span></p>
<p>Le tableau <code>lasrosas.corn</code>, utilis√© pr√©c√©demment, contenait trois r√©p√©titions effectu√©s au cours de deux ann√©es, 1999 et 2001. √âtant donn√© que la r√©p√©tition R1 de 1999 n‚Äôa rien √† voir avec la r√©p√©tition R1 de 2001, on dit qu‚Äôelle est <strong>embo√Æt√©e</strong> dans l‚Äôann√©e.</p>
<p>Le module <code>nlme</code> nous aidera √† monter notre mod√®le mixte.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="chapitre-biostats.html#cb153-1"></a><span class="kw">library</span>(<span class="st">&quot;nlme&quot;</span>)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;nlme&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     collapse</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="chapitre-biostats.html#cb156-1"></a>mmodlin_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">lme</span>(<span class="dt">fixed =</span> yield <span class="op">~</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>long <span class="op">+</span><span class="st"> </span>nitro <span class="op">+</span><span class="st"> </span>topo <span class="op">+</span><span class="st"> </span>bv,</span>
<span id="cb156-2"><a href="chapitre-biostats.html#cb156-2"></a>                 <span class="dt">random =</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span><span class="op">|</span>year<span class="op">/</span>rep,</span>
<span id="cb156-3"><a href="chapitre-biostats.html#cb156-3"></a>                 <span class="dt">data =</span> lasrosas.corn)</span></code></pre></div>
<p>√Ä ce stade vous devriez commencer √† √™tre familier avec l‚Äôinterface formule et vous deviez saisir l‚Äôargument <code>fixed</code>, qui d√©signe l‚Äôeffet fixe. L‚Äôeffet al√©atoire, <code>random</code>, suit un tilde <code>~</code>. √Ä gauche de la barre verticale <code>|</code>, on place les variables d√©signant les effets al√©atoire sur la pente. Nous n‚Äôavons pas couvert cet aspect, alors nous le laissons √† <code>1</code>. √Ä droite, on retrouve un structure d‚Äôembo√Ætement d√©signant l‚Äôeffet al√©atoire: le premier niveau est l‚Äôann√©e, dans laquelle est embo√Æt√©e la r√©p√©tition.</p>
<p><code>{r biostats-multivariate-nlme-model}-summ summary(mmodlin_1)</code></p>
<p>La sortie est semblable √† celle de la fonction <code>lm()</code>.</p>
<div id="mod√®les-mixtes-non-lin√©aires" class="section level4">
<h4><span class="header-section-number">6.8.2.1</span> Mod√®les mixtes non-lin√©aires</h4>
<p>Le mod√®le non lin√©aire cr√©√© plus haut liait le rendement √† la dose d‚Äôazote. Toutefois, les unit√©s exp√©rimentales (le site <code>loc</code> et l‚Äôann√©e <code>year</code>) n‚Äô√©taient pas pris en consid√©ration. Nous allons maintenant les consid√©rer.</p>
<p>Nous devons d√©cider la structure de l‚Äôeffet al√©atoire, et sur quelles variables il doit √™tre appliqu√© - la d√©cision appartient √† l‚Äôanalyste. Il me semble plus convenable de supposer que le site et l‚Äôann√©e affectera le rendement maximum plut√¥t que l‚Äôenvironnement et le taux: les effets al√©atoires seront donc affect√©s √† la variable <code>A</code>. Les effets al√©atoires n‚Äôont pas de structure d‚Äôembo√Ætement. L‚Äôeffet de l‚Äôann√©e sur A sera celui d‚Äôune pente et l‚Äôeffet de site sera celui de l‚Äôintercept. La fonction que nous utiliserons est <code>nlme()</code>.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="chapitre-biostats.html#cb157-1"></a>mm &lt;-<span class="st"> </span><span class="kw">nlme</span>(yield <span class="op">~</span><span class="st"> </span>A <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>R<span class="op">*</span>(E <span class="op">+</span><span class="st"> </span>nitro))),</span>
<span id="cb157-2"><a href="chapitre-biostats.html#cb157-2"></a>           <span class="dt">data =</span> engelstad.nitro,</span>
<span id="cb157-3"><a href="chapitre-biostats.html#cb157-3"></a>           <span class="dt">start =</span> <span class="kw">c</span>(<span class="dt">A =</span> <span class="dv">75</span>, <span class="dt">E =</span> <span class="dv">30</span>, <span class="dt">R =</span> <span class="fl">0.02</span>),</span>
<span id="cb157-4"><a href="chapitre-biostats.html#cb157-4"></a>           <span class="dt">fixed =</span> <span class="kw">list</span>(A <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, E <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, R <span class="op">~</span><span class="st"> </span><span class="dv">1</span>),</span>
<span id="cb157-5"><a href="chapitre-biostats.html#cb157-5"></a>           <span class="dt">random =</span> A <span class="op">~</span><span class="st"> </span>year <span class="op">|</span><span class="st"> </span>loc)</span>
<span id="cb157-6"><a href="chapitre-biostats.html#cb157-6"></a><span class="kw">summary</span>(mm)</span></code></pre></div>
<pre><code>## Nonlinear mixed-effects model fit by maximum likelihood
##   Model: yield ~ A * (1 - exp(-R * (E + nitro))) 
##  Data: engelstad.nitro 
##        AIC     BIC    logLik
##   477.2286 491.889 -231.6143
## 
## Random effects:
##  Formula: A ~ year | loc
##  Structure: General positive-definite, Log-Cholesky parametrization
##               StdDev       Corr  
## A.(Intercept)  2.611534836 A.(In)
## A.year         0.003066832 -0.556
## Residual      11.152757999       
## 
## Fixed effects: list(A ~ 1, E ~ 1, R ~ 1) 
##                  Value Std.Error DF   t-value p-value
## A.(Intercept) 74.58222  4.722715 56 15.792234  0.0000
## E             65.56721 25.533993 56  2.567840  0.0129
## R              0.01308  0.004808 56  2.720215  0.0087
##  Correlation: 
##   A.(In) E     
## E  0.379       
## R -0.483 -0.934
## 
## Standardized Within-Group Residuals:
##         Min          Q1         Med          Q3         Max 
## -1.83373132 -0.89293033  0.07418165  0.68353577  1.82434347 
## 
## Number of Observations: 60
## Number of Groups: 2</code></pre>
<p>Et sur graphique:</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="chapitre-biostats.html#cb159-1"></a>engelstad.nitro <span class="op">%&gt;%</span></span>
<span id="cb159-2"><a href="chapitre-biostats.html#cb159-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> nitro, <span class="dt">y =</span> yield)) <span class="op">+</span></span>
<span id="cb159-3"><a href="chapitre-biostats.html#cb159-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(year <span class="op">~</span><span class="st"> </span>loc) <span class="op">+</span></span>
<span id="cb159-4"><a href="chapitre-biostats.html#cb159-4"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> <span class="kw">tibble</span>(<span class="dt">nitro =</span> engelstad.nitro<span class="op">$</span>nitro,</span>
<span id="cb159-5"><a href="chapitre-biostats.html#cb159-5"></a>                          <span class="dt">yield =</span> <span class="kw">predict</span>(mm, <span class="dt">level =</span> <span class="dv">0</span>)),</span>
<span id="cb159-6"><a href="chapitre-biostats.html#cb159-6"></a>            <span class="dt">colour =</span> <span class="st">&quot;grey35&quot;</span>) <span class="op">+</span></span>
<span id="cb159-7"><a href="chapitre-biostats.html#cb159-7"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb159-8"><a href="chapitre-biostats.html#cb159-8"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">95</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/biostats-multivariate-nlme-nl-plot-1.png" width="672" /></p>
<p>Les mod√®les mixtes non lin√©aires peuvent devenir tr√®s complexes lorsque les param√®tres, par exemple A, E et R, sont eux-m√™me affect√©s lin√©airement par des variables (par exemple <code>A ~ topo</code>). Pour aller plus loin, consultez <a href="https://doi.org/10.3389/fenvs.2017.00081">Parent et al.¬†(2017)</a> ainsi que les <a href="https://github.com/essicolo/site-specific-multilevel-modeling-of-potato-response-to-nitrogen-fertilization">calculs associ√©s √† l‚Äôarticle</a>. Ou √©crivez-moi un courriel pour en discuter!</p>
<p><strong>Note</strong>. L‚Äôinterpr√©tation de p-values sur les mod√®les mixtes est controvers√©e. √Ä ce sujet, Douglas Bates a √©crit une longue lettre √† la communaut√© de d√©veloppement du module <code>lme4</code>, une alternative √† <code>nlme</code>, qui remet en cause l‚Äôutilisation des p-values, <a href="https://stat.ethz.ch/pipermail/r-help/2006-May/094765.html">ici</a>. De plus en plus, pour les mod√®les mixtes, on se tourne vers les statistiques bay√©siennes, couvertes dans le chapitre <a href="chapitre-biostats-bayes.html#chapitre-biostats-bayes">7</a> avec le module greta. Mais en ce qui a trait aux mod√®les mixtes, le module <a href="https://github.com/paul-buerkner/brms"><code>brms</code></a> automatise bien des aspects de l‚Äôapproche bay√©sienne.</p>
</div>
</div>
<div id="aller-plus-loin" class="section level3">
<h3><span class="header-section-number">6.8.3</span> Aller plus loin</h3>
<div id="statistiques-g√©n√©rales" class="section level4">
<h4><span class="header-section-number">6.8.3.1</span> Statistiques g√©n√©rales:</h4>
<ul>
<li><a href="https://ariane25.bibl.ulaval.ca/ariane/wicket/detail?c=ariane&amp;m=S&amp;rq.ct=PE&amp;rq.fa=false&amp;rq.r.esc=false&amp;rq.r.l%5B0%5D.c=TI&amp;rq.r.l%5B0%5D.ex=false&amp;rq.r.l%5B0%5D.op=AND&amp;rq.r.l%5B0%5D.v=the+analysis+of+biological+data&amp;rq.r.la=*&amp;rq.r.loc=*&amp;rq.r.pft=true&amp;rq.r.ta=*&amp;rq.r.td=*&amp;rq.rows=5&amp;rq.st=1">The analysis of biological data</a></li>
</ul>
</div>
<div id="statistiques-avec-r" class="section level4">
<h4><span class="header-section-number">6.8.3.2</span> Statistiques avec R</h4>
<ul>
<li>Disponibles en version √©lectronique √† la biblioth√®que de l‚ÄôUniversit√© Laval:
<ul>
<li>Introduction aux statistiques avec R: <a href="https://ariane25.bibl.ulaval.ca/ariane/wicket/detail?c=ariane&amp;m=S&amp;rq.ct=PE&amp;rq.fa=false&amp;rq.r.esc=false&amp;rq.r.l%5B0%5D.c=TI&amp;rq.r.l%5B0%5D.ex=false&amp;rq.r.l%5B0%5D.op=AND&amp;rq.r.l%5B0%5D.v=Introductory+statistics+with+R&amp;rq.r.la=*&amp;rq.r.loc=*&amp;rq.r.pft=true&amp;rq.r.ta=*&amp;rq.r.td=*&amp;rq.rows=1&amp;rq.st=0">Introductory statistics with R</a></li>
<li>Approfondir les statistiques avec R: <a href="https://ariane25.bibl.ulaval.ca/ariane/wicket/detail?c=ariane&amp;m=S&amp;rq.ct=PE&amp;rq.fa=false&amp;rq.r.esc=false&amp;rq.r.l%5B0%5D.c=TI&amp;rq.r.l%5B0%5D.ex=false&amp;rq.r.l%5B0%5D.op=AND&amp;rq.r.l%5B0%5D.v=the+r+book&amp;rq.r.la=*&amp;rq.r.loc=*&amp;rq.r.pft=true&amp;rq.r.ta=*&amp;rq.r.td=*&amp;rq.rows=15&amp;rq.st=2">The R Book, Second edition</a></li>
<li>Approfondir les mod√®les √† effets mixtes avec R: <a href="https://ariane25.bibl.ulaval.ca/ariane/wicket/detail?c=ariane&amp;m=S&amp;rq.ct=PE&amp;rq.fa=false&amp;rq.r.esc=false&amp;rq.r.l%5B0%5D.c=TI&amp;rq.r.l%5B0%5D.ex=false&amp;rq.r.l%5B0%5D.op=AND&amp;rq.r.l%5B0%5D.v=Mixed+Effects+Models+and+Extensions+in+Ecology+with+R&amp;rq.r.la=*&amp;rq.r.loc=*&amp;rq.r.pft=false&amp;rq.r.ta=*&amp;rq.r.td=*&amp;rq.rows=2&amp;rq.st=1">Mixed Effects Models and Extensions in Ecology with R</a></li>
</ul></li>
<li><a href="https://moderndive.com/index.html">ModernDive</a>, un livre en ligne offrant une approche moderne avec le package <code>moderndive</code>.</li>
</ul>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre-git.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre-biostats-bayes.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
