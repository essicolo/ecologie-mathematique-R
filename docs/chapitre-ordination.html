<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>9 Association, partitionnement et ordination | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</title>
  <meta name="description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="9 Association, partitionnement et ordination | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="9 Association, partitionnement et ordination | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  
  <meta name="twitter:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

<meta name="author" content="Serge-√âtienne Parent" />


<meta name="date" content="2020-04-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapitre-explorer.html"/>
<link rel="next" href="chapitre-outliers.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.2.1/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.0.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.0.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.52.2/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.52.2/plotly-latest.min.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.5/grViz.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/Proj4Leaflet-1.0.1/proj4-compressed.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.3/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.3/leaflet-providers-plugin.js"></script>
<script src="libs/Leaflet.Sync-0.0.5/L.Map.Sync.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#d√©finitions"><i class="fa fa-check"></i><b>1.1</b> D√©finitions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#√†-qui-sadresse-ce-manuel"><i class="fa fa-check"></i><b>1.2</b> √Ä qui s‚Äôadresse ce manuel?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#les-logiciels-libres"><i class="fa fa-check"></i><b>1.3</b> Les logiciels libres</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#langage-de-programmation"><i class="fa fa-check"></i><b>1.4</b> Langage de programmation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.4.1</b> R</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#pourquoi-pas-python"><i class="fa fa-check"></i><b>1.4.2</b> Pourquoi pas Python?</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#pourquoi-pas-matlab"><i class="fa fa-check"></i><b>1.4.3</b> Pourquoi pas Matlab?</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#et-sas"><i class="fa fa-check"></i><b>1.4.4</b> Et‚Ä¶ SAS?</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#mais-pourquoi-pas-______"><i class="fa fa-check"></i><b>1.4.5</b> Mais pourquoi pas ______ ?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#contenu-du-manuel"><i class="fa fa-check"></i><b>1.5</b> Contenu du manuel</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#objectifs-g√©n√©raux"><i class="fa fa-check"></i><b>1.6</b> Objectifs g√©n√©raux</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#lectures-compl√©mentaires"><i class="fa fa-check"></i><b>1.7</b> Lectures compl√©mentaires</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#√©cologie-math√©matique"><i class="fa fa-check"></i><b>1.7.1</b> √âcologie math√©matique</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#programmation"><i class="fa fa-check"></i><b>1.7.2</b> Programmation</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#divers"><i class="fa fa-check"></i><b>1.7.3</b> Divers</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#besoin-daide"><i class="fa fa-check"></i><b>1.8</b> Besoin d‚Äôaide?</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#√†-propos-de-lauteur"><i class="fa fa-check"></i><b>1.9</b> √Ä propos de l‚Äôauteur</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#un-cours-compl√©mentaire-√†-dautres-cours"><i class="fa fa-check"></i><b>1.10</b> Un cours compl√©mentaire √† d‚Äôautres cours</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#contribuer-au-manuel"><i class="fa fa-check"></i><b>1.11</b> Contribuer au manuel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html"><i class="fa fa-check"></i><b>2</b> La science des donn√©es avec R</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#statistiques-ou-science-des-donn√©es"><i class="fa fa-check"></i><b>2.1</b> Statistiques ou science des donn√©es?</a></li>
<li class="chapter" data-level="2.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#d√©buter-en-r"><i class="fa fa-check"></i><b>2.2</b> D√©buter en R</a></li>
<li class="chapter" data-level="2.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#pr√©parer-son-flux-de-travail"><i class="fa fa-check"></i><b>2.3</b> Pr√©parer son flux de travail</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-classique"><i class="fa fa-check"></i><b>2.3.1</b> Installation classique</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-avec-anaconda"><i class="fa fa-check"></i><b>2.3.2</b> Installation avec Anaconda</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#utilisation-infonuagique"><i class="fa fa-check"></i><b>2.3.3</b> Utilisation infonuagique</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#premiers-pas-avec-r"><i class="fa fa-check"></i><b>2.4</b> Premiers pas avec R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#types-de-donn√©es"><i class="fa fa-check"></i><b>2.4.1</b> Types de donn√©es</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-collections-de-donn√©es"><i class="fa fa-check"></i><b>2.4.2</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-fonctions"><i class="fa fa-check"></i><b>2.4.3</b> Les fonctions</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-boucles"><i class="fa fa-check"></i><b>2.4.4</b> Les boucles</a></li>
<li class="chapter" data-level="2.4.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#conditions-if-else-if-else"><i class="fa fa-check"></i><b>2.4.5</b> Conditions: <code>if</code>, <code>else if</code>, <code>else</code></a></li>
<li class="chapter" data-level="2.4.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installer-et-charger-un-module"><i class="fa fa-check"></i><b>2.4.6</b> Installer et charger un module</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#enfin"><i class="fa fa-check"></i><b>2.5</b> Enfin‚Ä¶</a></li>
<li class="chapter" data-level="2.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#petit-truc"><i class="fa fa-check"></i><b>2.6</b> Petit truc!</a></li>
<li class="chapter" data-level="2.7" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#extra-jupyter"><i class="fa fa-check"></i><b>2.7</b> Extra: Utiliser R avec Jupyter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html"><i class="fa fa-check"></i><b>3</b> Organisation des donn√©es et op√©rations sur des tableaux</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#les-collections-de-donn√©es-1"><i class="fa fa-check"></i><b>3.1</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#organiser-un-tableau-de-donn√©es"><i class="fa fa-check"></i><b>3.2</b> Organiser un tableau de donn√©es</a></li>
<li class="chapter" data-level="3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#formats-de-tableau"><i class="fa fa-check"></i><b>3.3</b> Formats de tableau</a><ul>
<li class="chapter" data-level="3.3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#xls-ou-xlsx"><i class="fa fa-check"></i><b>3.3.1</b> <em>xls</em> ou <em>xlsx</em></a></li>
<li class="chapter" data-level="3.3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#csv"><i class="fa fa-check"></i><b>3.3.2</b> <em>csv</em></a></li>
<li class="chapter" data-level="3.3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#json"><i class="fa fa-check"></i><b>3.3.3</b> <em>json</em></a></li>
<li class="chapter" data-level="3.3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#sqlite"><i class="fa fa-check"></i><b>3.3.4</b> SQLite</a></li>
<li class="chapter" data-level="3.3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#suggestion"><i class="fa fa-check"></i><b>3.3.5</b> Suggestion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#entreposer-ses-donn√©es"><i class="fa fa-check"></i><b>3.4</b> Entreposer ses donn√©es</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#manipuler-des-donn√©es-en-mode-tidyverse"><i class="fa fa-check"></i><b>3.5</b> Manipuler des donn√©es en mode tidyverse</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#importer-vos-donn√©es-dans-votre-session-de-travail"><i class="fa fa-check"></i><b>3.5.1</b> Importer vos donn√©es dans votre session de travail</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#comment-s√©lectionner-et-filtrer-des-donn√©es"><i class="fa fa-check"></i><b>3.5.2</b> Comment s√©lectionner et filtrer des donn√©es ?</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#le-format-long-et-le-format-large"><i class="fa fa-check"></i><b>3.5.3</b> Le format long et le format large</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#combiner-des-tableaux"><i class="fa fa-check"></i><b>3.5.4</b> Combiner des tableaux</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#op√©rations-sur-les-tableaux"><i class="fa fa-check"></i><b>3.5.5</b> Op√©rations sur les tableaux</a></li>
<li class="chapter" data-level="3.5.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exemple-difficile"><i class="fa fa-check"></i><b>3.5.6</b> Exemple (difficile)</a></li>
<li class="chapter" data-level="3.5.7" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exporter-un-tableau"><i class="fa fa-check"></i><b>3.5.7</b> Exporter un tableau</a></li>
<li class="chapter" data-level="3.5.8" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#aller-plus-loin-dans-le-tidyverse"><i class="fa fa-check"></i><b>3.5.8</b> Aller plus loin dans le tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#r√©f√©rences"><i class="fa fa-check"></i><b>3.6</b> R√©f√©rences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html"><i class="fa fa-check"></i><b>4</b> Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#pourquoi-explorer-graphiquement"><i class="fa fa-check"></i><b>4.1</b> Pourquoi explorer graphiquement?</a></li>
<li class="chapter" data-level="4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publier-un-graphique"><i class="fa fa-check"></i><b>4.2</b> Publier un graphique</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#cinq-qualit√©s-dun-bon-graphique"><i class="fa fa-check"></i><b>4.2.1</b> Cinq qualit√©s d‚Äôun bon graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-le-type-de-graphique-le-plus-appropri√©"><i class="fa fa-check"></i><b>4.3</b> Choisir le type de graphique le plus appropri√©</a></li>
<li class="chapter" data-level="4.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-son-outil-de-visualisation"><i class="fa fa-check"></i><b>4.4</b> Choisir son outil de visualisation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-imp√©rative"><i class="fa fa-check"></i><b>4.4.1</b> Approche imp√©rative</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-d√©clarative"><i class="fa fa-check"></i><b>4.4.2</b> Approche d√©clarative</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visualisation-en-r"><i class="fa fa-check"></i><b>4.5</b> Visualisation en R</a></li>
<li class="chapter" data-level="4.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#module-de-base-pour-les-graphiques"><i class="fa fa-check"></i><b>4.6</b> Module de base pour les graphiques</a></li>
<li class="chapter" data-level="4.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#la-grammaire-graphique-ggplot2"><i class="fa fa-check"></i><b>4.7</b> La grammaire graphique <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#mon-premier-ggplot"><i class="fa fa-check"></i><b>4.8</b> Mon premier ggplot</a><ul>
<li class="chapter" data-level="4.8.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#plusieurs-sources-de-donn√©es"><i class="fa fa-check"></i><b>4.8.1</b> Plusieurs sources de donn√©es</a></li>
<li class="chapter" data-level="4.8.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-avec-style"><i class="fa fa-check"></i><b>4.8.2</b> Exporter avec style</a></li>
<li class="chapter" data-level="4.8.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#nuages-de-points"><i class="fa fa-check"></i><b>4.8.3</b> Nuages de points</a></li>
<li class="chapter" data-level="4.8.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#diagrammes-en-lignes"><i class="fa fa-check"></i><b>4.8.4</b> Diagrammes en lignes</a></li>
<li class="chapter" data-level="4.8.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-histogrammes"><i class="fa fa-check"></i><b>4.8.5</b> Les histogrammes</a></li>
<li class="chapter" data-level="4.8.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#boxplots"><i class="fa fa-check"></i><b>4.8.6</b> Boxplots</a></li>
<li class="chapter" data-level="4.8.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-diagrammes-en-barre"><i class="fa fa-check"></i><b>4.8.7</b> Les diagrammes en barre</a></li>
<li class="chapter" data-level="4.8.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-un-graphique"><i class="fa fa-check"></i><b>4.8.8</b> Exporter un graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-graphiques-comme-outil-dexploration-des-donn√©es"><i class="fa fa-check"></i><b>4.9</b> Les graphiques comme outil d‚Äôexploration des donn√©es</a><ul>
<li class="chapter" data-level="4.9.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-graphiques-interactifs"><i class="fa fa-check"></i><b>4.9.1</b> Des graphiques interactifs!</a></li>
<li class="chapter" data-level="4.9.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-extensions-de-ggplot2"><i class="fa fa-check"></i><b>4.9.2</b> Des extensions de <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.9.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#aller-plus-loin-avec-ggplot2"><i class="fa fa-check"></i><b>4.9.3</b> Aller plus loin avec <strong><code>ggplot2</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#extra-r√®gles-particuli√®res"><i class="fa fa-check"></i><b>4.10</b> Extra: R√®gles particuli√®res</a><ul>
<li class="chapter" data-level="4.10.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#ne-tronquez-pas-inutilement-laxe-des-y"><i class="fa fa-check"></i><b>4.10.1</b> Ne tronquez pas inutilement l‚Äôaxe des <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="4.10.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#utilisez-un-encrage-proportionnel"><i class="fa fa-check"></i><b>4.10.2</b> Utilisez un encrage proportionnel</a></li>
<li class="chapter" data-level="4.10.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publiez-vos-donn√©es"><i class="fa fa-check"></i><b>4.10.3</b> Publiez vos donn√©es</a></li>
<li class="chapter" data-level="4.10.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visitez-www.junkcharts.typepad.com-de-temps-√†-autre"><i class="fa fa-check"></i><b>4.10.4</b> Visitez www.junkcharts.typepad.com de temps √† autre</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapitre-git.html"><a href="chapitre-git.html"><i class="fa fa-check"></i><b>5</b> Science ouverte et reproductibilit√©</a><ul>
<li class="chapter" data-level="5.1" data-path="chapitre-git.html"><a href="chapitre-git.html#un-code-reproductible"><i class="fa fa-check"></i><b>5.1</b> Un code reproductible</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chapitre-git.html"><a href="chapitre-git.html#structure-dun-projet"><i class="fa fa-check"></i><b>5.1.1</b> Structure d‚Äôun projet</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapitre-git.html"><a href="chapitre-git.html#le-format-r-markdown"><i class="fa fa-check"></i><b>5.1.2</b> Le format <span>R markdown</span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-github"><i class="fa fa-check"></i><b>5.2</b> Introduction √† GitHub</a></li>
<li class="chapter" data-level="5.3" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-pakrat"><i class="fa fa-check"></i><b>5.3</b> Introduction √† Pakrat üì¶üêÄ</a></li>
<li class="chapter" data-level="5.4" data-path="chapitre-git.html"><a href="chapitre-git.html#pour-terminer-le-reprex"><i class="fa fa-check"></i><b>5.4</b> Pour terminer, le <strong>reprex</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html"><i class="fa fa-check"></i><b>6</b> Biostatistiques</a><ul>
<li class="chapter" data-level="6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#populations-et-√©chantillons"><i class="fa fa-check"></i><b>6.1</b> Populations et √©chantillons</a></li>
<li class="chapter" data-level="6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-variables"><i class="fa fa-check"></i><b>6.2</b> Les variables</a><ul>
<li class="chapter" data-level="6.2.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-quantitatives"><i class="fa fa-check"></i><b>6.2.1</b> Variables quantitatives</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-qualitatives"><i class="fa fa-check"></i><b>6.2.2</b> Variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-probabilit√©s"><i class="fa fa-check"></i><b>6.3</b> Les probabilit√©s</a></li>
<li class="chapter" data-level="6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-distributions"><i class="fa fa-check"></i><b>6.4</b> Les distributions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-binomiale"><i class="fa fa-check"></i><b>6.4.1</b> Distribution binomiale</a></li>
<li class="chapter" data-level="6.4.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-de-poisson"><i class="fa fa-check"></i><b>6.4.2</b> Distribution de Poisson</a></li>
<li class="chapter" data-level="6.4.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-uniforme"><i class="fa fa-check"></i><b>6.4.3</b> Distribution uniforme</a></li>
<li class="chapter" data-level="6.4.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-normale"><i class="fa fa-check"></i><b>6.4.4</b> Distribution normale</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#statistiques-descriptives"><i class="fa fa-check"></i><b>6.5</b> Statistiques descriptives</a></li>
<li class="chapter" data-level="6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-dhypoth√®ses-√†-un-et-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6</b> Tests d‚Äôhypoth√®ses √† un et deux √©chantillons</a><ul>
<li class="chapter" data-level="6.6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-t-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.1</b> Test de t √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#attention-mauvaises-interpr√©tations-des-p-values"><i class="fa fa-check"></i><b>6.6.2</b> Attention: mauvaises interpr√©tations des <em>p-values</em></a></li>
<li class="chapter" data-level="6.6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-wilcoxon-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.3</b> Test de Wilcoxon √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-t-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.4</b> Tests de t √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#comparaison-des-variances"><i class="fa fa-check"></i><b>6.6.5</b> Comparaison des variances</a></li>
<li class="chapter" data-level="6.6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-wilcoxon-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.6</b> Tests de Wilcoxon √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-tests-pair√©s"><i class="fa fa-check"></i><b>6.6.7</b> Les tests pair√©s</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#lanalyse-de-variance"><i class="fa fa-check"></i><b>6.7</b> L‚Äôanalyse de variance</a></li>
<li class="chapter" data-level="6.8" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-mod√®les-statistiques"><i class="fa fa-check"></i><b>6.8</b> Les mod√®les statistiques</a><ul>
<li class="chapter" data-level="6.8.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-fixes"><i class="fa fa-check"></i><b>6.8.1</b> Mod√®les √† effets fixes</a></li>
<li class="chapter" data-level="6.8.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-mixtes"><i class="fa fa-check"></i><b>6.8.2</b> Mod√®les √† effets mixtes</a></li>
<li class="chapter" data-level="6.8.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#aller-plus-loin"><i class="fa fa-check"></i><b>6.8.3</b> Aller plus loin</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html"><i class="fa fa-check"></i><b>7</b> Introduction √† l‚Äôanalyse bay√©sienne en √©cologie</a><ul>
<li class="chapter" data-level="7.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#quest-ce-que-cest"><i class="fa fa-check"></i><b>7.1</b> Qu‚Äôest-ce que c‚Äôest?</a></li>
<li class="chapter" data-level="7.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pourquoi-lutiliser"><i class="fa fa-check"></i><b>7.2</b> Pourquoi l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.3" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#comment-lutiliser"><i class="fa fa-check"></i><b>7.3</b> Comment l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.4" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#faucons-p√©lerins"><i class="fa fa-check"></i><b>7.4</b> Faucons p√©lerins</a></li>
<li class="chapter" data-level="7.5" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#statistiques-dune-population"><i class="fa fa-check"></i><b>7.5</b> Statistiques d‚Äôune population</a><ul>
<li class="chapter" data-level="7.5.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#calcul-analytique"><i class="fa fa-check"></i><b>7.5.1</b> Calcul analytique</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#greta"><i class="fa fa-check"></i><b>7.5.2</b> greta</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#test-de-t-diff√©rence-entre-des-groupes"><i class="fa fa-check"></i><b>7.6</b> Test de t: Diff√©rence entre des groupes</a></li>
<li class="chapter" data-level="7.7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#mod√©lisation-multiniveau"><i class="fa fa-check"></i><b>7.7</b> Mod√©lisation multiniveau</a></li>
<li class="chapter" data-level="7.8" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>7.8</b> Pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html"><i class="fa fa-check"></i><b>8</b> Explorer R</a><ul>
<li class="chapter" data-level="8.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-sur-le-web"><i class="fa fa-check"></i><b>8.1</b> R sur le web</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#github"><i class="fa fa-check"></i><b>8.1.1</b> GitHub</a></li>
<li class="chapter" data-level="8.1.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#twitter"><i class="fa fa-check"></i><b>8.1.2</b> Twitter</a></li>
<li class="chapter" data-level="8.1.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#nouvelles"><i class="fa fa-check"></i><b>8.1.3</b> Nouvelles</a></li>
<li class="chapter" data-level="8.1.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#des-questions"><i class="fa fa-check"></i><b>8.1.4</b> Des questions?</a></li>
<li class="chapter" data-level="8.1.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#participer"><i class="fa fa-check"></i><b>8.1.5</b> Participer</a></li>
<li class="chapter" data-level="8.1.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#mise-en-garde"><i class="fa fa-check"></i><b>8.1.6</b> Mise en garde</a></li>
<li class="chapter" data-level="8.1.7" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#prendre-tout-√ßa-en-note"><i class="fa fa-check"></i><b>8.1.7</b> Prendre tout √ßa en note</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-en-chaire-et-en-os"><i class="fa fa-check"></i><b>8.2</b> R en chaire et en os</a></li>
<li class="chapter" data-level="8.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#quelques-outils-en-√©cologie-math√©matique-avec-r"><i class="fa fa-check"></i><b>8.3</b> Quelques outils en √©cologie math√©matique avec R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#pr√©traitement-des-donn√©es"><i class="fa fa-check"></i><b>8.3.1</b> Pr√©traitement des donn√©es</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#acqu√©rir-des-donn√©es-m√©t√©o"><i class="fa fa-check"></i><b>8.3.2</b> Acqu√©rir des donn√©es m√©t√©o</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#p√©dom√©trie-avec-r"><i class="fa fa-check"></i><b>8.3.3</b> P√©dom√©trie avec R</a></li>
<li class="chapter" data-level="8.3.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#m√©ta-analyses-en-r"><i class="fa fa-check"></i><b>8.3.4</b> M√©ta-analyses en R</a></li>
<li class="chapter" data-level="8.3.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#cr√©er-des-applications-avec-r"><i class="fa fa-check"></i><b>8.3.5</b> Cr√©er des applications avec R</a></li>
<li class="chapter" data-level="8.3.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#travailler-en-python"><i class="fa fa-check"></i><b>8.3.6</b> Travailler en Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html"><i class="fa fa-check"></i><b>9</b> Association, partitionnement et ordination</a><ul>
<li class="chapter" data-level="9.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#espaces-danalyse"><i class="fa fa-check"></i><b>9.1</b> Espaces d‚Äôanalyse</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#abondance-et-occurence"><i class="fa fa-check"></i><b>9.1.1</b> Abondance et occurence</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#environnement"><i class="fa fa-check"></i><b>9.1.2</b> Environnement</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#analyse-dassociation"><i class="fa fa-check"></i><b>9.2</b> Analyse d‚Äôassociation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#association-entre-objets-mode-q"><i class="fa fa-check"></i><b>9.2.1</b> Association entre objets (mode Q)</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#associations-entre-variables-mode-r"><i class="fa fa-check"></i><b>9.2.2</b> Associations entre variables (mode R)</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-les-associations"><i class="fa fa-check"></i><b>9.2.3</b> Conclusion sur les associations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement"><i class="fa fa-check"></i><b>9.3</b> Partitionnement</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#√©valuation-dun-partitionnement"><i class="fa fa-check"></i><b>9.3.1</b> √âvaluation d‚Äôun partitionnement</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-non-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.2</b> Partitionnement non hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.3</b> Partitionnement hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique-bas√©e-sur-la-densit√©-des-points"><i class="fa fa-check"></i><b>9.3.4</b> Partitionnement hi√©rarchique bas√©e sur la densit√© des points</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-le-partitionnement"><i class="fa fa-check"></i><b>9.3.5</b> Conclusion sur le partitionnement</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination"><i class="fa fa-check"></i><b>9.4</b> Ordination</a><ul>
<li class="chapter" data-level="9.4.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-non-contraignante"><i class="fa fa-check"></i><b>9.4.1</b> Ordination non contraignante</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-contraignante"><i class="fa fa-check"></i><b>9.4.2</b> Ordination contraignante</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html"><i class="fa fa-check"></i><b>10</b> D√©tection de valeurs aberrantes et imputation de donn√©es manquantes</a><ul>
<li class="chapter" data-level="10.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#donn√©es-manquantes-d√©finition-origine-typologie-et-traitement"><i class="fa fa-check"></i><b>10.1</b> Donn√©es manquantes: d√©finition, origine, typologie et traitement</a><ul>
<li class="chapter" data-level="10.1.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finition"><i class="fa fa-check"></i><b>10.1.1</b> D√©finition</a></li>
<li class="chapter" data-level="10.1.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.2</b> Origines des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#profils-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.3</b> Profils des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#traitement-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.4</b> Traitement des donn√©es manquantes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#valeurs-et-√©chantillons-aberrants-d√©finition-origines-m√©thodes-de-d√©tection-et-traitement"><i class="fa fa-check"></i><b>10.2</b> Valeurs et √©chantillons aberrants: d√©finition, origines, m√©thodes de d√©tection et traitement</a><ul>
<li class="chapter" data-level="10.2.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finitions-1"><i class="fa fa-check"></i><b>10.2.1</b> D√©finitions</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines"><i class="fa fa-check"></i><b>10.2.2</b> Origines</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-valeurs-aberrantes-univari√©s"><i class="fa fa-check"></i><b>10.2.3</b> D√©tection et traitement des valeurs aberrantes univari√©s</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-√©chantillons-aberrants-multivari√©s"><i class="fa fa-check"></i><b>10.2.4</b> D√©tection et traitement des √©chantillons aberrants multivari√©s</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapitre-ml.html"><a href="chapitre-ml.html"><i class="fa fa-check"></i><b>11</b> Introduction √† l‚Äôautoapprentissage</a><ul>
<li class="chapter" data-level="11.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lexique"><i class="fa fa-check"></i><b>11.1</b> Lexique</a></li>
<li class="chapter" data-level="11.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©marche"><i class="fa fa-check"></i><b>11.2</b> D√©marche</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#pr√©traitement"><i class="fa fa-check"></i><b>11.2.1</b> Pr√©traitement</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#entra√Ænement-et-test"><i class="fa fa-check"></i><b>11.2.2</b> Entra√Ænement et test</a></li>
<li class="chapter" data-level="11.2.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#sousapprentissage-et-surapprentissage"><i class="fa fa-check"></i><b>11.2.3</b> Sousapprentissage et surapprentissage</a></li>
<li class="chapter" data-level="11.2.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#validation-crois√©e"><i class="fa fa-check"></i><b>11.2.4</b> Validation crois√©e</a></li>
<li class="chapter" data-level="11.2.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#choix-de-lalgorithme-dapprentissage"><i class="fa fa-check"></i><b>11.2.5</b> Choix de l‚Äôalgorithme d‚Äôapprentissage</a></li>
<li class="chapter" data-level="11.2.6" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©ploiement"><i class="fa fa-check"></i><b>11.2.6</b> D√©ploiement</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lautoapprentissage-en-r"><i class="fa fa-check"></i><b>11.3</b> L‚Äôautoapprentissage en R</a></li>
<li class="chapter" data-level="11.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#algorithmes"><i class="fa fa-check"></i><b>11.4</b> Algorithmes</a><ul>
<li class="chapter" data-level="11.4.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-k-plus-proches-voisins"><i class="fa fa-check"></i><b>11.4.1</b> Les <em>k</em> plus proches voisins</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-arbres-d√©cisionnels"><i class="fa fa-check"></i><b>11.4.2</b> Les arbres d√©cisionnels</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-r√©seaux-neuronaux"><i class="fa fa-check"></i><b>11.4.3</b> Les r√©seaux neuronaux</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens"><i class="fa fa-check"></i><b>11.4.4</b> Les processus gaussiens</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens-en-r"><i class="fa fa-check"></i><b>11.4.5</b> Les processus gaussiens en <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapitre-temps.html"><a href="chapitre-temps.html"><i class="fa fa-check"></i><b>12</b> Les s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#op√©rations-sur-les-donn√©es-temporelles"><i class="fa fa-check"></i><b>12.1</b> Op√©rations sur les donn√©es temporelles</a></li>
<li class="chapter" data-level="12.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#analyse-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2</b> Analyse de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.2.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#cr√©er-et-visualiser-des-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.1</b> Cr√©er et visualiser des s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#structures-dans-les-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.2</b> Structures dans les s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#lautocorr√©lation"><i class="fa fa-check"></i><b>12.2.3</b> L‚Äôautocorr√©lation</a></li>
<li class="chapter" data-level="12.2.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#signification-statistique-dune-s√©rie-temporelle"><i class="fa fa-check"></i><b>12.2.4</b> Signification statistique d‚Äôune s√©rie temporelle</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#mod√©lisation-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.3</b> Mod√©lisation de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.3.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-na√Øve"><i class="fa fa-check"></i><b>12.3.1</b> M√©thode na√Øve</a></li>
<li class="chapter" data-level="12.3.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-ses"><i class="fa fa-check"></i><b>12.3.2</b> M√©thode SES</a></li>
<li class="chapter" data-level="12.3.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#la-m√©thode-arima"><i class="fa fa-check"></i><b>12.3.3</b> La m√©thode ARIMA</a></li>
<li class="chapter" data-level="12.3.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-dynamiques"><i class="fa fa-check"></i><b>12.3.4</b> Les mod√®les dynamiques</a></li>
<li class="chapter" data-level="12.3.5" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-tbats"><i class="fa fa-check"></i><b>12.3.5</b> Les mod√®les TBATS</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#pour-terminer"><i class="fa fa-check"></i><b>12.4</b> Pour terminer‚Ä¶</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapitre-geo.html"><a href="chapitre-geo.html"><i class="fa fa-check"></i><b>13</b> Les donn√©es g√©ospatiales</a><ul>
<li class="chapter" data-level="13.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.1</b> Les donn√©es spatiales</a></li>
<li class="chapter" data-level="13.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#cartographier-avec-le-module-ggmap"><i class="fa fa-check"></i><b>13.2</b> Cartographier avec le module <strong><code>ggmap</code></strong></a></li>
<li class="chapter" data-level="13.3" data-path="chapitre-geo.html"><a href="chapitre-geo.html#types-g√©n√©riques-de-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.3</b> Types g√©n√©riques de donn√©es spatiales</a></li>
<li class="chapter" data-level="13.4" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-choropl√®the"><i class="fa fa-check"></i><b>13.4</b> Les choropl√®the</a></li>
<li class="chapter" data-level="13.5" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-rasters"><i class="fa fa-check"></i><b>13.5</b> Les rasters</a></li>
<li class="chapter" data-level="13.6" data-path="chapitre-geo.html"><a href="chapitre-geo.html#autoapprentissage-spatial"><i class="fa fa-check"></i><b>13.6</b> Autoapprentissage spatial</a></li>
<li class="chapter" data-level="13.7" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-objets-spatialis√©s-en-r"><i class="fa fa-check"></i><b>13.7</b> Les objets spatialis√©s en R</a><ul>
<li class="chapter" data-level="13.7.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-vectorielles-points-lignes-et-polygones"><i class="fa fa-check"></i><b>13.7.1</b> Donn√©es vectorielles (points, lignes et polygones)</a></li>
<li class="chapter" data-level="13.7.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-raster"><i class="fa fa-check"></i><b>13.7.2</b> Donn√©es raster</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="chapitre-geo.html"><a href="chapitre-geo.html#section-systeme-coord"><i class="fa fa-check"></i><b>13.8</b> Les syst√®mes de coordonn√©es</a></li>
<li class="chapter" data-level="13.9" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-tableaux-sf"><i class="fa fa-check"></i><b>13.9</b> Manipuler des tableaux <code>sf</code></a></li>
<li class="chapter" data-level="13.10" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-objets-raster"><i class="fa fa-check"></i><b>13.10</b> Manipuler des objets raster</a></li>
<li class="chapter" data-level="13.11" data-path="chapitre-geo.html"><a href="chapitre-geo.html#graphiques-dobjets-spatialis√©s"><i class="fa fa-check"></i><b>13.11</b> Graphiques d‚Äôobjets spatialis√©s</a></li>
<li class="chapter" data-level="13.12" data-path="chapitre-geo.html"><a href="chapitre-geo.html#ressources-compl√©mentaires"><i class="fa fa-check"></i><b>13.12</b> Ressources compl√©mentaires</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chapitre-ode.html"><a href="chapitre-ode.html"><i class="fa fa-check"></i><b>14</b> Mod√©lisation de m√©canismes √©cologiques</a><ul>
<li class="chapter" data-level="14.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©quations-diff√©rentielles"><i class="fa fa-check"></i><b>14.1</b> √âquations diff√©rentielles</a></li>
<li class="chapter" data-level="14.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#les-√©quations-diff√©rentielles-ordinaires-en-mod√©lisation-√©cologique"><i class="fa fa-check"></i><b>14.2</b> Les √©quations diff√©rentielles ordinaires en mod√©lisation √©cologique</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©volution-dune-seule-population-en-fonction-du-temps"><i class="fa fa-check"></i><b>14.2.1</b> √âvolution d‚Äôune seule population en fonction du temps</a></li>
<li class="chapter" data-level="14.2.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#population-exploit√©e"><i class="fa fa-check"></i><b>14.2.2</b> Population exploit√©e</a></li>
<li class="chapter" data-level="14.2.3" data-path="chapitre-ode.html"><a href="chapitre-ode.html#interactions-biologiques"><i class="fa fa-check"></i><b>14.2.3</b> Interactions biologiques</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre-ordination" class="section level1">
<h1><span class="header-section-number">9</span> Association, partitionnement et ordination</h1>
<hr />
<p>Ô∏è¬†<strong>Objectifs sp√©cifiques</strong>:</p>
<p>√Ä la fin de ce chapitre, vous</p>
<ul>
<li>serez en mesure d‚Äôeffectuer des calculs permettant de mesurer des diff√©rence entre des observations, des groupes d‚Äôobservation ou des variables observ√©es</li>
<li>serez en mesure d‚Äôeffection des analyses de partitionnement hi√©rarchiques et non-hi√©rarchiques</li>
<li>serez en mesure d‚Äôeffectuer des calculs d‚Äôordination √† l‚Äôaide des techniques de r√©duction d‚Äôaxe communes: analyse en composante principale, l‚Äôanalyse de correspondance, l‚Äôanalyse en coordonn√©es principales, analyse discriminante lin√©aire, l‚Äôanalyse de redondance et l‚Äôanalyse canonique des correspondances.</li>
</ul>
<hr />
<p>Les donn√©es √©cologiques incluent g√©n√©ralement plusieurs variables qui doivent √™tre analys√©es conjointement. Les techniques pour l‚Äôanalyse multivari√©e de donn√©es √©cologiques ont grandi en nombre et en complexit√©, laissant √©merger l‚Äô√©cologie num√©rique, un nouveau domaine d‚Äô√©tude scientifique initi√© par Pierre Legendre et Louis Legendre dont l‚Äôouvrage <em>Numerical Ecology</em>, aujourd‚Äôhui √† sa troisi√®me √©dition, reste un incontournable pour qui s‚Äôint√©resse aux math√©matiques sous-jacentes au domaine. Pour la r√©daction de ces notes, c‚Äôest toutefois le livre <em>Numerical ecology with R</em>, √©crit par Borcard et al.¬†(2011) pour offrir un guide √† qui voudrait une approche plus appliqu√©e.</p>
<p>L‚Äô√©cologie num√©rique sera effleur√©e dans ce chapitre, qui introduit √† trois concepts.</p>
<ol style="list-style-type: decimal">
<li>Les <strong>associations</strong> permettent de quantifier la ressemblance ou la diff√©rence entre deux observation (√©chantillons) ou variables (descripteurs). Lorsque l‚Äôon a plus de deux variables ou plus de deux site, nous obtenons des matrices d‚Äôassociation.</li>
<li>Le <strong>partitionnement</strong> permet de regrouper des observations ou des variables selon des m√©triques d‚Äôassociation.</li>
<li>L‚Äô<strong>ordination</strong> vise par l‚Äôinterm√©diaire de techniques de r√©duction d‚Äôaxe √† mettre de l‚Äôordre dans des donn√©es dont le nombre √©lev√© de variables peut amener √† des difficult√©s d‚Äôappr√©ciation et d‚Äôinterpr√©taion.</li>
</ol>
<div class="sourceCode" id="cb603"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb603-1" title="1"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</a></code></pre></div>
<div id="espaces-danalyse" class="section level2">
<h2><span class="header-section-number">9.1</span> Espaces d‚Äôanalyse</h2>
<div id="abondance-et-occurence" class="section level3">
<h3><span class="header-section-number">9.1.1</span> Abondance et occurence</h3>
<p>L‚Äôabondance est le d√©compte d‚Äôesp√®ces observ√©es, tandis que l‚Äôoccurence est la pr√©sence ou l‚Äôabsence d‚Äôune esp√®ce. Le tableau suivant contient des donn√©es d‚Äôabondance.</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb604-1" title="1">abundance &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="st">&#39;Bruant familier&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb604-2" title="2">                    <span class="st">&#39;Citelle √† poitrine rousse&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-3" title="3">                    <span class="st">&#39;Colibri √† gorge rubis&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-4" title="4">                    <span class="st">&#39;Geai bleu&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-5" title="5">                    <span class="st">&#39;Bruant chanteur&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb604-6" title="6">                    <span class="st">&#39;Chardonneret&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">9</span>, <span class="dv">6</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-7" title="7">                    <span class="st">&#39;Bruant √† gorge blanche&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-8" title="8">                    <span class="st">&#39;M√©sange √† t√™te noire&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">20</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb604-9" title="9">                    <span class="st">&#39;Jaseur bor√©al&#39;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">66</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</a></code></pre></div>
<p>Ce tableau peut √™tre rapidement transform√© en donn√©es d‚Äôoccurence, qui ne comprennent que l‚Äôinformation bool√©enne de pr√©sence (not√© 1) et d‚Äôabsence (not√© 0).</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb605-1" title="1">occurence &lt;-<span class="st"> </span>abundance <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb605-2" title="2"><span class="st">  </span><span class="kw">transmute_all</span>(<span class="op">~</span><span class="kw">if_else</span>(. <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>))</a></code></pre></div>
<p>L‚Äô<strong>espace des esp√®ces</strong> (ou des variables ou descripteurs) est celui o√π les esp√®ces forment les axes et o√π les sites sont positionn√©s dans cet espace. Il s‚Äôagit d‚Äôune perspective en <em>mode R</em>, qui permet principalement d‚Äôidentifier quels esp√®ces se retrouvent plus courrament ensemble.</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb606-1" title="1">abundance <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb606-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="st">`</span><span class="dt">Bruant chanteur</span><span class="st">`</span>, Chardonneret, <span class="st">`</span><span class="dt">M√©sange √† t√™te noire</span><span class="st">`</span>)</a></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   `Bruant chanteur` Chardonneret `M√©sange √† t√™te noire`
##               &lt;dbl&gt;        &lt;dbl&gt;                  &lt;dbl&gt;
## 1                 1            0                     20
## 2                 0            9                      1
## 3                 5            6                      1
## 4                 2            0                      0</code></pre>
<p>Dans l‚Äô<strong>espace des sites</strong> (ou les √©chantillons ou objets), on transpose la matrice d‚Äôabondance. On passe ici en <em>mode Q</em>, o√π chaque point est une esp√®ce, et o√π l‚Äôon peut observer quels √©chantillons sont similaires.</p>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb608-1" title="1">abundance <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">t</span>()</a></code></pre></div>
<pre><code>##                           [,1] [,2] [,3] [,4]
## Bruant familier              1    0    0    3
## Citelle √† poitrine rousse    1    0    0    0
## Colibri √† gorge rubis        0    1    0    0
## Geai bleu                    3    2    0    0
## Bruant chanteur              1    0    5    2
## Chardonneret                 0    9    6    0
## Bruant √† gorge blanche       1    0    0    0
## M√©sange √† t√™te noire        20    1    1    0
## Jaseur bor√©al               66    0    0    0</code></pre>
</div>
<div id="environnement" class="section level3">
<h3><span class="header-section-number">9.1.2</span> Environnement</h3>
<p>L‚Äô<strong>espace de l‚Äôenvironnement</strong> comprend souvent un autre tableau contenant l‚Äôinformation sur l‚Äôenvironnement o√π se trouve les esp√®ces: les coordonn√©es et l‚Äô√©l√©vation, la pente, le pH du sol, la pluviom√©trie, etc.</p>
</div>
</div>
<div id="analyse-dassociation" class="section level2">
<h2><span class="header-section-number">9.2</span> Analyse d‚Äôassociation</h2>
<p>Nous utiliserons le terme <em>association</em> comme une <strong>mesure pour quantifier la ressemblance ou la diff√©rence entre deux objets (√©chantillons) ou variables (descripteurs)</strong>.</p>
<p>Alors que la corr√©lation et la covariance sont des mesures d‚Äôassociation entre des variables (analyse en <em>mode R</em>), la <strong>similarit√©</strong> et la <strong>distance</strong> sont deux types de une mesure d‚Äôassociation entre des objets (analyse en <em>mode Q</em>). Une distance de 0 est mesur√©e chez deux objets identiques. La distance augmente au fur et √† mesure que les objets sont dissoci√©s. Une similarit√© ayant une valeur de 0 indique aucune association, tandis qu‚Äôune valeur de 1 indique une association parfaite. √Ä l‚Äôoppos√©, la dissimilarit√© est √©gale √† 1-similarit√©.</p>
<p>La distance peut √™tre li√©e √† la similarit√© par la relation:</p>
<p><span class="math display">\[distance=\sqrt{1-similarit√©}\]</span></p>
<p>ou</p>
<p><span class="math display">\[distance=\sqrt{dissimilarit√©}\]</span></p>
<p>La racine carr√©e permet, pour certains indices de similarit√©, d‚Äôobtenir des propri√©t√©s eucl√©diennes. Pour plus de d√©tails, voyez le tableau 7.2 de <a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre (2012)</a>.</p>
<p>Les matrices d‚Äôassociation sont g√©n√©ralement pr√©sent√©es comme des matrices carr√©es, dont les dimensions sont √©gales au nombre d‚Äôobjets (<em>mode Q</em>) ou de vrariables (<em>mode R</em>) dans le tableau. Chaque √©l√©ment (‚Äúcellule‚Äù) de la matrice est un indice d‚Äôassociation entre un objet (ou une variable) et un autre. Ainsi, la diagonale de la matrice est un vecteur nul (distance ou dissimilarit√©) ou unitaire (similarit√©), car elle correspond √† l‚Äôassociation entre un objet et lui-m√™me.</p>
<p>Puisque l‚Äôassociation entre A et B est la m√™me qu‚Äôentre B et A, et puisque la diagonale retourne une valeur convenue, il est possible d‚Äôexprimer une matrice d‚Äôassociation en mode ‚Äúcompact‚Äù, sous forme de vecteur. Le vecteur d‚Äôassociation entre des objets A, B et C contiendra toute l‚Äôinformation n√©cessaire en un vecteur de trois chiffres, <code>[AB, AC, BC]</code>, plut√¥t qu‚Äôune matrice de dimension <span class="math inline">\(3 \times 3\)</span>. L‚Äôimpact sur la m√©moire vive peut √™tre consid√©rable pour les calculs comprenant de nombreuses dimensions.</p>
<p>En R, les calculs de similarit√© et de distances peuvent √™tre effectu√©s avec le module vegan. La fonction <code>vegdist</code> permet de calculer les indices d‚Äôassociation en forme carr√©e.</p>
<p>Nous verons plus tard les m√©thodes de mesure de similarit√© et de distance plus loin. Pour l‚Äôinstant, utilisons la m√©thode de <em>Jaccard</em> pour une d√©monstration sur des donn√©es d‚Äôoccurence.</p>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb610-1" title="1"><span class="kw">library</span>(<span class="st">&quot;vegan&quot;</span>)</a>
<a class="sourceLine" id="cb610-2" title="2"><span class="kw">vegdist</span>(occurence, <span class="dt">method =</span> <span class="st">&quot;jaccard&quot;</span>,</a>
<a class="sourceLine" id="cb610-3" title="3">        <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>##           1         2         3         4
## 1 0.0000000 0.7777778 0.7500000 0.7142857
## 2 0.7777778 0.0000000 0.6000000 1.0000000
## 3 0.7500000 0.6000000 0.0000000 0.7500000
## 4 0.7142857 1.0000000 0.7500000 0.0000000</code></pre>
<p>Remarquez que <code>vegdist</code> retourne une matrice dont la diagonale est de 0 (on l‚Äôaffiche en sp√©cifiant <code>diag = TRUE</code>). La diagonale est l‚Äôassociation d‚Äôun objet avec lui-m√™me. Or la similarit√© d‚Äôun objet avec lui-m√™me devrait √™tre de 1! En fait, par convention <code>vegdist</code> retourne des dissimilarit√©s, non pas des similarit√©s. La matrice de distance serait donc calcul√©e en extrayant la racine carr√©e des √©l√©ments de la matrice de dissimilarit√©:</p>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb612-1" title="1">dissimilarity &lt;-<span class="st"> </span><span class="kw">vegdist</span>(occurence, <span class="dt">method =</span> <span class="st">&quot;jaccard&quot;</span>,</a>
<a class="sourceLine" id="cb612-2" title="2">                         <span class="dt">diag =</span> <span class="ot">TRUE</span>, <span class="dt">upper =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb612-3" title="3">distance &lt;-<span class="st"> </span><span class="kw">sqrt</span>(dissimilarity)</a>
<a class="sourceLine" id="cb612-4" title="4">distance</a></code></pre></div>
<pre><code>##           1         2         3         4
## 1 0.0000000 0.8819171 0.8660254 0.8451543
## 2 0.8819171 0.0000000 0.7745967 1.0000000
## 3 0.8660254 0.7745967 0.0000000 0.8660254
## 4 0.8451543 1.0000000 0.8660254 0.0000000</code></pre>
<p>Dans le chapitre sur l‚Äôanalyse compositionnelle, nous avons abord√© les significations diff√©rentes que peuvent prendre le z√©ro. L‚Äôinformation fournie par un z√©ro peut √™tre diff√©rente selon les circonstances. Dans le cas d‚Äôune variable continue, un z√©ro signifie g√©n√©ralement une mesure sous le seuil de d√©tection. Deux tissus dont la concentration en cuivre est nulle ont une afinit√© sous la perspective de la concentration en cuivre. Dans le cas de mesures d‚Äôabondance (d√©compte) ou d‚Äôoccurence (pr√©sence-absence), on pourra d√©crire comme similaires deux niches √©cologiques o√π l‚Äôon retrouve une esp√®ce en particulier. Mais deux sites o√π l‚Äôon de retouve pas d‚Äôours polaires ne correspondent pas n√©cessairement √† des niches similaires! En effet, il peut exister de nombreuses raisons √©cologiques et m√©thodologiques pour lesquelles l‚Äôesp√®ces ou les esp√®ces n‚Äôont pas √©t√© observ√©es. C‚Äôest le probl√®me des <strong>double-z√©ros</strong> (esp√®ces non observ√©es √† deux sites), probl√®me qui est amplifi√© avec les grilles comprenant des esp√®ces rares.</p>
<p>La ressemblance entre des objets comprenant des donn√©es continues devrait √™tre calcul√©e gr√¢ce √† des indicateurs <em>sym√©triques</em>. Inversement, les affinit√©s entre les objets d√©crits par des donn√©es d‚Äôabondance ou d‚Äôoccurence susceptibles de g√©n√©rer des probl√®mes de double-z√©ros devraient √™tre √©valu√©es gr√¢ce √† des indicateurs <em>asym√©triques</em>. Un d√©fi suppl√©mentaire arrive lorsque les donn√©es sont de type mixte.</p>
<p>Nous utiliserons la convention de <code>vegan</code> et nous calculerons la dissimilarit√©, non pas la similarit√©. Les mesures de dissimilarit√© sont calcul√©es sur des donn√©es d‚Äôabondance ou des donn√©es d‚Äôoccurence. Notons qu‚Äôil existe beaucoup de confusion dans la litt√©rature sur la mani√®re de nommer les dissimilarit√©s (ce qui n‚Äôest pas le cas des distances, dont les noms sont reconnus). Dans les sections suivantes, nous noterons la dissimilarit√© avec un <span class="math inline">\(d\)</span> minuscule et la distance avec un <span class="math inline">\(D\)</span> majuscule.</p>
<div id="association-entre-objets-mode-q" class="section level3">
<h3><span class="header-section-number">9.2.1</span> Association entre objets (mode Q)</h3>
<div id="objets-abondance" class="section level4">
<h4><span class="header-section-number">9.2.1.1</span> Objets: Abondance</h4>
<p>La <strong>dissimilarit√© de Bray-Curtis</strong> est asym√©trique. Elle est aussi appel√©e l‚Äôindice de Steinhaus, de Czekanowski ou de S√∏rensen. Il est important de s‚Äôassurer de bien s‚Äôentendre la m√©thode √† laquelle on fait r√©f√©rence. L‚Äô√©quation enl√®ve toute ambiguit√©. La dissimilarit√© de Bray-Curtis entre les points A et B est calcul√©e comme suit.</p>
<p><span class="math display">\[d_{AB} =  \frac {\sum \left| A_{i} - B_{i} \right| }{\sum \left(A_{i}+B_{i}\right)}\]</span></p>
<p>Utilisons <code>vegdist</code> pour g√©n√©rer les matrices d‚Äôassociation. Le format ‚Äúliste‚Äù de R est pratique pour enregistrer la collection d‚Äôobjets, dont les matrice d‚Äôassociation que nous allons cr√©er dans cette section.</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb614-1" title="1">associations_abund &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb614-2" title="2">associations_abund[[<span class="st">&#39;BrayCurtis&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">vegdist</span>(abundance, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</a>
<a class="sourceLine" id="cb614-3" title="3">associations_abund[[<span class="st">&#39;BrayCurtis&#39;</span>]]</a></code></pre></div>
<pre><code>##           1         2         3
## 2 0.9433962                    
## 3 0.9619048 0.4400000          
## 4 0.9591837 1.0000000 0.7647059</code></pre>
<p>La dissimilarit√© de Bray-Curtis est souvent utilis√©e dans la litt√©rature. Toutefois, la version originale de Bray-Curtis n‚Äôest pas tout √† fait m√©trique (semim√©trique). Cons√©quemment, la <strong>dissimilarit√© de Ruzicka</strong> (une variante de la dissimilarit√© de Jaccard pour les donn√©es d‚Äôabondance) est m√©trique, et devrait probablement √™tre pr√©f√©r√© √† Bary-Curtis (<a href="http://ocw.um.es/ciencias/geobotanica/otros-recursos-1/documentos/vegantutorial.pdf">Oksanen, 2006</a>).</p>
<p><span class="math display">\[d_{AB, Ruzicka} =  \frac { 2 \times d_{AB, Bray-Curtis} }{1 + d_{AB, Bray-Curtis}}\]</span></p>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb616-1" title="1">associations_abund[[<span class="st">&#39;Ruzicka&#39;</span>]] &lt;-<span class="st"> </span>associations_abund[[<span class="st">&#39;BrayCurtis&#39;</span>]] <span class="op">*</span><span class="st"> </span><span class="dv">2</span> <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>associations_abund[[<span class="st">&#39;BrayCurtis&#39;</span>]])</a></code></pre></div>
<p>La <strong>dissimilarit√© de Kulczynski</strong> (aussi √©crit Kulsinski) est asym√©trique et semim√©trique, tout comme celle de Bray-Curtis. Elle est calcul√©e comme suit.</p>
<p><span class="math display">\[d_{AB} = 1-\frac{1}{2} \times \left[ \frac{\sum min(A_i, B_i)}{\sum A_i} + \frac{\sum min(A_i, B_i)}{\sum B_i} \right]\]</span></p>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb617-1" title="1">associations_abund[[<span class="st">&#39;Kulczynski&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">vegdist</span>(abundance, <span class="dt">method =</span> <span class="st">&quot;kulczynski&quot;</span>)</a></code></pre></div>
<p>Une approche commune pour mesurer l‚Äôassociation entre sites d√©crits par des donn√©es d‚Äôabondance est la <strong>distance de Hellinger</strong>. Notez qu‚Äôil s‚Äôagit ici d‚Äôune distance, non pas d‚Äôune dissimilarit√©. Pour l‚Äôobtenir, on doit d‚Äôabord diviser chaque donn√©e d‚Äôabondance par l‚Äôabondance totale pour chaque site pour obtenir les esp√®ces en tant que proportions, puis on extrait la racine carr√©e de chaque √©l√©ment. Enfin, on calcule la distance euclidienne entre les proportions de chaque site. Pour rappel, une distance euclidienne est la g√©n√©ralisation en plusieurs dimensions du th√©or√®me de Pythagore, <span class="math inline">\(c = \sqrt{a^2 + b^2}\)</span>.</p>
<p><span class="math display">\[D_{AB} = \sqrt {\sum \left( \frac{A_i}{\sum A_i} - \frac{B_i}{\sum B_i} \right)^2}\]</span></p>
<table style="width:93%;">
<colgroup>
<col width="26%" />
<col width="66%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left">üò±¬†<strong>Attention</strong></td>
<td>La distance d‚ÄôHellinger h√©rite des biais li√©es aux donn√©es compositionnelles. Elle peut √™tre substiti√©e par une matrice de distances d‚ÄôAitchison.</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb618-1" title="1">associations_abund[[<span class="st">&#39;Hellinger&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(abundance, <span class="dt">method=</span><span class="st">&quot;hellinger&quot;</span>))</a></code></pre></div>
<p>Toute comme la distance d‚ÄôHellinger, la <strong>distance de chord</strong> est calcul√©e par une distance euclidienne sur des donn√©es d‚Äôabondance transform√©es de sorte que chaque ligne ait une longueur (norme) de 1.</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb619-1" title="1">associations_abund[[<span class="st">&#39;Chord&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(abundance, <span class="dt">method=</span><span class="st">&quot;normalize&quot;</span>))</a></code></pre></div>
<p>La <strong>m√©trique du chi-carr√©</strong>, ou <span class="math inline">\(\chi\)</span>-carr√©, ou chi-square, donne davantage de poids aux esp√®ces rares qu‚Äôaux esp√®ces communes. Son utilisation est recommand√©e lorsque les esp√®ces rares sont de bons indicateurs de conditions √©cologiques particuli√®res (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>, p.¬†308).</p>
<p><span class="math display">\[  d_{AB} = \sqrt{\sum _j \frac{1}{\sum y_j} \left( \frac{A_j}{\sum A} - \frac{B_j}{\sum B} \right)^2 }  \]</span></p>
<p>La m√©trique peut √™tre transform√©e en distance en la multipliant par la racine carr√©e de la somme totale des esp√®ces dans la matric d‚Äôabondance (<span class="math inline">\(X\)</span>).</p>
<p><span class="math display">\[ D_{AB} = \sqrt{\sum X} \times d_{AB} \]</span></p>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb620-1" title="1">associations_abund[[<span class="st">&#39;ChiSquare&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(abundance, <span class="dt">method=</span><span class="st">&quot;chi.square&quot;</span>))</a></code></pre></div>
<p>Une manni√®re visuellement plus int√©ressante de pr√©senter une matrice d‚Äôassociation est un graphique de type <em>heatmap</em>.</p>
<div class="sourceCode" id="cb621"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb621-1" title="1">associations_abund_df &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb621-2" title="2"></a>
<a class="sourceLine" id="cb621-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(associations_abund)) {</a>
<a class="sourceLine" id="cb621-4" title="4">  associations_abund_df[[i]] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.matrix</span>(associations_abund[[i]]))</a>
<a class="sourceLine" id="cb621-5" title="5">  <span class="kw">colnames</span>(associations_abund_df[[i]]) &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_abund_df[[i]])</a>
<a class="sourceLine" id="cb621-6" title="6">  associations_abund_df[[i]]<span class="op">$</span>row &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_abund_df[[i]])</a>
<a class="sourceLine" id="cb621-7" title="7">  associations_abund_df[[i]] &lt;-<span class="st"> </span>associations_abund_df[[i]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>row)</a>
<a class="sourceLine" id="cb621-8" title="8">  associations_abund_df[[i]]<span class="op">$</span>column =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb621-9" title="9">  associations_abund_df[[i]]<span class="op">$</span>dist &lt;-<span class="st"> </span><span class="kw">names</span>(associations_abund)[i]</a>
<a class="sourceLine" id="cb621-10" title="10">}</a>
<a class="sourceLine" id="cb621-11" title="11">associations_abund_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, associations_abund_df)</a>
<a class="sourceLine" id="cb621-12" title="12"></a>
<a class="sourceLine" id="cb621-13" title="13"><span class="kw">ggplot</span>(associations_abund_df, <span class="kw">aes</span>(<span class="dt">x=</span>row, <span class="dt">y=</span>column)) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>dist, <span class="dt">nrow =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-15" title="15"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-16" title="16"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(value, <span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-17" title="17"><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low =</span> <span class="st">&quot;#00ccff&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;#aad400&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#ff0066&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb621-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Site&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Site&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-dist-comparaison-1.png" width="672" /></p>
<p>Peu importe le type d‚Äôassociation utilis√©e, les <em>heatmaps</em> montrent les m√™mes tendances. Les assocaitions de dissimilarit√© (Bray-Curtis, Kulczynski et Ruzicka) s‚Äô√©talent de 0 √† 1, tandis que les distances (Chi-Square, Chord et Hellinger) partent de z√©ro, mais n‚Äôont pas de limite sup√©rieure. On note les plus grandes diff√©rences entre les sites 2 et 4, tandis que les sites 2 et 3 sont les plus semblables pour toutes les mesures d‚Äôassociation √† l‚Äôexception de la dissimilarit√© de Kulczynski.</p>
</div>
<div id="objets-occurence-pr√©sence-absence" class="section level4">
<h4><span class="header-section-number">9.2.1.2</span> Objets: Occurence (pr√©sence-absence)</h4>
<p>Des indices d‚Äôassociation diff√©rents devraient √™tre utilis√©s lorsque des donn√©es sont compil√©es sous forme bool√©enne. En g√©n√©ral, les tableaux de donn√©es d‚Äôoccurence seront compil√©s avec des 1 (pr√©sence) et des 0 (absence).</p>
<p>La <strong>similarit√© de Jaccard</strong> entre le site A et le site B est la proportion de double 1 (pr√©sences de 1 dans A et B) parmi les esp√®ces. La dissimilari√© est la proportion compl√©mentaire (comprenant [1, 0], [0, 1] et [0, 0]). La distance de Jaccard est la racine carr√©e de la dissimilarit√©.</p>
<div class="sourceCode" id="cb622"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb622-1" title="1">associations_occ &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb622-2" title="2">associations_occ[[<span class="st">&#39;Jaccard&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">vegdist</span>(occurence, <span class="dt">method =</span> <span class="st">&quot;jaccard&quot;</span>)</a></code></pre></div>
<p>Les <strong>distances d‚ÄôHellinger, de chord et de chi-carr√©</strong> sont aussi appropri√©es pour les calculs de distances sur des tableaux d‚Äôoccurence.</p>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb623-1" title="1">associations_occ[[<span class="st">&#39;Hellinger&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(occurence, <span class="dt">method=</span><span class="st">&quot;hellinger&quot;</span>))</a>
<a class="sourceLine" id="cb623-2" title="2">associations_occ[[<span class="st">&#39;Chord&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(occurence, <span class="dt">method=</span><span class="st">&quot;normalize&quot;</span>))</a>
<a class="sourceLine" id="cb623-3" title="3">associations_occ[[<span class="st">&#39;ChiSquare&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(<span class="kw">decostand</span>(occurence, <span class="dt">method=</span><span class="st">&quot;chi.square&quot;</span>))</a></code></pre></div>
<p>Graphiquement,</p>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb624-1" title="1">associations_occ_df &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb624-2" title="2"></a>
<a class="sourceLine" id="cb624-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(associations_occ)) {</a>
<a class="sourceLine" id="cb624-4" title="4">  associations_occ_df[[i]] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.matrix</span>(associations_occ[[i]]))</a>
<a class="sourceLine" id="cb624-5" title="5">  <span class="kw">colnames</span>(associations_occ_df[[i]]) &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_occ_df[[i]])</a>
<a class="sourceLine" id="cb624-6" title="6">  associations_occ_df[[i]]<span class="op">$</span>row &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_occ_df[[i]])</a>
<a class="sourceLine" id="cb624-7" title="7">  associations_occ_df[[i]] &lt;-<span class="st"> </span>associations_occ_df[[i]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>row)</a>
<a class="sourceLine" id="cb624-8" title="8">  associations_occ_df[[i]]<span class="op">$</span>column =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb624-9" title="9">  associations_occ_df[[i]]<span class="op">$</span>dist &lt;-<span class="st"> </span><span class="kw">names</span>(associations_occ)[i]</a>
<a class="sourceLine" id="cb624-10" title="10">}</a>
<a class="sourceLine" id="cb624-11" title="11">associations_occ_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, associations_occ_df)</a>
<a class="sourceLine" id="cb624-12" title="12"></a>
<a class="sourceLine" id="cb624-13" title="13"><span class="kw">ggplot</span>(associations_occ_df, <span class="kw">aes</span>(<span class="dt">x=</span>row, <span class="dt">y=</span>column)) <span class="op">+</span></a>
<a class="sourceLine" id="cb624-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>dist) <span class="op">+</span></a>
<a class="sourceLine" id="cb624-15" title="15"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> value)) <span class="op">+</span></a>
<a class="sourceLine" id="cb624-16" title="16"><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> <span class="kw">round</span>(value, <span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb624-17" title="17"><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low =</span> <span class="st">&quot;#00ccff&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;#aad400&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#ff0066&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">1</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb624-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Site&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Site&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-occ-comparaison-1.png" width="672" /></p>
<p>Il est attendu que les matrices d‚Äôassociation sur l‚Äôoccurence sont semblables √† celles sur l‚Äôabondance. Dans ce cas-ci, la distance d‚ÄôHellinger donne des r√©sultats semblables √† la dissimilarit√© de Jaccard.</p>
</div>
<div id="objets-donn√©es-quantitatives" class="section level4">
<h4><span class="header-section-number">9.2.1.3</span> Objets: Donn√©es quantitatives</h4>
<p>Les donn√©es quantitative en √©cologie peuvent d√©crire l‚Äô√©tat de l‚Äôenvironnement: le climat, l‚Äôhydrologie, l‚Äôhydrog√©ochimie, la p√©dologie, etc. En r√®gle g√©n√©rale, les coordonn√©es des sites ne sot pas des variables environnementales, √† que l‚Äôon soup√ßonne la coordonn√©e elle-m√™me d‚Äô√™tre responsable d‚Äôeffets sur notre syst√®me: mais il s‚Äôagira la plupart du temps d‚Äôeffets confondants (par exemple, on peut mesurer un effet de lattitude sur le rendement des agrumes, mais il s‚Äôagira probablement avant tout d‚Äôeffets dus aux conditions climatiques, qui elles changent en fonction de la lattitude). D‚Äôautre types de donn√©es quantitative pouvant √™tre appr√©hend√©es par des distances sont les traits ph√©nologiques, les ionomes, les g√©nomes, etc.</p>
<p>La <strong>distance euclidienne</strong> est la racine carr√©e de la somme des carr√©s des distances sur tous les axes. Il s‚Äôagit d‚Äôune application multidimensionnelle du th√©or√®me de Pythagore. La <strong>distance d‚ÄôAitchison</strong>, couverte dans le chapitre <a href="chapitre-explorer.html#chapitre-explorer">8</a>, est une distance euclidienne calcul√©e sur des donn√©es compositionnelles pr√©alablement transform√©es. La distance euclidienne est sensible aux unit√©s utilis√©s: utiliser des milim√®tres plut√¥t que des m√®tres enflera la distance euclidienne. Il est recommand√© de porter une attention particuli√®re aux unit√©s, et de standardiser les donn√©es au besoin (par exemple, en centrant la moyenne √† z√©ro et en fixant l‚Äô√©cart-type √† 1).</p>
<p>On pourrait, par exemple, mesurer la distance entre des observations des dimensions de diff√©rentes esp√®ces d‚Äôiris. Ce tableau est inclu dans R par d√©faut.</p>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb625-1" title="1"><span class="kw">data</span>(iris)</a>
<a class="sourceLine" id="cb625-2" title="2">iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>##   Sepal.Length Sepal.Width Petal.Length Petal.Width    Species
## 1          6.6         3.0          4.4         1.4 versicolor
## 2          7.7         3.8          6.7         2.2  virginica
## 3          4.4         3.2          1.3         0.2     setosa
## 4          5.6         3.0          4.1         1.3 versicolor
## 5          6.9         3.1          5.1         2.3  virginica</code></pre>
<p>Les mesures du tableau sont en centim√®tres. Pour √©viter de donner davantage de poids aux longueur des s√©pales et en m√™me temps de n√©gliger la largeur des p√©tales, nous allons standardiser le tableau.</p>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb627-1" title="1">iris_sc &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb627-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb627-3" title="3"><span class="st">  </span><span class="kw">scale</span>(.)<span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb627-4" title="4"><span class="st">  </span><span class="kw">as_tibble</span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb627-5" title="5"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Species =</span> iris<span class="op">$</span>Species) </a>
<a class="sourceLine" id="cb627-6" title="6">iris_sc</a></code></pre></div>
<pre><code>## # A tibble: 150 x 5
##    Sepal.Length Sepal.Width Petal.Length Petal.Width Species
##           &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;fct&gt;  
##  1       -0.898      1.02          -1.34       -1.31 setosa 
##  2       -1.14      -0.132         -1.34       -1.31 setosa 
##  3       -1.38       0.327         -1.39       -1.31 setosa 
##  4       -1.50       0.0979        -1.28       -1.31 setosa 
##  5       -1.02       1.25          -1.34       -1.31 setosa 
##  6       -0.535      1.93          -1.17       -1.05 setosa 
##  7       -1.50       0.786         -1.34       -1.18 setosa 
##  8       -1.02       0.786         -1.28       -1.31 setosa 
##  9       -1.74      -0.361         -1.34       -1.31 setosa 
## 10       -1.14       0.0979        -1.28       -1.44 setosa 
## # ... with 140 more rows</code></pre>
<p>Pour les comparaisons des dimensions, prenons la moyenne des dimensions (mises √† l‚Äô√©chelle) par esp√®ce.</p>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb629-1" title="1">iris_means &lt;-<span class="st"> </span>iris_sc <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb629-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb629-3" title="3"><span class="st">  </span><span class="kw">summarise_all</span>(mean) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb629-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species)</a>
<a class="sourceLine" id="cb629-5" title="5">iris_means</a></code></pre></div>
<pre><code>## # A tibble: 3 x 4
##   Sepal.Length Sepal.Width Petal.Length Petal.Width
##          &lt;dbl&gt;       &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt;
## 1       -1.01        0.850       -1.30       -1.25 
## 2        0.112      -0.659        0.284       0.166
## 3        0.899      -0.191        1.02        1.08</code></pre>
<p>Nous pouvons utiliser la distance euclidienne, commune en g√©om√©trie, pour comparer les esp√®ces. La distance euclidienne est calcul√©e comme suit.</p>
<p><span class="math display">\[ \mathcal{E} = \sqrt{\Sigma_i \left( A_i - B_i \right) ^2 } \]</span></p>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb631-1" title="1">associations_cont =<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb631-2" title="2">associations_cont[[<span class="st">&#39;Euclidean&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">dist</span>(iris_sc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species), <span class="dt">method=</span><span class="st">&quot;euclidean&quot;</span>)</a></code></pre></div>
<p>La <strong>distance de Mahalanobis</strong> est semblable √† la distance euclidienne, mais qui tient compte de la covariance de la matrice des objets. Cette covariance peut √™tre utilis√©e pour d√©crire la structure d‚Äôun nuage de points. La diastance de Mahalanobis se calcule comme suit.</p>
<p><span class="math display">\[\mathcal{M} = \sqrt{(A - B)^T S^{-1} (A-B)}\]</span></p>
<p>Notez qu‚Äôil s‚Äôagit d‚Äôune g√©n√©ralisation de la distance euclidienne, qui √©quivaut √† une distance de Mahalanobis dont la matrice de covariance est une matrice identit√©.</p>
<p>La distance de Mahalanobis permet de repr√©senter des distances dans un espace fortement corr√©l√©. Elle est courramment utilis√©e pour d√©tecter les valeurs aberrantes selon des crit√®res de distance √† partir du centre d‚Äôun jeu de donn√©es multivari√©es.</p>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb632-1" title="1">associations_cont[[<span class="st">&#39;Mahalanobis&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">vegdist</span>(iris_sc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species), <span class="st">&#39;mahalanobis&#39;</span>)</a></code></pre></div>
<p>La <strong>distance de Manhattan</strong> porte aussi le nom de distance de cityblock ou de taxi. C‚Äôest la distance que vous devrez parcourir pour vous rendre du point A au point B √† Manhattan, c‚Äôest-√†-dire selon une s√©quence de tron√ßons perpendiculaires.</p>
<p><span class="math display">\[ D_{AB} = \sum _i \left| A_i - B_i \right| \]</span></p>
<p>La distance de Manhattan est appropri√©e lorsque les gradients (changements d‚Äôun √©tat √† l‚Äôautre ou d‚Äôune r√©gion √† l‚Äôautre) ne permettent pas des changements simultan√©s. Mieux vaut standardiser les variables pour √©viter qu‚Äôune dimension soit pr√©pond√©rante.</p>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb633-1" title="1">associations_cont[[<span class="st">&#39;Manhattan&#39;</span>]] &lt;-<span class="st"> </span><span class="kw">vegdist</span>(iris_sc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species), <span class="st">&#39;manhattan&#39;</span>)</a></code></pre></div>
<p>Avant de pr√©senter les r√©sultats des esp√®ces d‚Äôiris, voici une repr√©sentation des distances euclidiennes (rouge), de Mahalanobis (bleu) et de Manhattan (vert), chacune de 1 et 2 unit√©s √† partir du centre et, pour ce qui est de la distance de Mahalanobis, selon la covariance.</p>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb634-1" title="1"><span class="kw">library</span>(<span class="st">&quot;car&quot;</span>)</a></code></pre></div>
<pre><code>## Loading required package: carData</code></pre>
<pre><code>## Registered S3 methods overwritten by &#39;car&#39;:
##   method                          from
##   influence.merMod                lme4
##   cooks.distance.influence.merMod lme4
##   dfbeta.influence.merMod         lme4
##   dfbetas.influence.merMod        lme4</code></pre>
<pre><code>## 
## Attaching package: &#39;car&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     recode</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     some</code></pre>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb640-1" title="1"><span class="kw">library</span>(<span class="st">&quot;MASS&quot;</span>)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:plotly&#39;:
## 
##     select</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb644-1" title="1">select &lt;-<span class="st"> </span>dplyr<span class="op">::</span>select <span class="co"># √©viter les conflits de fonctions entre MASS et dplyr</span></a>
<a class="sourceLine" id="cb644-2" title="2">filter &lt;-<span class="st"> </span>dplyr<span class="op">::</span>filter</a>
<a class="sourceLine" id="cb644-3" title="3"></a>
<a class="sourceLine" id="cb644-4" title="4">sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.6</span>, <span class="fl">0.6</span>, <span class="dv">1</span>), <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="co"># matrice de covariance</span></a>
<a class="sourceLine" id="cb644-5" title="5">mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>) <span class="co"># centre</span></a>
<a class="sourceLine" id="cb644-6" title="6">data &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dt">n =</span> <span class="dv">100</span>, mu, sigma) <span class="co"># g√©n√©rer des donn√©es</span></a>
<a class="sourceLine" id="cb644-7" title="7"></a>
<a class="sourceLine" id="cb644-8" title="8"><span class="kw">plot</span>(data, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb644-9" title="9"></a>
<a class="sourceLine" id="cb644-10" title="10"><span class="co">## cercles</span></a>
<a class="sourceLine" id="cb644-11" title="11">t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>pi,<span class="dt">length=</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb644-12" title="12">c1 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">rbind</span>(mu[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(t)<span class="op">*</span><span class="dv">1</span>, mu[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(t)<span class="op">*</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb644-13" title="13">c2 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">rbind</span>(mu[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(t)<span class="op">*</span><span class="dv">2</span>, mu[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(t)<span class="op">*</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb644-14" title="14"><span class="kw">lines</span>(c1, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb644-15" title="15"><span class="kw">lines</span>(c2, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb644-16" title="16"></a>
<a class="sourceLine" id="cb644-17" title="17"></a>
<a class="sourceLine" id="cb644-18" title="18"><span class="co">## ellipses</span></a>
<a class="sourceLine" id="cb644-19" title="19">e1 &lt;-<span class="st"> </span><span class="kw">ellipse</span>(mu, sigma, <span class="dt">radius=</span><span class="dv">1</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb644-20" title="20">e2 &lt;-<span class="st"> </span><span class="kw">ellipse</span>(mu, sigma, <span class="dt">radius=</span><span class="dv">2</span>, <span class="dt">add=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb644-21" title="21"></a>
<a class="sourceLine" id="cb644-22" title="22"><span class="co">## carr√©s</span></a>
<a class="sourceLine" id="cb644-23" title="23"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">-1</span>, <span class="dv">0</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a>
<a class="sourceLine" id="cb644-24" title="24"><span class="kw">lines</span>(<span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">-2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">-2</span>, <span class="dv">0</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-dist-iris-comparaison-1.png" width="480" /></p>
<p>Et, graphiquement, les r√©sultats des distances des iris.</p>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb645-1" title="1">associations_cont_df &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb645-2" title="2"></a>
<a class="sourceLine" id="cb645-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(associations_cont)) {</a>
<a class="sourceLine" id="cb645-4" title="4">  associations_cont_df[[i]] &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">as.matrix</span>(associations_cont[[i]]))</a>
<a class="sourceLine" id="cb645-5" title="5">  <span class="kw">colnames</span>(associations_cont_df[[i]]) &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_cont_df[[i]])</a>
<a class="sourceLine" id="cb645-6" title="6">  associations_cont_df[[i]]<span class="op">$</span>row &lt;-<span class="st"> </span><span class="kw">rownames</span>(associations_cont_df[[i]])</a>
<a class="sourceLine" id="cb645-7" title="7">  associations_cont_df[[i]] &lt;-<span class="st"> </span>associations_cont_df[[i]] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(<span class="dt">key=</span>row)</a>
<a class="sourceLine" id="cb645-8" title="8">  associations_cont_df[[i]]<span class="op">$</span>column =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(iris), <span class="kw">nrow</span>(iris))</a>
<a class="sourceLine" id="cb645-9" title="9">  associations_cont_df[[i]]<span class="op">$</span>dist &lt;-<span class="st"> </span><span class="kw">names</span>(associations_cont)[i]</a>
<a class="sourceLine" id="cb645-10" title="10">}</a>
<a class="sourceLine" id="cb645-11" title="11">associations_cont_df &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, associations_cont_df)</a>
<a class="sourceLine" id="cb645-12" title="12"></a>
<a class="sourceLine" id="cb645-13" title="13"><span class="kw">ggplot</span>(associations_cont_df, <span class="kw">aes</span>(<span class="dt">x=</span>row, <span class="dt">y=</span>column)) <span class="op">+</span></a>
<a class="sourceLine" id="cb645-14" title="14"><span class="st">  </span><span class="kw">facet_wrap</span>(. <span class="op">~</span><span class="st"> </span>dist) <span class="op">+</span></a>
<a class="sourceLine" id="cb645-15" title="15"><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> value), <span class="dt">colour =</span> <span class="ot">NA</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb645-16" title="16"><span class="st">  </span><span class="co">#geom_text(aes(label = round(value, 2))) +</span></a>
<a class="sourceLine" id="cb645-17" title="17"><span class="st">  </span><span class="kw">scale_fill_gradient2</span>(<span class="dt">low =</span> <span class="st">&quot;#00ccff&quot;</span>, <span class="dt">mid =</span> <span class="st">&quot;#aad400&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#ff0066&quot;</span>, <span class="dt">midpoint =</span> <span class="dv">5</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb645-18" title="18"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Site&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Site&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-dist-comparaison-plot-1.png" width="672" /></p>
<p>Le tableau <code>iris</code> est ordonn√© par esp√®ce. Les distances euclidienne et de Manhattan permettent ais√©ment de distinguer les esp√®ces selon les dimensions des p√©tales et des s√©pales. Toutefois, l‚Äôutilsation de la covariance avec la distance de Mahalanobis cr√©e des distinction moins tranch√©es.</p>
</div>
<div id="objets-donn√©es-mixtes" class="section level4">
<h4><span class="header-section-number">9.2.1.4</span> Objets: Donn√©es mixtes</h4>
<p>Les donn√©es cat√©gorielles ordinales peuvent √™tre transform√©es en donn√©es continues par gradations lin√©aires ou quadratiques. Les donn√©es cat√©gorielles nominales, quant √† elles, peuvent √™tre encod√©es (<em>encodage cat√©goriel</em>) en donn√©es similaires √† des occurences. Attention toutefois: contrairement √† la r√©gression lin√©aire qui demande d‚Äôexclure une cat√©gorie, l‚Äôencodage cat√©goriel doit inclure toutes les cat√©gories. Le comportement par d√©faut de la fonction <code>model.matrix</code> est d‚Äôexclure la cat√©gorie de r√©f√©rence: on doit sp√©cifier que l‚Äôintercept est de z√©ro, c‚Äôest-√†-dire <code>model.matrix(~ + categorie)</code>.</p>
<p>La <strong>similarit√© de Gower</strong> a √©t√© d√©velopp√©e pour mesurer des associations entre des objets dont les donn√©es sont mixtes: bool√©ennes, cat√©gorielles et continues. La similarit√© de Gower est calcul√©e en additionnant les distances calcul√©es par colonne, individuellement. Si la colonne est bool√©enne, on utilise les distances de Jaccard (qui exclue les double-z√©ro) de mani√®re univari√©e: une variable √† la fois. Pour les variables continues, on utilise la distance de Manhattan divis√©e par la plage de valeurs de la variable (pour fin de standardisation). Puisqu‚Äôelle h√©rite de la particularit√© de la distance de Manhattan et de la similarit√© de Jaccard univari√©e, la <strong>similarit√© de Gower</strong> reste une combinaison lin√©aire de distances univari√©es.</p>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb646-1" title="1">X &lt;-<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">ID =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">8</span>,</a>
<a class="sourceLine" id="cb646-2" title="2">            <span class="dt">age =</span> <span class="kw">c</span>(<span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">30</span>, <span class="dv">21</span>, <span class="dv">21</span>, <span class="dv">19</span>, <span class="dv">30</span>),</a>
<a class="sourceLine" id="cb646-3" title="3">            <span class="dt">gender =</span> <span class="kw">c</span>(<span class="st">&#39;M&#39;</span>,<span class="st">&#39;M&#39;</span>,<span class="st">&#39;N&#39;</span>,<span class="st">&#39;M&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;F&#39;</span>,<span class="st">&#39;F&#39;</span>),</a>
<a class="sourceLine" id="cb646-4" title="4">            <span class="dt">civil_status =</span> <span class="kw">c</span>(<span class="st">&#39;MARRIED&#39;</span>,<span class="st">&#39;SINGLE&#39;</span>,<span class="st">&#39;SINGLE&#39;</span>,<span class="st">&#39;SINGLE&#39;</span>,<span class="st">&#39;MARRIED&#39;</span>,<span class="st">&#39;SINGLE&#39;</span>,<span class="st">&#39;WIDOW&#39;</span>,<span class="st">&#39;DIVORCED&#39;</span>),</a>
<a class="sourceLine" id="cb646-5" title="5">            <span class="dt">salary =</span> <span class="kw">c</span>(<span class="fl">3000.0</span>,<span class="fl">1200.0</span> ,<span class="fl">32000.0</span>,<span class="fl">1800.0</span> ,<span class="fl">2900.0</span> ,<span class="fl">1100.0</span> ,<span class="fl">10000.0</span>,<span class="fl">1500.0</span>),</a>
<a class="sourceLine" id="cb646-6" title="6">            <span class="dt">children =</span> <span class="kw">c</span>(<span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">TRUE</span>, <span class="ot">FALSE</span>, <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb646-7" title="7">            <span class="dt">available_credit =</span> <span class="kw">c</span>(<span class="dv">2200</span>,<span class="dv">100</span>,<span class="dv">22000</span>,<span class="dv">1100</span>,<span class="dv">2000</span>,<span class="dv">100</span>,<span class="dv">6000</span>,<span class="dv">2200</span>))</a>
<a class="sourceLine" id="cb646-8" title="8">X</a></code></pre></div>
<pre><code>## # A tibble: 8 x 7
##      ID   age gender civil_status salary children available_credit
##   &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt; &lt;lgl&gt;               &lt;dbl&gt;
## 1     1    21 M      MARRIED        3000 TRUE                 2200
## 2     2    21 M      SINGLE         1200 FALSE                 100
## 3     3    19 N      SINGLE        32000 TRUE                22000
## 4     4    30 M      SINGLE         1800 TRUE                 1100
## 5     5    21 F      MARRIED        2900 TRUE                 2000
## 6     6    21 F      SINGLE         1100 TRUE                  100
## 7     7    19 F      WIDOW         10000 FALSE                6000
## 8     8    30 F      DIVORCED       1500 TRUE                 2200</code></pre>
<p>Il faut pr√©alablement proc√©der √† l‚Äôencodage cat√©goriel pour les variables cat√©gorielles nominales.</p>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb648-1" title="1">X_dum &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="st"> </span><span class="dv">0</span> <span class="op">+</span><span class="st"> </span>., X[, <span class="dv">-1</span>])</a>
<a class="sourceLine" id="cb648-2" title="2">X_dum</a></code></pre></div>
<pre><code>##   age genderF genderM genderN civil_statusMARRIED civil_statusSINGLE civil_statusWIDOW salary
## 1  21       0       1       0                   1                  0                 0   3000
## 2  21       0       1       0                   0                  1                 0   1200
## 3  19       0       0       1                   0                  1                 0  32000
## 4  30       0       1       0                   0                  1                 0   1800
## 5  21       1       0       0                   1                  0                 0   2900
## 6  21       1       0       0                   0                  1                 0   1100
## 7  19       1       0       0                   0                  0                 1  10000
## 8  30       1       0       0                   0                  0                 0   1500
##   childrenTRUE available_credit
## 1            1             2200
## 2            0              100
## 3            1            22000
## 4            1             1100
## 5            1             2000
## 6            1              100
## 7            0             6000
## 8            1             2200
## attr(,&quot;assign&quot;)
##  [1] 1 2 2 2 3 3 3 4 5 6
## attr(,&quot;contrasts&quot;)
## attr(,&quot;contrasts&quot;)$gender
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$civil_status
## [1] &quot;contr.treatment&quot;
## 
## attr(,&quot;contrasts&quot;)$children
## [1] &quot;contr.treatment&quot;</code></pre>
<p>Calculons la dissimilarit√© de Gower (cette fois le graphique est fait avec <code>pheatmap</code>).</p>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb650-1" title="1"><span class="kw">library</span>(<span class="st">&quot;pheatmap&quot;</span>)</a>
<a class="sourceLine" id="cb650-2" title="2">d_gow &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">vegdist</span>(X_dum, <span class="st">&#39;gower&#39;</span>))</a>
<a class="sourceLine" id="cb650-3" title="3"><span class="kw">colnames</span>(d_gow) &lt;-<span class="st"> </span><span class="kw">rownames</span>(d_gow) &lt;-<span class="st"> </span>X<span class="op">$</span>ID</a>
<a class="sourceLine" id="cb650-4" title="4"><span class="kw">pheatmap</span>(d_gow)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-mixte-gower-heatmap-1.png" width="672" /></p>
<p>Les dendrogrammes apparaissants sur les axes du graphique sont issus d‚Äôun processus de partitionnement bas√© sur la distance, que nous verrons plus loin dans ce chapiter. Les profils des clients 4 et 7, ainsi que ceux des clients 3 et 7 diff√®rent le plus. Les profils 3 et 4 sont n√©anmoins plut√¥t diff√©rents.</p>
</div>
</div>
<div id="associations-entre-variables-mode-r" class="section level3">
<h3><span class="header-section-number">9.2.2</span> Associations entre variables (mode R)</h3>
<p>Il existe de nombreuses approches pour mesurer les associations entre variables. La plus connue est la corr√©lation. Mais les donn√©es d‚Äôabondance et d‚Äôoccurence demandent des approches diff√©rentes.</p>
<div id="variables-abondance" class="section level4">
<h4><span class="header-section-number">9.2.2.1</span> Variables: Abondance</h4>
<p>La distance du chi-carr√© est sugg√©r√©e par <a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>.</p>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb651-1" title="1">abundance_r &lt;-<span class="st"> </span><span class="kw">t</span>(abundance)</a>
<a class="sourceLine" id="cb651-2" title="2">D_chisq_R &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(<span class="kw">decostand</span>(abundance_r, <span class="dt">method=</span><span class="st">&quot;chi.square&quot;</span>)))</a>
<a class="sourceLine" id="cb651-3" title="3"><span class="kw">pheatmap</span>(D_chisq_R, <span class="dt">display_numbers =</span> <span class="kw">round</span>(D_chisq_R, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-r-abond-chisq-1.png" width="672" /></p>
<p>Des coabondances sont notables pour la m√©sange √† t√™te noire, le jaseur bor√©al, la citelle √† poitrine rousse et le bruant √† gorge blanche (tache bleu au centre).</p>
</div>
<div id="variables-occurence" class="section level4">
<h4><span class="header-section-number">9.2.2.2</span> Variables: Occurence</h4>
<p>La dissimilarit√© de Jaccard peut √™tre utilis√©e.</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb652-1" title="1">occurence_r &lt;-<span class="st"> </span><span class="kw">t</span>(occurence)</a>
<a class="sourceLine" id="cb652-2" title="2">D_jacc_R &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">vegdist</span>(occurence_r, <span class="dt">method =</span> <span class="st">&quot;jaccard&quot;</span>))</a>
<a class="sourceLine" id="cb652-3" title="3"><span class="kw">pheatmap</span>(D_jacc_R, <span class="dt">display_numbers =</span> <span class="kw">round</span>(D_jacc_R, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-r-aocc-jaccard-1.png" width="672" /></p>
<p>Des cooccurences sont notables pour le jaseur bor√©al, la citelle √† poitrine rousse et le bruant √† gorge blanche (tache bleu au centre).</p>
</div>
<div id="variables-quantit√©s" class="section level4">
<h4><span class="header-section-number">9.2.2.3</span> Variables: Quantit√©s</h4>
<p>La matrice des corr√©lations de Pearson peut √™tre utilis√©e pour les donn√©es continues. Quant aux variables ordinales, elles devraient id√©alement √™tre li√©es lin√©airement ou quadratiquement. Si ce n‚Äôest pas le cas, c‚Äôest-√†-dire que les cat√©gories sont ordonn√©es par rang seulement, vous pourrez avoir recours aux coefficients de corr√©lation de Spearman ou de Kendall.</p>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb653-1" title="1">iris_cor &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb653-2" title="2"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Species) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb653-3" title="3"><span class="st">  </span><span class="kw">cor</span>(.)</a>
<a class="sourceLine" id="cb653-4" title="4"><span class="kw">pheatmap</span>(<span class="kw">cor</span>(iris[, <span class="dv">-5</span>]), <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>, <span class="dt">cluster_cols =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb653-5" title="5">         <span class="dt">display_numbers =</span> <span class="kw">round</span>(iris_cor, <span class="dv">2</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-r-corr-1.png" width="672" /></p>
</div>
</div>
<div id="conclusion-sur-les-associations" class="section level3">
<h3><span class="header-section-number">9.2.3</span> Conclusion sur les associations</h3>
<p>Il n‚Äôexiste pas de r√®gle claire pour d√©terminer quelle technique d‚Äôassociation utiliser. Cela d√©pend en premier lieu de vos donn√©es. Vous s√©lectionnerez votre m√©thode d‚Äôassociation selon le type de donn√©es que vous abordez, la question √† laquelle vous d√©sirez r√©pondre ainsi l‚Äôexp√©rience dans la litt√©rature comme celle de vos coll√®gues scientifiques. S‚Äôil n‚Äôexiste pas de r√®gle clair, c‚Äôest qu‚Äôil existe des dizaines de m√©thodes diff√©rentes, et la plupart d‚Äôentre elles vous donneront une perspective juste et valide. Il faut n√©anmoins faire attention pour √©viter de s√©lectionner les m√©thodes qui ne sont pas appropri√©es.</p>
</div>
</div>
<div id="partitionnement" class="section level2">
<h2><span class="header-section-number">9.3</span> Partitionnement</h2>
<p>Les donn√©es suivantes ont √©t√© g√©n√©r√©es par <a href="https://github.com/scikit-learn-contrib/hdbscan/blob/master/notebooks/clusterable_data.npy">Leland McInnes</a> (Tutte institute of mathematics, Ottawa). √ätes-vous en mesure d‚Äôidentifier des groupes? Combien en trouvez-vous?</p>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb654-1" title="1">df_mcinnes &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/clusterable_data.csv&quot;</span>, <span class="dt">col_names =</span> <span class="kw">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>), <span class="dt">skip =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   x = col_double(),
##   y = col_double()
## )</code></pre>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb656-1" title="1"><span class="kw">ggplot</span>(df_mcinnes, <span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-load-mcinnes-data-1.png" width="672" /></p>
<p>En 2D, l‚Äôoeil humain peut facilement d√©tecter les groupes. En 3D, c‚Äôest toujours possible, mais au-del√† de 3D, le partitionnement cognitive devient rapidement maladroite. Les algorithmes sont alors d‚Äôune aide pr√©cieuse. Mais ils transportent en pratique tout un baggage de limitations. Quel est le crit√®re d‚Äôassociation entre les groupes? Combien de groupe devrions-nous cr√©er? Comment distinguer une donn√©e trop bruit√©e pour √™tre classifi√©e?</p>
<p>Le partitionnement de donn√©es (<em>clustering</em> en anglais), et inversement leur regroupement, permet de cr√©er des ensembles selon des crit√®res d‚Äôassociation. On suppose donc que Le partitionnement permet de cr√©er des groupes selon l‚Äôinformation que l‚Äôon fait √©merger des donn√©es. Il est cons√©quemment entendu que les donn√©es ne sont pas cat√©goris√©es √† priori: <strong>il ne s‚Äôagit pas de pr√©dire la cat√©gorie d‚Äôun objet, mais bien de cr√©er des cat√©gories √† partir des objets</strong> par exemple selon leurs dimensions, leurs couleurs, leurs signature chimique, leurs comportements, leurs g√®nes, etc.</p>
<p>Plusieurs m√©thodes sont aujourd‚Äôhui offertes aux analystes pour partitionner leurs donn√©es. Dans le cadre de ce manuel, nous couvrirons ici deux grandes tendances dans les algorithmes.</p>
<ol style="list-style-type: decimal">
<li><p><em>M√©thodes hi√©rarchique et non hi√©rarchiques</em>. Dans un partitionnement hi√©rarchique, l‚Äôensemble des objets forme un groupe, comprenant des sous-regroupements, des sous-sous-regroupements, etc., dont les objets forment l‚Äôultime partitionnement. On pourra alors identifier comment se d√©cline un partitionnement. √Ä l‚Äôinverse, un partitionnement non-hi√©rarchique des algorhitmes permettent de cr√©er les groupes non hi√©rarchis√©s les plus diff√©rents que possible.</p></li>
<li><p><em>Membership exclusif ou flou</em>. Certaines techniques attribuent √† chaque objet une classe unique: l‚Äôappartenance sera indiqu√©e par un 1 et la non appartenance par un 0. D‚Äôautres techniques vont attribuer un membership flou o√π le degr√© d‚Äôappartenance est une variable continue de 0 √† 1. Parmi les m√©thodes floues, on retrouve les m√©thodes probabilistes.</p></li>
</ol>
<div id="√©valuation-dun-partitionnement" class="section level3">
<h3><span class="header-section-number">9.3.1</span> √âvaluation d‚Äôun partitionnement</h3>
<p>Le choix d‚Äôune technique de partitionnement parmi de nombreuses disponibles, ainsi que le choix des param√®tres gouvernant chacune d‚Äôentre elles, est avant tout bas√© sur ce que l‚Äôon d√©sire d√©finir comme √©tant un groupe, ainsi que la mani√®re d‚Äôinterpr√©ter les groupes. En outre, <strong>le nombre de groupe √† d√©partager est <em>toujours</em> une d√©cision de l‚Äôanalyste</strong>. N√©anmoins, on peut se fier <a href="http://scikit-learn.org/stable/modules/clustering.html#clustering-performance-evaluation">des indicateurs de performance de partitionnement</a>. Parmis ceux-ci, retenons le score <a href="https://rdrr.io/cran/cluster/man/silhouette.html">silouhette</a> ainsi que l‚Äô<a href="https://www.tandfonline.com/doi/abs/10.1080/03610927408827101">indice de Calinski-Harabaz</a>.</p>
<div id="score-silouhette" class="section level4">
<h4><span class="header-section-number">9.3.1.1</span> Score silouhette</h4>
<p>En anglais, le <em>h</em> dans silouhette se trouve apr√®s le <em>l</em>: on parle donc de <em>silhouette coefficient</em> pour d√©signer le score de chacun des objets dans le partitionnement. Pour chaque objet, on calcule la distance moyenne qui le s√©pare des autres points de son groupe (<span class="math inline">\(a\)</span>) ainsi que la distance moyenne qui le s√©pare des points du groupe le plus rapproch√©.</p>
<p><span class="math display">\[s = \frac{b-a}{max \left(a, b \right)}\]</span></p>
<p>Un coefficient de -1 indique le pire classement, tandis qu‚Äôun coefficient de 1 indique le meilleur classement. La moyenne des coefficients silouhette est le score silouhette.</p>
</div>
<div id="indice-de-calinski-harabaz" class="section level4">
<h4><span class="header-section-number">9.3.1.2</span> Indice de Calinski-Harabaz</h4>
<p>L‚Äôindice de Calinski-Harabaz est proportionnel au ratio des dispersions intra-groupe et la moyenne des dispersions inter-groupes. Plus l‚Äôindice est √©lev√©, mieux les groupes sont d√©finis. La math√©matique est d√©crite <a href="http://scikit-learn.org/stable/modules/clustering.html#calinski-harabaz-index">dans la documentation de scikit-learn</a>, un module d‚Äôanalyse et autoapprentissage sur Python.</p>
<p><strong>Note</strong>. Les coefficients silouhette et l‚Äôindice de Calinski-Harabaz sont plus appropri√©s pour les formes de groupes convexes (cercles, sph√®res, hypersph√®res) que pour les formes irr√©guli√®res (notamment celles obtenues par la DBSCAN, discut√©e ci-desssous).</p>
</div>
</div>
<div id="partitionnement-non-hi√©rarchique" class="section level3">
<h3><span class="header-section-number">9.3.2</span> Partitionnement non hi√©rarchique</h3>
<p>Il peut arriver que vous n‚Äôayez pas besoin de comprendre la structure d‚Äôagglom√©ration des objets (ou variables). Plusieurs techniques de partitionnement non hi√©rarchique sont disponibles sur R. On s‚Äôint√©ressera en particulier aux <em>k-means</em> et au <em>dbscan</em>.</p>
<div id="kmeans" class="section level4">
<h4><span class="header-section-number">9.3.2.1</span> Kmeans</h4>
<p>L‚Äôobjectif des kmeans est de minimiser la distance eucl√©dienne entre un nombre pr√©d√©fini de <em>k</em> groupes exclusifs.</p>
<ol style="list-style-type: decimal">
<li>L‚Äôalgorhitme commence par placer une nombre <em>k</em> de centroides au hasard dans l‚Äôespace d‚Äôun nombre <em>p</em> de variables (vous devez fixer <em>k</em>, et <em>p</em> est le nombre de colonnes de vos donn√©es).</li>
<li>Ensuite, chaque objet est √©tiquett√© comme appartenant au groupe du centroid le plus pr√®s.</li>
<li>La position du centroide est d√©plac√©e √† la moyenne de chaque groupe.</li>
<li>Recommencer √† partir de l‚Äô√©tape 2 jusqu‚Äô√† ce que l‚Äôassignation des objets aux groupes ne change plus.</li>
</ol>
<img src="https://media.giphy.com/media/12vVAGkaqHUqCQ/giphy.gif" />
<center>
Source: <a href="https://dashee87.github.io/data%20science/general/Clustering-with-Scikit-with-GIFs/">David Sheehan</a>
</center>
<p>La technique des kmeans suppose que les groupes ont des distributions multinormales - repr√©sent√©es par des cercles en 2D, des sph√®res en 3D, des hypersph√®res en plus de 3D. Cette limitation est probl√©matique lorsque les groupes se pr√©sentent sous des formes irr√©guli√®res, comme celles du nuage de points de Leland McInnes, pr√©sent√© plus haut. De plus, la technique classique des kmeans est bas√©e sur des distances euclidiennes: l‚Äôutilisation des kmeans n‚Äôest appropri√©e pour les donn√©es comprenant beaucoup de z√©ros, comme les donn√©es d‚Äôabondance, qui devraient pr√©alablement √™tre transform√©es en variables centr√©es et r√©duites (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>). La technique des <strong>mixtures gaussiennes</strong> (<a href="https://www.stat.washington.edu/mclust/"><em>gaussian mixtures</em></a>) est une g√©n√©ralisation des kmeans permettant d‚Äôint√©grer la covariance des groupes. Les groupes ne sont plus des hyper-sph√®res, mais des hyper-ellipso√Ødes.</p>
<div id="application" class="section level5">
<h5><span class="header-section-number">9.3.2.1.1</span> Application</h5>
<p>Nous pouvons utilis√© la fonction <code>kmeans</code> de R. Toutefois, puisque l‚Äôon d√©sire ici effectuer des tests de partitionnement pour plusieurs nombres de groupes, nous utiliserons <code>cascadeKM</code>, du module vegan. Notez que de nombreux param√®tres par d√©faut sont utilis√©s dans les ex√©cutions ci-dessous. Ces notes de cours ne forment pas un travail de recherche scientifique. Lors de travaux de recherche, l‚Äôutilsation d‚Äôun argument ou d‚Äôun autre dans une fonction doit √™tre justifi√©: qu‚Äôun param√®tre soit utilis√© par d√©faut dans une fonction n‚Äôest a priori pas une justification convainquante.</p>
<p>Pour les kmeans, on doit fixer le nombre de groupes. Le graphique des donn√©es de Leland McInnes montrent 6 groupes. Toutefois, il est rare que l‚Äôon puisse visualiser des d√©marquations aussi tranch√©es que celles de l‚Äôexemple, qui plus est dans des cas o√π l‚Äôon doit traiter de plus de deux dimensions. Je vais donc lancer le partitionnement en boucle pour plusieurs nombres de groupes, de 3 √† 10 et pour chaque groupe, √©valuer le score silouhette et de Calinski-Habaraz. J‚Äôutilise un argument random_state pour m‚Äôassurer que les groupes seront les m√™mes √† chaque fois que la cellule sera lanc√©e.</p>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb657-1" title="1"><span class="kw">library</span>(<span class="st">&quot;vegan&quot;</span>)</a>
<a class="sourceLine" id="cb657-2" title="2">mcinnes_kmeans &lt;-<span class="st"> </span><span class="kw">cascadeKM</span>(df_mcinnes, <span class="dt">inf.gr =</span> <span class="dv">3</span>, <span class="dt">sup.gr =</span> <span class="dv">10</span>, <span class="dt">criterion =</span> <span class="st">&quot;calinski&quot;</span>)</a>
<a class="sourceLine" id="cb657-3" title="3"><span class="kw">str</span>(mcinnes_kmeans)</a></code></pre></div>
<pre><code>## List of 4
##  $ partition: int [1:2309, 1:8] 1 1 1 1 1 1 1 1 1 1 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2309] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
##   .. ..$ : chr [1:8] &quot;3 groups&quot; &quot;4 groups&quot; &quot;5 groups&quot; &quot;6 groups&quot; ...
##  $ results  : num [1:2, 1:8] 85.1 2164.5 61.4 2294.6 51.4 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;SSE&quot; &quot;calinski&quot;
##   .. ..$ : chr [1:8] &quot;3 groups&quot; &quot;4 groups&quot; &quot;5 groups&quot; &quot;6 groups&quot; ...
##  $ criterion: chr &quot;calinski&quot;
##  $ size     : int [1:10, 1:8] 1243 505 561 NA NA NA NA NA NA NA ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:10] &quot;Group 1&quot; &quot;Group 2&quot; &quot;Group 3&quot; &quot;Group 4&quot; ...
##   .. ..$ : chr [1:8] &quot;3 groups&quot; &quot;4 groups&quot; &quot;5 groups&quot; &quot;6 groups&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;cascadeKM&quot;</code></pre>
<p>L‚Äôobjet <code>mcinnes_kmeans</code>, de type <code>cascadeKM</code>, peut √™tre visualis√© directement avec la fonction <code>plot</code>.</p>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb659-1" title="1"><span class="kw">plot</span>(mcinnes_kmeans)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-kmeans-mcinnes-plot-1.png" width="672" /></p>
<p>On obtient un maximum de Calinski √† 4 groupes, qui correspons √† la deuxi√®me simulation effectu√©e de 3 √† 10.</p>
<p>Examinons les scores silouhette (module: cluster).</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb660-1" title="1"><span class="kw">library</span>(<span class="st">&quot;cluster&quot;</span>)</a>
<a class="sourceLine" id="cb660-2" title="2">asw &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb660-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(mcinnes_kmeans<span class="op">$</span>partition)) {</a>
<a class="sourceLine" id="cb660-4" title="4">  mcinnes_kmeans_silhouette &lt;-<span class="st"> </span><span class="kw">silhouette</span>(mcinnes_kmeans<span class="op">$</span>partition[, i], <span class="dt">dist =</span> <span class="kw">vegdist</span>(df_mcinnes, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>))</a>
<a class="sourceLine" id="cb660-5" title="5">  asw[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(mcinnes_kmeans_silhouette)<span class="op">$</span>avg.width</a>
<a class="sourceLine" id="cb660-6" title="6">}</a>
<a class="sourceLine" id="cb660-7" title="7"><span class="kw">plot</span>(<span class="dv">3</span><span class="op">:</span><span class="dv">10</span>, asw, <span class="dt">type =</span> <span class="st">&#39;b&#39;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-kmeans-mcinnes-silouhette-1.png" width="672" /></p>
<p>Le score silouhette maximum est √† 3 groupes. La forme des groupes n‚Äô√©tant pas convexe, il fallait s‚Äôattendre √† ce que indicateurs maximaux pour les deux indicateurs soient diff√©rents. C‚Äôest d‚Äôailleurs souvent le cas. Cet exemple supporte que le choix du nombre de groupe √† d√©partager repose sur l‚Äôanalyste, non pas uniquement sur les indicateurs de performance. Choisissons 6 groupes, puisque que c‚Äôest visuellement ce que l‚Äôon devrait chercher pour ce cas d‚Äô√©tude.</p>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb661-1" title="1">kmeans_group &lt;-<span class="st"> </span>mcinnes_kmeans<span class="op">$</span>partition[, <span class="dv">4</span>]</a>
<a class="sourceLine" id="cb661-2" title="2">mcinnes_kmeans<span class="op">$</span>partition <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">head</span>(<span class="dv">3</span>)</a></code></pre></div>
<pre><code>##   3 groups 4 groups 5 groups 6 groups 7 groups 8 groups 9 groups 10 groups
## 1        1        4        5        3        1        6        7        10
## 2        1        4        4        1        1        3        7        10
## 3        1        1        5        3        6        6        3         3</code></pre>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb663-1" title="1">df_mcinnes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb663-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">kmeans_group =</span> kmeans_group) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># ajouter une colonne de regoupement</span></a>
<a class="sourceLine" id="cb663-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb663-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(kmeans_group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb663-5" title="5"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-kmeans-mcinnes-6groupes-1.png" width="672" /></p>
<p>L‚Äôalgorithme kmeans est loin d‚Äô√™tre statisfaisant. Cela est attendu, puisque les kmeans recherchent des distribution gaussiennes sur des groupes vraisemblablement non-gaussiens.</p>
<p>Nous pouvons cr√©er un graphique silouhette pour nos 6 groupes. Notez qu‚Äô√† cause d‚Äôun bogue, il n‚Äôest pas possible de pr√©senter les donn√©es clairement lorsqu‚Äôelles sont nombreuses.</p>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb664-1" title="1">sil &lt;-<span class="st"> </span><span class="kw">silhouette</span>(mcinnes_kmeans<span class="op">$</span>partition[, <span class="dv">6</span>],</a>
<a class="sourceLine" id="cb664-2" title="2">                  <span class="dt">dist =</span> <span class="kw">vegdist</span>(df_mcinnes[, ], <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>))</a>
<a class="sourceLine" id="cb664-3" title="3">sil &lt;-<span class="st"> </span><span class="kw">sortSilhouette</span>(sil)</a>
<a class="sourceLine" id="cb664-4" title="4"><span class="kw">plot</span>(sil, <span class="dt">col =</span> <span class="st">&#39;black&#39;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-kmeans-mcinnes-silouhette-plot-1.png" width="768" /></p>
</div>
</div>
<div id="dbscan" class="section level4">
<h4><span class="header-section-number">9.3.2.2</span> DBSCAN</h4>
<p>La technique DBSCAN (* <strong>D</strong>ensity-<strong>B</strong>ased <strong>S</strong>patial <strong>C</strong>lustering of <strong>A</strong>pplications with <strong>N</strong>oise<em>) sousentend que les groupes sont compos√©s de zones o√π l‚Äôon retrouve plus de points (zones denses) s√©par√©es par des zones de faible densit√©. Pour lancer l‚Äôalgorithme, nous devons sp√©cifier une mesure d‚Äôassociation critique (distance ou dissimilarit√©) </em>d* ainsi qu‚Äôun nombre de point critique <em>k</em> dans le voisinage de cette distance.</p>
<ol style="list-style-type: decimal">
<li>L‚Äôalgorithme commence par √©tiqueter chaque point selon l‚Äôune de ces cat√©gories:</li>
</ol>
<ul>
<li><em>Noyau</em>: le point a au moins <em>k</em> points dans son voisinage, c‚Äôest-√†-dire √† une distance inf√©rieure ou √©gale √† <em>d</em>.</li>
<li><em>Bordure</em>: le point a moins de <em>k</em> points dans son voisinage, mais l‚Äôun de des points voisins est un <em>noyau</em>.</li>
<li><em>Bruit</em>: le cas √©ch√©ant. Ces points sont consid√©r√©s comme des outliers.</li>
</ul>
<p><img src="images/07_dbscan_1.svg" width=600></p>
<ol start="2" style="list-style-type: decimal">
<li>Les noyaux distanc√©s de <em>d</em> ou moins sont connect√©s entre eux en englobant les bordures.</li>
</ol>
<p><img src="images/07_dbscan_2.svg" width=600></p>
<p>Le nombre de groupes est prescrit par l‚Äôalgorithme DBSCAN, qui permet du coup de d√©tecter des donn√©es trop bruit√©es pour √™tre class√©es.</p>
<p><a href="https://doi.org/10.1145/2666310.2666417">Damiani et al.¬†(2014)</a> a d√©velopp√© une approche utilisant la technique DBSCAN pour partitionner des zones d‚Äôescale pour les flux de populations migratoires.</p>
<div id="application-1" class="section level5">
<h5><span class="header-section-number">9.3.2.2.1</span> Application</h5>
<p>La technique <strong>DBSCAN</strong> n‚Äôest pas bas√©e sur le nombre de groupe, mais sur la densit√© des points. L‚Äôargument <code>x</code> ne constitue pas les donn√©es, mais une matrice d‚Äôassociation. L‚Äôargument minPts sp√©cifie le nombre minimal de points qui l‚Äôon doit retrouver √† une distance critique d* pour la formation des *noyaux et la propagation des groupes, sp√©cifi√©e dans l‚Äôargument eps. La distance d peut √™tre estim√©e en prenant une fraction de la moyenne, mais on aura volontiers recours √† sont bon jugement.</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb665-1" title="1"><span class="kw">library</span>(<span class="st">&quot;dbscan&quot;</span>)</a>
<a class="sourceLine" id="cb665-2" title="2">mcinnes_dbscan &lt;-<span class="st"> </span><span class="kw">dbscan</span>(<span class="dt">x =</span> <span class="kw">vegdist</span>(df_mcinnes[, ], <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>),</a>
<a class="sourceLine" id="cb665-3" title="3">                         <span class="dt">eps =</span> <span class="fl">0.03</span>, <span class="dt">minPts =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb665-4" title="4">dbscan_group &lt;-<span class="st"> </span>mcinnes_dbscan<span class="op">$</span>cluster</a>
<a class="sourceLine" id="cb665-5" title="5"><span class="kw">unique</span>(dbscan_group)</a></code></pre></div>
<pre><code>## [1] 1 0 2 6 3 4 5</code></pre>
<p>Les param√®tres sp√©cifi√©s donnent 5 groupes (<code>1, 2, ..., 5</code>) et des points trop bruit√©s pour √™tre classifi√©s (√©tiquet√©s <code>0</code>). Voyons comment les groupes ont √©t√© form√©s.</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb667-1" title="1">df_mcinnes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb667-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">dbscan_group =</span> dbscan_group) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># ajouter une colonne de regoupement</span></a>
<a class="sourceLine" id="cb667-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb667-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(dbscan_group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb667-5" title="5"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-dbscan-mcinnes-5groupes-1.png" width="672" /></p>
<p>Le partitionnement semble plus conforme √† ce que l‚Äôon recherche. N√©anmoins, DBSCAN cr√© quelques petits groupes ind√©sirables (groupe 6, en rose) ainsi qu‚Äôun grand groupe (violet) qui auraient lieu d‚Äô√™tre partitionn√©. Ces d√©faut pourraient √™tre r√©gl√©s en jouant sur les param√®tres <code>eps</code> et <code>minPts</code>.</p>
</div>
</div>
</div>
<div id="partitionnement-hi√©rarchique" class="section level3">
<h3><span class="header-section-number">9.3.3</span> Partitionnement hi√©rarchique</h3>
<p>Les techniques de partitionnement hi√©rarchique sont bas√©es sur les matrices d‚Äôassociation. La technique pour mesurer l‚Äôassociation (entre objets ou variables) d√©terminera en grande partie le paritionnement des donn√©es. Les partitionnements hi√©rarchiques ont l‚Äôavantage de pouvoir √™tre repr√©sent√©s sous forme de dendrogramme (ou arbre) de partition. Un tel dendrogramme pr√©sente des sous-groupes qui se joignent en groupes jusqu‚Äô√† former un seul ensemble.</p>
<p>Le partitionnement hi√©rarchique est abondamment utilis√© en phylog√©nie, pour √©tudier les relations de parent√© entre organismes vivants, populations d‚Äôorganismes et esp√®ces. La ph√©n√©tique, branche empirique de la phylog√©n√®se intersp√©cifique, fait usage du partitionnement hi√©rarchique √† partir d‚Äôassociations g√©n√©tiques entre unit√©s taxonomiques. On retrouve de nombreuses ressources acad√©miques en phylog√©n√©tique ainsi que des outils pour <a href="https://www.springer.com/us/book/9781461495413">R</a> et <a href="https://academic.oup.com/bioinformatics/article/26/12/1569/287181/DendroPy-a-Python-library-for-phylogenetic">Python</a>. Toutefois, la phylog√©n√©tique en particulier ne fait pas partie de la pr√©sente itt√©ration de ce manuel.</p>
<div id="techniques-de-partitionnement-hi√©rarchique" class="section level4">
<h4><span class="header-section-number">9.3.3.1</span> Techniques de partitionnement hi√©rarchique</h4>
<p>Le partitionnement hi√©rarchique est typiquement effectu√© avec une des quatres m√©thodes suivantes, dont chacune poss√®de ses particularit√©s, mais sont toutes agglom√©ratives: √† chaque √©tape d‚Äôagglom√©ration, on fusionne les deux groupes ayant le plus d‚Äôaffinit√© sur la base des deux sous-groupes les plus rapproch√©s.</p>
<p><strong>Single link</strong> (<code>single</code>). Les groupes sont agglom√©r√©s sur la base des deux points parmi les groupes, qui sont les plus proches.</p>
<p><strong>Complete link</strong> (<code>complete</code>). √Ä la diff√©rence de la m√©thode <em>single</em>, on consid√®re comme crit√®re d‚Äôagglom√©ration les √©l√©ments les plus √©loign√©s de chaque groupe.</p>
<p><strong>Agglom√©ration centrale</strong>. Il s‚Äôagit d‚Äôune fammlle de m√©thode bas√©es sur les diff√©rences entre les tendances centrales des objets ou des groupes.</p>
<ul>
<li><strong>Average</strong> (<code>average</code>). Appel√©e UPGMA (Unweighted Pair-Group Method unsing Average), les groupes sont agglom√©r√©s selon un centre calcul√©s par la moyenne et le nombre d‚Äôobjet pond√®re l‚Äôagglom√©ration (le poids des groupes est retir√©). Cette technique est historiquement utilis√©e en bioinformatique pour partitionner des groupes phylog√©n√©tiques (<a href="https://www.cabdirect.org/cabdirect/abstract/19730310919">Sneath et Sokal, 1973</a>).</li>
<li><strong>Weighted</strong> (<code>weighted</code>). La version de average, mais non pond√©r√©e (WPGMA).</li>
<li><strong>Centroid</strong> (<code>centroid</code>). Tout comme average, mais le centro√Øde (centre g√©om√©trique) est utilis√© au lieu de la moyenne. Accronyme: UPGMC.</li>
<li><strong>Median</strong> (<code>median</code>). Appel√©e WPGMC. Devinez! ;)</li>
</ul>
<p><strong>Ward</strong> (<code>ward</code>). L‚Äôoptimisation vise √† minimiser les sommes des carr√©s par regroupement.</p>
</div>
<div id="quel-outil-de-partitionnement-hi√©rarchique-utiliser" class="section level4">
<h4><span class="header-section-number">9.3.3.2</span> Quel outil de partitionnement hi√©rarchique utiliser?</h4>
<p>Alors que le choix de la matrice d‚Äôassociation d√©pend des donn√©es et de leur contexte, la technique de partitionnement hi√©rarchique peut, quant √† elle, √™tre bas√©e sur un crit√®re num√©rique. Il en existe plusieurs, mais le crit√®re recommand√© pour le choix d‚Äôune technique de partitionnement hi√©rarchique est la <strong>corr√©lation coph√©n√©tique</strong>. La distance coph√©n√©tique est la distance √† laquelle deux objets ou deux sous-groupes deviennent membres d‚Äôun m√™me groupe. La corr√©lation coph√©n√©tique est la corr√©lation de Pearson entre le vecteur d‚Äôassociation des objets et le vecteur de distances coph√©n√©tiques.</p>
</div>
<div id="application-2" class="section level4">
<h4><span class="header-section-number">9.3.3.3</span> Application</h4>
<p>Les techniques de partitionnement hi√©rarchique pr√©sent√©es ci-dessus sont disponibles dans le module <code>stats</code> de R, qui est charg√© automatiquement lors de l‚Äôouversture de R. Nous allons classifier les dimensions des iris gr√¢ce √† la distance de Manhattan.</p>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb668-1" title="1">mcinnes_hclust_distmat &lt;-<span class="st"> </span><span class="kw">vegdist</span>(df_mcinnes, <span class="dt">method =</span> <span class="st">&quot;manhattan&quot;</span>)</a>
<a class="sourceLine" id="cb668-2" title="2"></a>
<a class="sourceLine" id="cb668-3" title="3">clustering_methods &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;single&#39;</span>, <span class="st">&#39;complete&#39;</span>, <span class="st">&#39;average&#39;</span>, <span class="st">&#39;centroid&#39;</span>, <span class="st">&#39;ward&#39;</span>)</a>
<a class="sourceLine" id="cb668-4" title="4"></a>
<a class="sourceLine" id="cb668-5" title="5">clust_l &lt;-<span class="st"> </span><span class="kw">list</span>()</a>
<a class="sourceLine" id="cb668-6" title="6">coph_corr_l &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb668-7" title="7"></a>
<a class="sourceLine" id="cb668-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(clustering_methods)) {</a>
<a class="sourceLine" id="cb668-9" title="9">  clust_l[[i]] &lt;-<span class="st"> </span><span class="kw">hclust</span>(mcinnes_hclust_distmat, <span class="dt">method =</span> clustering_methods[i])</a>
<a class="sourceLine" id="cb668-10" title="10">  coph_corr_l[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(mcinnes_hclust_distmat, <span class="kw">cophenetic</span>(clust_l[[i]]))</a>
<a class="sourceLine" id="cb668-11" title="11">}</a></code></pre></div>
<pre><code>## The &quot;ward&quot; method has been renamed to &quot;ward.D&quot;; note new &quot;ward.D2&quot;</code></pre>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb670-1" title="1"><span class="kw">tibble</span>(clustering_methods, <span class="dt">coph_corr =</span> coph_corr_l) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb670-2" title="2"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> <span class="kw">fct_reorder</span>(clustering_methods, <span class="op">-</span>coph_corr), <span class="dt">y =</span> coph_corr)) <span class="op">+</span></a>
<a class="sourceLine" id="cb670-3" title="3"><span class="st">  </span><span class="kw">geom_col</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb670-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;M√©thode de partitionnement&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;Corr√©lation coph√©n√©tique&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hierarch-mcinnes-1.png" width="672" /></p>
<p>La m√©thode <code>average</code> retourne la corr√©lation la plus √©lev√©e. Pour plus de flexibilit√©, ench√¢ssons le nom de la m√©thode dans une variable. Ainsi, en chageant le nom de cette variable, le reste du code sera cons√©quent.</p>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb671-1" title="1"><span class="kw">names</span>(clust_l) &lt;-<span class="st"> </span>clustering_methods</a>
<a class="sourceLine" id="cb671-2" title="2">best_method &lt;-<span class="st"> &quot;average&quot;</span></a></code></pre></div>
<p>Le partitionnement hi√©rarchique peut √™tre visualis√© par un dendrogramme.</p>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb672-1" title="1"><span class="kw">plot</span>(clust_l[[best_method]])</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hierarch-mcinnes-plot-1.png" width="1440" /></p>
</div>
<div id="combien-de-groupes-utiliser" class="section level4">
<h4><span class="header-section-number">9.3.3.4</span> Combien de groupes utiliser?</h4>
<p>La longueur des lignes verticales est la distance s√©parant les groupes enfants. Bien que la s√©lection du nombre de groupe soit avant tout bas√©e sur les besoins du probl√®me, nous pouvons nous appuyer sur certains outils. La hauteur totale peut servir de crit√®re pour d√©finir un nombre de groupes ad√©quat. On pourra s√©lectionner le nombre de groupe o√π la hauteur se stabilise en fonction du nombre de groupe. On pourra aussi utiliser le <em>graphique silhouette</em>, comprenant une collection de <em>largeurs de silouhette</em>, repr√©sentant le degr√© d‚Äôappartenance √† son groupe. La fonction <code>sklearn.metrics.silhouette_score</code>, du module scikit-learn, s‚Äôen occupe.</p>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb673-1" title="1">asw &lt;-<span class="st"> </span><span class="kw">c</span>()</a>
<a class="sourceLine" id="cb673-2" title="2">num_groups &lt;-<span class="st"> </span><span class="dv">3</span><span class="op">:</span><span class="dv">10</span></a>
<a class="sourceLine" id="cb673-3" title="3"><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">seq_along</span>(num_groups)) {</a>
<a class="sourceLine" id="cb673-4" title="4">  sil &lt;-<span class="st"> </span><span class="kw">silhouette</span>(<span class="kw">cutree</span>(clust_l[[best_method]], <span class="dt">k =</span> num_groups[i]), mcinnes_hclust_distmat)</a>
<a class="sourceLine" id="cb673-5" title="5">  asw[i] &lt;-<span class="st"> </span><span class="kw">summary</span>(sil)<span class="op">$</span>avg.width</a>
<a class="sourceLine" id="cb673-6" title="6">}</a>
<a class="sourceLine" id="cb673-7" title="7"><span class="kw">plot</span>(num_groups, asw, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hierarch-mcinnes-ngroupes-1.png" width="672" /></p>
<p>Le nombre optimal de groupes serait de 5. Coupons le dendrorgamme √† la hauteur correspondant √† 5 groupes avec la fonction <code>cutree</code>.</p>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb674-1" title="1">k_opt &lt;-<span class="st"> </span>num_groups[<span class="kw">which.max</span>(asw)]</a>
<a class="sourceLine" id="cb674-2" title="2">hclust_group &lt;-<span class="st"> </span><span class="kw">cutree</span>(clust_l[[best_method]], <span class="dt">k =</span> k_opt)</a>
<a class="sourceLine" id="cb674-3" title="3"><span class="kw">plot</span>(clust_l[[best_method]])</a>
<a class="sourceLine" id="cb674-4" title="4"><span class="kw">rect.hclust</span>(clust_l[[best_method]], <span class="dt">k =</span> k_opt)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hierarch-mcinnes-5groupes-1.png" width="1440" /></p>
<p>La classification hi√©rarchique, uniquement bas√©e sur la distance, peut √™tre inappropri√©e pour d√©finir des formes complexes.</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb675-1" title="1">df_mcinnes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb675-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">hclust_group =</span> hclust_group) <span class="op">%&gt;%</span><span class="st"> </span><span class="co"># ajouter une colonne de regoupement</span></a>
<a class="sourceLine" id="cb675-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>x, <span class="dt">y=</span>y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb675-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> <span class="kw">factor</span>(hclust_group))) <span class="op">+</span></a>
<a class="sourceLine" id="cb675-5" title="5"><span class="st">  </span><span class="kw">coord_fixed</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hierarch-mcinnes-5groupes-plot-1.png" width="672" /></p>
</div>
</div>
<div id="partitionnement-hi√©rarchique-bas√©e-sur-la-densit√©-des-points" class="section level3">
<h3><span class="header-section-number">9.3.4</span> Partitionnement hi√©rarchique bas√©e sur la densit√© des points</h3>
<p>La tecchinque HDBSCAN, dont l‚Äôalgorithme est relativement r√©cent (<a href="https://link.springer.com/chapter/10.1007%2F978-3-642-37456-2_14">Campello et al., 2013</a>), permet une partitionnement hi√©rarchique sur le m√™me principe des zones de densit√© de la technique DBSCAN. Le HDBSCAN a √©t√© utilis√©e pour partitionner les lieux d‚Äôescale d‚Äôoiseaux migrateurs en Chine (<a href="https://www.jstage.jst.go.jp/article/dsj/12/0/12_WDS-027/_article">Xu et al., 2013</a>).</p>
<p>Avec DBSCAN, un rayon est fix√© dans une m√©trique appropri√©e. Pour chaque point, on compte le nombre de point voisins, c‚Äôest √† dire le nombre de point se situant √† une distance (ou une dissimilarit√©) √©gale ou inf√©rieure au rayon fix√©. Avec HDBSCAN, on sp√©cifie le nombre de points devant √™tre recouverts et on calcule le rayon n√©cessaire pour les recouvrir. Ainsi, chaque point est associ√© √† un rayon critique que l‚Äôon nommera <span class="math inline">\(d_{noyau}\)</span>. La m√©trique initiale est ensuite alt√©r√©e: on remplace les associations entre deux objets A et B par la valeur maximale entre cette association, le rayon critique de A et le rayon critique de B. Cette nouvelle distance est appel√©e la <em>distance d‚Äôatteinte mutuelle</em>: elle accentue les distances pour les points se trouvant dans des zones peu denses. On applique par la suite un algorithme semblable √† la partition hi√©rarchique <em>single link</em>: En s‚Äô√©largissant, les rayons se superposent, chaque superposition de rayon forment graduellement des groupes qui s‚Äôagglom√®rent ainsi de mani√®re hi√©rarchique. Au lieu d‚Äôeffectuer une tranche √† une hauteur donn√©e dans un dendrogramme de partitionnement, la technique HDBSCAN se base sur un dendrogramme condens√© qui discarte les sous-groupes comprenant moins de <em>n</em> objets (<span class="math inline">\(n_{gr min}\)</span>). Dans nouveau dendrogramme, on recherche des groupes qui occupent bien l‚Äôespace d‚Äôanalyse. Pour ce faitre, on utilise l‚Äôinverse de la distance pour cr√©er un indicateur de <em>persistance</em> (semblable √† la similarit√©), <span class="math inline">\(\lambda\)</span>. Pour chaque groupe hi√©rarchique dans le dendrogramme condens√©, on peut calculer la persistance o√π le groupe prend naissance. De plus, pour chaque objet d‚Äôun groupe, on peut aussi calculer une distance √† laquelle il quitte le groupe. La <em>stabilit√©</em> d‚Äôun groupe est la domme des diff√©rences de persistance entre la persistance √† la naissance et les persistances des objets. On descend dans le dendrogramme. Si la somme des stabilit√© des groupes enfants est plus grande que la stabilit√© du groupe parent, on accepte la division. Sinon, le parent forme le groupe. La <a href="http://hdbscan.readthedocs.io/en/latest/how_hdbscan_works.html">documentation du module <code>hdbscan</code></a> pour Python offre une description intuitive et plus exhaustive des principes et algorithme de HDBSCAN.</p>
<div id="param√®tres" class="section level4">
<h4><span class="header-section-number">9.3.4.1</span> Param√®tres</h4>
<p>Outre la m√©trique d‚Äôassociation dont nous avons discut√©, HDBSCAN demande d‚Äô√™tre nourri avec <a href="https://www.rdocumentation.org/packages/dbscan/versions/1.1-3/topics/hdbscan">quelques param√®tres importants</a>. En particulier, le <strong>nombre minimum d‚Äôobjets par groupe</strong>, <span class="math inline">\(n_{gr min}\)</span> d√©pend de la quantit√© de donn√©es que vous avez √† votre disposition, ainsi que de la quantit√© d‚Äôobjets que vous jugez suffisante pour cr√©er des groupes. Nous utiliserons l‚Äôimpl√©mentation de HDBSCAN du module dbscan. Si vous d√©sirez davantage d‚Äôoptions, vous pr√©f√©rerez probablement l‚Äô<a href="https://www.rdocumentation.org/packages/largeVis/versions/0.2.1.1/topics/hdbscan">impl√©mentation du module largeVis</a>.</p>
<div class="sourceCode" id="cb676"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb676-1" title="1">mcinnes_hdbscan &lt;-<span class="st"> </span><span class="kw">hdbscan</span>(<span class="dt">x =</span> <span class="kw">vegdist</span>(df_mcinnes, <span class="dt">method =</span> <span class="st">&quot;euclidean&quot;</span>),</a>
<a class="sourceLine" id="cb676-2" title="2">                           <span class="dt">minPts =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb676-3" title="3">                           <span class="dt">gen_hdbscan_tree =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb676-4" title="4">                           <span class="dt">gen_simplified_tree =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb676-5" title="5">hdbscan_group &lt;-<span class="st"> </span>mcinnes_hdbscan<span class="op">$</span>cluster</a>
<a class="sourceLine" id="cb676-6" title="6"><span class="kw">unique</span>(hdbscan_group)</a></code></pre></div>
<pre><code>## [1] 6 0 4 3 5 1 2</code></pre>
<p>Nous avons 6 groupes, num√©rot√©s de 1 √† 6, ainsi que des √©tiquettes identifiant des objets d√©sign√©s comme √©tant du bruit de fond, num√©rot√© 0. Le dendrogramme non condens√© peu √™tre produit.</p>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb678-1" title="1"><span class="kw">plot</span>(mcinnes_hdbscan<span class="op">$</span>hdbscan_tree)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hbdscan-mcinnes-plot-1.png" width="672" /></p>
<p>Difficile d‚Äôy voir clair avec autant d‚Äôobjets. L‚Äôobjet <code>mcinnes_hdbscan</code> a un nombre minimum d‚Äôobjets par groupe de 20. Ce qui permet de pr√©senter le dendrogramme de mani√®re condens√©e.</p>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb679-1" title="1"><span class="kw">plot</span>(mcinnes_hdbscan)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hbdscan-mcinnes-plot2-1.png" width="1440" /></p>
<p>Enfin, un aper√ßu des strat√©gies de partitionnement utilis√©s jusqu‚Äôici.</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb680-1" title="1">clustering_group &lt;-<span class="st"> </span>df_mcinnes <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb680-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(kmeans_group,</a>
<a class="sourceLine" id="cb680-3" title="3">         hclust_group,</a>
<a class="sourceLine" id="cb680-4" title="4">         dbscan_group,</a>
<a class="sourceLine" id="cb680-5" title="5">         hdbscan_group) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb680-6" title="6"><span class="st">  </span><span class="kw">gather</span>(<span class="op">-</span>x, <span class="op">-</span>y, <span class="dt">key =</span> <span class="st">&quot;method&quot;</span>, <span class="dt">value =</span> <span class="st">&quot;cluster&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: attributes are not identical across measure variables;
## they will be dropped</code></pre>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb682-1" title="1">clustering_group<span class="op">$</span>cluster &lt;-<span class="st"> </span><span class="kw">factor</span>(clustering_group<span class="op">$</span>cluster)</a>
<a class="sourceLine" id="cb682-2" title="2">clustering_group <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb682-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)) <span class="op">+</span></a>
<a class="sourceLine" id="cb682-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>(<span class="kw">aes</span>(<span class="dt">colour =</span> cluster)) <span class="op">+</span></a>
<a class="sourceLine" id="cb682-5" title="5"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>method, <span class="dt">ncol =</span> <span class="dv">2</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb682-6" title="6"><span class="st">  </span><span class="kw">coord_equal</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb682-7" title="7"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-cluster-hbdscan-mcinnes-plot3-1.png" width="768" /></p>
<p>Clairement, le partitionnement avec HDBSCAN donne les meilleurs r√©sultats.</p>
</div>
</div>
<div id="conclusion-sur-le-partitionnement" class="section level3">
<h3><span class="header-section-number">9.3.5</span> Conclusion sur le partitionnement</h3>
<p>Au chapitre <a href="chapitre-visualisation.html#chapitre-visualisation">4</a>, nous avons vu avec le jeu de donn√©es ‚Äúdatasaurus‚Äù que la visualisation peut permettre de d√©tecter des structures en segmentant les donn√©es selon des groupes.</p>
<p><img src="images/07_datasaurus_mix.png" width=400></p>
<p><img src="images/07_datasaurus_facet.png"></p>
<p>Or, si les donn√©es n‚Äô√©taient pas √©tiquet√©es, leur structure serait ind√©tectable avec les algorithmes disponibles actuellement. Le partitionnement permet d‚Äôexplorer des donn√©es, de d√©tecter des tendances et de d√©gager des groupes permettant la prise de d√©cision.</p>
<p>Plusieurs techniques de partitionnement ont √©t√© pr√©sent√©es. Le choix de la technique sera d√©terminante sur la mani√®re dont les groupes seront partitionn√©s. La d√©finition d‚Äôun groupe variant d‚Äôun cas √† l‚Äôautre, il n‚Äôexiste pas de r√®gle pour prescrire une m√©thode ou une autre. La partitionnement hi√©rarchique a l‚Äôavantage de permetre de visualiser comment les groupes s‚Äôagglom√®rent. Parmi les m√©thodes de partitionnement hi√©rarchique disponibles, les m√©thodes bas√©es sur la densit√© permettent une grande flexibilit√©, ainsi qu‚Äôune d√©tection d‚Äôobservations ne faisant partie d‚Äôaucun goupe.</p>
</div>
</div>
<div id="ordination" class="section level2">
<h2><span class="header-section-number">9.4</span> Ordination</h2>
<p>En √©cologie, biologie, agronommie comme en foresterie, la plupart des tableaux de donn√©es comprennent de nombreuses variables: pH, nutriments, climat, esp√®ces ou cultivars, etc. L‚Äôordination vise √† mettre de l‚Äôordre dans des donn√©es dont le nombre √©lev√© de variables peut amener √† des difficult√©s d‚Äôappr√©ciation et d‚Äôinterpr√©taion (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>). Plus pr√©cis√©ment, le terme ordination est utilis√© en √©cologie pour d√©signer les techniques de r√©duction d‚Äôaxe. L‚Äôanalyse en composante principale est probablement la plus connue de ces techniques. Mais de nombreuses techniques d‚Äôordination ont √©t√© d√©velopp√©es au cours des derni√®res ann√©es, chacune ayant ses domaines d‚Äôapplication.</p>
<p>Les techniques de r√©duction d‚Äôaxe permettent de d√©gager l‚Äôinformation la plus importante en projetant une synth√®se des relations entre les observations et entre les variables. Les techniques ne supposant aucune structure <em>a priori</em> sont dites <em>non-contraignantes</em>: elles ne comprennent pas de tests statistiques. √Ä l‚Äôinverse, les ordinations contraignantes lient des variables descriptives avec une ou plusieurs variables pr√©dictives.</p>
<p>La r√©f√©rence en la mati√®re est indiscutablement (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>). Cette section en couvrira quelques unes et vous guidera vers la technique la plus appropri√©e pour vos donn√©es.</p>
<div id="ordination-non-contraignante" class="section level3">
<h3><span class="header-section-number">9.4.1</span> Ordination non contraignante</h3>
<p>Cette section couvrira l‚Äô<strong>analyse en composantes principales</strong> (ACP), l‚Äô<strong>analyse de correspondance</strong> (AC), <strong>l‚Äôanalyse factorielle</strong> (AF) ainsi que l‚Äô<strong>analyse en coordonn√©es principales</strong> (ACoP).</p>
<table>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th>M√©thode</th>
<th>Distance pr√©serv√©e</th>
<th>Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Analyse en composantes principales (ACP)</td>
<td>Distance euclidienne</td>
<td>Donn√©es quantitatives, relations lin√©aires (attention aux double-z√©ros)</td>
</tr>
<tr class="even">
<td>Analyse de correspondance (AC)</td>
<td>Distance de <span class="math inline">\(\chi^2\)</span></td>
<td>Donn√©es non-n√©gatives, dimentionnellement homog√®nes ou binaires, abondance ou occurence</td>
</tr>
<tr class="odd">
<td>Positionnement multidimensionnel (PoMd)</td>
<td>Toute mesure de dissimilarit√©</td>
<td>Donn√©es quantitatives, qualitatives nominales/ordinales ou mixtes</td>
</tr>
</tbody>
</table>
<p>Source: Adapt√© de (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>, chapitre 9)</p>
<div id="analyse-en-composantes-principales" class="section level4">
<h4><span class="header-section-number">9.4.1.1</span> Analyse en composantes principales</h4>
<p>L‚Äôobjectif d‚Äôune ACP est de repr√©senter les donn√©es dans un nombre r√©duit de dimensions repr√©sentant le plus possible la variation d‚Äôun tableau de donn√©es: elle permet de projetter les donn√©es dans un espace o√π les variables sont combin√©es en axes orthogonaux dont le premier axe capte le maximum de variance. L‚ÄôACP peut par exemple √™tre utilis√©e pour analyser des corr√©lations entre variables ou d√©gager l‚Äôinformation la plus pertinente d‚Äôun tableau de donn√©es m√©t√©o ou de signal en un nombre plus retreint de variables.</p>
<p>L‚ÄôACP effectue une rotation des axes √† partir du centre (moyenne) du nuage de points effectu√©e de mani√®re √† ce que le premier axe d√©finisse la direction o√π l‚Äôon retrouve la variance maximale. Ce premier axe est une combinaison lin√©aire des variables et forme la premi√®re composante principale. Une fois cet axe d√©finit, on trouve de deuxi√®me axe, orthogonal au premier, o√π l‚Äôon retouve la variance maximale - cet axe forme la deuxi√®me composante principale, et ainsi de suite jusqu‚Äô√† ce que le nombre d‚Äôaxe corresponde au nombre de variables. Les projections des observations sur ces axes principaux sont appel√©s les <strong>scores</strong>. Les projections des variables sur les axes principaux sont les <strong>vecteurs propres</strong> (<em>eigenvectors</em>, ou <em>loadings</em>). La variance des composantes principales diminue de la premi√®re √† la derni√®re, et peut √™tre calcul√©e comme une proportion de la variance totale: c‚Äôest le <strong>pourcentage d‚Äôinertie</strong>. Par convention, on utilise les <strong>valeurs propres</strong> (<em>eigenvalues</em>) pour mesurer l‚Äôimportance des axes. Si la premi√®re composante principale a une inertie de 50% et la deuxi√®me a une intertie de 30%, la repr√©sentation en 2D des projection repr√©sentera 80% de la variance du nuage de points.</p>
<p>L‚Äôh√©t√©rog√©n√©it√© des √©chelles de mesure peut avoir une grande importance sur les r√©sultats d‚Äôune ACP (les donn√©es doivent √™tre dimensionnellement homog√®nes). En effet, la hauteur d‚Äôun ceriser aura une variance plus grande que le diam√®tre d‚Äôune cerise exprim√© dans les m√™mes unit√©s, et cette derni√®re aura plus de variance que la teneur en cuivre d‚Äôune feuille. Il est cons√©quemment avis√© de mettre les donn√©es √† l‚Äô√©chelle en centrant la moyenne √† z√©ro et l‚Äô√©cart-type √† 1 avant de proc√©der √† une ACP.</p>
<p>L‚ÄôACP a √©t√© con√ßue pour projetter en un nombre moindre de dimensions des observations dont les distributions sont multinormales. Bien que l‚ÄôACP soit une technique robuste, il est pr√©f√©rable de transformer pr√©alablement les variables dont la distribution est particuli√®rement asym√©triques (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012, p.¬†450</a>). Le cas √©ch√©ant, les valeurs extr√™mes pourraient faire d√©vier les vecteurs propres et biaiser l‚Äôanalyse. En particulier, les donn√©es ACP men√©es sur des donn√©es compositionnelles sont r√©put√©es pour g√©n√©rer des analyses biais√©es (<a href="http://sp.lyellcollection.org/content/specpubgsl/264/1/1.full.pdf">Pawlowsky-Glahn and Egozcue, 2006</a>). Le test de Mardia (<a href="https://journal.r-project.org/archive/2014-2/korkmaz-goksuluk-zararsiz.pdf">Korkmaz, 2014</a>) peut √™tre utilis√© pour tester la multinormalit√©. Une distribution multinormale devrait g√©n√©rer des scores en forme d‚Äôhypersph√®re (en forme de cercle sur un biplot: voir plus loin).</p>
<div id="vecteurs-propres-et-valeurs-propres" class="section level5">
<h5><span class="header-section-number">9.4.1.1.1</span> Vecteurs propres et valeurs propres</h5>
<p>Une matrice carr√©e (comme une matrice de covariance <span class="math inline">\(\Sigma\)</span>) multipli√©e par un vecteur propre <span class="math inline">\(e\)</span> est √©gale aux valeurs propres <span class="math inline">\(\lambda\)</span> multipli√©es par les vecteurs propres <span class="math inline">\(e\)</span>.</p>
<p><span class="math display">\[ \Sigma e = \lambda e \]</span></p>
<p>De mani√®re intuitive, les vecteurs propres indiquent l‚Äôorientation de la covariance, et les valeurs propres indique la longueur associ√©e √† cette direction. L‚ÄôACP est bas√©e sur le calcul des vecteurs propres et des valeurs propres de la matrice de covariance des variables. Pour d‚Äôabord obtenir les valeurs propres <span class="math inline">\(\lambda\)</span>, il faut r√©soudre l‚Äô√©quation</p>
<p><span class="math display">\[ det(cov(X) - \lambda I) = 0 \]</span>,</p>
<p>o√π <span class="math inline">\(det\)</span> est l‚Äôop√©ration permettant de calculer le d√©terminant, <span class="math inline">\(cov\)</span> est l‚Äôop√©ration pour calculer la covariance, <span class="math inline">\(X\)</span> est la matrice de donn√©es, <span class="math inline">\(\lambda\)</span> sont les valeurs propres et <span class="math inline">\(I\)</span> est une matrice d‚Äôidentit√©.</p>
<p>Pour <span class="math inline">\(p\)</span> variables dans votre tableau <span class="math inline">\(X\)</span>, vous obtiendrex <span class="math inline">\(p\)</span> valeurs propres. Ensuite, on trouve les vecteurs propres en r√©solvant l‚Äô√©quation $ e = e $.</p>
<p>Bien qu‚Äôil soit possible d‚Äô<a href="https://www.youtube.com/watch?v=2fCBE7DWgd0&amp;list=PLBv09BD7ez_5_yapAg86Od6JeeypkS4YM">effectuer cette op√©ration √† la main</a> pour des cas tr√®s simples, vous aurez avantage √† utiliser un langage de programmation.</p>
<p>Chargeons les donn√©es d‚Äôiris, puis isolons seulement les deux dimensions des s√©pales l‚Äôesp√®ce <em>setosa</em>.</p>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb683-1" title="1"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</a>
<a class="sourceLine" id="cb683-2" title="2">setosa_sepal &lt;-<span class="st"> </span>iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb683-3" title="3"><span class="st">  </span><span class="kw">filter</span>(Species <span class="op">==</span><span class="st"> &quot;setosa&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb683-4" title="4"><span class="st">  </span><span class="kw">select</span>(<span class="kw">starts_with</span>(<span class="st">&quot;Sepal&quot;</span>))</a>
<a class="sourceLine" id="cb683-5" title="5">setosa_sepal</a></code></pre></div>
<pre><code>##    Sepal.Length Sepal.Width
## 1           5.1         3.5
## 2           4.9         3.0
## 3           4.7         3.2
## 4           4.6         3.1
## 5           5.0         3.6
## 6           5.4         3.9
## 7           4.6         3.4
## 8           5.0         3.4
## 9           4.4         2.9
## 10          4.9         3.1
## 11          5.4         3.7
## 12          4.8         3.4
## 13          4.8         3.0
## 14          4.3         3.0
## 15          5.8         4.0
## 16          5.7         4.4
## 17          5.4         3.9
## 18          5.1         3.5
## 19          5.7         3.8
## 20          5.1         3.8
## 21          5.4         3.4
## 22          5.1         3.7
## 23          4.6         3.6
## 24          5.1         3.3
## 25          4.8         3.4
## 26          5.0         3.0
## 27          5.0         3.4
## 28          5.2         3.5
## 29          5.2         3.4
## 30          4.7         3.2
## 31          4.8         3.1
## 32          5.4         3.4
## 33          5.2         4.1
## 34          5.5         4.2
## 35          4.9         3.1
## 36          5.0         3.2
## 37          5.5         3.5
## 38          4.9         3.6
## 39          4.4         3.0
## 40          5.1         3.4
## 41          5.0         3.5
## 42          4.5         2.3
## 43          4.4         3.2
## 44          5.0         3.5
## 45          5.1         3.8
## 46          4.8         3.0
## 47          5.1         3.8
## 48          4.6         3.2
## 49          5.3         3.7
## 50          5.0         3.3</code></pre>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb685-1" title="1"><span class="kw">library</span>(<span class="st">&quot;MVN&quot;</span>)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<pre><code>## sROC 0.1-2 loaded</code></pre>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb688-1" title="1">setosa_sepal_mvn &lt;-<span class="st"> </span><span class="kw">mvn</span>(setosa_sepal, <span class="dt">mvnTest =</span> <span class="st">&quot;mardia&quot;</span>)</a>
<a class="sourceLine" id="cb688-2" title="2">setosa_sepal_mvn<span class="op">$</span>multivariateNormality</a></code></pre></div>
<pre><code>##              Test          Statistic           p value Result
## 1 Mardia Skewness  0.759503524380438 0.943793240544741    YES
## 2 Mardia Kurtosis 0.0934600553610254 0.925538081956867    YES
## 3             MVN               &lt;NA&gt;              &lt;NA&gt;    YES</code></pre>
<p>Pour consid√©rer la distribution comme multinormale, la p-value de la distortion (<code>Mardia Skewness</code>) <strong>et</strong> la statistique de Kurtosis (<code>Mardia Kurtosis</code>) doit √™tre √©gale ou plus √©lev√©e que 0.05 (<a href="https://www.rdocumentation.org/packages/MVN/versions/5.6/topics/mvn">Kormaz, 2019, fiche d‚Äôaide de la fonction <code>mvn</code> de R</a>). C‚Äôest bien le cas pour les donn√©es du tableau <code>setosa_sepal</code>.</p>
<p>Retirons de la matrice de covariance les valeurs et vecteurs propres avec la fonction <code>eigen</code>.</p>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb690-1" title="1">setosa_eigen &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(setosa_sepal))</a>
<a class="sourceLine" id="cb690-2" title="2">setosa_eigenval &lt;-<span class="st"> </span>setosa_eigen<span class="op">$</span>values</a>
<a class="sourceLine" id="cb690-3" title="3">setosa_eigenvec &lt;-<span class="st"> </span>setosa_eigen<span class="op">$</span>vectors</a></code></pre></div>
<p>Le premier vecteur propre correspond √† la premi√®re colonne, et le second √† la deuxi√®me. Les coordonn√©es x et y sont les premi√®res et deuxi√®mes lignes. Les vecteurs propres ont une longueur unitaire (norme de 1). Ils peuvent √™tre mis √† l‚Äô√©chelles √† la racine carr√©e des valeurs propres.</p>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb691-1" title="1">setosa_eigenvec_sc &lt;-<span class="st"> </span>setosa_eigenvec <span class="op">%*%</span><span class="st"> </span><span class="kw">diag</span>(<span class="kw">sqrt</span>(setosa_eigen<span class="op">$</span>values))</a></code></pre></div>
<p>Pour effectuer une translation des vecteurs propres au centre du nuage de point, nous avons besoin du centro√Øde.</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb692-1" title="1">centroid &lt;-<span class="st"> </span>setosa_sepal <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">apply</span>(., <span class="dv">2</span>, mean)</a></code></pre></div>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb693-1" title="1"><span class="kw">plot</span>(setosa_sepal, <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb693-2" title="2"></a>
<a class="sourceLine" id="cb693-3" title="3"><span class="co"># vecteurs propres brutes</span></a>
<a class="sourceLine" id="cb693-4" title="4"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(centroid[<span class="dv">1</span>], centroid[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec[<span class="dv">1</span>, <span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb693-5" title="5">      <span class="dt">y=</span><span class="kw">c</span>(centroid[<span class="dv">2</span>], centroid[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec[<span class="dv">2</span>, <span class="dv">1</span>]), <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>) <span class="co"># vecteur propre 1</span></a>
<a class="sourceLine" id="cb693-6" title="6"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(centroid[<span class="dv">1</span>], centroid[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec[<span class="dv">1</span>, <span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb693-7" title="7">      <span class="dt">y=</span><span class="kw">c</span>(centroid[<span class="dv">2</span>], centroid[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec[<span class="dv">2</span>, <span class="dv">2</span>]), <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">lwd =</span> <span class="dv">3</span>) <span class="co"># vecteur propre 1</span></a>
<a class="sourceLine" id="cb693-8" title="8"></a>
<a class="sourceLine" id="cb693-9" title="9"><span class="co"># vecteurs propres √† l&#39;√©chelle</span></a>
<a class="sourceLine" id="cb693-10" title="10"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(centroid[<span class="dv">1</span>], centroid[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec_sc[<span class="dv">1</span>, <span class="dv">1</span>]),</a>
<a class="sourceLine" id="cb693-11" title="11">      <span class="dt">y=</span><span class="kw">c</span>(centroid[<span class="dv">2</span>], centroid[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec_sc[<span class="dv">2</span>, <span class="dv">1</span>]), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>) <span class="co"># vecteur propre 1</span></a>
<a class="sourceLine" id="cb693-12" title="12"><span class="kw">lines</span>(<span class="dt">x=</span><span class="kw">c</span>(centroid[<span class="dv">1</span>], centroid[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec_sc[<span class="dv">1</span>, <span class="dv">2</span>]),</a>
<a class="sourceLine" id="cb693-13" title="13">      <span class="dt">y=</span><span class="kw">c</span>(centroid[<span class="dv">2</span>], centroid[<span class="dv">2</span>] <span class="op">+</span><span class="st"> </span>setosa_eigenvec_sc[<span class="dv">2</span>, <span class="dv">2</span>]), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>) <span class="co"># vecteur propre 1</span></a>
<a class="sourceLine" id="cb693-14" title="14"></a>
<a class="sourceLine" id="cb693-15" title="15"><span class="kw">points</span>(<span class="dt">x=</span>centroid[<span class="dv">1</span>], <span class="dt">y=</span>centroid[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">col  =</span><span class="st">&quot;blue&quot;</span>) <span class="co"># centroid</span></a></code></pre></div>
<p><img src="_main_files/figure-html/apo-iris-sepal-plot-1.png" width="672" /></p>
<p>On peut observer que, comme je l‚Äôai mentionn√© plus haut, <strong>les vecteurs propres indiquent l‚Äôorientation de la covariance, et les valeurs propres indique la longueur associ√©e √† cette direction</strong>.</p>
</div>
<div id="biplot" class="section level5">
<h5><span class="header-section-number">9.4.1.1.2</span> Biplot</h5>
<p>Imaginez un nuage de points en 3D, axes y compris. Vous tournez votre nuage de points pour trouver la perspective en 2D qui fera en sorte que vos donn√©es soient les plus dispers√©es possibles. Avec une lampe de poche, vous illuminez votre nuage de points dans l‚Äôaxe de cette perspective: vous venez d‚Äôeffectuer une analyse en composantes principales, et l‚Äôombre des points et des axes sur le mur formera votre biplot.</p>
<p>Pour cr√©er un biplot, on juxtapose les descripteurs (variables) en tant que vecteurs propres, repr√©sent√©s par des fl√®ches, et les objets (observations) en tant que scores, repr√©sent√©s par des points. Les r√©sultats d‚Äôune ordination peuvent √™tre pr√©sent√©s selon deux types de biplots (<a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Legendre et Legendre, 2012</a>).</p>
<p><img src="images/07_bipolot-meteo-sc2.svg" /></p>
<center>
Biplot de corr√©lation permettant de visualiser les corr√©lations entre des variables m√©t√©orologiques.
</center>
<p>Deux types de projection sont courramment utilis√©s.</p>
<p><strong>Biplot de distance</strong>. Ce type de projection permet de visualiser la position des objets entre eux et par rapport aux descripteurs et d‚Äôappr√©cier la contribution des descripteurs pour cr√©er les composantes principales. Pour cr√©er un biplot de distance, on projette directement les vecteurs propres (<span class="math inline">\(U\)</span>) en guise de descripteurs. Pour ce qui est des objets, on utilise les scores de l‚ÄôACP (<span class="math inline">\(F\)</span>). De cette mani√®re,</p>
<ol style="list-style-type: decimal">
<li>les distances euclidiennes entre les scores sont des approximations des distances euclidiennes dans l‚Äôespace multidimentionnel,</li>
<li>la projection d‚Äôun objet sur un descripteur perpendiculairement √† ce dernier est une approximation de la position de l‚Äôobjet sur le descripteur et</li>
<li>la projection d‚Äôun descripteur sur un axe principal est proportionnelle √† sa contribution pour g√©n√©rer l‚Äôaxe.</li>
</ol>
<p><strong>Biplot de corr√©lation</strong>. Cette projection permet d‚Äôappr√©cier les corr√©lations entre les descripteurs. Pour ce faire, les objets et les valeurs propres doivent √™tre transform√©s. Pour g√©n√©rer les descripteurs, les vecteurs propres (<span class="math inline">\(U\)</span>) doivent √™tre multipli√©s par la matrice diagonalis√©e de la racine carr√©e des valeurs propres (<span class="math inline">\(\Lambda\)</span>), c‚Äôest-√†-dire <span class="math inline">\(U \Lambda ^{\frac{1}{2}}\)</span>. En ce qui a trait aux objets, on multiplie les scores par (<span class="math inline">\(F\)</span>) par la racine carr√©e n√©gative des valeurs propres diagonalis√©es, c‚Äôest-√†-dire <span class="math inline">\(F \Lambda ^{- \frac{1}{2}}\)</span>. De cette mani√®re,</p>
<ol style="list-style-type: decimal">
<li>tout comme c‚Äôest le cas pour le biplot de distance, la projection d‚Äôun objet sur un descripteur perpendiculairement √† ce dernier est une approximation de la position de l‚Äôobjet sur le descripteur,</li>
<li>la projection d‚Äôun descripteur sur un axe principal est proportionnelle √† son √©cart-type et</li>
<li>les <strong>angles</strong> entre les descripteurs sont proportionnelles √† leur corr√©lation (et non pas leur proximit√©).</li>
</ol>
<p>En d‚Äôautres mots, le bilot de distances devrait √™tre utilis√© pour appr√©cier la distance entre les objets et le biplot de corr√©lation devrait √™tre utilis√© pour appr√©cier les corr√©lations entre les descripteurs. Mais dans tous les cas, <strong>le type de biplot utilis√© doit √™tre indiqu√©</strong>.</p>
<p>Le <em>triplot</em> est une forme apparent√©e au biplot, auquel on ajoute des variables pr√©dictives. Le triplot est utile pour repr√©senter les r√©sultats des ordinations contraignantes comme les analyses de redondance et les analyse de correspondance canoniques.</p>
</div>
<div id="application-3" class="section level5">
<h5><span class="header-section-number">9.4.1.1.3</span> Application</h5>
<p>Bien que l‚ÄôACP puisse √™tre effectu√©e gr√¢ce √† des modules de base de R, nous utiliserons le module vegan. Le tableau <a href="https://rdrr.io/rforge/vegan/man/varechem.html"><code>varechem</code></a> comprend des donn√©es issues d‚Äôanalyse de sols identifi√©s par leur composition chimique, leur pH, leur profondeur totale et la profondeur de l‚Äôhumus publi√©es dans <a href="http://onlinelibrary.wiley.com/doi/10.2307/3236351/abstract">V√§re et al.¬†(1995)</a> et export√©es du module <a href="https://rdrr.io/rforge/vegan/">vegan</a>.</p>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb694-1" title="1"><span class="kw">library</span>(<span class="st">&quot;vegan&quot;</span>)</a>
<a class="sourceLine" id="cb694-2" title="2"><span class="kw">data</span>(<span class="st">&quot;varechem&quot;</span>)</a>
<a class="sourceLine" id="cb694-3" title="3">varechem <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb694-4" title="4"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>##      N    P     K    Ca   Mg    S    Al    Fe    Mn   Zn  Mo Baresoil Humdepth  pH
## 1 26.6 36.7 171.4 738.6 94.9 33.8  20.7   2.5  77.6  7.4 0.3     23.0      2.8 2.8
## 2 26.2 61.9 202.2 741.2 86.3 48.6 124.3  23.6  94.5 10.2 0.6     56.9      2.5 2.9
## 3 22.8 50.6 151.7 648.0 64.8 30.2  12.1   2.3 122.9  8.1 0.2     23.7      2.6 2.9
## 4 18.0 64.9 224.5 517.6 59.7 52.9 435.1 101.2  38.0  9.5 1.1     21.3      1.8 2.9
## 5 19.1 26.4  61.1 259.1 37.0 21.4 155.1  81.4  20.6  4.0 0.6      5.8      1.9 3.0</code></pre>
<p>Comme nous l‚Äôavons vu pr√©cdemment, les donn√©es de concentration sont de type <em>compositionnelles</em>. Les donn√©es compositionnelles du tableau <code>varechem</code> m√©riteraient d‚Äô√™tre transform√©es (<a href="http://doi.wiley.com/10.1111/1467-9876.00275">Aitchison et Greenacre, 2002</a>). Utilisons les log-ratios centr√©s (<em>clr</em>).</p>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb696-1" title="1"><span class="kw">library</span>(<span class="st">&quot;compositions&quot;</span>)</a>
<a class="sourceLine" id="cb696-2" title="2">varecomp &lt;-<span class="st"> </span>varechem <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb696-3" title="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>Baresoil, <span class="op">-</span>Humdepth, <span class="op">-</span>pH) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb696-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Fv =</span> <span class="kw">apply</span>(., <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fl">1e6</span> <span class="op">-</span><span class="st"> </span><span class="kw">sum</span>(x)))</a>
<a class="sourceLine" id="cb696-5" title="5">vareclr &lt;-<span class="st"> </span>varecomp <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb696-6" title="6"><span class="st">  </span><span class="kw">acomp</span>(.) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb696-7" title="7"><span class="st">  </span><span class="kw">clr</span>(.) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb696-8" title="8"><span class="st">  </span><span class="kw">as_tibble</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb696-9" title="9"><span class="st">  </span><span class="kw">bind_cols</span>(varechem <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb696-10" title="10"><span class="st">              </span><span class="kw">select</span>(Baresoil, Humdepth, pH))</a>
<a class="sourceLine" id="cb696-11" title="11">vareclr <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb696-12" title="12"><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 15
##        N      P     K    Ca      Mg      S    Al      Fe     Mn    Zn    Mo    Fv Baresoil
##    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;
## 1 -1.34  -0.760 0.673  2.07  0.549  -0.762 0.181 -1.60   -0.696 -2.26 -5.39  9.34     40.5
## 2 -1.37  -0.655 0.697  2.01 -0.0269 -0.705 0.547 -1.89   -0.869 -2.35 -5.06  9.67     11.2
## 3 -0.773 -0.988 0.175  1.05 -0.174  -0.960 1.50   0.628  -1.88  -3.09 -5.11  9.62     18.6
## 4 -0.871 -0.623 0.872  1.92 -0.244  -0.757 0.250 -1.77   -0.862 -2.41 -5.26  9.76     29.8
## 5 -1.68  -0.469 0.833  2.57  0.347  -0.910 1.04   0.0773 -1.27  -2.39 -7.49  9.32      7.6
## # ... with 2 more variables: Humdepth &lt;dbl&gt;, pH &lt;dbl&gt;</code></pre>
<p>Effectuons l‚ÄôACP. Pour cet exemple, nous standardiserons les donn√©es √©tant donn√©es que les colonnes Baresoil, Humedepth et pH ne sont pas √† la m√™me √©chelle que les colonnes des clr.</p>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb698-1" title="1">vareclr_sc &lt;-<span class="st"> </span><span class="kw">scale</span>(vareclr)</a>
<a class="sourceLine" id="cb698-2" title="2">vare_pca &lt;-<span class="st"> </span><span class="kw">rda</span>(vareclr_sc) <span class="co"># ou bien rda(vareclr, scale = TRUE, mais la mise √† l&#39;√©chelle pr√©alable est plus explicite)</span></a></code></pre></div>
<p>L‚Äôobjet <code>vareclr_pca</code> contient l‚Äôinformation n√©cessaire pour mener notre ACP.</p>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb699-1" title="1"><span class="kw">summary</span>(vare_pca, <span class="dt">scaling =</span> <span class="dv">2</span>) <span class="co"># scaling = 2 pour obtenir les infos pour les biplots de corr√©lation</span></a></code></pre></div>
<pre><code>## 
## Call:
## rda(X = vareclr_sc) 
## 
## Partitioning of variance:
##               Inertia Proportion
## Total              15          1
## Unconstrained      15          1
## 
## Eigenvalues, and their contribution to the variance 
## 
## Importance of components:
##                          PC1    PC2    PC3     PC4     PC5     PC6     PC7     PC8     PC9
## Eigenvalue            7.1523 2.4763 2.1122 0.93015 0.57977 0.48786 0.36646 0.29432 0.19686
## Proportion Explained  0.4768 0.1651 0.1408 0.06201 0.03865 0.03252 0.02443 0.01962 0.01312
## Cumulative Proportion 0.4768 0.6419 0.7827 0.84473 0.88338 0.91590 0.94034 0.95996 0.97308
##                          PC10     PC11     PC12     PC13      PC14
## Eigenvalue            0.15434 0.107357 0.095635 0.042245 0.0042200
## Proportion Explained  0.01029 0.007157 0.006376 0.002816 0.0002813
## Cumulative Proportion 0.98337 0.990527 0.996902 0.999719 1.0000000
## 
## Scaling 2 for species and site scores
## * Species are scaled proportional to eigenvalues
## * Sites are unscaled: weighted dispersion equal on all dimensions
## * General scaling constant of scores:  4.309777 
## 
## 
## Species scores
## 
##              PC1     PC2     PC3      PC4        PC5       PC6
## N         0.1437  0.7606 -0.6792  0.19837  0.1128526 -0.050149
## P         0.8670 -0.3214 -0.2950 -0.22940  0.1437960 -0.042884
## K         0.9122 -0.3857  0.2357  0.03469  0.2737020  0.075717
## Ca        0.9649 -0.3362 -0.2147  0.17757 -0.2188717  0.008051
## Mg        0.8263 -0.2723  0.1035  0.52135 -0.1495399 -0.342214
## S         0.8825 -0.3169  0.3539 -0.21216  0.1176279 -0.191386
## Al       -1.0105 -0.2442  0.2146  0.02674 -0.1005560 -0.043569
## Fe       -1.0338 -0.2464  0.1492  0.13162  0.1512218  0.081571
## Mn        0.9556  0.1041 -0.1256 -0.21300  0.2565831  0.275275
## Zn        0.7763 -0.1031 -0.3123 -0.36493 -0.5665691  0.153089
## Mo       -0.2152  0.8717  0.4065 -0.33643 -0.2134335 -0.167725
## Fv        0.2360  0.5776 -0.8112  0.12736  0.1280097 -0.109737
## Baresoil  0.5147  0.4210  0.4472  0.54980 -0.1438570  0.463148
## Humdepth  0.7455  0.4379  0.5194  0.16493  0.0004757 -0.273056
## pH       -0.5754 -0.5864 -0.5957  0.23408 -0.1517661 -0.056641
## 
## 
## Site scores (weighted sums of species scores)
## 
##            PC1       PC2      PC3      PC4      PC5      PC6
## sit1   0.16862  0.423777  0.46731  0.91175  1.10380  1.06421
## sit2  -0.09705 -0.097482  0.61143 -0.29049  1.14916  0.40622
## sit3   0.02831 -0.795737  0.74176 -0.19097 -2.43337 -0.81762
## sit4   1.39081 -0.354376 -0.19377 -0.45160  0.46020 -0.31446
## sit5   1.30346  0.357866  0.29887  0.76856  0.20913 -0.64145
## sit6   0.43636  0.495037  1.21722  1.18128 -0.98242 -0.74474
## sit7   1.07306  0.467575 -0.32245  0.03717  0.13956 -0.64972
## sit8   0.02545  0.659714 -0.28861 -0.01424  0.47105  0.45173
## sit9   1.42005  0.007356 -0.29000 -0.78474  0.97592 -0.80263
## sit10 -0.50638 -0.220909  1.52981  0.26289  0.42135  0.94054
## sit11  0.45392  0.649297  0.44573 -0.26620 -0.74522 -0.53228
## sit12  0.18623  0.259640  0.89112  0.21096 -0.51393  2.24361
## sit13  1.26264  0.225744 -0.96668 -0.69334  0.61990  0.43312
## sit14 -1.48685  0.739545 -0.20926  1.09256  0.61856 -0.87999
## sit15 -0.50622  1.108685 -2.61287 -1.00433 -1.35383  1.21964
## sit16 -1.28653  0.898663 -0.38778 -0.47556 -0.02449 -0.29419
## sit17 -1.72773  0.476962 -0.48878  0.71156  1.06398 -1.33473
## sit18 -0.82844 -0.296515  1.20315 -1.49821 -0.18330  1.05231
## sit19 -1.00247 -0.609253  0.25185 -0.85420  0.71031  0.14854
## sit20 -0.43405 -0.338912  0.55348 -1.35776 -0.81986 -1.02468
## sit21 -0.05083  0.122645 -0.04611 -0.56047 -0.26151 -0.98053
## sit22  0.17891 -2.315489 -0.69084 -0.19547  0.80628  0.04291
## sit23 -0.46443 -2.592018 -1.21615  1.56359 -0.62334  0.28748
## sit24  0.46316  0.728185 -0.49843  1.89726 -0.80791  0.72671</code></pre>
<p>La deuxi√®me ligne de <code>Importance of components</code>, <code>Proportion Explained</code>, indique la proportion de la variance totale capt√©e successivement par les axes principaux. Le premier axe principal comporte 47.68% de la variance. Le deuxi√®me axe principal ajoutant une proportion de 16,51%, une repr√©sentation en deux axes principaux pr√©sentent 64.19 % de la variance.</p>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb701-1" title="1">prop_expl &lt;-<span class="st"> </span>vare_pca<span class="op">$</span>CA<span class="op">$</span>eig <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig)</a>
<a class="sourceLine" id="cb701-2" title="2">prop_expl</a></code></pre></div>
<pre><code>##          PC1          PC2          PC3          PC4          PC5          PC6          PC7 
## 0.4768180610 0.1650859388 0.1408156459 0.0620101490 0.0386511040 0.0325238535 0.0244303815 
##          PC8          PC9         PC10         PC11         PC12         PC13         PC14 
## 0.0196215021 0.0131238464 0.0102890284 0.0071571089 0.0063756951 0.0028163495 0.0002813359</code></pre>
<p>La d√©cision du nombre d‚Äôaxes principaux √† retenir est arbitraire. Elle peut d√©pendre d‚Äôun nombre maximal de param√®tre √† retenir pour √©viter de surdimensionner un mod√®le (<em>curse of dimensionality</em>, section 11) ou d‚Äôun seuil de pourcentage de variance minimal √† retenir, par exemple 75%. Ou bien, vous retiendrez deux composantes principales si vous d√©sirez pr√©senter un seul biplot.</p>
<p>L‚Äôapproche de <em>Kaiser-Guttmann</em> (<a href="http://www.springer.com/us/book/9781441979759">Borcard et al., 2011</a>) consiste √† s√©lectionner les composantes principales dont la valeur propre est sup√©rieure √† leur moyenne.</p>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb703-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig),</a>
<a class="sourceLine" id="cb703-2" title="2">     <span class="dt">y =</span> vare_pca<span class="op">$</span>CA<span class="op">$</span>eig,</a>
<a class="sourceLine" id="cb703-3" title="3">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb703-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb703-5" title="5">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>)</a>
<a class="sourceLine" id="cb703-6" title="6"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varechem-pca-kaiser-1.png" width="672" /></p>
<p>L‚Äôapproche du <em>broken stick</em> consiste √† couper un b√¢ton d‚Äôune longueur de 1 en n tranches. La premi√®re tranche est de longueur <span class="math inline">\(\frac{1}{n}\)</span>. La tranche suivante est d‚Äôune longueur de la tranche pr√©c√©dente √† laquelle on aditionne <span class="math inline">\(\frac{1}{longueur~restante}\)</span>. Puis on place les longueurs en ordre d√©croissant. On retient les composantes principales dont les valeurs propres cumul√©es sont plus grandes que le broken stick.</p>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb704-1" title="1">broken_stick &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb704-2" title="2">  bsm &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;numeric&quot;</span>, <span class="dt">length =</span> x)</a>
<a class="sourceLine" id="cb704-3" title="3">  bsm[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>x</a>
<a class="sourceLine" id="cb704-4" title="4">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>x) {</a>
<a class="sourceLine" id="cb704-5" title="5">    bsm[i] &lt;-<span class="st"> </span>bsm[i<span class="dv">-1</span>] <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(x<span class="op">+</span><span class="dv">1</span><span class="op">-</span>i)</a>
<a class="sourceLine" id="cb704-6" title="6">  }</a>
<a class="sourceLine" id="cb704-7" title="7">  bsm &lt;-<span class="st"> </span><span class="kw">rev</span>(bsm<span class="op">/</span>x)</a>
<a class="sourceLine" id="cb704-8" title="8">  <span class="kw">return</span>(bsm)</a>
<a class="sourceLine" id="cb704-9" title="9">}</a></code></pre></div>
<p>Le graphique du <em>broken stick</em>:</p>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb705-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig),</a>
<a class="sourceLine" id="cb705-2" title="2">     <span class="dt">y =</span> prop_expl,</a>
<a class="sourceLine" id="cb705-3" title="3">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb705-4" title="4">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb705-5" title="5">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>)</a>
<a class="sourceLine" id="cb705-6" title="6"><span class="kw">lines</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig),</a>
<a class="sourceLine" id="cb705-7" title="7">      <span class="dt">y =</span> <span class="kw">broken_stick</span>(<span class="kw">length</span>(vare_pca<span class="op">$</span>CA<span class="op">$</span>eig)),</a>
<a class="sourceLine" id="cb705-8" title="8">      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb705-9" title="9">      <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varechem-pca-bs-plot-1.png" width="672" /></p>
<p>Les approches <em>Kaiser-Guttmann</em> et <em>broken stick</em> sugg√®rent que les trois premi√®res composantes sont suffisantes pour d√©crire la dispersion des donn√©es.</p>
<p>Examinons les <em>loadings</em> (vecteurs propres) plus en particulier. Dans le langage du module vegan, les vecteurs propres sont les esp√®ces (<code>species</code>) et les scores sont les <code>sites</code>.</p>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb706-1" title="1">vare_eigenvec &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(vare_pca, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">display =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">choices =</span> <span class="dv">1</span><span class="op">:</span>(<span class="kw">ncol</span>(vareclr)<span class="op">-</span><span class="dv">1</span>))</a>
<a class="sourceLine" id="cb706-2" title="2">vare_eigenvec</a></code></pre></div>
<pre><code>##                 PC1        PC2        PC3        PC4           PC5          PC6         PC7
## N         0.1437343  0.7606006 -0.6792046  0.1983670  0.1128526122 -0.050148980 -0.09111164
## P         0.8669892 -0.3213683 -0.2949864 -0.2294036  0.1437959857 -0.042883754  0.26894062
## K         0.9122089 -0.3857245  0.2356904  0.0346904  0.2737019601  0.075717162 -0.21662612
## Ca        0.9648855 -0.3361651 -0.2147486  0.1775746 -0.2188716732  0.008050762  0.03630015
## Mg        0.8263327 -0.2723055  0.1035276  0.5213484 -0.1495399242 -0.342213793  0.04617838
## S         0.8824519 -0.3169039  0.3538854 -0.2121562  0.1176278503 -0.191386377 -0.26825994
## Al       -1.0105173 -0.2441785  0.2145614  0.0267422 -0.1005559874 -0.043569364 -0.22737412
## Fe       -1.0337676 -0.2463987  0.1491865  0.1316173  0.1512218115  0.081571443  0.10553041
## Mn        0.9555632  0.1041030 -0.1256178 -0.2130047  0.2565830557  0.275275174  0.20224538
## Zn        0.7763480 -0.1030878 -0.3122919 -0.3649341 -0.5665691228  0.153089144 -0.12332232
## Mo       -0.2152399  0.8717229  0.4064967 -0.3364279 -0.2134335302 -0.167725160  0.13788948
## Fv        0.2360040  0.5775863 -0.8111953  0.1273582  0.1280096553 -0.109737235 -0.20911147
## Baresoil  0.5147445  0.4209983  0.4472351  0.5497950 -0.1438569673  0.463148072 -0.02103009
## Humdepth  0.7455213  0.4379436  0.5193895  0.1649306  0.0004756685 -0.273056212  0.17061078
## pH       -0.5753858 -0.5863743 -0.5957495  0.2340826 -0.1517660977 -0.056640816  0.19890884
##                  PC8          PC9        PC10         PC11         PC12        PC13
## N        -0.06122008  0.315645453  0.08090232 -0.019251478  0.045420621  0.05020956
## P         0.34111276  0.021124287  0.08756299 -0.045741546  0.145128883 -0.03337551
## K        -0.01641260  0.143099440 -0.08737113  0.183005607  0.002260341 -0.10566808
## Ca        0.04775616 -0.073609828 -0.10601799  0.161460554  0.041210064  0.14341793
## Mg       -0.12098602 -0.051599273  0.18373857 -0.009862571 -0.063493608 -0.03782662
## S         0.15822845  0.038378858  0.05100717 -0.138785063 -0.117144869  0.06075094
## Al        0.10598673  0.040586196 -0.14473132 -0.089462074  0.058212507  0.01983102
## Fe       -0.09254655 -0.079426433  0.09908706 -0.006376211  0.049837173 -0.01169516
## Mn       -0.19347804 -0.038859808 -0.07637994 -0.083300112 -0.133353213  0.02679781
## Zn       -0.14862229  0.024026151  0.02643462 -0.064973307  0.051057277 -0.06538348
## Mo        0.17165900  0.032981311  0.01419924  0.128814989 -0.114803631 -0.01989539
## Fv        0.11289753 -0.281443886 -0.08391004 -0.012456867 -0.020157331 -0.05448619
## Baresoil  0.23028292  0.004554036  0.02604286 -0.061147847 -0.019696758 -0.01640490
## Humdepth -0.11310394  0.027515405 -0.23068827 -0.102189307  0.109293684 -0.02485030
## pH        0.12152266  0.150118818 -0.15240317 -0.037691048 -0.153813168 -0.04523353
##                  PC14
## N         0.002340519
## P        -0.010109130
## K         0.001169065
## Ca        0.007419161
## Mg       -0.023575986
## S         0.025874035
## Al       -0.037901576
## Fe        0.036048221
## Mn       -0.021373612
## Zn        0.010896560
## Mo       -0.001335923
## Fv        0.005707928
## Baresoil  0.003823725
## Humdepth  0.016559206
## pH        0.014193061
## attr(,&quot;const&quot;)
## [1] 4.309777</code></pre>
<p>L‚Äôordre d‚Äôimportance des vecteurs propres est √©tabli en ordre croissant des √©l√©ment des vecteurs propres associ√©es. Un vecteur propre est une combinaison lin√©aire des variables. Par exemple, le premier vecteur propre pointe surtout dans la direction du Fe (-1.497) et de l‚ÄôAl (-1.463). Le deuxi√®me pointe surtout vers le Mo (2.145). Les vecteurs (<em>loadings</em>) d‚Äôun biplot de distance pr√©sentant les des deux premi√®res composantes principales prendront les coordonn√©es des deux premi√®res colonnes. Le vecteur Al aura la coordonn√©e [-1.463 ; -0.601], le vecteur de Fe sera plac√© √† [-1.497 ; -0.606] et le vecteur Mo √† [-0.312 ; 2.145]. Il existe diff√©rentes fonctions d‚Äôaffichage des biplots. Notez que leur longueur peut √™tre magnifi√©e pour am√©liorer la visualisation.</p>
<p>Lan√ßons la fonction <code>biplot</code> pour cr√©er un biplot de distance et un autre de corr√©lation.</p>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb708-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb708-2" title="2"><span class="kw">biplot</span>(vare_pca, <span class="dt">scaling =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Biplot de distance&quot;</span>)</a>
<a class="sourceLine" id="cb708-3" title="3"><span class="kw">biplot</span>(vare_pca, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;Biplot de corr√©lation&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varechem-pca-biplots-1.png" width="672" /></p>
<p>Le biplot de distance permet de d√©gager les variables qui expliquent davantage la variabilit√© dans notre tableau: les clr du Fe et de l‚ÄôAl forment en grande partie le premier axe principal, alors que le clr du Mo forme en grande partie le second axe. Le biplot de corr√©lation montre que les clr du Fe et du Al sont corr√©l√©s dans le m√™me sens, mais das le sens contraire du clr du Mn. L‚Äôinformation sur la teneur en Fe et celle de l‚ÄôAl est en grande partie redondante. Toutefois, le clr du Mo est presque ind√©pendant du clr du Fe, ceux-ci √©tant √† angle presque droit (~90¬∞). Ces relations peuvent √™tre explor√©es directement.</p>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb709-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb709-2" title="2"><span class="kw">plot</span>(vareclr<span class="op">$</span>Al, vareclr<span class="op">$</span>Fe)</a>
<a class="sourceLine" id="cb709-3" title="3"><span class="kw">plot</span>(vareclr<span class="op">$</span>Mo, vareclr<span class="op">$</span>Fe)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varechem-pca-al-fe-mo-1.png" width="672" /></p>
<p>Nous avons mentionn√© que l‚ÄôACP est une rotation. Prenons un second exemple pour bien en saisir les tenants et aboutissants. Le tableau de donn√©es que nous chargerons provient d‚Äôun infographie d‚Äôun dauphin, intitull√©e <em>Bottlenose Dolphin</em>, con√ßu par l‚Äôartiste <a href="https://www.blendswap.com/blends/view/83681">Tarnyloo</a>. Les points correspondent √† la surface d‚Äôun dauphin. J‚Äôai ajout√© une colonne <code>anatomy</code>, qui indique √† quelle partie anatomique le point appartient.</p>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb710-1" title="1">dolphin &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/07_dolphin.csv&quot;</span>)</a></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   x = col_double(),
##   y = col_double(),
##   z = col_double(),
##   anatomy = col_character()
## )</code></pre>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb712-1" title="1">dolphin <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">sample_n</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>## # A tibble: 5 x 4
##         x      y        z anatomy   
##     &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;     
## 1 -0.440   1.06   1.24    Caudal fin
## 2  0.0360 -0.494 -0.198   Head      
## 3 -0.177  -0.324  0.00479 Head      
## 4  0.0921 -0.436 -0.0795  Head      
## 5 -0.333   1.07   1.23    Caudal fin</code></pre>
<p>Voici en vue isom√©trique ce en quoi consiste ce nuage de points.</p>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb714-1" title="1"><span class="kw">library</span>(<span class="st">&quot;scatterplot3d&quot;</span>)</a>
<a class="sourceLine" id="cb714-2" title="2"><span class="kw">scatterplot3d</span>(<span class="dt">x =</span> dolphin<span class="op">$</span>x, <span class="dt">y =</span> dolphin<span class="op">$</span>y, <span class="dt">z =</span> dolphin<span class="op">$</span>z, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex.symbols =</span> <span class="fl">0.2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-pca-dauphin-3d-1.png" width="672" /></p>
<p>Effectuons l‚ÄôACP sur le dauphin.</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb715-1" title="1">dolph_pca &lt;-<span class="st"> </span><span class="kw">rda</span>(dolphin <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(x, y, z), <span class="dt">scale =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb715-2" title="2"><span class="kw">biplot</span>(dolph_pca, <span class="dt">scaling =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-pca-dauphin-biplot-1.png" width="672" /></p>
<p>On n‚Äôy voit pas grand chose, mais si l‚Äôon extrait les scores et que l‚Äôon raccourcit les vecteurs:</p>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb716-1" title="1">dolph_scores &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(dolph_pca, <span class="dt">display =</span> <span class="st">&quot;sites&quot;</span>)</a>
<a class="sourceLine" id="cb716-2" title="2">dolph_loads &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(dolph_pca, <span class="dt">display =</span> <span class="st">&quot;species&quot;</span>)</a>
<a class="sourceLine" id="cb716-3" title="3">dolph_loads</a></code></pre></div>
<pre><code>##           PC1         PC2
## x -0.02990131  0.01608095
## y -7.13731672 -1.43221776
## z -4.56612084  2.23859843
## attr(,&quot;const&quot;)
## [1] 9.089026</code></pre>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb718-1" title="1"><span class="kw">plot</span>(dolph_scores, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.24</span>, <span class="dt">asp =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">factor</span>(dolphin<span class="op">$</span>anatomy))</a>
<a class="sourceLine" id="cb718-2" title="2"><span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>), <span class="dt">y0 =</span> <span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">3</span>),</a>
<a class="sourceLine" id="cb718-3" title="3">         <span class="dt">x =</span> dolph_loads[, <span class="dv">1</span>]<span class="op">/</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb718-4" title="4">         <span class="dt">y =</span> dolph_loads[, <span class="dv">2</span>]<span class="op">/</span><span class="dv">50</span>,</a>
<a class="sourceLine" id="cb718-5" title="5">         <span class="dt">col =</span> <span class="st">&quot;chocolate&quot;</span>, <span class="dt">lwd =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-pca-dauphin-biplot2-1.png" width="672" /></p>
<p>La meilleure repr√©sentation du dauphin en 2D, selon la variance, est son profil - en effet, il est plus long et haut que large.</p>
<div class="alert alert-block alert-info">
<strong>Note</strong>. Une ACP effectue seulement une rotation des points. Les distances euclidiennes entre les points sont maintenues.
</div>
<div class="alert alert-block alert-info">
<strong>Note</strong>. L‚ÄôACP a √©t√© con√ßue pour projetter en un nombre moindre de dimensions des observations dont les distributions sont multinormales (ce n‚Äôest √©videmment pas le cas du dauphin).
</div>
<div class="alert alert-block alert-info">
<strong>Note</strong>. Les axes principaux d‚Äôune ACP sont des variables al√©atoires. Elles peuvent √™tre assujetties √† des tests ststistiques, des mod√®les, du partitionnement de donn√©es, etc.
</div>
<div class="alert alert-block alert-success">
<strong>Excercice</strong>. Effectuez maintenant une ACP avec les donn√©es d‚Äôiris.
</div>
</div>
</div>
<div id="analyse-de-correspondance-ac" class="section level4">
<h4><span class="header-section-number">9.4.1.2</span> Analyse de correspondance (AC)</h4>
<p>L‚Äôanalyse de correspondance (AC) est particuli√®rement appropri√©e pour traiter des donn√©es d‚Äôabondance et d‚Äôoccurence. Tout comme l‚Äôanalyse en composantes principales, les donn√©es apport√©s vers une AC doivent √™tre dimensionnellement homog√®nes, c‚Äôest-√†-dire que chaque variable doit √™tre de m√™me m√©trique: pour des donn√©es d‚Äôabondance, cela signifie que les d√©comptes r√©f√®rent tous au m√™me concept: individus, colonies, surfaces occup√©es, etc. Alors que la distance euclidienne est pr√©serv√©e avec l‚ÄôACP, l‚ÄôAC pr√©serve la distance du <span class="math inline">\(\chi^2\)</span>, qui est insensible aux double-z√©ros.</p>
<p>L‚ÄôAC produit <span class="math inline">\(min(n,p)-1\)</span> axes principaux orthogonaux qui captent non pas le maximum de variance, mais la proportion de mesures aux carr√© par rapport √† la somme des carr√©s de la matrice. Le biplot obtenu peut √™tre pr√©sent√© sous forme de biplot de site (<em>scaling 1</em>), o√π la distance du <span class="math inline">\(\chi^2\)</span> est pr√©serv√©e entre les sites ou biplot d‚Äôesp√®ces (<em>scaling 2</em>), ou la distance du <span class="math inline">\(\chi^2\)</span> est pr√©serv√©e entre les esp√®ces. L‚ÄôAC h√©rite du coup une propri√©t√© importate de la distance du <span class="math inline">\(\chi^2\)</span>, qui accorde davantage de distance entre un compte de 0 et de 1 qu‚Äôentre 1 et 2, et davantage entre 1 et 2 qu‚Äôentre 2 et 3.</p>
<p>Par exemple, sur ces trois sites, on a compt√© un individu A de moins que d‚Äôindividu B.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb719-1" title="1">abundance_<span class="dv">0123</span> =<span class="st"> </span><span class="kw">tibble</span>(<span class="dt">Site =</span> <span class="kw">c</span>(<span class="st">&quot;Site 1&quot;</span>, <span class="st">&quot;Site 2&quot;</span>, <span class="st">&quot;Site 3&quot;</span>),</a>
<a class="sourceLine" id="cb719-2" title="2">                        <span class="dt">A =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">9</span>),</a>
<a class="sourceLine" id="cb719-3" title="3">                        <span class="dt">B =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">10</span>))</a>
<a class="sourceLine" id="cb719-4" title="4">abundance_<span class="dv">0123</span></a></code></pre></div>
<pre><code>## # A tibble: 3 x 3
##   Site       A     B
##   &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt;
## 1 Site 1     0     1
## 2 Site 2     1     2
## 3 Site 3     9    10</code></pre>
<p>Pourtant, la distance du <span class="math inline">\(\chi^2\)</span> est plus √©lev√©e entre le site 1 et le site 2 qu‚Äôentre le site 2 et le site 3.</p>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb721-1" title="1"><span class="kw">dist</span>(<span class="kw">decostand</span>(abundance_<span class="dv">0123</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Site), <span class="dt">method=</span><span class="st">&quot;chi.square&quot;</span>))</a></code></pre></div>
<pre><code>##           1         2
## 2 0.6724111          
## 3 0.9555316 0.2831205</code></pre>
<p>La distance du <span class="math inline">\(\chi^2\)</span> donne davantage d‚Äôimportance aux esp√®ces rares, ce dont une analyse doit tenir compte. Il pourrait √™tre envisageable de retirer d‚Äôun tableau des esp√®ces rare, ou bien pr√©transformer des donn√©es d‚Äôabondance par une transformation de chord ou de Hellinger (tel que discut√© au chapitre 6), puis proc√©der √† une ACP sur ces donn√©es (<a href="https://doi.org/10.1007/s004420100716">Legendre et Gallagher, 2001</a>).</p>
<div id="application-4" class="section level5">
<h5><span class="header-section-number">9.4.1.2.1</span> Application</h5>
<p>Le tableau <a href="https://rdrr.io/rforge/vegan/man/varechem.html"><code>varespec</code></a> comprend des donn√©es de surface de couverture de 44 esp√®ces de plantes en lien avec les donn√©es environnementales du tableau <code>varechem</code>. Ces donn√©es ont √©t√© publi√©es dans <a href="http://onlinelibrary.wiley.com/doi/10.2307/3236351/abstract">V√§re et al.¬†(1995)</a> et export√©es du module <a href="https://rdrr.io/rforge/vegan/">vegan</a>.</p>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb723-1" title="1"><span class="kw">data</span>(<span class="st">&quot;varespec&quot;</span>)</a>
<a class="sourceLine" id="cb723-2" title="2">varespec <span class="op">%&gt;%</span><span class="kw">sample_n</span>(<span class="dv">5</span>)</a></code></pre></div>
<pre><code>##   Callvulg Empenigr Rhodtome Vaccmyrt Vaccviti Pinusylv Descflex Betupube Vacculig Diphcomp
## 1     0.03     3.65     0.00     0.00     4.43     0.00     0.00        0     1.65     0.50
## 2     0.00     1.63     0.35    18.27     7.13     0.05     0.40        0     0.20     0.00
## 3     3.75     5.65     0.00     0.08     5.30     0.10     0.00        0     0.00     0.00
## 4     3.40     0.63     0.00     0.00     1.98     0.05     0.05        0     0.03     0.00
## 5     0.00     5.30     0.00     0.00     8.20     0.00     0.05        0     8.10     0.28
##   Dicrsp Dicrfusc Dicrpoly Hylosple Pleuschr Polypili Polyjuni Polycomm Pohlnuta Ptilcili
## 1    0.0     0.55     0.00     0.00     0.05        0     0.00     0.00     0.03     0.03
## 2    0.3     0.52     0.20     9.97    70.03        0     0.08     0.00     0.07     0.03
## 3    0.0    11.32     0.00     0.00     7.75        0     0.30     0.02     0.07     0.00
## 4    0.0     0.20     0.00     0.00     1.53        0     0.10     0.00     0.05     0.00
## 5    0.0     0.45     0.03     0.00     0.10        0     0.25     0.00     0.03     0.00
##   Barbhatc Cladarbu Cladrang Cladstel Cladunci Cladcocc Cladcorn Cladgrac Cladfimb Cladcris
## 1        0     8.80    29.50    55.60     0.25     0.08     0.25     0.25     0.15     0.10
## 2        0     0.17     0.87     0.00     0.05     0.02     0.03     0.07     0.10     0.02
## 3        0    17.45     1.32     0.12    23.68     0.22     0.50     0.15     0.23     0.97
## 4        0    15.73    20.03    28.20     0.73     0.10     0.15     0.13     0.10     0.15
## 5        0    35.00    42.50     0.28     0.35     0.08     0.20     0.25     0.18     0.13
##   Cladchlo Cladbotr Cladamau Cladsp Cetreric Cetrisla Flavniva Nepharct Stersp Peltapht
## 1     0.03     0.00     0.03   0.00     0.05     0.00     0.15     0.15   0.28        0
## 2     0.00     0.02     0.00   0.00     0.00     0.02     0.00     0.00   0.02        0
## 3     0.00     0.00     0.00   0.00     0.68     0.02     0.00     0.00   0.33        0
## 4     0.00     0.00     0.00   0.05     0.28     0.05    10.03     0.00   0.95        0
## 5     0.08     0.00     0.00   0.00     0.05     0.00     0.23     0.20   0.93        0
##   Icmaeric Cladcerv Claddefo Cladphyl
## 1     0.00     0.00     0.08     0.00
## 2     0.00     0.00     0.08     0.00
## 3     0.02     0.00     1.57     0.05
## 4     0.00     0.05     0.08     0.00
## 5     0.03     0.00     0.10     0.00</code></pre>
<p>Pour effectuer l‚ÄôAC, nous utiliserons, comme pour l‚ÄôACP, le module vegan mais cette fois-ci avec la fonction <code>cca</code>. L‚ÄôAC en <em>scaling 1</em> est effectu√©e sur le tableau des abondances avec les esp√®ces comme colonnes et les sites comme lignes. Les matrices d‚Äôabondance transpos√©es indique les sites o√π chque esp√®ce ont √©t√© d√©nombr√©es: pour une analyse en <em>scaling 2</em>, on effectue une analyse de correspondance sur la matrice d‚Äôabondance (ou d‚Äôoccurence) transpos√©e.</p>
<p>Pour chacune des AC, je filtre pour m‚Äôassurer que toutes les lignes contiennent au moins une observation. Ce n‚Äôest pas n√©cessaire dans notre cas, mais je le laisse pour l‚Äôexemple.</p>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb725-1" title="1">vare_cca &lt;-<span class="st"> </span><span class="kw">cca</span>(varespec <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">rowSums</span>(.) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb725-2" title="2"><span class="kw">summary</span>(vare_cca, <span class="dt">scaling =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## cca(X = varespec %&gt;% filter(rowSums(.) &gt; 0)) 
## 
## Partitioning of scaled Chi-square:
##               Inertia Proportion
## Total           2.083          1
## Unconstrained   2.083          1
## 
## Eigenvalues, and their contribution to the scaled Chi-square 
## 
## Importance of components:
##                          CA1    CA2    CA3     CA4     CA5     CA6     CA7     CA8     CA9
## Eigenvalue            0.5249 0.3568 0.2344 0.19546 0.17762 0.12156 0.11549 0.08894 0.07318
## Proportion Explained  0.2520 0.1713 0.1125 0.09383 0.08526 0.05835 0.05544 0.04269 0.03513
## Cumulative Proportion 0.2520 0.4233 0.5358 0.62962 0.71489 0.77324 0.82868 0.87137 0.90650
##                          CA10    CA11    CA12    CA13     CA14     CA15     CA16     CA17
## Eigenvalue            0.05752 0.04434 0.02546 0.01710 0.014896 0.010160 0.007830 0.006032
## Proportion Explained  0.02761 0.02129 0.01222 0.00821 0.007151 0.004877 0.003759 0.002896
## Cumulative Proportion 0.93411 0.95539 0.96762 0.97583 0.982978 0.987855 0.991614 0.994510
##                           CA18     CA19      CA20      CA21      CA22      CA23
## Eigenvalue            0.004008 0.002865 0.0019275 0.0018074 0.0005864 0.0002434
## Proportion Explained  0.001924 0.001375 0.0009253 0.0008676 0.0002815 0.0001168
## Cumulative Proportion 0.996434 0.997809 0.9987341 0.9996017 0.9998832 1.0000000
## 
## Scaling 1 for species and site scores
## * Sites are scaled proportional to eigenvalues
## * Species are unscaled: weighted dispersion equal on all dimensions
## 
## 
## Species scores
## 
##                 CA1       CA2      CA3       CA4        CA5       CA6
## Callvulg  0.0303167 -1.597460  0.11455 -2.894569  0.1376073  2.291129
## Empenigr  0.0751030  0.379305  0.39303  0.023675  0.8568729 -0.400964
## Rhodtome  1.1052309  1.499299  3.04284  0.120106  3.2324306 -0.283510
## Vaccmyrt  1.4614812  1.622935  2.72375  0.231688  0.4604556  0.712538
## Vaccviti  0.1468014  0.313436  0.14696  0.243505  0.6868371 -0.147815
## Pinusylv -0.4820096  0.588517 -0.36020 -0.127094  0.4064754  0.386604
## Descflex  1.5348239  1.218806  1.87562 -0.001340 -1.3136979 -0.070731
## Betupube  0.6694503  1.951826  3.84017  1.389423  7.5959115 -0.244478
## Vacculig -0.0830789 -1.629259  1.05063  0.802648 -0.3058811 -1.625341
## Diphcomp -0.5446464 -1.037570  0.52282  0.940275  0.3682126 -1.082929
## Dicrsp    1.8120408  0.360290 -4.92082  3.088562  1.3867372  0.157815
## Dicrfusc  1.2704743 -0.562978 -0.39718 -2.929542  0.3848272 -2.408710
## Dicrpoly  0.7248118  1.409347  0.80341  1.915549  4.5674148  1.295447
## Hylosple  2.0062408  1.743883  2.27549  0.928884 -3.7648428  2.254851
## Pleuschr  1.3102086  0.583036 -0.01004  0.137298 -1.1216144  0.200422
## Polypili -0.3805097 -1.243904  0.54593  1.477188 -0.7276341 -0.387641
## Polyjuni  1.0133795  0.099043 -2.24697  1.510641  0.7729714 -3.062378
## Polycomm  0.8468241  1.321773  1.13585  1.140723  2.6836594 -0.605038
## Pohlnuta -0.0136453  0.589290 -0.35542  0.135481  0.9369707  0.397246
## Ptilcili  0.4223631  1.598584  3.43474  1.400065  6.3209491  0.198935
## Barbhatc  0.5018348  2.119334  4.57303  1.693188  8.1101807  0.645995
## Cladarbu -0.1531729 -1.483884  0.20024  0.193680  0.0734141  0.358926
## Cladrang -0.5502561 -1.084008  0.40552  0.724060 -0.3357992 -0.335924
## Cladstel -1.4373146  1.077753 -0.44397 -0.375926 -0.2421525  0.004212
## Cladunci  0.8151727 -1.006186 -1.82587 -1.389523  1.6046713  3.675908
## Cladcocc -0.2133215 -0.584429 -0.21434 -0.567886 -0.0003788 -0.145303
## Cladcorn  0.2631227 -0.177858 -0.44464  0.272422  0.3992282 -0.306738
## Cladgrac  0.1956947 -0.311167 -0.23894  0.379013  0.4933026  0.037581
## Cladfimb  0.0009213 -0.161418  0.18463 -0.435908  0.4831233 -0.143751
## Cladcris  0.3373031 -0.470369 -0.05093 -0.823855  0.7182250  0.636140
## Cladchlo -0.6200021  1.207278  0.21889  0.426447  1.9506082  0.120722
## Cladbotr  0.5647242  1.047333  2.65330  0.907734  4.4946805  1.201655
## Cladamau -0.6598144 -1.512880  0.83251  1.577699 -0.0407227 -1.419139
## Cladsp   -0.8209003  0.476164 -0.49752 -0.998241 -0.2393208  0.390785
## Cetreric  0.2458192 -0.689228 -1.68427 -0.131681  0.7439412  2.374535
## Cetrisla -0.3465221  1.362693  0.85897  0.396752  2.7526968  0.396591
## Flavniva -1.4391907 -0.833589 -0.12919  0.007071 -1.4841375  2.956977
## Nepharct  1.6813309  0.199484 -4.33509  2.229917  0.9561223 -5.472858
## Stersp   -0.5172793 -2.280900  0.99775  2.377013 -0.8892757 -1.441228
## Peltapht  0.4035858 -0.043265  0.04538  0.711040  0.1824679 -0.841227
## Icmaeric  0.0378754 -2.419595  0.72135  0.361302 -0.3736424 -2.092136
## Cladcerv -0.9232858 -0.005233 -1.22058  0.305290 -0.8142627  0.414135
## Claddefo  0.5190399 -0.496632 -0.15271 -0.695927  0.9042143  0.909191
## Cladphyl -1.2836161  1.155872 -0.79912 -0.741170 -0.1608002  0.490526
## 
## 
## Site scores (weighted averages of species scores)
## 
##             CA1      CA2       CA3      CA4        CA5      CA6
## sit1  -0.108122 -0.53705  0.229574  0.24412  0.1405624 -0.14253
## sit2   0.697118 -0.14441 -0.031788 -0.21743 -0.2738522 -0.08146
## sit3   0.987603  0.15042 -1.348447  0.80472  0.3095168  0.46773
## sit4   0.851765  0.49901  0.443559  0.12277 -0.4814871  0.07589
## sit5   0.359881 -0.05608  0.145813  0.15087  0.2405263 -0.17770
## sit6   0.003545  0.37017  0.027760  0.06168 -0.1158930 -0.03413
## sit7   0.860732 -0.11504  0.110869 -1.02169  0.0772348 -0.60530
## sit8   0.636936 -0.33250  0.001120 -0.79797  0.0130769 -0.54049
## sit9   1.279352  0.81557  0.670053  0.23137 -0.8929976  0.41783
## sit10 -0.195009 -0.80564  0.117686 -0.58286 -0.0007212  0.53071
## sit11  0.528532 -0.70420 -0.517771 -0.86836  0.5713441  0.91671
## sit12  0.382866 -0.18686 -0.004789  0.10156  0.0458125  0.21087
## sit13  0.990715  0.11967 -1.110040  0.44929  0.1885902 -0.70694
## sit14 -0.264704 -1.06013  0.334900  0.45973 -0.0326631 -0.19945
## sit15 -0.428410 -1.20765  0.374344  0.74970 -0.2596294 -0.30467
## sit16 -0.330534 -0.77498  0.130760  0.22391  0.0632686  0.09060
## sit17 -0.899601  0.12075 -0.075742  0.03842 -0.1489585 -0.12031
## sit18 -0.770294 -0.35351 -0.033779 -0.01795 -0.3007839  0.44303
## sit19 -0.992193  0.50319 -0.157505 -0.07070 -0.1065172 -0.09928
## sit20 -0.937173  0.78688 -0.258119 -0.19377 -0.0343535 -0.01259
## sit21 -0.726413  0.49163 -0.157235 -0.08698 -0.0105774 -0.02801
## sit22 -1.002083  0.71239 -0.236526 -0.18643 -0.0231666 -0.04928
## sit23 -0.322647 -0.03871 -0.001297  0.09029 -0.1481448  0.06934
## sit24  0.259527  0.80746  1.124258  0.36083  1.5437866  0.07051</code></pre>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb727-1" title="1">varespec_eigenval &lt;-<span class="st"> </span><span class="kw">eigenvals</span>(vare_cca, <span class="dt">scaling =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb727-2" title="2"></a>
<a class="sourceLine" id="cb727-3" title="3">prop_expl &lt;-<span class="st"> </span>varespec_eigenval <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(varespec_eigenval)</a>
<a class="sourceLine" id="cb727-4" title="4"></a>
<a class="sourceLine" id="cb727-5" title="5"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb727-6" title="6"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb727-7" title="7">     <span class="dt">y =</span> vare_cca<span class="op">$</span>CA<span class="op">$</span>eig,</a>
<a class="sourceLine" id="cb727-8" title="8">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb727-9" title="9">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb727-10" title="10">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>)</a>
<a class="sourceLine" id="cb727-11" title="11"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(varespec_eigenval), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb727-12" title="12"></a>
<a class="sourceLine" id="cb727-13" title="13"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb727-14" title="14">     <span class="dt">y =</span> prop_expl,</a>
<a class="sourceLine" id="cb727-15" title="15">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb727-16" title="16">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb727-17" title="17">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>)</a>
<a class="sourceLine" id="cb727-18" title="18"><span class="kw">lines</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb727-19" title="19">      <span class="dt">y =</span> <span class="kw">broken_stick</span>(<span class="kw">length</span>(varespec_eigenval)),</a>
<a class="sourceLine" id="cb727-20" title="20">      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb727-21" title="21">      <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varespec-cca-plot-1.png" width="672" /></p>
<p>Cr√©ons les biplots.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb728-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb728-2" title="2"><span class="kw">plot</span>(vare_cca, <span class="dt">scaling =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Biplot des esp√®ces&quot;</span>)</a>
<a class="sourceLine" id="cb728-3" title="3"><span class="kw">plot</span>(vare_cca, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">main =</span> <span class="st">&quot;Biplot des sites&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varespec-cca-biplot-1.png" width="960" /></p>
<p>Le <strong>biplot des esp√®ces</strong>, √† gauche (<code>scaling = 1</code>), montre la distribution des sites selon les esp√®ces. Les emplacements des scores (en noir) montrent les contrastes entre sites selon les esp√®ces qui les recouvrent. Les sites 14 et 15, par exemple, contrastent les sites 19, 20, 21 et 22 selon le 2i√®me axe principal. Par ailleurs, les axes principaux sont form√© de plusieurs esp√®ces dont aucune ne domine clairement.</p>
<p>Le <strong>biplot des sites</strong>, √† droite (<code>scaling = 2</code>), montre la distribution des recouvrements d‚Äôesp√®ces selon les sites. Par exemple, les esp√®ces Betupube (<a href="https://fr.wikipedia.org/wiki/Betula_pubescens"><em>Betula pubescens</em></a>) et Barbhatc (<a href="https://en.wikipedia.org/wiki/Marchantiophyta"><em>Barbilophozia hatcheri </em></a>) se recouvrent en particulier le site 24. Le site 1 est difficile √† identifier, car il est couvert par plusieurs noms d‚Äôesp√®ces, au bas au centre. Les sites 3 et 13 se confondent avec Dicrsp (une esp√®ce de <a href="https://en.wikipedia.org/wiki/Dicranum"><em>Dicranum</em></a>) qui le recouvre amplement.</p>
<p>Pour les deux types de biplot, les sites o√π les esp√®ces situ√©s pr√®s de l‚Äôorigine, car ils peuvent √™tre soit pr√®s de la moyenne, soit distribu√©s uniform√©ment.</p>
<p>Le nombre de composantes √† retenir peut √™tre √©valu√© par les approches <em>Kaiser-Guttmann</em> et <em>broken-stick</em>.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb729-1" title="1">scaling &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb729-2" title="2">varespec_eigenval &lt;-<span class="st"> </span><span class="kw">eigenvals</span>(vare_cca, <span class="dt">scaling =</span> scaling) <span class="co"># peut √™tre effectu√© sur les deux types de scaling</span></a>
<a class="sourceLine" id="cb729-3" title="3"></a>
<a class="sourceLine" id="cb729-4" title="4">prop_expl &lt;-<span class="st"> </span>varespec_eigenval <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(varespec_eigenval)</a>
<a class="sourceLine" id="cb729-5" title="5"></a>
<a class="sourceLine" id="cb729-6" title="6"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb729-7" title="7"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb729-8" title="8">     <span class="dt">y =</span> vare_cca<span class="op">$</span>CA<span class="op">$</span>eig,</a>
<a class="sourceLine" id="cb729-9" title="9">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb729-10" title="10">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb729-11" title="11">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb729-12" title="12">     <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Eigenvalue - Kaiser-Guttmann, scaling =&quot;</span>, scaling))</a>
<a class="sourceLine" id="cb729-13" title="13"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="kw">mean</span>(varespec_eigenval), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb729-14" title="14"></a>
<a class="sourceLine" id="cb729-15" title="15"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb729-16" title="16">     <span class="dt">y =</span> prop_expl,</a>
<a class="sourceLine" id="cb729-17" title="17">     <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,</a>
<a class="sourceLine" id="cb729-18" title="18">     <span class="dt">xlab =</span> <span class="st">&quot;Rang de la valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb729-19" title="19">     <span class="dt">ylab =</span> <span class="st">&quot;Valeur propre&quot;</span>,</a>
<a class="sourceLine" id="cb729-20" title="20">     <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">&quot;Proportion - broken stick, scaling =&quot;</span>, scaling))</a>
<a class="sourceLine" id="cb729-21" title="21"><span class="kw">lines</span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(varespec_eigenval),</a>
<a class="sourceLine" id="cb729-22" title="22">      <span class="dt">y =</span> <span class="kw">broken_stick</span>(<span class="kw">length</span>(varespec_eigenval)),</a>
<a class="sourceLine" id="cb729-23" title="23">      <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,</a>
<a class="sourceLine" id="cb729-24" title="24">      <span class="dt">lty =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-varespec-cca-analysis-1.png" width="960" /></p>
<p>Pour les deux scalings, l‚Äôapproche <em>Kaiser-Guttmann</em> propose 7 axes, tandis que l‚Äôapproche <em>broken-stick</em> en propose 5.</p>
<p>Les repr√©sentations biplot d‚Äôanalyse de correspondance peuvent prendre la forme d‚Äôun boomerang, en particulier celles qui sont bas√©es sur des donn√©es d‚Äôoccurence. Le tableau suivant initialement de <a href="http://pbil.univ-lyon1.fr/R/pdf/pps047.pdf">Chessel et al.¬†(1987)</a> et est distribu√© dans le module ade4.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb730-1" title="1"><span class="kw">library</span>(<span class="st">&quot;ade4&quot;</span>)</a>
<a class="sourceLine" id="cb730-2" title="2"><span class="kw">data</span>(<span class="st">&quot;doubs&quot;</span>)</a>
<a class="sourceLine" id="cb730-3" title="3">fish &lt;-<span class="st"> </span>doubs<span class="op">$</span>fish</a>
<a class="sourceLine" id="cb730-4" title="4">doubs_cca &lt;-<span class="st"> </span><span class="kw">cca</span>(fish <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(<span class="kw">rowSums</span>(.) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>))</a>
<a class="sourceLine" id="cb730-5" title="5"><span class="kw">plot</span>(doubs_cca, <span class="dt">scaling =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-doubs-cca-biplot-1.png" width="672" /></p>
<p>Les num√©ros de sites correspondent √† la position dans une rivi√®re, 1 √©tant en amont et 30 en aval. Le premier axe discrimine l‚Äôamont et l‚Äôaval, tandis que le deuxi√®me montre deux niches en amont. Bien que l‚Äôon observe une discontinuit√© dans le cours d‚Äôeau, il y a une continuit√© dans les abondances. Cet effet peut √™tre corrig√© en retirant la tendance de l‚Äôanalyse de correspondance par une <em>detrended correspondance analysis</em>. Pour cela, il faudra utiliser la fonction <code>decorana</code>, ce qui ne sera pas couvert ici.</p>
<p>L‚Äô<em>analyse des correspondances multiples</em> (ACM) est utile pour l‚Äôordination des donn√©es cat√©gorielles. Le module <a href="https://larmarange.github.io/analyse-R/analyse-des-correspondances-multiples.html#acm-avec-ade4"><em>ade4</em></a> est en mesure d‚Äôeffectuer des AMC, mais n‚Äôest pas couvert dans ce manuel.</p>
<div class="alert alert-block alert-success">
<strong>Excercice</strong>. Effectuez et analysez une AC avec les donn√©es de recouvrement <code>varespec</code>.
</div>
</div>
</div>
<div id="positionnement-multidimensionnel-pomd" class="section level4">
<h4><span class="header-section-number">9.4.1.3</span> Positionnement multidimensionnel (PoMd)</h4>
<p>Le positionnement multidimensionnel (PoMd), ou <a href="http://scikit-learn.org/stable/modules/manifold.html"><em>manifold analysis</em></a>, se base sur les assiciations entre les objets (mode Q) ou les variables (mode R) pour en r√©duire les dimensions. Alors que l‚Äôanalyse en composantes principales conserve la distance euclidienne et que l‚Äôanalyse de correspondance conserve la distance du <span class="math inline">\(\chi^2\)</span>, le PoMd conserve l‚Äôassociation que vous s√©lectionnerez √† votre convenance. Le PoMd vise √† repr√©senter en un nombre limit√© de dimensions (souvent 2) la distance (ou dissimilarit√©) qu‚Äôont les objets (ou des variables) les uns par rapport aux autres dans l‚Äôespace multidimensionnel.</p>
<p>Il existe deux types d‚ÄôAEM. Le <strong>PoMd-m√©trique</strong> (<em>metric multidimentional scaling</em> MMDS, parfois le <em>metric</em> est retir√©, MDS, et parfois l‚Äôon parle de <em>classic MDS</em>) vise √† repr√©senter fid√®lement la distance entre les objets ou les variables. Le PoMd-m√©trique ne devrait √™tre utilis√©e que lorsque la m√©trique n‚Äôest ni euclidienne, ni de <span class="math inline">\(\chi^2\)</span> et que l‚Äôon d√©sire pr√©server les distances entre les objets. L‚ÄôPoMd-m√©trique aussi appel√©e <em>analyse en coordonn√©es principales</em> (ACoP ou de l‚Äôanglais <em>PCoA</em>) .</p>
<p>Le <strong>PoMd-non-m√©trique</strong> (<em>nonmetric multidimentional scaling</em>, NMDS) vise quant √† lui √† repr√©senter l‚Äôordre des distances entre les objets ou les variables. C‚Äôest une approche par rang: le PoMd-non-m√©trique vise repr√©senter les objets sont plus proches ou plus √©loign√©es les uns des autres plut√¥t que de repr√©senter leur similarit√© dans l‚Äôespace multidimentionnelle.</p>
<p>L‚Äô<strong>IsoMap</strong>, pour <em>isometric feature mapping</em>, est une extension du PoMd qui recontruit les distances selon les points retrouv√©s dans le voisinage. Les isomaps sont en mesure d‚Äôapplatir des donn√©es ayant des formes complexes.</p>
<p>Nous ne traitons pour l‚Äôinstant que de l‚ÄôPoMd-m√©trique (fonction <code>vegan::cmdscale</code>) et des PoMd-non-m√©trique (fonction <code>vegan::metaMDS</code>).</p>
<div id="application-5" class="section level5">
<h5><span class="header-section-number">9.4.1.3.1</span> Application</h5>
<p>Utilisons les donn√©es d‚Äôabondance que nous avions au tout d√©but de ce chapitre. La matrice d‚Äôassociation de Bray-Curtis sera utilis√©e.</p>
<div class="sourceCode" id="cb731"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb731-1" title="1">assoc_mat &lt;-<span class="st"> </span><span class="kw">vegdist</span>(abundance, <span class="dt">method =</span> <span class="st">&quot;bray&quot;</span>)</a>
<a class="sourceLine" id="cb731-2" title="2"><span class="kw">pheatmap</span>(assoc_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>(), <span class="dt">cluster_rows =</span> <span class="ot">FALSE</span>, <span class="dt">cluster_cols =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb731-3" title="3">         <span class="dt">display_numbers =</span> <span class="kw">round</span>(assoc_mat <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">as.matrix</span>(), <span class="dv">2</span>))</a></code></pre></div>
<p><img src="_main_files/figure-html/aop-pomd-abun-data-1.png" width="288" /></p>
<p>Les sites 2 et 3 devraient √™tre plus pr√®s l‚Äôun et l‚Äôautre, puis les sites 3 et 4. Les autres associations sont √©loign√©s d‚Äôenviron la m√™me distance. Lan√ßons le calcul de la PoMd-m√©trique.</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb732-1" title="1">pcoa &lt;-<span class="st"> </span><span class="kw">cmdscale</span>(assoc_mat, <span class="dt">k =</span> <span class="kw">nrow</span>(abundance)<span class="op">-</span><span class="dv">1</span>, <span class="dt">eig =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb732-2" title="2">spec_scores &lt;-<span class="st"> </span><span class="kw">wascores</span>(pcoa<span class="op">$</span>points, abundance)</a>
<a class="sourceLine" id="cb732-3" title="3"><span class="kw">ordiplot</span>(vegan<span class="op">::</span><span class="kw">scores</span>(pcoa), <span class="dt">type =</span> <span class="st">&#39;t&#39;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## species scores not available</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb734-1" title="1"><span class="kw">text</span>(spec_scores, <span class="kw">row.names</span>(spec_scores), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/aop-pomd-abun-compute-1.png" width="672" /></p>
<p>On observe en effet que les sites 2 et 3 sont les plus pr√®s. Les sites 3 et 4sont plus √©loign√©s. Les sites 1, 2 et 4 font √† peu pr√®s un triangle √©quilat√©ral, ce qui correspond √† ce √† quoi on devrait s‚Äôattendre. Les wa-scores permettent de juxtaposer les esp√®ces sur les sites, pour r√©f√©rence. Le colibri n‚Äôest pr√©sent que sur le site 2. Le site 1 est popul√© par des jaseurs et des m√©sanges, et c‚Äôest le seul site o√π l‚Äôon a observ√© une citelle. On a observ√© des chardonnerets sur les sites 2 et 3. Sur le site 4, on n‚Äôa observ√© que des bruants, que l‚Äôon a aussi observ√© ailleurs, sauf au site 2.</p>
<p>Le PoMd-non-m√©trique (<em>non metric dimensional scaling, NMDS</em>) fonctionne de la m√™me mani√®re que la PoMd-m√©trique, √† la diff√©rence que la distance est bas√©e sur les rangs. √Ä cet √©gard, le site 4 √† une distance de 0.76 du site 3, mais plut√¥t le deuxi√®me plus loin, apr√®s le site 2 et avant le site 1. Utilisons la fonction <code>metaMDS</code>.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb735-1" title="1">nmds &lt;-<span class="st"> </span><span class="kw">metaMDS</span>(assoc_mat, <span class="dt">k =</span> <span class="kw">nrow</span>(abundance)<span class="op">-</span><span class="dv">1</span>, <span class="dt">eig =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## Run 0 stress 0 
## Run 1 stress 0 
## ... Procrustes: rmse 0.1712075  max resid 0.2311738 
## Run 2 stress 0 
## ... Procrustes: rmse 0.1038622  max resid 0.1447403 
## Run 3 stress 0 
## ... Procrustes: rmse 0.1355982  max resid 0.1807723 
## Run 4 stress 0 
## ... Procrustes: rmse 0.1149604  max resid 0.1456473 
## Run 5 stress 0 
## ... Procrustes: rmse 0.08167542  max resid 0.1146596 
## Run 6 stress 0 
## ... Procrustes: rmse 0.1284115  max resid 0.1569041 
## Run 7 stress 0 
## ... Procrustes: rmse 0.1834823  max resid 0.2366359 
## Run 8 stress 0 
## ... Procrustes: rmse 0.1367236  max resid 0.1848335 
## Run 9 stress 0 
## ... Procrustes: rmse 0.09492646  max resid 0.1233517 
## Run 10 stress 0 
## ... Procrustes: rmse 0.12845  max resid 0.1738103 
## Run 11 stress 8.215235e-05 
## ... Procrustes: rmse 0.07684147  max resid 0.1148002 
## Run 12 stress 0 
## ... Procrustes: rmse 0.06054277  max resid 0.07388255 
## Run 13 stress 0 
## ... Procrustes: rmse 0.1239983  max resid 0.1544609 
## Run 14 stress 0 
## ... Procrustes: rmse 0.09964013  max resid 0.1300011 
## Run 15 stress 0 
## ... Procrustes: rmse 0.06571301  max resid 0.08654521 
## Run 16 stress 0 
## ... Procrustes: rmse 0.1092868  max resid 0.1707372 
## Run 17 stress 0 
## ... Procrustes: rmse 0.1520543  max resid 0.202858 
## Run 18 stress 0 
## ... Procrustes: rmse 0.158808  max resid 0.2101473 
## Run 19 stress 0 
## ... Procrustes: rmse 0.1124983  max resid 0.1450684 
## Run 20 stress 0 
## ... Procrustes: rmse 0.09344561  max resid 0.1301929 
## *** No convergence -- monoMDS stopping criteria:
##     20: stress &lt; smin</code></pre>
<pre><code>## Warning in metaMDS(assoc_mat, k = nrow(abundance) - 1, eig = TRUE): stress is (nearly) zero:
## you may have insufficient data</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb738-1" title="1">spec_scores &lt;-<span class="st"> </span><span class="kw">wascores</span>(nmds<span class="op">$</span>points, abundance)</a>
<a class="sourceLine" id="cb738-2" title="2"><span class="kw">ordiplot</span>(vegan<span class="op">::</span><span class="kw">scores</span>(nmds), <span class="dt">type =</span> <span class="st">&#39;t&#39;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)</a></code></pre></div>
<pre><code>## species scores not available</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb740-1" title="1"><span class="kw">text</span>(spec_scores, <span class="kw">row.names</span>(spec_scores), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.75</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/aop-pomd-abun-compute-nmds-1.png" width="672" /></p>
<p>Dans ce cas, entre PoMd-m√©trique et non-m√©trique, les r√©sultats peuvent √™tre interpr√©t√©s de mani√®re similaire.</p>
<p>En ce qui a trait au dauphin,</p>
<p><img src="_main_files/figure-html/aop-pomd-dauphin-plot-1.png" width="672" /></p>
<p>Pour plus de d√©tails, je vous invite √† vous r√©f√©rer √† <a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>) ou de consulter l‚Äôexcellent site <a href="https://mb3is.megx.net/gustame/dissimilarity-based-methods/nmds">GUSTA ME</a>.</p>
</div>
</div>
<div id="conclusion-sur-lordination-non-contraignante" class="section level4">
<h4><span class="header-section-number">9.4.1.4</span> Conclusion sur l‚Äôordination non contraignante</h4>
<p>Lorsque les donn√©es sont euclidiennes, l‚Äôanalyse en composantes principales (ACP) dervait √™tre utilis√©e. Lorsque la m√©trique est celle du <span class="math inline">\(\chi^2\)</span>, on pr√©f√©rera l‚Äôanalyse de correspondance (AC). Si la m√©trique est autre, le positionnement multidimensionel (PoMd) est pr√©f√©rable. Dans ce dernier cas, si l‚Äôon recherche une repr√©sentation simplifi√©e de la distance entre les objets ou variables, on utilisera un PoMd-m√©trique. √Ä l‚Äôinverse, si l‚Äôon d√©sire une repr√©sentation plus fid√®le au rang des distances, on pr√©f√©rera l‚ÄôPoMd-non-m√©trique.</p>
</div>
</div>
<div id="ordination-contraignante" class="section level3">
<h3><span class="header-section-number">9.4.2</span> Ordination contraignante</h3>
<p>Alors que l‚Äôordination non contraignante vous permet de dresser un protrait de vos variables, l‚Äôordination contraignante (ou canonique) permet de tester statistiquement ainsi que de repr√©senter la relation entre plusieurs variables explicatives (par exemple, des conditions environnementales) et une ou plusieurs variables r√©ponses (par exemple, les esp√®ces observ√©es).</p>
<ul>
<li>L‚Äôanalyse discriminante n‚Äôa fondamentalement qu‚Äôune seulement variable r√©ponse, et celle-ci doit d√©crire l‚Äôappartenance √† une cat√©gorie.</li>
<li>L‚Äôanalyse de redondance sera pr√©f√©r√©e lorsque le nombre de variable est plus restreint (variables ionomiques et indicateurs de performance des cultures). Les d√©tails, ainsi que les tenants et aboutissants de ces m√©thodes, sont pr√©sent√©s dans <a href="https://www.elsevier.com/books/numerical-ecology/legendre/978-0-444-53868-0">Numerical Ecology (Legendre et Legendre, 2012)</a>.</li>
<li>L‚Äôanalyse canonique des corr√©lations sera pr√©f√©r√©e lorsque les variables sont parsem√©es (beaucoup de colonnes avec beaucoup de z√©ros, comme les variables d‚Äôabondance).</li>
</ul>
<div id="analyse-discriminante" class="section level4">
<h4><span class="header-section-number">9.4.2.1</span> Analyse discriminante</h4>
<p>Alors que l‚Äôanalyse en composante principale vise √† pr√©senter la perspective (les axes) selon laquelle les points sont les plus √©clat√©es, l‚Äôanalyse discriminante, le plus souvent utilis√© dans sa forme lin√©aire (ADL) et quadratique (ADQ), vise √† pr√©senter la perspective selon laquelle les groupes sont les plus √©clat√©s, les groupes formant la variable contraignante. Ces groupes peuvent √™tre connus (e.g.¬†cultivar, r√©gion g√©ographique) ou attribu√©s (exemple: par partitionnement). L‚ÄôADL est parfois nomm√©e <em>analyse canonique de la variance</em>.</p>
<p>L‚ÄôAD vise √† repr√©senter des diff√©rences entre des groupes aux moyens de combinaisons lin√©aires (ADL) ou quadratique (ADQ) de variables mesur√©es. Sa repr√©sentation sous forme de biplot permet d‚Äôappr√©cier les diff√©rences entre les groupes d‚Äôidentifier les variables qui sont responsables de la discrimination.</p>
<p><img src="images/07_ionome-revisited-figure4d.png" alt="" style="width: 600px;"/></p>
<center>
Biplot de distance de l‚Äôanalyse discriminante des ionomes d‚Äôesp√®ces de plantes √† fruits cultiv√©es sauvages et domestiqu√©es, Source: <a href="https://doi.org/10.3389/fpls.2013.00039">Parent et al.¬†(2013)</a>
</center>
<p>L‚ÄôADL a √©t√© d√©velopp√©e par <a href="http://onlinelibrary.wiley.com/doi/10.1111/j.1469-1809.1936.tb02137.x/abstract">Fisher (1936)</a>, qui √† titre d‚Äôexemple d‚Äôapplication a utilis√© un jeu de donn√©es de dimensions d‚Äôiris collect√©es par Edgar Anderson, du Jardin botanique du Missouri, sur 150 sp√©cimens d‚Äôiris collect√©s en Gasp√©sie (Est du Qu√©bec), ma r√©gion natale (suis-je assez chauvin?). Ce jeu de donn√©es est amplement utilis√© √† titre d‚Äôexemple en analyse multivari√©e.</p>
<p><a href="http://www.jstor.org/stable/1937836">Williams (1983)</a> a pr√©sent√© les tenants et aboutissants de l‚ÄôADL en √©cologie. Tout comme les donn√©es passant pas une ACP doivent suivre une distribution multinormale pour √™tre statistiquement valide, les distributions des groupes dans une ADL doivent √™tre multinormales et les variances des points par groupe doivent √™tre homog√®nes‚Ä¶ ce qui est rarement le cas en science. N√©anmoins:</p>
<blockquote>
<p>Heureusement, il y a des √©vidences dans la litt√©rature que certaines d‚Äôentre [ces r√®gles] peuvent √™tre transgress√©es mod√©r√©ment sans de grands changement dans les taux de classification. Cette conclusion d√©pends, toutefois, de la s√©v√©rit√© des transgressions, et de facteurs structueaux comme la position relative des moyennes des populations et de la nature des dispersions. - <a href="http://www.jstor.org/stable/1937836">Williams (1983)</a></p>
</blockquote>
<p>L‚ÄôADL peut servir autant d‚Äôoutil d‚Äôinterpr√©tation que d‚Äôoutil de classification, c‚Äôest √† dire de pr√©dire une cat√©gorie selon les variables (chapitre <a href="chapitre-ml.html#chapitre-ml">11</a>). Dans les deux cas, lorsque le nombre de variables approchent le nombre d‚Äôobservation, les r√©sultats d‚Äôune ADL risque d‚Äô√™tre difficilement interpr√©tables. Le test appropri√© pour √©valuer l‚Äôhomod√©n√©it√© de la covariance est le M-test de Box. Ce test est peu document√© dans la litt√©rature, est rarement utilis√© mais a la <a href="https://en.wikiversity.org/wiki/Box%27s_M">r√©putation</a> d‚Äô√™tre particuli√®rement s√©v√®re.</p>
<p>Il est rare que des donn√©es √©cologiques aient des dispersions (covariances) homog√®nes. Contrairement √† l‚ÄôADL, l‚ÄôADQ ne demande pas √† ce que les dispersions (covariances) soient homog√®nes. N√©anmoins, l‚ÄôADQ ne g√©n√®re ni de scores, ni de loadings: il s‚Äôagit d‚Äôun outil pour pr√©dire des cat√©gories (classification), non pas d‚Äôun outil d‚Äôordination.</p>
<div id="application-6" class="section level5">
<h5><span class="header-section-number">9.4.2.1.1</span> Application</h5>
<p>Utilisons les donn√©es d‚Äôiris.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb741-1" title="1"><span class="kw">data</span>(<span class="st">&quot;iris&quot;</span>)</a></code></pre></div>
<p>Testons la multinormalit√© par groupe. Rappelons-nous que pour consid√©rer la distribution comme multinormale, la p-value de la distortion ainsi que la statistique de Kurtosis doivent √™tre √©gale ou plus √©lev√©e que 0.05. La fonction <code>split</code> s√©pare le tableau en listes et la fonction <code>map</code> applique la fonction sp√©cifi√©e √† chaque √©l√©ment de la liste. Cela permet d‚Äôeffectuer des tests de multinormalit√© sur chacune des esp√®ces d‚Äôiris.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb742-1" title="1">iris <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb742-2" title="2"><span class="st">  </span><span class="kw">split</span>(.<span class="op">$</span>Species) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb742-3" title="3"><span class="st">  </span><span class="kw">map</span>(<span class="op">~</span><span class="st"> </span><span class="kw">mvn</span>(.x <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species),</a>
<a class="sourceLine" id="cb742-4" title="4">            <span class="dt">mvnTest =</span> <span class="st">&quot;mardia&quot;</span>)<span class="op">$</span>multivariateNormality)</a></code></pre></div>
<pre><code>## $setosa
##              Test        Statistic           p value Result
## 1 Mardia Skewness 25.6643445196298 0.177185884467652    YES
## 2 Mardia Kurtosis 1.29499223711605 0.195322907441935    YES
## 3             MVN             &lt;NA&gt;              &lt;NA&gt;    YES
## 
## $versicolor
##              Test         Statistic           p value Result
## 1 Mardia Skewness  25.1850115362466 0.194444483140265    YES
## 2 Mardia Kurtosis -0.57186635893429 0.567412516528727    YES
## 3             MVN              &lt;NA&gt;              &lt;NA&gt;    YES
## 
## $virginica
##              Test         Statistic           p value Result
## 1 Mardia Skewness  26.2705981752915 0.157059707690356    YES
## 2 Mardia Kurtosis 0.152614173978342 0.878702546726567    YES
## 3             MVN              &lt;NA&gt;              &lt;NA&gt;    YES</code></pre>
<p>Le test est pass√© pour toutes les esp√®ces. Voyons maintenant l‚Äôhomog√©n√©it√© de la covariance. Pour ce faire, nous aurons besoin de la fonction <code>boxM</code>, disponible avec le module <code>biotools</code>. Pour que les covariances soient consid√©r√©es comme √©gales, la p-vaule doit √™tre sup√©rieure √† 0.05.</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb744-1" title="1"><span class="kw">library</span>(<span class="st">&quot;heplots&quot;</span>)</a></code></pre></div>
<pre><code>## 
## Attaching package: &#39;heplots&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:pls&#39;:
## 
##     coefplot</code></pre>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb747-1" title="1"><span class="kw">boxM</span>(iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species),</a>
<a class="sourceLine" id="cb747-2" title="2">     <span class="dt">group =</span> iris<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## 
##  Box&#39;s M-test for Homogeneity of Covariance Matrices
## 
## data:  iris %&gt;% select(-Species)
## Chi-Sq (approx.) = 140.94, df = 20, p-value &lt; 2.2e-16</code></pre>
<p>On est loin d‚Äôun cas o√π les distributions sont homog√®nes. Nous allons n√©anmoins proc√©der √† l‚Äôanalyse discriminante avec le module ade4. Nous aurons d‚Äôabord besoin d‚Äôeffectuer une ACP avec la fonction <code>dudi.pca</code> de ade4 (en sp√©cifiant une mise √† l‚Äô√©chelle), que nous projeterons en ADL avec <code>discrimin</code>.</p>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb749-1" title="1"><span class="kw">library</span>(<span class="st">&quot;ade4&quot;</span>)</a>
<a class="sourceLine" id="cb749-2" title="2">iris_pca &lt;-<span class="st"> </span><span class="kw">dudi.pca</span>(<span class="dt">df =</span> iris <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(<span class="op">-</span>Species),</a>
<a class="sourceLine" id="cb749-3" title="3">                     <span class="dt">scannf =</span> <span class="ot">FALSE</span>, <span class="co"># ne pas g√©n√©rer de graphique</span></a>
<a class="sourceLine" id="cb749-4" title="4">                     <span class="dt">scale =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb749-5" title="5">iris_lda &lt;-<span class="st"> </span><span class="kw">discrimin</span>(<span class="dt">dudi =</span> iris_pca,</a>
<a class="sourceLine" id="cb749-6" title="6">                      <span class="dt">fac =</span> iris<span class="op">$</span>Species,</a>
<a class="sourceLine" id="cb749-7" title="7">                      <span class="dt">scannf =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>La visualisation peut √™tre effectu√©e directement sur l‚Äôobjet issu de la fonction <code>discrimin</code>.</p>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb750-1" title="1"><span class="kw">plot</span>(iris_lda)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-lda-plot-1.png" width="672" /></p>
<p>Il s‚Äôagit toutefois d‚Äôune visualisation pour le diagnostic davantage que pour la publication. Si l‚Äôobjectif est la pubilcation, vous pourriez utiliser la fonction <code>plotDA</code> que j‚Äôai con√ßue √† cet effet. J‚Äôai aussi con√ßu une <a href="https://raw.githubusercontent.com/essicolo/AgFun/master/plotDA_trad.R">fonction similaire qui utilise le module graphique de base de R</a>.</p>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb751-1" title="1"><span class="kw">source</span>(<span class="st">&quot;https://raw.githubusercontent.com/essicolo/AgFun/master/plotDA_gg.R&quot;</span>)</a>
<a class="sourceLine" id="cb751-2" title="2"><span class="kw">plotDA</span>(<span class="dt">scores =</span> iris_lda<span class="op">$</span>li,</a>
<a class="sourceLine" id="cb751-3" title="3">       <span class="dt">loadings =</span> iris_lda<span class="op">$</span>fa,</a>
<a class="sourceLine" id="cb751-4" title="4">       <span class="dt">fac =</span> iris<span class="op">$</span>Species,</a>
<a class="sourceLine" id="cb751-5" title="5">       <span class="dt">level=</span><span class="fl">0.95</span>,</a>
<a class="sourceLine" id="cb751-6" title="6">       <span class="dt">facname =</span> <span class="st">&quot;Species&quot;</span>,</a>
<a class="sourceLine" id="cb751-7" title="7">       <span class="dt">propLoadings =</span> <span class="dv">1</span>) </a></code></pre></div>
<pre><code>## Loading required package: ellipse</code></pre>
<pre><code>## 
## Attaching package: &#39;ellipse&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:car&#39;:
## 
##     ellipse</code></pre>
<pre><code>## The following object is masked from &#39;package:graphics&#39;:
## 
##     pairs</code></pre>
<pre><code>## Loading required package: grid</code></pre>
<pre><code>## Loading required package: plyr</code></pre>
<pre><code>## ---------------------------------------------------------------------------------------------</code></pre>
<pre><code>## You have loaded plyr after dplyr - this is likely to cause problems.
## If you need functions from both plyr and dplyr, please load plyr first, then dplyr:
## library(plyr); library(dplyr)</code></pre>
<pre><code>## ---------------------------------------------------------------------------------------------</code></pre>
<pre><code>## 
## Attaching package: &#39;plyr&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:plotly&#39;:
## 
##     arrange, mutate, rename, summarise</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     arrange, count, desc, failwith, id, mutate, rename, summarise, summarize</code></pre>
<pre><code>## The following object is masked from &#39;package:purrr&#39;:
## 
##     compact</code></pre>
<p><img src="_main_files/figure-html/apo-lda-biplot-1.png" width="672" /></p>
<p>√Ä la diff√©rence de l‚ÄôACP, l‚ÄôADL maximise la s√©patation des groupes. Nous avions not√© avec l‚ÄôACP que les dimensions des p√©tales distingaient les groupes. Puisque nous avions justement des informations sur les groupes, nous aurions pu proc√©der directement √† un ADL pour obtenir des conclusions plus directes. Si la longueur des p√©tales permet de distinguer l‚Äôesp√®ce <em>setosa</em> des deux autres, la largeur des p√©tales permet de distinguer <em>virginica</em> et <em>versicolor</em>, bien que les nuages de points se superposent. De mani√®re bivari√©e, les r√©gions de confiance des moyennes des scores discriminants (petites ellipses) montrent des diff√©rence significatives au seuil 0.05.</p>
<div class="alert alert-block alert-success">
<strong>Excercice</strong>. Si l‚Äôon effectuait l‚ÄôADL sur notre dauphin, avec la colonne <code>anatomy</code> comme variable de regroupement, qu‚Äôobtiendrions-nous? Si l‚Äôon consi√®re la nageoire codale (queue) comme faisant partie du corps? Quelles sont les limitations?
</div>
</div>
</div>
<div id="analyse-de-redondance-rda" class="section level4">
<h4><span class="header-section-number">9.4.2.2</span> Analyse de redondance (RDA)</h4>
<p>En anglais, on la nomme <em>redundancy analysis</em>, souvent abr√©g√©e RDA. Elle est utilis√©e pour r√©sumer les relations lin√©aires entre des variables r√©ponse et des variables explicatives. La ‚Äúredondance‚Äù se situe dans l‚Äôutilisation de deux tableaux de donn√©es contenant de l‚Äôinformation concordante. L‚Äôanalyse de redondance est une mani√®re √©l√©gante d‚Äôeffectuer une r√©gresssion lin√©aire multiple, o√π la matrice de valeurs pr√©dites par la r√©gression est assujettie √† une analyse en composantes principales. Il est ainsi possible de superposer les scores des variables explicatives √† ceux des variables r√©ponse.</p>
<p>Plus pr√©cis√©ment, une RDA effectue les √©tapes suivantes (<a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>) entre une matrice de variables ind√©pendantes (explicatives) <span class="math inline">\(X\)</span> et une matrice de variables d√©pendantes (r√©ponse) <span class="math inline">\(Y\)</span>.</p>
<div id="r√©gression-entre-y-et-x" class="section level5">
<h5><span class="header-section-number">9.4.2.2.1</span> 1. R√©gression entre <span class="math inline">\(Y\)</span> et <span class="math inline">\(X\)</span></h5>
<p>Pour chacune des variables r√©ponse de <span class="math inline">\(Y\)</span> (<span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_2\)</span>, , <span class="math inline">\(y_j\)</span>), effectuer une r√©gression lin√©aire sur les variables explicatives <span class="math inline">\(X\)</span>.</p>
<p><span class="math display">\[\hat{y}_j = b_j + m_{1, j} \times x_1 + m_{2, j} \times x_2 + ... + m_{i, j} \times x_i\]</span></p>
<p><span class="math display">\[\hat{y}_j = y_j + y_{res, j}\]</span></p>
<p>Pour chaque observation (<span class="math inline">\(n\)</span>), nous obtenons une s√©rie de valeurs de <span class="math inline">\(\hat{y}_j\)</span> et de <span class="math inline">\(y_{res, j}\)</span>. Donc chaque cellule de la matrice <span class="math inline">\(Y\)</span> a ses pendant <span class="math inline">\(\hat{y}\)</span> et <span class="math inline">\(y_{res}\)</span>. Nous obtenons ainsi une matrice de pr√©diction <span class="math inline">\(\hat{Y}\)</span> et une matrice des r√©sidus <span class="math inline">\(Y_{res} = Y - \hat{Y}\)</span>.</p>
</div>
<div id="analyse-en-composantes-principales-1" class="section level5">
<h5><span class="header-section-number">9.4.2.2.2</span> 2. Analyse en composantes principales</h5>
<p>Ensuite, on effectue une analyse en composantes principales (ACP) sur la matrice des pr√©dictions <span class="math inline">\(\hat{Y}\)</span>. On obtient ainsi ses valeurs et vecteurs propres. Nommons <span class="math inline">\(U\)</span> ses vecteurs propres. Les fonctions de RDA mettent souvent ces veceturs √† l‚Äô√©chelle avant de les retourner √† l‚Äôutilisateur. En ordination √©cologique, ces vecteurs mis √† l‚Äô√©chelle sont souvent appel√©s les <em>scores des esp√®ces</em>, bien qu‚Äôil ne s‚Äôagisse pas n√©cessairement d‚Äôesp√®ces, mais plus g√©n√©ralement des variables de la matrice d√©pendante <span class="math inline">\(Y\)</span>.</p>
<p>Il est aussi possible d‚Äôeffectuer une ACP sur <span class="math inline">\(Y_{res}\)</span>.</p>
</div>
<div id="calculer-les-scores" class="section level5">
<h5><span class="header-section-number">9.4.2.2.3</span> 3. Calculer les scores</h5>
<p>Les vecteurs propres <span class="math inline">\(U\)</span> sont utilis√©s pour calculer les <em>scores des sites</em>, <span class="math inline">\(Y \times U\)</span>, ainsi que les <em>contraintes de site</em> <span class="math inline">\(\hat{Y} \times U\)</span>.</p>
</div>
<div id="application-7" class="section level5">
<h5><span class="header-section-number">9.4.2.2.4</span> Application</h5>
<p>Nous allons utiliser la fonction <code>rda</code> du module vegan. En ce qui a trait aux donn√©es, utilisons les donn√©es varespec (matrice Y) et varechem (matrice X). La fonction <code>rda</code> peut fonctionner avec l‚Äôinterface-formule de R, o√π √† gauche du <code>~</code> on retrouve le Y (la matrice de la communaut√© √©cologique, i.e.¬†les abondances d‚Äôesp√®ces) contre le X (l), √† gauche, ce qui peut √™tre pratique pour l‚Äôanalyse d‚Äôint√©ractions. Mais pour comparer deux matrices, nous pouvons d√©finir X et Y. Ce qui est m√©langeant, c‚Äôest que vegan, contrairement aux conventions, d√©fini X comme √©tant la matrice r√©ponse et Y comme √©tant la matrice explicative.</p>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb765-1" title="1">vare_rda &lt;-<span class="st"> </span><span class="kw">rda</span>(<span class="dt">X =</span> varespec, <span class="dt">Y =</span> vareclr, <span class="dt">scale =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb765-2" title="2"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb765-3" title="3"><span class="kw">ordiplot</span>(vare_rda, <span class="dt">scaling =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Scaling 1: triplot de distance&quot;</span>)</a>
<a class="sourceLine" id="cb765-4" title="4"><span class="kw">ordiplot</span>(vare_rda, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Scaling 2: triplot de corr√©lation&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-vare-rda-1.png" width="960" /></p>
<p>La fonction <code>ordiplot</code> permet de cr√©er un triplot de base. La repr√©sentation des wascores est r√©put√©e plus robuste (moins susceptible d‚Äô√™tre bruit√©e), mais leur interpr√©tation porte √† confusion (<a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>).</p>
<p><strong>Triplot de distance (scaling 1)</strong>. Les angles entre les variables explicatives repr√©sentent leur corr√©lation (non pas les variables r√©ponse).</p>
<p><strong>Triplot de corr√©lation (scaling 2)</strong>. Les angles entre les variables repr√©sentent leurs corr√©lation, que les variables soient r√©ponse ou explicative, ou entre variables r√©ponses et variables explicatives. Les distances entre les objets sur le triplot ne sont pas des approximation de leur distance euclidienne.</p>
<p>Les triplots montrent que les variables ont toutes un r√¥le important sur la dispersion des sites autours des axeds principaux. Le premier axe principal est compos√© de mani√®re plus marqu√©e par le clr de l‚ÄôAl et celui du Fe. Le deuxi√®me axe principal est compos√© de mani√®re plus marqu√©e par le clr du S, du P et du K. Le triplot de corr√©lation ne pr√©sente pas de tendance appr√©ciable pour la plupart des esp√®ces, qui ne poss√®dent pas de niche particuli√®re. Toutefois, l‚Äôesp√®ce Cladstel, pr√©sente surtout dans les sites 9 et 10, est li√©e √† de basses teneurs en N et √† de faibles valeurs de Baresoil (sol nu). L‚Äôesp√®ce Pleuschr est li√©e √† des sols o√π l‚Äôon retrouve une grande √©paisseur d‚Äôhumus, ainsi que des teneurs √©lev√©es en nutriment K, P, S, Ca, Mg et Zn. Elle semble appr√©cier les sols √† bas pH, mais √† faible teneur en Fe et Al. La teneur en N lui semble plus indiff√©rente (son vecteur √©tant presque perpendiculaire).</p>
<p>On pourra personnaliser les graphiques en extrayant les scores.</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb766-1" title="1">scaling &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb766-2" title="2">sites &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(vare_rda, <span class="dt">display =</span> <span class="st">&quot;wa&quot;</span>, <span class="dt">scaling =</span> scaling)</a>
<a class="sourceLine" id="cb766-3" title="3">species &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(vare_rda, <span class="dt">display =</span> <span class="st">&quot;species&quot;</span>, <span class="dt">scaling =</span> scaling)</a>
<a class="sourceLine" id="cb766-4" title="4">env &lt;-<span class="st"> </span>vegan<span class="op">::</span><span class="kw">scores</span>(vare_rda, <span class="dt">display =</span> <span class="st">&quot;reg&quot;</span>, <span class="dt">scaling =</span> scaling)</a>
<a class="sourceLine" id="cb766-5" title="5"></a>
<a class="sourceLine" id="cb766-6" title="6"><span class="kw">plot</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">5</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">3</span>, <span class="dv">4</span>), <span class="dt">asp =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb766-7" title="7"><span class="kw">abline</span>(<span class="dt">h=</span><span class="dv">0</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">col =</span> <span class="st">&quot;grey80&quot;</span>)</a>
<a class="sourceLine" id="cb766-8" title="8"><span class="kw">text</span>(sites<span class="op">/</span><span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">rownames</span>(sites), <span class="dt">cex =</span> <span class="fl">0.7</span>, <span class="dt">col =</span> <span class="st">&quot;grey50&quot;</span>)</a>
<a class="sourceLine" id="cb766-9" title="9"><span class="kw">text</span>(species<span class="op">/</span><span class="dv">2</span>, <span class="dt">labels =</span> <span class="kw">rownames</span>(species), <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">cex =</span> <span class="fl">0.7</span>)</a>
<a class="sourceLine" id="cb766-10" title="10"><span class="kw">segments</span>(<span class="dt">x0 =</span> <span class="dv">0</span>, <span class="dt">y0 =</span> <span class="dv">0</span>, <span class="dt">x =</span> env[, <span class="dv">1</span>], <span class="dt">y =</span> env[, <span class="dv">2</span>], <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</a>
<a class="sourceLine" id="cb766-11" title="11"><span class="kw">text</span>(env, <span class="dt">labels =</span> <span class="kw">rownames</span>(env), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">cex =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-vare-rda-plot-1.png" width="576" /></p>
<p>On pourra effectuer une analyse de Kaiser-Guttmann ou de broken-stick de la m√™me mani√®re que pr√©c√©demment. √âtant une collection de r√©gressions, une RDA est en mesure d‚Äôeffectuer des tests statistiques sur les coefficients de la r√©gression en utilisant des permutations pour tester la signification des coefficients et des axes d‚Äôune RDA. On doit n√©anmoins obligatoirement effectuer la RDA avec l‚Äôinterface formule. L‚Äôa variable de gauche‚Äôobjet √† gauche du <code>~</code> peut √™tre une matrice ou un tableau, et celui de droite est d√©fini dans <code>data</code>. Le <code>.</code> dans l‚Äôinterface formule signifie ‚Äúune combinaison lin√©aire de toutes les variables, sans int√©raction‚Äù.</p>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb767-1" title="1">vare_rda &lt;-<span class="st"> </span><span class="kw">rda</span>(varespec <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> vareclr, <span class="dt">scale =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb767-2" title="2">perm_test_term &lt;-<span class="st"> </span><span class="kw">anova</span>(vare_rda, <span class="dt">by =</span> <span class="st">&quot;term&quot;</span>)</a>
<a class="sourceLine" id="cb767-3" title="3"><span class="co">#perm_test_axis &lt;- anova(vare_rda, by = &quot;axis&quot;)</span></a></code></pre></div>
<p>La signification des axes est difficile √† interpr√©ter. Toutefois, celui des variables pr√©sente un int√©r√™t.</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb768-1" title="1">perm_test_term</a></code></pre></div>
<pre><code>## Permutation test for rda under reduced model
## Terms added sequentially (first to last)
## Permutation: free
## Number of permutations: 999
## 
## Model: rda(formula = varespec ~ N + P + K + Ca + Mg + S + Al + Fe + Mn + Zn + Mo + Fv + Baresoil + Humdepth + pH, data = vareclr, scale = FALSE)
##          Df Variance      F Pr(&gt;F)   
## N         1   216.13 4.8470  0.009 **
## P         1   272.71 6.1159  0.003 **
## K         1   194.97 4.3724  0.016 * 
## Ca        1    24.92 0.5589  0.686   
## Mg        1    52.61 1.1799  0.303   
## S         1   100.07 2.2441  0.095 . 
## Al        1   177.91 3.9900  0.024 * 
## Fe        1   118.59 2.6595  0.053 . 
## Mn        1    25.96 0.5822  0.621   
## Zn        1    35.81 0.8030  0.483   
## Mo        1    23.51 0.5273  0.668   
## Baresoil  1    98.64 2.2122  0.100 . 
## Humdepth  1    43.59 0.9777  0.402   
## pH        1    38.93 0.8730  0.460   
## Residual  9   401.31                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>La p-value est la probabilit√© que les pentes calcul√©es pour les variables √©mergent de distributions dont la moyenne est nulle. Au seuil 0.05, les variables significatives sont (les clr de) l‚Äôazote, le phosphore, le potassium et l‚Äôaluminium.</p>
<p>Dans le cas des matrices d‚Äôabondance (ce n‚Äôest pas le cas de varespec, constitu√©e de donn√©es de recouvrement), il est pr√©f√©rable avec les RDA de les transformer pr√©alablement avec la transformation compositionnelle, de chord ou de Hellinger (chapitre <a href="chapitre-explorer.html#chapitre-explorer">8</a>). Une autre option est d‚Äôeffectuer une RDA sur des matrices d‚Äôassociation en passant par une analyse en coordonn√©es principales (<a href="http://www.jstor.org/stable/2657192">Legendre et Anderson, 1999</a>). Enfin, les donn√©es d‚Äôabondance √† l‚Äô√©tat brutes devraient plut√¥t passer utiliser une analyse canonique des corr√©lations.</p>
</div>
</div>
<div id="analyse-canonique-des-correspondances-acc" class="section level4">
<h4><span class="header-section-number">9.4.2.3</span> Analyse canonique des correspondances (ACC)</h4>
<p>L‚Äôanalyse canonique des correspondances (<em>Canonical correspondance analysis</em>), ACC, a √©t√© √† l‚Äôorigine con√ßue pour √©tudier les liens entre des variables environnementales et l‚Äôabondance (d√©compte) ou l‚Äôoccurence (pr√©sence-absence) d‚Äôesp√®ces (<a href="https://www.ohio.edu/plantbio/staff/mccarthy/multivariate/terBraak1986.pdf">ter Braak, 1986</a>). L‚ÄôACC est √† la RDA ce que la CA est √† l‚ÄôACP. Alors que la RDA pr√©serve les distance euclidiennes entre variables d√©pendantes et indpendantes, l‚ÄôACC pr√©serve les distances du <span class="math inline">\(\chi^2\)</span>. Tout comme l‚ÄôAC, elle h√©rite du coup une propri√©t√© importate de la distance du <span class="math inline">\(\chi^2\)</span>: il y a davantage davantage d‚Äôimportance aux esp√®ces rares.</p>
<p>L‚Äôanalyse des correspondances canoniques est souvent utilis√©e dans la litt√©rature, mais dans bien des cas une RDA sur des donn√©es d‚Äôabondance transform√©es donnera des r√©sultats davantage int√©rpr√©tables (<a href="https://doi.org/10.1007/s004420100716">Legendre et Gallagher, 2001</a>).</p>
<div id="application-8" class="section level5">
<h5><span class="header-section-number">9.4.2.3.1</span> Application</h5>
<p>Cet exemple d‚Äôapplication concerne des donn√©es d‚Äôabondance. Nous allons cons√©quemment utiliser une CCA avec la fonction <code>cca</code>, toujours avec le module vegan.</p>
<p>Les tableaux <a href="https://rdrr.io/cran/ade4/man/doubs.html"><code>doubs_fish</code> et <code>doubs_env</code></a> comprennent respectivement des donn√©es d‚Äôabondance d‚Äôesp√®ces de poissons et dans diff√©rents environnements de la rivi√®re Doubs (Europe) publi√©es dans <a href="https://www.worldcat.org/title/cours-deau-de-franche-comte-massif-du-jura-recherches-ecologiques-sur-le-reseau-hydrographique-du-doubs-essai-de-biotypologie/oclc/496763306">Verneaux. (1973)</a> et export√©es du module <a href="https://rdrr.io/rforge/ade4/"><code>ade4</code></a>.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb770-1" title="1"><span class="kw">data</span>(<span class="st">&quot;doubs&quot;</span>)</a>
<a class="sourceLine" id="cb770-2" title="2">doubs_fish &lt;-<span class="st"> </span>doubs<span class="op">$</span>fish</a>
<a class="sourceLine" id="cb770-3" title="3">doubs_env &lt;-<span class="st"> </span>doubs<span class="op">$</span>env</a></code></pre></div>
<p>Sur le site no 8, aucun poisson n‚Äôa pas √©t√© observ√©. Les observations ne comprenant que des z√©ro doivent √™tre pr√©alablement retir√©es.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb771-1" title="1">tot_spec &lt;-<span class="st"> </span>doubs_fish <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb771-2" title="2"><span class="st">  </span><span class="kw">transmute</span>(<span class="dt">tot_spec =</span> <span class="kw">apply</span>(., <span class="dv">1</span>, sum))</a>
<a class="sourceLine" id="cb771-3" title="3">doubs_fish &lt;-<span class="st"> </span>doubs_fish <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb771-4" title="4"><span class="st">  </span><span class="kw">filter</span>(tot_spec <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb771-5" title="5">doubs_env &lt;-<span class="st"> </span>doubs_env <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb771-6" title="6"><span class="st">  </span><span class="kw">filter</span>(tot_spec <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</a></code></pre></div>
<p>De la m√™me mani√®re qu‚Äôavec la fonction <code>rda</code> de vegan, nous utilisons <code>cca</code> pour l‚ÄôACC.</p>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb772-1" title="1">doubs_cca &lt;-<span class="st"> </span><span class="kw">cca</span>(doubs_fish <span class="op">~</span><span class="st"> </span>., <span class="dt">data =</span> doubs_env, <span class="dt">scale =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p>Comparons les r√©sultats</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb773-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb773-2" title="2"><span class="kw">ordiplot</span>(doubs_cca, <span class="dt">scaling =</span> <span class="dv">1</span>, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;CCA - Scaling 1 - Triplot de distance&quot;</span>)</a>
<a class="sourceLine" id="cb773-3" title="3"><span class="kw">ordiplot</span>(doubs_cca, <span class="dt">scaling =</span> <span class="dv">2</span>, <span class="dt">type =</span> <span class="st">&quot;text&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;CCA - Scaling 2 - Triplot de corr√©lation&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/apo-doubs-cca-ordiplot-1.png" width="960" /></p>
<p><strong>Triplot de distance (scaling 1)</strong>.</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>La projection des variables r√©ponse √† angle droit sur les variables explicatives est une approximation de la r√©ponse sur l‚Äôexplication. (2) Un objet (site ou r√©ponse) situ√© pr√®s d‚Äôune variable explicative est plus susceptible d‚Äôavoir le d√©compte <code>1</code>. (3) Les distances entre les variables (r√©ponse et explicatives) approximent la distance du <span class="math inline">\(\chi^2\)</span> (traduction adapt√©e de <a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>).</li>
</ol>
</blockquote>
<p><strong>Triplot de corr√©lation (scaling 2)</strong>.</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>La valeur optmiale de l‚Äôesp√®ce sur une variable environnementale quantitative peut √™tre obtenue en projetant l‚Äôesp√®ce √† angle droit sur la variable. (2) Une esp√®ce se trouvant pr√®s d‚Äôune variable environnementale est susceptible de se trouver en plus grande abondance aux sites de statut <code>1</code> pour cette variable. (3) Les distances n‚Äôapproximent pas la distance du <span class="math inline">\(\chi^2\)</span> (traduction adapt√©e de <a href="http://www.springer.com/us/book/9781441979759">Borcard et al.¬†(2011)</a>).</li>
</ol>
</blockquote>

</div>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre-explorer.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre-outliers.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
