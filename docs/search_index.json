[
["chapitre-intro-a-R.html", "2 La science des donn√©es avec R 2.1 Statistiques ou science des donn√©es? 2.2 D√©buter en R 2.3 Pr√©parer son flux de travail 2.4 Premiers pas avec R 2.5 Enfin‚Ä¶ 2.6 Petit truc! 2.7 Extra: Utiliser R avec Jupyter", " 2 La science des donn√©es avec R Ô∏è Objectifs sp√©cifiques: √Ä la fin de ce chapitre, vous saurez contextualiser la science des donn√©es par rapport aux statistiques, serez en mesure de vous lancer dans un environnement de programmation R, serez en mesure d‚Äôeffectuer des op√©rations de base en R, saurez diff√©rencier les grands types d‚Äôobjets de R et saurez installer et charger des modules compl√©mentaire. Un projet en science des donn√©es comprend trois grandes √©tapes. D‚Äôabord, vous devez collecter des donn√©es et vous les compilez ad√©quatement. Cela peut consister √† t√©l√©charger des donn√©es existantes, ex√©cuter un dispositif exp√©rimental ou effectuer une recensement (√©tude observationnelle). Compiler les donn√©es dans un format qui puisse √™tre import√© est une t√¢che souvent longue et fastidieuse. Puis, vous investiguez les donn√©es collect√©es, c‚Äôest-√†-dire vous les visualisez, vous appliquez des mod√®les et testez des hypoth√®ses. Enfin, la communication des r√©sultats consiste √† pr√©senter les connaissances qui √©mergent de votre analyse sous forme visuelle et narrative, avec un langage adapt√© √† la personne qui vous √©coute, qu‚Äôelle soit experte ou novice, r√©viseure de revue savante ou gestionnaire Grolemund et Wickham (2018) propose la structure d‚Äôanalyse de la figure 2.1, avec de l√©g√®res modifications de ma part. Figure 2.1: Flux des donn√©es en sciences des donn√©es. Le grand cadre sp√©cifie Programmer. Oui, vous aurez besoin d‚Äô√©crire du code. Mais comme je l‚Äôai indiqu√© dans le premier chapitre, ceci n‚Äôest pas un cours de programmation et je pr√©f√©rerai les approches intuitives. 2.1 Statistiques ou science des donn√©es? Selon Whitlock et Schluter (2015), la statistique est l‚Äô√©tude des m√©thodes pour d√©crire et mesurer des aspects de la nature √† partir d‚Äô√©chantillon. Pour Grolemund et Wickham (2018), la science des donn√©es est une discipline excitante permettant de transformer des donn√©es brutes en compr√©hension, perspectives et connaissances. Oui, excitante! La diff√©rence entre les deux champs d‚Äôexpertise est subtile, et certaines personnes n‚Äôy voient qu‚Äôune diff√©rence de ton. Data Science is statistics on a Mac. ‚Äî Big Data Borat (@BigDataBorat) 27 ao√ªt 2013 Confin√©es √† ses applications traditionnelles, les statistiques sont davantage vou√©es √† la d√©finition de dispositifs exp√©rimentaux et √† l‚Äôex√©cution de tests d‚Äôhypoth√®ses, alors que la science des donn√©es est moins lin√©aire, en particulier dans sa phase d‚Äôanalyse, o√π de nouvelles questions (donc de nouvelles hypoth√®ses) peuvent √™tre pos√©es au fur et √† mesure de l‚Äôanalyse. Cela arrive g√©n√©ralement davantage lorsque l‚Äôon fait face √† de nombreuses observations sur lesquelles de nombreux param√®tres sont mesur√©s. La quantit√© de donn√©es et de mesures auxquelles nous avons aujourd‚Äôhui acc√®s gr√¢ce aux technologies de mesure et de stockage relativement peu dispendieux rend la science des donn√©es une discipline particuli√®rement attrayante, pour ne pas dire sexy. 2.2 D√©buter en R R est un langage de programmation d√©riv√© du langage S, qui fut initialement lanc√© en 1976. Figure 2.2: Logo officiel du language R. R figure parmi les langages de programmation les plus utilis√©s au monde. Bien qu‚Äôil soit bas√© sur les langages statiques C et Fortran, R est un langage dynamique, c‚Äôest-√†-dire que le code peut √™tre ex√©cut√© ligne par ligne ou bloc par bloc: un avantage majeur pour des activit√©s qui n√©cessitent des interactions fr√©quentes. Bien que R soit surtout utilis√© pour le calcul statistique, il s‚Äôimpose de plus en plus comme outil privil√©gi√© en sciences des donn√©es en raison des r√©cents d√©veloppements de modules d‚Äôanalyse, de mod√©lisation et de visualisation, dont plusieurs seront utilis√©s dans ce manuel. Un langage de programmation s‚Äôapprend un peu comme une langue. Au d√©but, un code R peut sembler incompr√©hensible. Et face √† son clavier, on ne sait pas trop comment exprimer ce que l‚Äôon d√©sire. Au fur et √† mesure de l‚Äôapprentissage, les symboles, les fonctions et le style deviennent de plus en plus familiers et on apprend tranquillement √† traduire en code ce que l‚Äôon d√©sire effectuer. Comme une langue s‚Äôapprend en la parlant dans la vie de tous les jours, un language de programmation s‚Äôapprend avantageusement en solutionnant vos propres probl√®mes (figure 2.3). Figure 2.3: R avant et maintenant, Illustration de Allison Horst 2.3 Pr√©parer son flux de travail Il existe de nombreuses mani√®res d‚Äôutiliser R. Parmi celles-ci, j‚Äôen couvrirai 3: Installation classique (installation sugg√©r√©e) Installation avec Anaconda Utilisation infonuagique 2.3.1 Installation classique Installation sugg√©r√©e. Sur Windows ou Mac, dirigez-vous ici, t√©l√©chargez et installez. Sur Linux, ouvrez votre gestionnaire d‚Äôapplication, chercher r-base (Ubuntu, Debian), R-base (openSuse) ou R-core (Fedora) et installez-le (assurez-vous que les librairies suivantes sont aussi install√©es: gcc, gcc-fortran, gcc-c++ et make), vous aurez peut-√™tre besoin d‚Äôinstaller des librairies suppl√©mentaires pour faire fonctionner certains modules. Note. Les modules pr√©sent√©s dans ce cours devraient √™tre disponibles sur Linux, Windows et Mac. Ce n‚Äôest pas le cas pour tous les modules R. La plupart fonctionnent n√©anmoins sur Linux, dont les syst√®mes d‚Äôop√©ration (je recommande Ubuntu ou l‚Äôune de ses d√©riv√©es comme elementary OS) sont de bonnes options pour le calcul scientifique. √Ä cette √©tape, R devrait fonctionner dans un interpr√©teur de commande . Si vous lancez R dans un terminal (chercher cmd dans le menu si vous √™tes sur Windows), vous obtiendrez quelque chose comme ceci. Figure 2.4: R dans le terminal. Le symbole &gt; indique que R attend que vos instructions. Vous voil√† dans un √©tat m√©ditatif devant l‚Äôind√©chiffrable vide du terminal üòµ. Ne vous en faites pas: nous commencerons bient√¥t √† jaser avec R. Avant cela, installons-nous au salon. Afin de travailler dans un environnement de travail plus confortable, je recommande l‚Äôinstallation de l‚Äôinterface RStudio, gratuite et open source: t√©l√©chargez l‚Äôinstallateur et suivez les instructions. RStudio ressemble √† ceci. Figure 2.5: Fen√™tre de RStudio. En haut √† droite se trouve un menu Project (None). Il s‚Äôagit d‚Äôun menu de vos projets. Je recommande d‚Äôutiliser ces projets avec RStudio, qui vous permettront de mieux g√©rer vos sessions de travail, en particulier en lien avec les chemins vers de vos donn√©es, graphiques, etc., que vous pouvez g√©rer relativement √† l‚Äôemplacement de votre dossier de projet plut√¥t qu‚Äô√† l‚Äôemplacement des fichiers sur votre machine: nous verrons plus en d√©tails au chapitre 5. En haut √† gauche, vous avez vos feuilles de calcul, qui appara√Ætront en tant qu‚Äôonglets. Une feuille de calcul est une s√©rie de commandes que vous lancez en s√©quence. Il peut aussi s‚Äôagir d‚Äôun livre de calcul (notebook) si vous choisissez de travailler en format R markdown. Ce format vous permettra de d‚Äô√©crire du texte en format Markdown entre des blocs de code. Il est question du format R markdown au chapitre (chapitre-git). En bas √† gauche appara√Æt la Console, o√π vous voyez les commandes envoy√©es √† R ainsi que ses sorties. En haut √† droite, les diff√©rents onglets indiquent o√π vous en √™tes dans vos calculs. En particulier, la liste sous Environment indique les objets qui ont √©t√© g√©n√©r√©s ou charg√©s jusqu‚Äôalors. En bas √† droite, on retrouve des onglets de nature vari√©s. Files contient les sous-dossiers et fichiers du dossier de projets. Plots est l‚Äôendroit o√π appara√Ætront vos graphiques. Packages contient la liste des modules d√©j√† install√©s, ainsi qu‚Äôun outil de gestion des modules pour leur installation, leur d√©sinstallation et leur mise √† jour. Help affiche les fiches d‚Äôaide des fonctions (pour obtenir de l‚Äôaide sur une fonction dans RStudio, surlignez la fonction dans votre feuille de calcul, puis appuyez sur F1). Enfin, l‚Äôonglet Viewer affichera les sorties HTML, en particulier les graphiques interactifs que vous g√©n√©rerez par exemple avec le module plotly. Si votre environnement de travail √©tait un avion, R serait le moteur et RStudio serait le cockpit! Figure 2.6: Sc√®ne de Fifi Brindacier (Astrid Lindgren, 1945). 2.3.2 Installation avec Anaconda Si vous cherchez une trousse compl√®te d‚Äôanalyse de donn√©es, comprenant R et Python, vous pourrez pr√©f√©rer Anaconda. Une fois install√©e, vous pourrez isoler un environnement de travail sur R, ou m√™me isoler des environnements de travail particuliers pour vos projets. Une mani√®re conviviale de cr√©er des environnements de travail est de passer par l‚Äôinterface Anaconda navigator, que vous lancerez soit dans le menu Windows, soit en ligne de commande anaconda-navigator sous Mac et Linux, puis d‚Äôinstaller r-essentials, rstudio et jupyterlab dans l‚Äôonglet Environment. Vous pourrez aussi installer RStudio et Jupyter lab via l‚Äôonglet Home de Anaconda navigator. Dans l‚Äôenvironnement de base, installez le package nb_conda_kernels pour vous assurer que tous les noyaux (R, Python, etc.) install√©s dans les environnements de travail soient automatiquement accessibles dans Jupyter. Si vous d√©sirez utiliser dans Jupyter la version de R install√©e avec l‚Äôinstallation classique, r√©f√©rez-vous au guide pr√©sent√© en extra au bas de la page. Figure 2.7: Anaconda navigator. Jupyter lab est une interface notebook semblable √† R markdown - les format Jupyter (*.ipynb) et R markdown (*.Rmd) sont par ailleurs convertibles gr√¢ce au module jupytext. L‚Äôutilisation de R en Anaconda n‚Äôest pas tout √† fait au point, et pourrait poser probl√®me pour l‚Äôinstallation de certains modules. Si vous optez pour cette option, pr√©parez-vous √† avoir √† bidouiller un peu. Plusieurs pr√©f√®rent Jupyter √† RStudio (ce n‚Äôest pas mon cas). 2.3.3 Utilisation infonuagique Pas besoin d‚Äôavoir une machine super puissante pour travailler en R. Il existe une multitude de services infonuagiques (dans le cloud) vous permettant de lancer vos calculs sur des serveurs plut√¥t que sur votre Chromebook ou votre vieux laptop d√©glingu√©. Certains services sont gratuits, et d‚Äôautres souvent plus √©labor√©s sont payants. Vous pouvez utiliser gratuitement Azure Notebooks ou un tour de passe-passe pour faire fonctionner Google colab en R. Une option gratuite de CoCalc vient avec un agressant bandeau rouge vif qui disparait avec l‚Äôoption payante. √Ä mon avis, le service Nextjournal est celui d‚Äôentre tous qui poss√®de en ce moment les meilleures qualit√©s dans sa version gratuite. Vous pourrez y travailler en mode collaboratif, comme dans Google docs. En outre, vous pouvez lancer ces notes de cours en les important dans Nextjournal. Vous devrez toutefois d√©poser les donn√©es dans l‚Äôinterface, puis √† chaque session installer les modules sp√©cialis√©s. Le sevice gratuit offre peu de puissance de calcul, mais pour effectuer les applications de base, √ßa devrait √™tre suffisant. 2.4 Premiers pas avec R R ne fonctionne pas avec des menus, en faisant danser une souris sous une musique de clics. Vous devrez donc entrer des commandes avec votre clavier, que vous apprendrez par c≈ìur au fur et √† mesure, ou que vous retrouverez en lan√ßant des recherches sur internet. Par exp√©rience personnelle, lorsque je travaille avec R, j‚Äôai toujours un navigateur ouvert pr√™t √† recevoir une question. Les √©tapes qui suivent sont des premiers pas. Elles ne feront pas de vous des ceintures noires del√† programmation. La plupart des utilisateurs de R ont appris R en se pratiquant sur leurs donn√©es, en frappant des murs, en apprenant comment les escalader ou les contourner‚Ä¶ Pour l‚Äôinstant, ouvrez seulement un interpr√©teur de commande, et lancez R. Voyons si R est aussi libre qu‚Äôon le pr√©tend. ‚ÄúLa libert√©, c‚Äôest la libert√© de dire que deux et deux font quatre. Si cela est accord√©, tout le reste suit.‚Äù - George Orwell, 1984 2 + 2 ## [1] 4 Et voil√†. Les op√©rations math√©matiques sont effectu√©es telles que l‚Äôon devrait s‚Äôattendre. 67.1 - 43.3 ## [1] 23.8 2 * 4 ## [1] 8 1 / 2 ## [1] 0.5 L‚Äôexposant peut √™tre not√© ^, comme c‚Äôest le cas dans Excel, ou ** comme c‚Äôest le cas en Python. 2^4 ## [1] 16 2**4 ## [1] 16 1 / 2 # utilisez des espaces de part et d&#39;autre des op√©rateurs (sauf pour l&#39;exposant) pour √©claircir le code ## [1] 0.5 R ne lit pas ce qui suit le caract√®re #. Cela vous laisse l‚Äôopportunit√© de commenter un code comprenant une s√©quence de plusieurs lignes. Remarquez √©galement que la derni√®re op√©ration comporte des espaces entre les nombres et l‚Äôop√©rateur /. Dans ce cas (ce n‚Äôest pas toujours le cas), les espaces ne signifient rien: ils aident seulement √† √©claircir le code. Il existe des guides pour l‚Äô√©criture de code en R. Je recommande le guide de style de Hadley Wickahm. Assigner des objets √† des variables est fondamental en programmation. En R, on assigne traditionnellement avec la fl√®che &lt;-, mais vous verrez parfois le =, qui est davantage utilis√© comme standard dans d‚Äôautres langages de programmation. Par exemple. a &lt;- 3 Techniquement, a pointe vers le nombre entier 3. Cons√©quemment, on peut effectuer des op√©rations sur a. a * 6 ## [1] 18 # A + 2 Le message d‚Äôerreur nous dit que A n‚Äôest pas d√©fini. Sa version minuscule, a, l‚Äôest pourtant. La raison est que R consid√®re la case dans la d√©finition des objets. Utiliser la mauvaise case m√®ne donc √† des erreurs. Note. Les messages d‚Äôerreur ne sont pas toujours clairs, mais vous apprendrez √† les comprendre. Dans tous les cas, ils sont fait pour vous aider. Lisez-les attentivement! En g√©n√©ral, le nom d‚Äôune variable doit toujours commencer par une lettre, et ne doit pas contenir de caract√®res r√©serv√©s (espaces, +, *). Dans la d√©finition des variables, plusieurs utilisent des symboles . pour d√©limiter les mots, mais la barre de soulignement _ est √† pr√©f√©rer. En effet, dans d‚Äôautres langages de programmation comme Python, le . a une autre signification: son utilisation est √† √©viter autant que possible. Note. √Ä ce stade, vous serez probablement plus √† l‚Äôaise de copier-coller ces commandes dans votre terminal. rendement_arbre &lt;- 50 # pomme/arbre nombre_arbre &lt;- 300 # arbre nombre_pomme &lt;- rendement_arbre * nombre_arbre nombre_pomme ## [1] 15000 Comme chez la plupart des langages de programmation, R respecte les conventions des priorit√©s des op√©rations math√©atiques. 10 - 9^0.5 * 2 ## [1] 4 2.4.1 Types de donn√©es Jusqu‚Äô√† maintenant, nous n‚Äôavons utilis√© que des nombres entiers (integer ou int) et des nombres r√©els (numeric ou float64). R inclut d‚Äôautres types. La cha√Æne de caract√®re (string ou character) contient un ou plusieurs symboles. Elle est d√©finie entre des doubles guillemets \" \" ou des apostrophes ' '. Il n‚Äôexiste pas de standard sur l‚Äôutilisation de l‚Äôun ou de l‚Äôautre, mais en r√®gle g√©n√©rale, on utilise les apostrophes pour les expressions courtes, contenant un simple mot ou s√©quence de lettres, et les guillemets pour les phrases. Une raison pour cela: les guillemets sont utiles pour ins√©rer des apostrophes dans une cha√Æne de caract√®re. a &lt;- &quot;L&#39;ours&quot; b &lt;- &quot;polaire&quot; paste(a, b) ## [1] &quot;L&#39;ours polaire&quot; On colle a et b avec la fonction paste. Notez que l‚Äôobjet a a √©t√© d√©fini pr√©c√©demment. Il est possible en R de r√©assigner une variable, mais cela peut porter √† confusion, jusqu‚Äô√† g√©n√©rer des erreurs de calcul si une variable n‚Äôest pas assign√©e √† l‚Äôobjet auquel on voulait r√©f√©rer. Combien de caract√®res contient la cha√Æne \"L'ours polaire\"? R sait compter. Demandons-lui. c &lt;- paste(a, b) nchar(c) ## [1] 14 Quatorze, c‚Äôest bien cela (comptez ‚ÄúL‚Äôours polaire‚Äù, en incluant l‚Äôespace). Comme paste, nchar est une fonction incluse par d√©faut dans l‚Äôenvironnement de travail de R: plus pr√©cis√©ment, ces fonctions sont incluses dans le module base, inclut par d√©faut lorsque R est lanc√©. La fonction est appel√©e en √©crivant nchar(). Mais une fonction de quoi? Des arguments, qui se trouvent entre les parenth√®ses. Dans ce cas, il y a un seul argument: c. En calcul scientifique, il est courant de lancer des requ√™tes sur si un r√©sultat est vrai ou faux. a &lt;- 17 a &lt; 10 ## [1] FALSE a &gt; 10 ## [1] TRUE a == 10 ## [1] FALSE a != 10 ## [1] TRUE a == 17 ## [1] TRUE !(a == 17) ## [1] FALSE Je viens d‚Äôintroduire un nouveau type de donn√©e: les donn√©es bool√©ennes (boolean, ou logical), qui ne peuvent prendre que deux √©tats - TRUE ou FALSE. En m√™me temps, j‚Äôai utilis√© la fonction print parce que dans mon carnet, seule la derni√®re op√©ration permet d‚Äôafficher le r√©sultat. Si l‚Äôon veut forcer une sortie, on utilise print. Puis, on a vu plus haut que le symbole = est r√©serv√© pour assigner des objets: pour les tests d‚Äô√©galit√©, on utilise le double √©gal, ==, ou != pour la non-√©galit√©. Enfin, pour inverser une donn√©e de type bool√©enne, on utilise le point d‚Äôexclamation !. 2.4.2 Les collections de donn√©es Les exercices pr√©c√©dents ont permis de pr√©senter les types de donn√©es offerts par d√©faut sur R qui sont les plus importants pour le calcul scientifique: int (integer, ou nombre entier), numeric (nombre r√©el), character (string, ou cha√Æne de caract√®re) et logical (bool√©en). D‚Äôautres s‚Äôajouteront tout au long du cours, comme les cat√©gories (factor) et les unit√©s de temps (date-heure). Lorsque l‚Äôon proc√®de √† des op√©rations de calcul en science, nous utilisons rarement des valeurs uniques. Nous pr√©f√©rons les organiser et les traiter en collections. Par d√©faut, R offre quatre types importants de collections: les vecteurs, les matrices, les listes et les tableaux. 2.4.2.1 Vecteurs D‚Äôabord, les vecteurs sont une s√©rie de variables de m√™me type. Un vecteur est d√©limit√© par la fonction c( ) (c pour concat√©nation). Les √©l√©ments de la liste sont s√©par√©s par des virgules. espece &lt;- c(&quot;Petromyzon marinus&quot;, &quot;Lepisosteus osseus&quot;, &quot;Amia calva&quot;, &quot;Hiodon tergisus&quot;) espece ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; ## [4] &quot;Hiodon tergisus&quot; Pour acc√©der aux √©l√©ments d‚Äôune liste, appelle la liste suivie de la position de l‚Äôobjet d√©sir√© entre crochets. espece[1] ## [1] &quot;Petromyzon marinus&quot; espece[2] ## [1] &quot;Lepisosteus osseus&quot; espece[1:3] ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; espece[c(1, 3)] ## [1] &quot;Petromyzon marinus&quot; &quot;Amia calva&quot; On peut noter que le premier √©l√©ment de la liste est not√© 1, et non 0 comme c‚Äôest le cas de la plupart de langages. Le raccourcis 1:3 cr√©e une liste de nombres entiers de 1 √† 3 inclusivement, c‚Äôest-√†-dire l‚Äô√©quivalent de c(1, 2, 3). En effet, on cr√©e une liste d‚Äôindices pour soutirer des √©l√©ments d‚Äôune liste. On peut utiliser le symbole de soustraction pour retirer un ou plusieurs √©l√©ments d‚Äôun vecteur. espece[-c(1, 3)] ## [1] &quot;Lepisosteus osseus&quot; &quot;Hiodon tergisus&quot; Pour ajouter un √©l√©ment √† notre liste, on peut utiliser la fonction c( ). espece &lt;- c(espece, &quot;Cyprinus carpio&quot;) espece ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; ## [4] &quot;Hiodon tergisus&quot; &quot;Cyprinus carpio&quot; Notez que l‚Äôon efface l‚Äôobjet espece par une concat√©nation de l‚Äôobjet espece, pr√©c√©demment d√©finie, et d‚Äôun autre √©l√©ment. En lan√ßant espece[3] &lt;- \"Lepomis gibbosus\", il est possible de changer un √©l√©ment de la liste. espece[3] &lt;- &quot;Lepomis gibbosus&quot; espece ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Lepomis gibbosus&quot; ## [4] &quot;Hiodon tergisus&quot; &quot;Cyprinus carpio&quot; 2.4.2.2 Matrices Une matrice est un vecteur de dimension plus √©lev√©e que 1. En √©cologie, on d√©passe rarement la deuxi√®me dimension, quoi que les matrices en N dimensions soient courantes en mod√©lisation math√©matique. Je ne consid√©rerai pour le moment que des matrices 2D. Comme c‚Äôest la cas des vecteurs, les matrices contiennent des valeurs de m√™me type. En R, on peut attribuer aux matrices 2D des noms de ligne et de colonne. mat &lt;- matrix(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12), ncol = 3) mat ## [,1] [,2] [,3] ## [1,] 1 5 9 ## [2,] 2 6 10 ## [3,] 3 7 11 ## [4,] 4 8 12 colnames(mat) &lt;- c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;) rownames(mat) &lt;- c(&quot;site_1&quot;, &quot;site_2&quot;, &quot;site_3&quot;, &quot;site_4&quot;) mat ## A B C ## site_1 1 5 9 ## site_2 2 6 10 ## site_3 3 7 11 ## site_4 4 8 12 On peut soutirer les noms de colonne et les noms de ligne. Le r√©sultat est un vecteur. colnames(mat) ## [1] &quot;A&quot; &quot;B&quot; &quot;C&quot; rownames(mat) ## [1] &quot;site_1&quot; &quot;site_2&quot; &quot;site_3&quot; &quot;site_4&quot; 2.4.2.3 Listes Les listes sont des collections h√©t√©rog√®nes dans lesquelles on peut placer les objets d√©sir√©s, sans distinction: elles peuvent m√™me inclure d‚Äôautres listes. Chacun des √©l√©ments de la liste peut √™tre identifi√© par une cl√©. ma_liste &lt;- list( especes = c( &quot;Petromyzon marinus&quot;, &quot;Lepisosteus osseus&quot;, &quot;Amia calva&quot;, &quot;Hiodon tergisus&quot; ), site = &quot;A101&quot;, stations_meteos = c(&quot;746583&quot;, &quot;783786&quot;, &quot;856363&quot;) ) ma_liste ## $especes ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; ## [4] &quot;Hiodon tergisus&quot; ## ## $site ## [1] &quot;A101&quot; ## ## $stations_meteos ## [1] &quot;746583&quot; &quot;783786&quot; &quot;856363&quot; Les √©l√©ments de la liste peuvent √™tre soutir√©s par le nom de la cl√© ou par l‚Äôindice, de cette mani√®re. ma_liste$especes ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; ## [4] &quot;Hiodon tergisus&quot; ma_liste[[1]] ## [1] &quot;Petromyzon marinus&quot; &quot;Lepisosteus osseus&quot; &quot;Amia calva&quot; ## [4] &quot;Hiodon tergisus&quot; Exercice. Acc√©der au deuxi√®me √©l√©ment du vecteur d‚Äôesp√®ces dans la liste ma_liste. 2.4.2.4 Tableaux Enfin, le type de collection de donn√©es le plus important est le tableau, ou data.frame. Techniquement, il s‚Äôagit d‚Äôune liste compos√©e de vecteurs de m√™me longueur. Chaque colonne peut ainsi prendre un type de donn√©e ind√©pendamment des autres colonnes. tableau &lt;- data.frame( espece = c( &quot;Petromyzon marinus&quot;, &quot;Lepisosteus osseus&quot;, &quot;Amia calva&quot;, &quot;Hiodon tergisus&quot; ), poids = c(10, 13, 21, 4), longueur = c(35, 44, 50, 8) ) tableau ## espece poids longueur ## 1 Petromyzon marinus 10 35 ## 2 Lepisosteus osseus 13 44 ## 3 Amia calva 21 50 ## 4 Hiodon tergisus 4 8 En programmation classique en R (nous verrons plus loin la m√©thode tidyverse), les √©l√©ments d‚Äôun tableau se manipulent comme ceux d‚Äôune matrice et les colonnes peuvent √™tre appel√©s comme les √©l√©ments d‚Äôune liste. tableau[, 2:3] ## poids longueur ## 1 10 35 ## 2 13 44 ## 3 21 50 ## 4 4 8 tableau$poids ## [1] 10 13 21 4 Vous verrez aussi, quoi que rarement, ce format, qui √† la diff√©rence du format $ g√©n√®re un tableau. tableau[&quot;poids&quot;] ## poids ## 1 10 ## 2 13 ## 3 21 ## 4 4 Le tableau est le format de collection √† privil√©gier pour manipuler des donn√©es. R√©cemment, le format de tableau tibble a √©t√© cr√©√© par l‚Äô√©quipe de RStudio pour offrir un format plus moderne. 2.4.3 Les fonctions Lorsque vous √©crivez une commande suivit de parenth√®ses, comme data.frame(especes = ...), vous demandez √† R de passer √† l‚Äôaction en appelant une fonction. De mani√®re tr√®s g√©n√©rale, une fonction transforme quelque chose en quelque chose d‚Äôautre (figure 2.8). Figure 2.8: Sch√©ma simplifi√© d‚Äôune fonction. Par exemple, la fonction mean() prend une collection de nombre comme entr√©e, puis en sort vous devinez quoi. mean(tableau$poids) ## [1] 12 Les entr√©es sont appel√©s les arguments de la fonction. Leur d√©finition est toujours disponible dans la documentation. Exercice. Familiarisez-vous avec la documentation de R en lan√ßant ?mean. Truc: si vous avez pris de l‚Äôavance et que vous travaillez d√©j√† en RStudio, mettez le terme en surbrillance, puis appuyez sur F1. Vous verrez dans la documentation que la fonction mean() demande trois arguments, x, trim et na.rm. Or nous avons seulement plac√© un vecteur, sans sp√©cifier d‚Äôargument! En effet. En l‚Äôabsence d‚Äôune d√©finition des arguments, R supposera que les arguments dans la parenth√®se, s√©par√©s par une virgule, sont pr√©sent√©s dans le m√™me ordre que celui sp√©cifi√© dans la d√©finition de la fonction (celle qui est pr√©sent√©e dans le fichier d‚Äôaide). Dans le cas qui nous int√©resse, mean(tableau$poids) est √©quivalent √† mean(x = tableau$poids). Maintenant, selon la fiche d‚Äôaire l‚Äôargument na.rm est un valeur logique sp√©cifiant si oui (TRUE) ou non (FALSE) les valeurs manquantes doivent √™tre consid√©r√©es (une moyenne d‚Äôun vecteur comprenant au moins un NA sera de NA). En ne sp√©cifiant rien, R prend la valeur par d√©faut, telle que sp√©cifi√©e dans la documentation. Il en va de m√™me que l‚Äôargument trim, qui permet d‚Äô√©laguer des valeurs extr√™mes. Dans la fiche d‚Äôaide, mean(x, trim = 0, na.rm = FALSE, ...) signifie que par d√©faut, l‚Äôargument x est vide (il doit donc √™tre sp√©cifi√©), l‚Äôargument trim est de 0 et l‚Äôargument na.rm est FALSE. mean(c(6, 1, 7, 4, 9, NA, 1)) ## [1] NA mean(c(6, 1, 7, 4, 9, NA, 1), na.rm = TRUE) ## [1] 4.666667 Vous n‚Äô√™tes pas emprisonn√© par les fonctions offertes par R. Vous pouvez installer des modules qui compl√®tent les fonctions de base de R: on le verra un peu plus loin dans ce chapitre. Mais pour l‚Äôinstant, voyons comment vous pouvez cr√©er vos propres fonctions. Disons que vous voulez cr√©er une fonction qui calcule la sortie de \\(x^3-2y+a\\). Pour obtenir la r√©ponse on a besoin des arguments x, y et a. La sortie de la fonction est ici triviale: la r√©ponse de l‚Äô√©quation. L‚Äôop√©ration function permet de prendre √ßa en charge. operation_f &lt;- function(x, y, a = 10) { return(x^3 - 2 * y + a) } Notez que a a une valeur par d√©faut. La sortie de la fonction est ce qui se trouve entre les parenth√®ses de return. Vous pouvez maintenant utiliser la fonction operation_nl au besoin. operation_f(x = 2, y = 3, a = 1) ## [1] 3 Une telle fonction est peu utile. Mais l‚Äôutilisation de fonctions personnalis√©es vous permettra d‚Äô√©viter de r√©p√©ter la m√™me op√©ration plusieurs fois dans un flux de travail, en √©vitant de g√©n√©rer trop de code, donc aussi de potentielles erreurs. Personnellement, j‚Äôutilise les fonctions surtout pour g√©n√©rer des graphiques personnalis√©s. Exercice. Afin d‚Äôacqu√©rir de l‚Äôautonomie, vous devrez √™tre en mesure de trouver le nom des commandes dont vous avez besoin pour effectuer la t√¢che que vous d√©sirer effectuer. Cela peut causer des frustrations, mais vous vous sentirez toujours plus √† l‚Äôaise avec R jour apr√®s jour. L‚Äôexercice ici est de trouver par vous-m√™me la commande qui vous permettra mesurer la longueur d‚Äôun vecteur. 2.4.4 Les boucles Les boucles permettent d‚Äôeffectuer une m√™me suite d‚Äôop√©rations sur plusieurs objets. Pour faire suite √† notre exemple, nous d√©sirons obtenir le r√©sultat de l‚Äôop√©ration f pour des param√®tres que nous enregistrons dans ce tableau. params &lt;- data.frame( x = c(2, 4, 1, 5, 6), y = c(3, 4, 8, 1, 0), a = c(6, 1, 8, 2, 5) ) params ## x y a ## 1 2 3 6 ## 2 4 4 1 ## 3 1 8 8 ## 4 5 1 2 ## 5 6 0 5 Nous cr√©ons un vecteur vide, puis nous it√©rons ligne par ligne en remplissant le vecteur. operation_res &lt;- c() for (i in 1:nrow(params)) { operation_res[i] &lt;- operation_f(x = params[i, 1], y = params[i, 2], a = params[i, 3]) } operation_res ## [1] 8 57 -7 125 221 En faisant varier i sur des valeurs du vecteur donn√© par la s√©quence de nombre entiers de 1 au nombre de ligne du tableau de param√®tres, nous demandons √† R d‚Äôeffectuer la suite d‚Äôop√©ration entre les accolades {}. √Ä chaque boucle, i prend une valeur de la s√©quence. i est utilis√© ici comme indice de la ligne √† soutirer du tableau params, qui correspond √† l‚Äôindice dans le vecteur operation_res. Ainsi, chaque r√©sultat est calcul√© dans l‚Äôordre des lignes du tableau de param√®tres et l‚Äôon pourra tr√®s bien y coller nos r√©sultats: params$resultats &lt;- operation_res params ## x y a resultats ## 1 2 3 6 8 ## 2 4 4 1 57 ## 3 1 8 8 -7 ## 4 5 1 2 125 ## 5 6 0 5 221 Notez que puisque la colonne resultat n‚Äôexiste pas dans le tableau params, R cr√©e automatiquement une nouvelle colonne. Les boucles for vous permettront par exemple de g√©n√©rer en peu de temps 10, 100, 1000 graphiques (autant que vous voulez), chacun issu de simulations obtenues √† partir de conditions initiales diff√©rentes, et de les enregistrer dans un r√©pertoire sur votre ordinateur. Un travail qui pourrait prendre des semaines sur Excel peut √™tre effectu√© en R en quelques secondes. Un second outil est disponible pour les it√©rations: les boucles while. Elles effectuent une op√©ration tant qu‚Äôun crit√®re n‚Äôest pas atteint. Elles sont utiles pour les op√©rations o√π l‚Äôon cherche une convergence. Je les couvre rapidement puisqu‚Äôelles sont rarement utilis√©es dans les flux de travail courants. En voici un petit exemple. x &lt;- 100 while (x &gt; 1.1) { x &lt;- sqrt(x) print(x) } ## [1] 10 ## [1] 3.162278 ## [1] 1.778279 ## [1] 1.333521 ## [1] 1.154782 ## [1] 1.074608 Nous avons initi√© x √† une valeur de 100. Puis, tant que (while) le test x &gt; 1.1 est vrai, attribuer √† x la nouvelle valeur calcul√©e en extrayant la racine de la valeur pr√©c√©dente de x. Enfin, indiquer la valeur avec print. 2.4.5 Conditions: if, else if, else Si la condition 1 est remplie, effectuer une suite d‚Äôinstruction 1. Si la condition 1 n‚Äôest pas remplie, et si la condition 2 est remplie, effectuer la suite d‚Äôinstruction 2. Sinon, effectuer la suite d‚Äôinstruction 3. Voil√† comment on exprime une suite de conditions. Prenons l‚Äôexemple simple d‚Äôune discr√©tisation d‚Äôune valeur continue. Si \\(x&lt;10\\), il est class√© comme faible. Si \\(10 \\leq x &lt;20\\), il est class√© comme moyen. Si \\(x \\geq 20\\), il est class√© comme √©lev√©. Pla√ßons cette classification dans une fonction. classification &lt;- function(x, lim1 = 10, lim2 = 20) { if (x &lt; lim1) { categorie &lt;- &quot;faible&quot; } else if (x &lt; lim2) { categorie &lt;- &quot;moyen&quot; } else { categorie &lt;- &quot;√©lev√©&quot; } return(categorie) } classification(-10) ## [1] &quot;faible&quot; classification(15.4) ## [1] &quot;moyen&quot; classification(1000) ## [1] &quot;√©lev√©&quot; Une condition est d√©finie avec le if, suivi du test √† vrai ou faux entre parenth√®ses. Si le test retourne un vrai (TRUE), l‚Äôinstruction entre accolades est ex√©cut√©e. Si elle est fausse, on passe au suivant. Exercice. Explorer les commandes ifelse et cut et r√©fl√©chissez √† la mani√®re qu‚Äôelles pourraient √™tre utilis√©es pour effectuer une discr√©tisation plus efficacement qu‚Äôavec les if et les else. 2.4.6 Installer et charger un module La plupart des op√©rations d‚Äôordre g√©n√©ral (comme les racines carr√©es, les tests statistiques, la gestion de matrices et de tableau, les graphiques, etc.) sont accessibles gr√¢ce aux modules de base de R, qui sont install√©s et charg√©s par d√©faut lors du d√©marrage de R. Des √©quipes de travail ont n√©anmoins d√©velopp√© plusieurs modules pour r√©pondre √† leurs besoins sp√©cialis√©s, et les ont laiss√©es disponibles au grand public dans des modules que vous pouvez installer d‚Äôun d√©p√¥t CRAN (le AppStore de R), d‚Äôun d√©p√¥t Anaconda (le AppStore de Anaconda, si vous utilisez cette plate-forme), d‚Äôun d√©p√¥t Github (d√©p√¥ts d√©centralis√©s), etc. RStudio poss√®de un pratique bouton Install qui vous permet d‚Äôy inscrire une liste de modules. Le navigateur anaconda offre aussi une interface d‚Äôinstallation. La commande R pour installer un module est install.packages(\"ggplot2\"), si par exemple vous d√©sirez installer ggplot2, le module graphique par excellence en R. C‚Äôest la commande que RStudio lancera tout seul si vous lui demandez d‚Äôinstaller ggplot2. Les modules sont l‚Äô√©quivalent des applications sp√©cialis√©es que vous installez sur un t√©l√©phone mobile. Pour les utiliser, il faut les ouvrir. G√©n√©ralement, j‚Äôouvre toutes les applications n√©cessaires √† mon flux de travail au tout d√©but de ma feuille de calcul (la prochaine cellule retournera un message d‚Äôerreur si les packages ne sont pas install√©s). library(&quot;tidyverse&quot;) # m√©ta-package qui charge entre autres dplyr et ggplot2 ## -- Attaching packages -------------------------------- tidyverse 1.3.0 -- ## v ggplot2 3.3.0 v purrr 0.3.4 ## v tibble 3.0.0 v dplyr 0.8.5 ## v tidyr 1.0.3 v stringr 1.4.0 ## v readr 1.3.1 v forcats 0.5.0 ## -- Conflicts ----------------------------------- tidyverse_conflicts() -- ## x dplyr::filter() masks stats::filter() ## x dplyr::lag() masks stats::lag() library(&quot;vegan&quot;) ## Loading required package: permute ## Loading required package: lattice ## This is vegan 2.5-6 library(&quot;nlme&quot;) ## ## Attaching package: &#39;nlme&#39; ## The following object is masked from &#39;package:dplyr&#39;: ## ## collapse Les modules sont install√©s sur votre ordinateur √† un endroit que vous pourrez retrouver avec la commande .libPaths() Exercice. √Ä partir d‚Äôici jusqu‚Äô√† la fin du cours, nous utiliserons RStudio. Ouvrez-le et familiarisez-vous avec l‚Äôinterface! Quelques petits trucs: pour lancer une ligne, placez votre curseur sur la ligne, puis appuyez sur Ctrl+Enter pour lancer une partie de code pr√©cise, mettez le en surbrillance, puis Ctrl+Enter utilisez toujours le gestionnaire de projets, en haut √† droite! installez le module tidyverse lancez data(\"iris\") pour obtenir un tableau d‚Äôexercice, puis cliquez sur l‚Äôobjet dans la fen√™tre environnement 2.5 Enfin‚Ä¶ Comme une langue, on n‚Äôapprend √† s‚Äôexprimer en un langage informatique qu‚Äôen se mettant √† l‚Äô√©preuve, ce que vous ferez tout au long de ce cours. Pour vous encourager, voici quelques trucs pour apprendre √† coder en R. R n‚Äôaime pas l‚Äôambigu√Øt√©. Une simple virgule mal plac√©e et il ne sait plus quoi faire. Cela peut √™tre frustrant au d√©but, mais cette rigidit√© est n√©cessaire pour effectuer du calcul scientifique. Le copier-coller est votre ami. En gardant √† l‚Äôesprit que vous √™tre responsable de votre code et que vous respectez les droits d‚Äôauteur, n‚Äôayez pas peur de copier-coller des lignes de code et de personnaliser par la suite. L‚Äôerreur que vous obtenez: d‚Äôautres l‚Äôont obtenue avant vous. Le site de question-r√©ponse stackoverflow est une ressource inestimable o√π des gens ayant post√© des questions ont re√ßu des r√©ponses d‚Äôexperts (les meilleures r√©ponses et les meilleures questions apparaissent en premier). Apprenez √† chercher intelligemment des r√©ponses en formulant pr√©cis√©ment vos questions! √âtudiez et pratiquez. Les messages d‚Äôerreur en R sont courants, m√™me chez les personnes exp√©riment√©es. La meilleure mani√®re d‚Äôapprendre une langue est de la parler, d‚Äô√©tudier ses susceptibilit√©s, de les tester dans une conversation, etc. 2.6 Petit truc! RStudio peut √™tre impl√©ment√© avec des extensions. L‚Äôune d‚Äôelle permet d‚Äôajuster votre style de code. Par exemple, vous voulez vous assurer que toutes les allocations sont bien effectu√©es avec des &lt;- et non pas des =, ‚Äôil y a bien des espaces de part et d‚Äôautre de &lt;-, que les retours de lignes sont bien plac√©s, etc. Installez le module stryler, et des options appara√Ætront dans le menu Addins comme √† la figure ??. Figure 2.9: L‚Äôextension styler permet de formater votre code dans un style particulier 2.7 Extra: Utiliser R avec Jupyter Pour utiliser R dans Jupyter notebook ou Jupyter lab, vous devez installer le module IRkernel dans la version de R que vous d√©sirez utiliser avec Jupyter, puis de lancer la commande IRkernel::installspec(). La prochaine fois que vous ouvrirez Jupyter, le noyau de R devrait appara√Ætre. Je n‚Äôai aucune exp√©rience sur Mac, mais semble-t-il cela fonctionne comme en Linux. Ouvrez R √† partir d‚Äôun terminal (R + Enter), puis lancez IRkernel::installspec() apr√®s avoir install√© IRkernel. Si vous travaillez en Windows, il vous faudra lancer R par son chemin complet dans l‚Äôinvite de commande de Anaconda (Anaconda Powershell Prompt). Par exemple, ouvrir Anaconda Powershell Prompt, puis, si votre installation de R se trouve dans C:\\Program Files\\R\\R-3.6.2, (base) PS C:\\Users\\fifi&gt; cd &quot;C:\\Program Files\\R\\R-3.6.2\\bin&quot; (base) PS C:\\Program Files\\R\\R-3.6.2\\bin&gt; .\\R.exe R version 3.6.2 (2019-12-12) -- &quot;Dark and Stormy Night&quot; Copyright (C) 2019 The R Foundation for Statistical Computing Platform: x86_64-w64-mingw32/x64 (64-bit) R est un logiciel libre livr√© sans AUCUNE GARANTIE. Vous pouvez le redistribuer sous certaines conditions. Tapez &#39;license()&#39; ou &#39;licence()&#39; pour plus de d√©tails. R est un projet collaboratif avec de nombreux contributeurs. Tapez &#39;contributors()&#39; pour plus d&#39;information et &#39;citation()&#39; pour la fa√ßon de le citer dans les publications. Tapez &#39;demo()&#39; pour des d√©monstrations, &#39;help()&#39; pour l&#39;aide en ligne ou &#39;help.start()&#39; pour obtenir l&#39;aide au format HTML. Tapez &#39;q()&#39; pour quitter R. &gt; install.packages(&quot;IRkernel&quot;) Installation du package dans &#39;C:/Users/fifi/Documents/R/win-library/3.6&#39; (car &#39;lib&#39; n&#39;est pas sp√©cifi√©) --- SVP s√©lectionner un miroir CRAN pour cette session --- essai de l&#39;URL &#39;https://cloud.r-project.org/bin/windows/contrib/3.6/IRkernel_1.1.zip&#39; Content type &#39;application/zip&#39; length 138696 bytes (135 KB) downloaded 135 KB le package &#39;IRkernel&#39; a √©t√© d√©compress√© et les sommes MD5 ont √©t√© v√©rifi√©es avec succ√©s Les packages binaires t√©l√©charg√©s sont dans C:\\Users\\fifi\\AppData\\Local\\Temp\\Rtmp6xJtB3\\downloaded_packages &gt; IRkernel::installspec() [InstallKernelSpec] Installed kernelspec ir in C:\\Users\\fifi\\AppData\\Roaming\\jupyter\\kernels\\ir &gt; qui() "]
]
