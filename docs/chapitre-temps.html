<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>12 Les s√©ries temporelles | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</title>
  <meta name="description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="12 Les s√©ries temporelles | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="12 Les s√©ries temporelles | Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes" />
  
  <meta name="twitter:description" content="Ce cours a pour objectif de former les √©tudiants gradu√©s en g√©nie agroenvironnemental, g√©nie civil, g√©nie √©cologique, agronomie, biologie, foresterie et √©cologie en analyse et mod√©lisation de syst√®mes vivants. Les sujets trait√©s sont l‚Äôintroduction au langage de programmation R, l‚Äôanalyse statistique descriptive, la visualisation, la mod√©lisation inf√©rentielle, pr√©dictive et d√©terministe." />
  

<meta name="author" content="Serge-√âtienne Parent" />


<meta name="date" content="2020-05-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="chapitre-ml.html"/>
<link rel="next" href="chapitre-geo.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#d√©finitions"><i class="fa fa-check"></i><b>1.1</b> D√©finitions</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#√†-qui-sadresse-ce-manuel"><i class="fa fa-check"></i><b>1.2</b> √Ä qui s‚Äôadresse ce manuel?</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#les-logiciels-libres"><i class="fa fa-check"></i><b>1.3</b> Les logiciels libres</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#langage-de-programmation"><i class="fa fa-check"></i><b>1.4</b> Langage de programmation</a><ul>
<li class="chapter" data-level="1.4.1" data-path="index.html"><a href="index.html#r"><i class="fa fa-check"></i><b>1.4.1</b> R</a></li>
<li class="chapter" data-level="1.4.2" data-path="index.html"><a href="index.html#pourquoi-pas-python"><i class="fa fa-check"></i><b>1.4.2</b> Pourquoi pas Python?</a></li>
<li class="chapter" data-level="1.4.3" data-path="index.html"><a href="index.html#pourquoi-pas-matlab"><i class="fa fa-check"></i><b>1.4.3</b> Pourquoi pas Matlab?</a></li>
<li class="chapter" data-level="1.4.4" data-path="index.html"><a href="index.html#et-sas"><i class="fa fa-check"></i><b>1.4.4</b> Et‚Ä¶ SAS?</a></li>
<li class="chapter" data-level="1.4.5" data-path="index.html"><a href="index.html#mais-pourquoi-pas-______"><i class="fa fa-check"></i><b>1.4.5</b> Mais pourquoi pas ______ ?</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#contenu-du-manuel"><i class="fa fa-check"></i><b>1.5</b> Contenu du manuel</a></li>
<li class="chapter" data-level="1.6" data-path="index.html"><a href="index.html#objectifs-g√©n√©raux"><i class="fa fa-check"></i><b>1.6</b> Objectifs g√©n√©raux</a></li>
<li class="chapter" data-level="1.7" data-path="index.html"><a href="index.html#lectures-compl√©mentaires"><i class="fa fa-check"></i><b>1.7</b> Lectures compl√©mentaires</a><ul>
<li class="chapter" data-level="1.7.1" data-path="index.html"><a href="index.html#√©cologie-math√©matique"><i class="fa fa-check"></i><b>1.7.1</b> √âcologie math√©matique</a></li>
<li class="chapter" data-level="1.7.2" data-path="index.html"><a href="index.html#programmation"><i class="fa fa-check"></i><b>1.7.2</b> Programmation</a></li>
<li class="chapter" data-level="1.7.3" data-path="index.html"><a href="index.html#divers"><i class="fa fa-check"></i><b>1.7.3</b> Divers</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="index.html"><a href="index.html#besoin-daide"><i class="fa fa-check"></i><b>1.8</b> Besoin d‚Äôaide?</a></li>
<li class="chapter" data-level="1.9" data-path="index.html"><a href="index.html#√†-propos-de-lauteur"><i class="fa fa-check"></i><b>1.9</b> √Ä propos de l‚Äôauteur</a></li>
<li class="chapter" data-level="1.10" data-path="index.html"><a href="index.html#un-cours-compl√©mentaire-√†-dautres-cours"><i class="fa fa-check"></i><b>1.10</b> Un cours compl√©mentaire √† d‚Äôautres cours</a></li>
<li class="chapter" data-level="1.11" data-path="index.html"><a href="index.html#contribuer-au-manuel"><i class="fa fa-check"></i><b>1.11</b> Contribuer au manuel</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html"><i class="fa fa-check"></i><b>2</b> La science des donn√©es avec R</a><ul>
<li class="chapter" data-level="2.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#statistiques-ou-science-des-donn√©es"><i class="fa fa-check"></i><b>2.1</b> Statistiques ou science des donn√©es?</a></li>
<li class="chapter" data-level="2.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#d√©buter-en-r"><i class="fa fa-check"></i><b>2.2</b> D√©buter en R</a></li>
<li class="chapter" data-level="2.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#pr√©parer-son-flux-de-travail"><i class="fa fa-check"></i><b>2.3</b> Pr√©parer son flux de travail</a><ul>
<li class="chapter" data-level="2.3.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-classique"><i class="fa fa-check"></i><b>2.3.1</b> Installation classique</a></li>
<li class="chapter" data-level="2.3.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installation-avec-anaconda"><i class="fa fa-check"></i><b>2.3.2</b> Installation avec Anaconda</a></li>
<li class="chapter" data-level="2.3.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#utilisation-infonuagique"><i class="fa fa-check"></i><b>2.3.3</b> Utilisation infonuagique</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#premiers-pas-avec-r"><i class="fa fa-check"></i><b>2.4</b> Premiers pas avec R</a><ul>
<li class="chapter" data-level="2.4.1" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#types-de-donn√©es"><i class="fa fa-check"></i><b>2.4.1</b> Types de donn√©es</a></li>
<li class="chapter" data-level="2.4.2" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-collections-de-donn√©es"><i class="fa fa-check"></i><b>2.4.2</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="2.4.3" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-fonctions"><i class="fa fa-check"></i><b>2.4.3</b> Les fonctions</a></li>
<li class="chapter" data-level="2.4.4" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#les-boucles"><i class="fa fa-check"></i><b>2.4.4</b> Les boucles</a></li>
<li class="chapter" data-level="2.4.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#conditions-if-else-if-else"><i class="fa fa-check"></i><b>2.4.5</b> Conditions: <code>if</code>, <code>else if</code>, <code>else</code></a></li>
<li class="chapter" data-level="2.4.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#installer-et-charger-un-module"><i class="fa fa-check"></i><b>2.4.6</b> Installer et charger un module</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#enfin"><i class="fa fa-check"></i><b>2.5</b> Enfin‚Ä¶</a></li>
<li class="chapter" data-level="2.6" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#petit-truc"><i class="fa fa-check"></i><b>2.6</b> Petit truc!</a></li>
<li class="chapter" data-level="2.7" data-path="chapitre-intro-a-R.html"><a href="chapitre-intro-a-R.html#extra-jupyter"><i class="fa fa-check"></i><b>2.7</b> Extra: Utiliser R avec Jupyter</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html"><i class="fa fa-check"></i><b>3</b> Organisation des donn√©es et op√©rations sur des tableaux</a><ul>
<li class="chapter" data-level="3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#les-collections-de-donn√©es-1"><i class="fa fa-check"></i><b>3.1</b> Les collections de donn√©es</a></li>
<li class="chapter" data-level="3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#organiser-un-tableau-de-donn√©es"><i class="fa fa-check"></i><b>3.2</b> Organiser un tableau de donn√©es</a></li>
<li class="chapter" data-level="3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#formats-de-tableau"><i class="fa fa-check"></i><b>3.3</b> Formats de tableau</a><ul>
<li class="chapter" data-level="3.3.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#xls-ou-xlsx"><i class="fa fa-check"></i><b>3.3.1</b> <em>xls</em> ou <em>xlsx</em></a></li>
<li class="chapter" data-level="3.3.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#csv"><i class="fa fa-check"></i><b>3.3.2</b> <em>csv</em></a></li>
<li class="chapter" data-level="3.3.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#json"><i class="fa fa-check"></i><b>3.3.3</b> <em>json</em></a></li>
<li class="chapter" data-level="3.3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#sqlite"><i class="fa fa-check"></i><b>3.3.4</b> SQLite</a></li>
<li class="chapter" data-level="3.3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#suggestion"><i class="fa fa-check"></i><b>3.3.5</b> Suggestion</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#entreposer-ses-donn√©es"><i class="fa fa-check"></i><b>3.4</b> Entreposer ses donn√©es</a></li>
<li class="chapter" data-level="3.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#manipuler-des-donn√©es-en-mode-tidyverse"><i class="fa fa-check"></i><b>3.5</b> Manipuler des donn√©es en mode tidyverse</a><ul>
<li class="chapter" data-level="3.5.1" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#importer-vos-donn√©es-dans-votre-session-de-travail"><i class="fa fa-check"></i><b>3.5.1</b> Importer vos donn√©es dans votre session de travail</a></li>
<li class="chapter" data-level="3.5.2" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#comment-s√©lectionner-et-filtrer-des-donn√©es"><i class="fa fa-check"></i><b>3.5.2</b> Comment s√©lectionner et filtrer des donn√©es ?</a></li>
<li class="chapter" data-level="3.5.3" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#le-format-long-et-le-format-large"><i class="fa fa-check"></i><b>3.5.3</b> Le format long et le format large</a></li>
<li class="chapter" data-level="3.5.4" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#combiner-des-tableaux"><i class="fa fa-check"></i><b>3.5.4</b> Combiner des tableaux</a></li>
<li class="chapter" data-level="3.5.5" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#op√©rations-sur-les-tableaux"><i class="fa fa-check"></i><b>3.5.5</b> Op√©rations sur les tableaux</a></li>
<li class="chapter" data-level="3.5.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exemple-difficile"><i class="fa fa-check"></i><b>3.5.6</b> Exemple (difficile)</a></li>
<li class="chapter" data-level="3.5.7" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#exporter-un-tableau"><i class="fa fa-check"></i><b>3.5.7</b> Exporter un tableau</a></li>
<li class="chapter" data-level="3.5.8" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#aller-plus-loin-dans-le-tidyverse"><i class="fa fa-check"></i><b>3.5.8</b> Aller plus loin dans le tidyverse</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="chapitre-tableaux.html"><a href="chapitre-tableaux.html#r√©f√©rences"><i class="fa fa-check"></i><b>3.6</b> R√©f√©rences</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html"><i class="fa fa-check"></i><b>4</b> Visualisation</a><ul>
<li class="chapter" data-level="4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#pourquoi-explorer-graphiquement"><i class="fa fa-check"></i><b>4.1</b> Pourquoi explorer graphiquement?</a></li>
<li class="chapter" data-level="4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publier-un-graphique"><i class="fa fa-check"></i><b>4.2</b> Publier un graphique</a><ul>
<li class="chapter" data-level="4.2.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#cinq-qualit√©s-dun-bon-graphique"><i class="fa fa-check"></i><b>4.2.1</b> Cinq qualit√©s d‚Äôun bon graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-le-type-de-graphique-le-plus-appropri√©"><i class="fa fa-check"></i><b>4.3</b> Choisir le type de graphique le plus appropri√©</a></li>
<li class="chapter" data-level="4.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#choisir-son-outil-de-visualisation"><i class="fa fa-check"></i><b>4.4</b> Choisir son outil de visualisation</a><ul>
<li class="chapter" data-level="4.4.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-imp√©rative"><i class="fa fa-check"></i><b>4.4.1</b> Approche imp√©rative</a></li>
<li class="chapter" data-level="4.4.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#approche-d√©clarative"><i class="fa fa-check"></i><b>4.4.2</b> Approche d√©clarative</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visualisation-en-r"><i class="fa fa-check"></i><b>4.5</b> Visualisation en R</a></li>
<li class="chapter" data-level="4.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#module-de-base-pour-les-graphiques"><i class="fa fa-check"></i><b>4.6</b> Module de base pour les graphiques</a></li>
<li class="chapter" data-level="4.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#la-grammaire-graphique-ggplot2"><i class="fa fa-check"></i><b>4.7</b> La grammaire graphique <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#mon-premier-ggplot"><i class="fa fa-check"></i><b>4.8</b> Mon premier ggplot</a><ul>
<li class="chapter" data-level="4.8.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#plusieurs-sources-de-donn√©es"><i class="fa fa-check"></i><b>4.8.1</b> Plusieurs sources de donn√©es</a></li>
<li class="chapter" data-level="4.8.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-avec-style"><i class="fa fa-check"></i><b>4.8.2</b> Exporter avec style</a></li>
<li class="chapter" data-level="4.8.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#nuages-de-points"><i class="fa fa-check"></i><b>4.8.3</b> Nuages de points</a></li>
<li class="chapter" data-level="4.8.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#diagrammes-en-lignes"><i class="fa fa-check"></i><b>4.8.4</b> Diagrammes en lignes</a></li>
<li class="chapter" data-level="4.8.5" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-histogrammes"><i class="fa fa-check"></i><b>4.8.5</b> Les histogrammes</a></li>
<li class="chapter" data-level="4.8.6" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#boxplots"><i class="fa fa-check"></i><b>4.8.6</b> Boxplots</a></li>
<li class="chapter" data-level="4.8.7" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-diagrammes-en-barre"><i class="fa fa-check"></i><b>4.8.7</b> Les diagrammes en barre</a></li>
<li class="chapter" data-level="4.8.8" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#exporter-un-graphique"><i class="fa fa-check"></i><b>4.8.8</b> Exporter un graphique</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#les-graphiques-comme-outil-dexploration-des-donn√©es"><i class="fa fa-check"></i><b>4.9</b> Les graphiques comme outil d‚Äôexploration des donn√©es</a><ul>
<li class="chapter" data-level="4.9.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-graphiques-interactifs"><i class="fa fa-check"></i><b>4.9.1</b> Des graphiques interactifs!</a></li>
<li class="chapter" data-level="4.9.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#des-extensions-de-ggplot2"><i class="fa fa-check"></i><b>4.9.2</b> Des extensions de <strong><code>ggplot2</code></strong></a></li>
<li class="chapter" data-level="4.9.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#aller-plus-loin-avec-ggplot2"><i class="fa fa-check"></i><b>4.9.3</b> Aller plus loin avec <strong><code>ggplot2</code></strong></a></li>
</ul></li>
<li class="chapter" data-level="4.10" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#extra-r√®gles-particuli√®res"><i class="fa fa-check"></i><b>4.10</b> Extra: R√®gles particuli√®res</a><ul>
<li class="chapter" data-level="4.10.1" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#ne-tronquez-pas-inutilement-laxe-des-y"><i class="fa fa-check"></i><b>4.10.1</b> Ne tronquez pas inutilement l‚Äôaxe des <span class="math inline">\(y\)</span></a></li>
<li class="chapter" data-level="4.10.2" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#utilisez-un-encrage-proportionnel"><i class="fa fa-check"></i><b>4.10.2</b> Utilisez un encrage proportionnel</a></li>
<li class="chapter" data-level="4.10.3" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#publiez-vos-donn√©es"><i class="fa fa-check"></i><b>4.10.3</b> Publiez vos donn√©es</a></li>
<li class="chapter" data-level="4.10.4" data-path="chapitre-visualisation.html"><a href="chapitre-visualisation.html#visitez-www.junkcharts.typepad.com-de-temps-√†-autre"><i class="fa fa-check"></i><b>4.10.4</b> Visitez www.junkcharts.typepad.com de temps √† autre</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="chapitre-git.html"><a href="chapitre-git.html"><i class="fa fa-check"></i><b>5</b> Science ouverte et reproductibilit√©</a><ul>
<li class="chapter" data-level="5.1" data-path="chapitre-git.html"><a href="chapitre-git.html#un-code-reproductible"><i class="fa fa-check"></i><b>5.1</b> Un code reproductible</a><ul>
<li class="chapter" data-level="5.1.1" data-path="chapitre-git.html"><a href="chapitre-git.html#structure-dun-projet"><i class="fa fa-check"></i><b>5.1.1</b> Structure d‚Äôun projet</a></li>
<li class="chapter" data-level="5.1.2" data-path="chapitre-git.html"><a href="chapitre-git.html#le-format-r-markdown"><i class="fa fa-check"></i><b>5.1.2</b> Le format <span>R markdown</span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-github"><i class="fa fa-check"></i><b>5.2</b> Introduction √† GitHub</a></li>
<li class="chapter" data-level="5.3" data-path="chapitre-git.html"><a href="chapitre-git.html#introduction-√†-pakrat"><i class="fa fa-check"></i><b>5.3</b> Introduction √† Pakrat üì¶üêÄ</a></li>
<li class="chapter" data-level="5.4" data-path="chapitre-git.html"><a href="chapitre-git.html#pour-terminer-le-reprex"><i class="fa fa-check"></i><b>5.4</b> Pour terminer, le <strong>reprex</strong></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html"><i class="fa fa-check"></i><b>6</b> Biostatistiques</a><ul>
<li class="chapter" data-level="6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#populations-et-√©chantillons"><i class="fa fa-check"></i><b>6.1</b> Populations et √©chantillons</a></li>
<li class="chapter" data-level="6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-variables"><i class="fa fa-check"></i><b>6.2</b> Les variables</a><ul>
<li class="chapter" data-level="6.2.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-quantitatives"><i class="fa fa-check"></i><b>6.2.1</b> Variables quantitatives</a></li>
<li class="chapter" data-level="6.2.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#variables-qualitatives"><i class="fa fa-check"></i><b>6.2.2</b> Variables qualitatives</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-probabilit√©s"><i class="fa fa-check"></i><b>6.3</b> Les probabilit√©s</a></li>
<li class="chapter" data-level="6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-distributions"><i class="fa fa-check"></i><b>6.4</b> Les distributions</a><ul>
<li class="chapter" data-level="6.4.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-binomiale"><i class="fa fa-check"></i><b>6.4.1</b> Distribution binomiale</a></li>
<li class="chapter" data-level="6.4.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-de-poisson"><i class="fa fa-check"></i><b>6.4.2</b> Distribution de Poisson</a></li>
<li class="chapter" data-level="6.4.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-uniforme"><i class="fa fa-check"></i><b>6.4.3</b> Distribution uniforme</a></li>
<li class="chapter" data-level="6.4.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#distribution-normale"><i class="fa fa-check"></i><b>6.4.4</b> Distribution normale</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#statistiques-descriptives"><i class="fa fa-check"></i><b>6.5</b> Statistiques descriptives</a></li>
<li class="chapter" data-level="6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-dhypoth√®ses-√†-un-et-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6</b> Tests d‚Äôhypoth√®ses √† un et deux √©chantillons</a><ul>
<li class="chapter" data-level="6.6.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-t-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.1</b> Test de t √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#attention-mauvaises-interpr√©tations-des-p-values"><i class="fa fa-check"></i><b>6.6.2</b> Attention: mauvaises interpr√©tations des <em>p-values</em></a></li>
<li class="chapter" data-level="6.6.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#test-de-wilcoxon-√†-un-seul-√©chantillon"><i class="fa fa-check"></i><b>6.6.3</b> Test de Wilcoxon √† un seul √©chantillon</a></li>
<li class="chapter" data-level="6.6.4" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-t-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.4</b> Tests de t √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.5" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#comparaison-des-variances"><i class="fa fa-check"></i><b>6.6.5</b> Comparaison des variances</a></li>
<li class="chapter" data-level="6.6.6" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#tests-de-wilcoxon-√†-deux-√©chantillons"><i class="fa fa-check"></i><b>6.6.6</b> Tests de Wilcoxon √† deux √©chantillons</a></li>
<li class="chapter" data-level="6.6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-tests-pair√©s"><i class="fa fa-check"></i><b>6.6.7</b> Les tests pair√©s</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#lanalyse-de-variance"><i class="fa fa-check"></i><b>6.7</b> L‚Äôanalyse de variance</a></li>
<li class="chapter" data-level="6.8" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#les-mod√®les-statistiques"><i class="fa fa-check"></i><b>6.8</b> Les mod√®les statistiques</a><ul>
<li class="chapter" data-level="6.8.1" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-fixes"><i class="fa fa-check"></i><b>6.8.1</b> Mod√®les √† effets fixes</a></li>
<li class="chapter" data-level="6.8.2" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#mod√®les-√†-effets-mixtes"><i class="fa fa-check"></i><b>6.8.2</b> Mod√®les √† effets mixtes</a></li>
<li class="chapter" data-level="6.8.3" data-path="chapitre-biostats.html"><a href="chapitre-biostats.html#aller-plus-loin"><i class="fa fa-check"></i><b>6.8.3</b> Aller plus loin</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html"><i class="fa fa-check"></i><b>7</b> Introduction √† l‚Äôanalyse bay√©sienne en √©cologie</a><ul>
<li class="chapter" data-level="7.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#quest-ce-que-cest"><i class="fa fa-check"></i><b>7.1</b> Qu‚Äôest-ce que c‚Äôest?</a></li>
<li class="chapter" data-level="7.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pourquoi-lutiliser"><i class="fa fa-check"></i><b>7.2</b> Pourquoi l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.3" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#comment-lutiliser"><i class="fa fa-check"></i><b>7.3</b> Comment l‚Äôutiliser?</a></li>
<li class="chapter" data-level="7.4" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#faucons-p√©lerins"><i class="fa fa-check"></i><b>7.4</b> Faucons p√©lerins</a></li>
<li class="chapter" data-level="7.5" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#statistiques-dune-population"><i class="fa fa-check"></i><b>7.5</b> Statistiques d‚Äôune population</a><ul>
<li class="chapter" data-level="7.5.1" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#calcul-analytique"><i class="fa fa-check"></i><b>7.5.1</b> Calcul analytique</a></li>
<li class="chapter" data-level="7.5.2" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#greta"><i class="fa fa-check"></i><b>7.5.2</b> greta</a></li>
</ul></li>
<li class="chapter" data-level="7.6" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#test-de-t-diff√©rence-entre-des-groupes"><i class="fa fa-check"></i><b>7.6</b> Test de t: Diff√©rence entre des groupes</a></li>
<li class="chapter" data-level="7.7" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#mod√©lisation-multiniveau"><i class="fa fa-check"></i><b>7.7</b> Mod√©lisation multiniveau</a></li>
<li class="chapter" data-level="7.8" data-path="chapitre-biostats-bayes.html"><a href="chapitre-biostats-bayes.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>7.8</b> Pour aller plus loin</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html"><i class="fa fa-check"></i><b>8</b> Explorer R</a><ul>
<li class="chapter" data-level="8.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-sur-le-web"><i class="fa fa-check"></i><b>8.1</b> R sur le web</a><ul>
<li class="chapter" data-level="8.1.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#github"><i class="fa fa-check"></i><b>8.1.1</b> GitHub</a></li>
<li class="chapter" data-level="8.1.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#twitter"><i class="fa fa-check"></i><b>8.1.2</b> Twitter</a></li>
<li class="chapter" data-level="8.1.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#nouvelles"><i class="fa fa-check"></i><b>8.1.3</b> Nouvelles</a></li>
<li class="chapter" data-level="8.1.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#des-questions"><i class="fa fa-check"></i><b>8.1.4</b> Des questions?</a></li>
<li class="chapter" data-level="8.1.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#participer"><i class="fa fa-check"></i><b>8.1.5</b> Participer</a></li>
<li class="chapter" data-level="8.1.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#mise-en-garde"><i class="fa fa-check"></i><b>8.1.6</b> Mise en garde</a></li>
<li class="chapter" data-level="8.1.7" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#prendre-tout-√ßa-en-note"><i class="fa fa-check"></i><b>8.1.7</b> Prendre tout √ßa en note</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#r-en-chaire-et-en-os"><i class="fa fa-check"></i><b>8.2</b> R en chaire et en os</a></li>
<li class="chapter" data-level="8.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#quelques-outils-en-√©cologie-math√©matique-avec-r"><i class="fa fa-check"></i><b>8.3</b> Quelques outils en √©cologie math√©matique avec R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#pr√©traitement-des-donn√©es"><i class="fa fa-check"></i><b>8.3.1</b> Pr√©traitement des donn√©es</a></li>
<li class="chapter" data-level="8.3.2" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#acqu√©rir-des-donn√©es-m√©t√©o"><i class="fa fa-check"></i><b>8.3.2</b> Acqu√©rir des donn√©es m√©t√©o</a></li>
<li class="chapter" data-level="8.3.3" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#p√©dom√©trie-avec-r"><i class="fa fa-check"></i><b>8.3.3</b> P√©dom√©trie avec R</a></li>
<li class="chapter" data-level="8.3.4" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#m√©ta-analyses-en-r"><i class="fa fa-check"></i><b>8.3.4</b> M√©ta-analyses en R</a></li>
<li class="chapter" data-level="8.3.5" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#cr√©er-des-applications-avec-r"><i class="fa fa-check"></i><b>8.3.5</b> Cr√©er des applications avec R</a></li>
<li class="chapter" data-level="8.3.6" data-path="chapitre-explorer.html"><a href="chapitre-explorer.html#travailler-en-python"><i class="fa fa-check"></i><b>8.3.6</b> Travailler en Python</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html"><i class="fa fa-check"></i><b>9</b> Association, partitionnement et ordination</a><ul>
<li class="chapter" data-level="9.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#espaces-danalyse"><i class="fa fa-check"></i><b>9.1</b> Espaces d‚Äôanalyse</a><ul>
<li class="chapter" data-level="9.1.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#abondance-et-occurence"><i class="fa fa-check"></i><b>9.1.1</b> Abondance et occurence</a></li>
<li class="chapter" data-level="9.1.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#environnement"><i class="fa fa-check"></i><b>9.1.2</b> Environnement</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#analyse-dassociation"><i class="fa fa-check"></i><b>9.2</b> Analyse d‚Äôassociation</a><ul>
<li class="chapter" data-level="9.2.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#association-entre-objets-mode-q"><i class="fa fa-check"></i><b>9.2.1</b> Association entre objets (mode Q)</a></li>
<li class="chapter" data-level="9.2.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#associations-entre-variables-mode-r"><i class="fa fa-check"></i><b>9.2.2</b> Associations entre variables (mode R)</a></li>
<li class="chapter" data-level="9.2.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-les-associations"><i class="fa fa-check"></i><b>9.2.3</b> Conclusion sur les associations</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement"><i class="fa fa-check"></i><b>9.3</b> Partitionnement</a><ul>
<li class="chapter" data-level="9.3.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#√©valuation-dun-partitionnement"><i class="fa fa-check"></i><b>9.3.1</b> √âvaluation d‚Äôun partitionnement</a></li>
<li class="chapter" data-level="9.3.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-non-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.2</b> Partitionnement non hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.3" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique"><i class="fa fa-check"></i><b>9.3.3</b> Partitionnement hi√©rarchique</a></li>
<li class="chapter" data-level="9.3.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#partitionnement-hi√©rarchique-bas√©e-sur-la-densit√©-des-points"><i class="fa fa-check"></i><b>9.3.4</b> Partitionnement hi√©rarchique bas√©e sur la densit√© des points</a></li>
<li class="chapter" data-level="9.3.5" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#conclusion-sur-le-partitionnement"><i class="fa fa-check"></i><b>9.3.5</b> Conclusion sur le partitionnement</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination"><i class="fa fa-check"></i><b>9.4</b> Ordination</a><ul>
<li class="chapter" data-level="9.4.1" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-non-contraignante"><i class="fa fa-check"></i><b>9.4.1</b> Ordination non contraignante</a></li>
<li class="chapter" data-level="9.4.2" data-path="chapitre-ordination.html"><a href="chapitre-ordination.html#ordination-contraignante"><i class="fa fa-check"></i><b>9.4.2</b> Ordination contraignante</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html"><i class="fa fa-check"></i><b>10</b> D√©tection de valeurs aberrantes et imputation de donn√©es manquantes</a><ul>
<li class="chapter" data-level="10.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#donn√©es-manquantes-d√©finition-origine-typologie-et-traitement"><i class="fa fa-check"></i><b>10.1</b> Donn√©es manquantes: d√©finition, origine, typologie et traitement</a><ul>
<li class="chapter" data-level="10.1.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finition"><i class="fa fa-check"></i><b>10.1.1</b> D√©finition</a></li>
<li class="chapter" data-level="10.1.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.2</b> Origines des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#profils-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.3</b> Profils des donn√©es manquantes</a></li>
<li class="chapter" data-level="10.1.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#traitement-des-donn√©es-manquantes"><i class="fa fa-check"></i><b>10.1.4</b> Traitement des donn√©es manquantes</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#valeurs-et-√©chantillons-aberrants-d√©finition-origines-m√©thodes-de-d√©tection-et-traitement"><i class="fa fa-check"></i><b>10.2</b> Valeurs et √©chantillons aberrants: d√©finition, origines, m√©thodes de d√©tection et traitement</a><ul>
<li class="chapter" data-level="10.2.1" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©finitions-1"><i class="fa fa-check"></i><b>10.2.1</b> D√©finitions</a></li>
<li class="chapter" data-level="10.2.2" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#origines"><i class="fa fa-check"></i><b>10.2.2</b> Origines</a></li>
<li class="chapter" data-level="10.2.3" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-valeurs-aberrantes-univari√©s"><i class="fa fa-check"></i><b>10.2.3</b> D√©tection et traitement des valeurs aberrantes univari√©s</a></li>
<li class="chapter" data-level="10.2.4" data-path="chapitre-outliers.html"><a href="chapitre-outliers.html#d√©tection-et-traitement-des-√©chantillons-aberrants-multivari√©s"><i class="fa fa-check"></i><b>10.2.4</b> D√©tection et traitement des √©chantillons aberrants multivari√©s</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="chapitre-ml.html"><a href="chapitre-ml.html"><i class="fa fa-check"></i><b>11</b> Introduction √† l‚Äôautoapprentissage</a><ul>
<li class="chapter" data-level="11.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lexique"><i class="fa fa-check"></i><b>11.1</b> Lexique</a></li>
<li class="chapter" data-level="11.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©marche"><i class="fa fa-check"></i><b>11.2</b> D√©marche</a><ul>
<li class="chapter" data-level="11.2.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#pr√©traitement"><i class="fa fa-check"></i><b>11.2.1</b> Pr√©traitement</a></li>
<li class="chapter" data-level="11.2.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#entra√Ænement-et-test"><i class="fa fa-check"></i><b>11.2.2</b> Entra√Ænement et test</a></li>
<li class="chapter" data-level="11.2.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#sousapprentissage-et-surapprentissage"><i class="fa fa-check"></i><b>11.2.3</b> Sousapprentissage et surapprentissage</a></li>
<li class="chapter" data-level="11.2.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#validation-crois√©e"><i class="fa fa-check"></i><b>11.2.4</b> Validation crois√©e</a></li>
<li class="chapter" data-level="11.2.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#choix-de-lalgorithme-dapprentissage"><i class="fa fa-check"></i><b>11.2.5</b> Choix de l‚Äôalgorithme d‚Äôapprentissage</a></li>
<li class="chapter" data-level="11.2.6" data-path="chapitre-ml.html"><a href="chapitre-ml.html#d√©ploiement"><i class="fa fa-check"></i><b>11.2.6</b> D√©ploiement</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#lautoapprentissage-en-r"><i class="fa fa-check"></i><b>11.3</b> L‚Äôautoapprentissage en R</a></li>
<li class="chapter" data-level="11.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#algorithmes"><i class="fa fa-check"></i><b>11.4</b> Algorithmes</a><ul>
<li class="chapter" data-level="11.4.1" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-k-plus-proches-voisins"><i class="fa fa-check"></i><b>11.4.1</b> Les <em>k</em> plus proches voisins</a></li>
<li class="chapter" data-level="11.4.2" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-arbres-d√©cisionnels"><i class="fa fa-check"></i><b>11.4.2</b> Les arbres d√©cisionnels</a></li>
<li class="chapter" data-level="11.4.3" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-r√©seaux-neuronaux"><i class="fa fa-check"></i><b>11.4.3</b> Les r√©seaux neuronaux</a></li>
<li class="chapter" data-level="11.4.4" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens"><i class="fa fa-check"></i><b>11.4.4</b> Les processus gaussiens</a></li>
<li class="chapter" data-level="11.4.5" data-path="chapitre-ml.html"><a href="chapitre-ml.html#les-processus-gaussiens-en-r"><i class="fa fa-check"></i><b>11.4.5</b> Les processus gaussiens en <code>R</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="chapitre-temps.html"><a href="chapitre-temps.html"><i class="fa fa-check"></i><b>12</b> Les s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#op√©rations-sur-les-donn√©es-temporelles"><i class="fa fa-check"></i><b>12.1</b> Op√©rations sur les donn√©es temporelles</a></li>
<li class="chapter" data-level="12.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#analyse-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2</b> Analyse de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.2.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#cr√©er-et-visualiser-des-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.1</b> Cr√©er et visualiser des s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#structures-dans-les-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.2.2</b> Structures dans les s√©ries temporelles</a></li>
<li class="chapter" data-level="12.2.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#lautocorr√©lation"><i class="fa fa-check"></i><b>12.2.3</b> L‚Äôautocorr√©lation</a></li>
<li class="chapter" data-level="12.2.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#signification-statistique-dune-s√©rie-temporelle"><i class="fa fa-check"></i><b>12.2.4</b> Signification statistique d‚Äôune s√©rie temporelle</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#mod√©lisation-de-s√©ries-temporelles"><i class="fa fa-check"></i><b>12.3</b> Mod√©lisation de s√©ries temporelles</a><ul>
<li class="chapter" data-level="12.3.1" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-na√Øve"><i class="fa fa-check"></i><b>12.3.1</b> M√©thode na√Øve</a></li>
<li class="chapter" data-level="12.3.2" data-path="chapitre-temps.html"><a href="chapitre-temps.html#m√©thode-ses"><i class="fa fa-check"></i><b>12.3.2</b> M√©thode SES</a></li>
<li class="chapter" data-level="12.3.3" data-path="chapitre-temps.html"><a href="chapitre-temps.html#la-m√©thode-arima"><i class="fa fa-check"></i><b>12.3.3</b> La m√©thode ARIMA</a></li>
<li class="chapter" data-level="12.3.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-dynamiques"><i class="fa fa-check"></i><b>12.3.4</b> Les mod√®les dynamiques</a></li>
<li class="chapter" data-level="12.3.5" data-path="chapitre-temps.html"><a href="chapitre-temps.html#les-mod√®les-tbats"><i class="fa fa-check"></i><b>12.3.5</b> Les mod√®les TBATS</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="chapitre-temps.html"><a href="chapitre-temps.html#pour-terminer"><i class="fa fa-check"></i><b>12.4</b> Pour terminer‚Ä¶</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="chapitre-geo.html"><a href="chapitre-geo.html"><i class="fa fa-check"></i><b>13</b> Les donn√©es g√©ospatiales</a><ul>
<li class="chapter" data-level="13.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.1</b> Les donn√©es spatiales</a></li>
<li class="chapter" data-level="13.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#cartographier-avec-le-module-ggmap"><i class="fa fa-check"></i><b>13.2</b> Cartographier avec le module <strong><code>ggmap</code></strong></a></li>
<li class="chapter" data-level="13.3" data-path="chapitre-geo.html"><a href="chapitre-geo.html#types-g√©n√©riques-de-donn√©es-spatiales"><i class="fa fa-check"></i><b>13.3</b> Types g√©n√©riques de donn√©es spatiales</a></li>
<li class="chapter" data-level="13.4" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-choropl√®the"><i class="fa fa-check"></i><b>13.4</b> Les choropl√®the</a></li>
<li class="chapter" data-level="13.5" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-rasters"><i class="fa fa-check"></i><b>13.5</b> Les rasters</a></li>
<li class="chapter" data-level="13.6" data-path="chapitre-geo.html"><a href="chapitre-geo.html#autoapprentissage-spatial"><i class="fa fa-check"></i><b>13.6</b> Autoapprentissage spatial</a></li>
<li class="chapter" data-level="13.7" data-path="chapitre-geo.html"><a href="chapitre-geo.html#les-objets-spatialis√©s-en-r"><i class="fa fa-check"></i><b>13.7</b> Les objets spatialis√©s en R</a><ul>
<li class="chapter" data-level="13.7.1" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-vectorielles-points-lignes-et-polygones"><i class="fa fa-check"></i><b>13.7.1</b> Donn√©es vectorielles (points, lignes et polygones)</a></li>
<li class="chapter" data-level="13.7.2" data-path="chapitre-geo.html"><a href="chapitre-geo.html#donn√©es-raster"><i class="fa fa-check"></i><b>13.7.2</b> Donn√©es raster</a></li>
</ul></li>
<li class="chapter" data-level="13.8" data-path="chapitre-geo.html"><a href="chapitre-geo.html#section-systeme-coord"><i class="fa fa-check"></i><b>13.8</b> Les syst√®mes de coordonn√©es</a></li>
<li class="chapter" data-level="13.9" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-tableaux-sf"><i class="fa fa-check"></i><b>13.9</b> Manipuler des tableaux <code>sf</code></a></li>
<li class="chapter" data-level="13.10" data-path="chapitre-geo.html"><a href="chapitre-geo.html#manipuler-des-objets-raster"><i class="fa fa-check"></i><b>13.10</b> Manipuler des objets raster</a></li>
<li class="chapter" data-level="13.11" data-path="chapitre-geo.html"><a href="chapitre-geo.html#graphiques-dobjets-spatialis√©s"><i class="fa fa-check"></i><b>13.11</b> Graphiques d‚Äôobjets spatialis√©s</a></li>
<li class="chapter" data-level="13.12" data-path="chapitre-geo.html"><a href="chapitre-geo.html#ressources-compl√©mentaires"><i class="fa fa-check"></i><b>13.12</b> Ressources compl√©mentaires</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="chapitre-ode.html"><a href="chapitre-ode.html"><i class="fa fa-check"></i><b>14</b> Mod√©lisation de m√©canismes √©cologiques</a><ul>
<li class="chapter" data-level="14.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©quations-diff√©rentielles"><i class="fa fa-check"></i><b>14.1</b> √âquations diff√©rentielles</a></li>
<li class="chapter" data-level="14.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#les-√©quations-diff√©rentielles-ordinaires-en-mod√©lisation-√©cologique"><i class="fa fa-check"></i><b>14.2</b> Les √©quations diff√©rentielles ordinaires en mod√©lisation √©cologique</a><ul>
<li class="chapter" data-level="14.2.1" data-path="chapitre-ode.html"><a href="chapitre-ode.html#√©volution-dune-seule-population-en-fonction-du-temps"><i class="fa fa-check"></i><b>14.2.1</b> √âvolution d‚Äôune seule population en fonction du temps</a></li>
<li class="chapter" data-level="14.2.2" data-path="chapitre-ode.html"><a href="chapitre-ode.html#population-exploit√©e"><i class="fa fa-check"></i><b>14.2.2</b> Population exploit√©e</a></li>
<li class="chapter" data-level="14.2.3" data-path="chapitre-ode.html"><a href="chapitre-ode.html#interactions-biologiques"><i class="fa fa-check"></i><b>14.2.3</b> Interactions biologiques</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Analyse et mod√©lisation d‚Äôagro√©cosyst√®mes</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="chapitre-temps" class="section level1">
<h1><span class="header-section-number">12</span> Les s√©ries temporelles</h1>
<hr />
<p>Ô∏è¬†<strong>Objectifs sp√©cifiques</strong>:</p>
<p>√Ä la fin de ce chapitre, vous</p>
<ul>
<li>saurez comment importer et manipuler des donn√©es temporelles (utiliser le format de date, filtrer, effectuer des sommaires, agr√©ger des donn√©es, etc.)</li>
<li>effectuer une r√©gression sur une s√©rie temporelle</li>
</ul>
<hr />
<p>Les s√©ries temporelles (ou chronologiques) sont des donn√©es associ√©es √† des indices temporels de tout ordre de grandeur: seconde, minute, heure, jour, mois, ann√©e, etc. En analyse de s√©rie temporelle, le temps est une variable explicative (ou d√©pendante) incontournable. L‚Äô√©mergence de cycles est une particularit√© des s√©ries temporelles. Ceux-ci peuvent √™tre analys√©s en vue d‚Äôen d√©terminer la tendance. Les s√©ries temporelles peuvent √©galement √™tre mod√©lis√©s en vue d‚Äôeffectuer des pr√©visions.</p>
<p><img src="https://media.giphy.com/media/495yjUBKN7TE6fr5vq/giphy.gif" /></p>
<p>Source: Sc√®ne de Back to the future, Robert Zemeckis et and Bob Gale, 1985</p>
<p>Nous allons couvrir les concepts de base en analyse et mod√©lisation de s√©ries temporelles. Mais avant cela, voyons comment les donn√©es temporelles sont manipul√©es en R.</p>
<p>Cette section est bas√©e sur le livre <em>Forecasting: Principles and Practice</em>, de Rob J. Hyndman et George Athanasopoulos, qui peut √™tre enti√®rement <a href="https://otexts.com/fpp2/">consult√© gratuitement en ligne</a>, ainsi que le cours associ√© sur la plateforme d‚Äôapprentissage <a href="https://campus.datacamp.com/courses/forecasting-using-r">DataCamp</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:ts-fpp2"></span>
<img src="images/09_fpp2_cover.jpg" alt="[*Forecasting: Principles and Practice*, de Rob J. Hyndman et George Athanasopoulos](https://otexts.com/fpp2/)." width="30%" />
<p class="caption">
Figure 12.1: <a href="https://otexts.com/fpp2/"><em>Forecasting: Principles and Practice</em>, de Rob J. Hyndman et George Athanasopoulos</a>.
</p>
</div>
<div id="op√©rations-sur-les-donn√©es-temporelles" class="section level2">
<h2><span class="header-section-number">12.1</span> Op√©rations sur les donn√©es temporelles</h2>
<p>Le d√©bit de la <a href="https://fr.wikipedia.org/wiki/Rivi%C3%A8re_Chaudi%C3%A8re">rivi√®re Chaudi√®re</a>, dont l‚Äôexutoire se situe pr√®s de Qu√©bec, sur la rive Sud du fleuve Saint-Laurent, est mesur√© depuis 1915.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="chapitre-temps.html#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.0     v purrr   0.3.4
## v tibble  3.0.0     v dplyr   0.8.5
## v tidyr   1.0.3     v stringr 1.4.0
## v readr   1.3.1     v forcats 0.5.0</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="chapitre-temps.html#cb5-1"></a>hydro &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/023402_Q.csv&quot;</span>)</span></code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Station = col_double(),
##   Date = col_date(format = &quot;&quot;),
##   D√©bit = col_double(),
##   Remarque = col_character()
## )</code></pre>
<p>La fonction <code>read_csv()</code> d√©tecte automatiquement que la colonne <code>Date</code> est une date.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="chapitre-temps.html#cb7-1"></a><span class="kw">glimpse</span>(hydro)</span></code></pre></div>
<pre><code>## Rows: 34,700
## Columns: 4
## $ Station  &lt;dbl&gt; 23402, 23402, 23402, 23402, 23402, 23402, 23402, 23402, 23...
## $ Date     &lt;date&gt; 1915-02-27, 1915-02-28, 1915-03-01, 1915-03-02, 1915-03-0...
## $ D√©bit    &lt;dbl&gt; 538.0, 377.0, 269.0, 345.0, 269.0, 334.0, 269.0, 269.0, 26...
## $ Remarque &lt;chr&gt; &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;, &quot;MC&quot;...</code></pre>
<p>Le d√©bit de la rivi√®re Chaudi√®re peut √™tre explor√© graphiquement.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="chapitre-temps.html#cb9-1"></a>hydro <span class="op">%&gt;%</span></span>
<span id="cb9-2"><a href="chapitre-temps.html#cb9-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> <span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb9-3"><a href="chapitre-temps.html#cb9-3"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-plot-hydro-1.png" width="672" /></p>
<p>On observe des donn√©es sont manquantes de la fin des ann√©es 1920 √† la fin des ann√©es 1930. Autrement, il est difficile de visualiser la structure du d√©bit en fonction du temps, notamment si le d√©bit suit des cycles r√©guliers. On pourra isoler les donn√©es depuis 2014.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="chapitre-temps.html#cb10-1"></a>hydro <span class="op">%&gt;%</span></span>
<span id="cb10-2"><a href="chapitre-temps.html#cb10-2"></a><span class="st">  </span><span class="kw">filter</span>(Date <span class="op">&gt;=</span><span class="st"> </span><span class="kw">as.Date</span>(<span class="st">&quot;2014-01-01&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb10-3"><a href="chapitre-temps.html#cb10-3"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> Date, <span class="dt">y =</span> <span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb10-4"><a href="chapitre-temps.html#cb10-4"></a><span class="st">  </span><span class="kw">geom_line</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-plot-hydro-2014-1.png" width="672" /></p>
<p>R comprend la fonction <code>as.Date()</code>, o√π l‚Äôargument <code>format</code> d√©crit la mani√®re avec laquelle la date est exprim√©e.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="chapitre-temps.html#cb11-1"></a><span class="kw">as.Date</span>(<span class="dt">x =</span> <span class="st">&quot;1999/03/29&quot;</span>, <span class="dt">format =</span> <span class="st">&quot;%Y/%m/%d&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;1999-03-29&quot;</code></pre>
<p>L‚Äôargument <code>x</code> peut aussi bien √™tre une cha√Æne de caract√®res qu‚Äôun vecteur o√π l‚Äôon retrouve plusieurs cha√Ænes de caract√®res exprimant un format de date commun. La fonction <code>as.Date()</code> permet ainsi de transformer des caract√®res en date si <code>read_csv()</code> ne le d√©tecte pas automatiquement. Ce format peut prendre la forme d√©sir√©e, dont les param√®tres sont list√©s sur la <a href="https://rdrr.io/r/base/strptime.html">page d‚Äôaide de la fonction <code>strptime()</code></a>. Toutefois, le plus petit incr√©ment de temps accept√© par <code>as.Date()</code> est le jour: <code>as.Date()</code> exclut les heures, minutes et secondes. Le module <a href="https://lubridate.tidyverse.org/"><strong><code>lubridate</code></strong></a>, issu du <em>tidyverse</em>, permet quant √† lui de manipuler avec plus de gr√¢ce les formats de date standards, incluant les dates et les heures: <strong><code>lubridate</code></strong> sera pr√©f√©r√© dans ce chapitre.</p>
<pre><code>## 
## Attaching package: &#39;lubridate&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:dplyr&#39;:
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     date, intersect, setdiff, union</code></pre>
<pre><code>## [1] &quot;2011-02-19 09:14:00 UTC&quot;</code></pre>
<p>Plusieurs autres formats standards sont pr√©sent√©s sur un <a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf">aide-m√©noire de <strong><code>lubridate</code></strong></a>. Si vos donn√©es comprennent des formats de date non standard, vous pourrez utiliser la fonction <code>as.POSIXlt()</code>, mais il pourrait √™tre pr√©f√©rable de standardiser les dates <em>a priori</em>.</p>
<div class="figure" style="text-align: center"><span id="fig:ts-lubridate-cheatsheet"></span>
<img src="images/09_lubridate-cheatsheet-thumbs.png" alt="Aide-m√©moire du module [lubridate](https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf)." width="100%" />
<p class="caption">
Figure 12.2: Aide-m√©moire du module <a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf">lubridate</a>.
</p>
</div>
<p>Le module <strong><code>lubridate</code></strong> rend possible l‚Äôextraction de la date (<code>date()</code>), l‚Äôann√©e (<code>year()</code>), le mois (<code>month()</code>), le jour de la semaine (<code>wday()</code>), le jour julien (<code>yday()</code>), etc. pour plus d‚Äôoptions, voir [l‚Äôaide-m√©moire de <strong><code>lubridate</code></strong>])(<a href="https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf" class="uri">https://rawgit.com/rstudio/cheatsheets/master/lubridate.pdf</a>).</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="chapitre-temps.html#cb17-1"></a>date_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">ymd_hms</span>(<span class="st">&quot;2019-03-14 09:14:00&quot;</span>)</span>
<span id="cb17-2"><a href="chapitre-temps.html#cb17-2"></a>date_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">date</span>()</span></code></pre></div>
<pre><code>## [1] &quot;2019-03-14&quot;</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="chapitre-temps.html#cb19-1"></a>date_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">month</span>()</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="chapitre-temps.html#cb21-1"></a>date_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">yday</span>()</span></code></pre></div>
<pre><code>## [1] 73</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="chapitre-temps.html#cb23-1"></a>date_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">wday</span>()</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="chapitre-temps.html#cb25-1"></a>date_<span class="dv">1</span> <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">seconds</span>()</span></code></pre></div>
<pre><code>## [1] &quot;1552554840S&quot;</code></pre>
<p>Ces extractions peuvent √™tre utilis√©es dans des suites d‚Äôop√©ration (<em>pipelines</em>). Par exemple, si nous d√©sirons obtenir le d√©bit mensuel moyen de la rivi√®re Chaudi√®re depuis 1990, nous pouvons cr√©er une nouvelle colonne <code>Year</code> et une autre <code>Month</code> avec la fonction <code>mutate()</code>, effectuer un filtre sur l‚Äôann√©e, regrouper par mois pour obtenir le sommaire en terme de moyenne, puis lancer le graphique.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="chapitre-temps.html#cb27-1"></a>hydro_month &lt;-<span class="st"> </span>hydro <span class="op">%&gt;%</span></span>
<span id="cb27-2"><a href="chapitre-temps.html#cb27-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">year</span>(),</span>
<span id="cb27-3"><a href="chapitre-temps.html#cb27-3"></a>         <span class="dt">Month =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">month</span>()) <span class="op">%&gt;%</span></span>
<span id="cb27-4"><a href="chapitre-temps.html#cb27-4"></a><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">1990</span>) <span class="op">%&gt;%</span></span>
<span id="cb27-5"><a href="chapitre-temps.html#cb27-5"></a><span class="st">  </span><span class="kw">group_by</span>(Month) <span class="op">%&gt;%</span></span>
<span id="cb27-6"><a href="chapitre-temps.html#cb27-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="dt">MeanFlow =</span> <span class="kw">mean</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</span>
<span id="cb27-7"><a href="chapitre-temps.html#cb27-7"></a></span>
<span id="cb27-8"><a href="chapitre-temps.html#cb27-8"></a>hydro_month <span class="op">%&gt;%</span></span>
<span id="cb27-9"><a href="chapitre-temps.html#cb27-9"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Month, <span class="dt">y=</span>MeanFlow)) <span class="op">+</span></span>
<span id="cb27-10"><a href="chapitre-temps.html#cb27-10"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb27-11"><a href="chapitre-temps.html#cb27-11"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">12</span>) <span class="op">+</span></span>
<span id="cb27-12"><a href="chapitre-temps.html#cb27-12"></a><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-extract-pipe-1.png" width="672" /></p>
<p>On pourra aussi agr√©ger par moyenne mensuelle en gardant l‚Äôann√©e respective en cr√©ant une nouvelle colonne de date <code>YearMonth</code> qui permettra le regroupement avec <code>group_by()</code>, puis cr√©er plusieurs facettes.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="chapitre-temps.html#cb28-1"></a>hydro <span class="op">%&gt;%</span></span>
<span id="cb28-2"><a href="chapitre-temps.html#cb28-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">year</span>(),</span>
<span id="cb28-3"><a href="chapitre-temps.html#cb28-3"></a>         <span class="dt">Month =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">month</span>(),</span>
<span id="cb28-4"><a href="chapitre-temps.html#cb28-4"></a>         <span class="dt">YearMonth =</span> <span class="kw">ymd</span>(<span class="kw">paste0</span>(Year, <span class="st">&quot;-&quot;</span>, Month, <span class="st">&quot;-01&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb28-5"><a href="chapitre-temps.html#cb28-5"></a><span class="st">  </span><span class="kw">filter</span>(Year <span class="op">&gt;=</span><span class="st"> </span><span class="dv">2010</span> <span class="op">&amp;</span><span class="st"> </span>Year <span class="op">&lt;</span><span class="st"> </span><span class="dv">2018</span>) <span class="op">%&gt;%</span></span>
<span id="cb28-6"><a href="chapitre-temps.html#cb28-6"></a><span class="st">  </span><span class="kw">group_by</span>(Year, YearMonth) <span class="op">%&gt;%</span></span>
<span id="cb28-7"><a href="chapitre-temps.html#cb28-7"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></span>
<span id="cb28-8"><a href="chapitre-temps.html#cb28-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>YearMonth, <span class="dt">y=</span><span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>)) <span class="op">+</span></span>
<span id="cb28-9"><a href="chapitre-temps.html#cb28-9"></a><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="op">~</span>Year, <span class="dt">scales =</span> <span class="st">&quot;free_x&quot;</span>, <span class="dt">ncol =</span> <span class="dv">4</span>) <span class="op">+</span></span>
<span id="cb28-10"><a href="chapitre-temps.html#cb28-10"></a><span class="st">  </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb28-11"><a href="chapitre-temps.html#cb28-11"></a><span class="st">  </span><span class="kw">expand_limits</span>(<span class="dt">y =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-group-by-1.png" width="960" /></p>
<p>Il est possible d‚Äôeffectuer des op√©rations math√©matiques sur des donn√©es temporelles. Par exemple, ajouter 10 jours √† chaque date.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="chapitre-temps.html#cb29-1"></a>hydro <span class="op">%&gt;%</span></span>
<span id="cb29-2"><a href="chapitre-temps.html#cb29-2"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb29-3"><a href="chapitre-temps.html#cb29-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">DateOffset =</span> Date <span class="op">+</span><span class="st"> </span><span class="kw">days</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   Station Date       D√©bit Remarque DateOffset
##     &lt;dbl&gt; &lt;date&gt;     &lt;dbl&gt; &lt;chr&gt;    &lt;date&gt;    
## 1   23402 1915-02-27   538 MC       1915-03-09
## 2   23402 1915-02-28   377 MC       1915-03-10
## 3   23402 1915-03-01   269 MC       1915-03-11
## 4   23402 1915-03-02   345 MC       1915-03-12
## 5   23402 1915-03-03   269 MC       1915-03-13</code></pre>
<p>Pour effectuer des op√©rations sur des incr√©ments inf√©rieurs aux jours, il faut s‚Äôassurer que le type des donn√©es temporelles soit bien <code>POSIXct</code>, et non pas <code>Date</code>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="chapitre-temps.html#cb31-1"></a>hydro <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(Date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>()</span></code></pre></div>
<pre><code>## [1] &quot;Date&quot;</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="chapitre-temps.html#cb33-1"></a>hydro &lt;-<span class="st"> </span>hydro <span class="op">%&gt;%</span></span>
<span id="cb33-2"><a href="chapitre-temps.html#cb33-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Date =</span> <span class="kw">as_datetime</span>(Date))</span>
<span id="cb33-3"><a href="chapitre-temps.html#cb33-3"></a>hydro <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(Date) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">class</span>()</span></code></pre></div>
<pre><code>## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="chapitre-temps.html#cb35-1"></a>hydro <span class="op">%&gt;%</span></span>
<span id="cb35-2"><a href="chapitre-temps.html#cb35-2"></a><span class="st">  </span><span class="kw">head</span>(<span class="dv">5</span>) <span class="op">%&gt;%</span></span>
<span id="cb35-3"><a href="chapitre-temps.html#cb35-3"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">DateOffset =</span> Date <span class="op">+</span><span class="st"> </span><span class="kw">seconds</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## # A tibble: 5 x 5
##   Station Date                D√©bit Remarque DateOffset         
##     &lt;dbl&gt; &lt;dttm&gt;              &lt;dbl&gt; &lt;chr&gt;    &lt;dttm&gt;             
## 1   23402 1915-02-27 00:00:00   538 MC       1915-02-27 00:00:10
## 2   23402 1915-02-28 00:00:00   377 MC       1915-02-28 00:00:10
## 3   23402 1915-03-01 00:00:00   269 MC       1915-03-01 00:00:10
## 4   23402 1915-03-02 00:00:00   345 MC       1915-03-02 00:00:10
## 5   23402 1915-03-03 00:00:00   269 MC       1915-03-03 00:00:10</code></pre>
</div>
<div id="analyse-de-s√©ries-temporelles" class="section level2">
<h2><span class="header-section-number">12.2</span> Analyse de s√©ries temporelles</h2>
<p>Tout comme c‚Äôest le cas de nombreux sujet couverts lors de ce cours, l‚Äôanalyse et mod√©lisation de s√©ries temporelles est un domaine d‚Äô√©tude en soi. Nous allons nous restreindre ici aux s√©ries temporelles consign√©es √† fr√©quence r√©guli√®re. Les exemples d‚Äôanalyses et mod√©lisation de s√©ries temporelles sont typiquement des donn√©es √©conomiques, bien que les principes qui les guident sont les m√™mes qu‚Äôen d‚Äôautres domaines. Cette section est vou√©e √† l‚Äôanalyse, alors que la prochaine est vou√©e √† la mod√©lisation.</p>
<p>Par exemple, voici une s√©rie temporelle √©conomique typique, qui exprime les d√©penses mensuelles en restauration en Australie.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="chapitre-temps.html#cb37-1"></a><span class="kw">library</span>(<span class="st">&quot;forecast&quot;</span>)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by &#39;quantmod&#39;:
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="chapitre-temps.html#cb39-1"></a><span class="kw">library</span>(<span class="st">&quot;fpp2&quot;</span>)</span></code></pre></div>
<pre><code>## Loading required package: fma</code></pre>
<pre><code>## Loading required package: expsmooth</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="chapitre-temps.html#cb42-1"></a><span class="kw">data</span>(<span class="st">&quot;auscafe&quot;</span>)</span>
<span id="cb42-2"><a href="chapitre-temps.html#cb42-2"></a><span class="kw">autoplot</span>(auscafe)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-load-ts-packages-1.png" width="672" /></p>
<p>On y d√©tecte une tendance g√©n√©rale, probablement propuls√©e par la croissance de la d√©mographie et des revenus, ainsi que des tendances cycliques. On verra plus loin comment pr√©dire des occurrences futures, ainsi que l‚Äôincertitude de ces pr√©dictions, √† partir des donn√©es consign√©es.</p>
<p>Jusqu‚Äô√† pr√©sent, nous avons travaill√© avec des tableaux de donn√©es incluant une colonne en format date. Nous allons maintenant travailler avec des s√©ries temporelles telles que repr√©sent√©es en R.</p>
<div id="cr√©er-et-visualiser-des-s√©ries-temporelles" class="section level3">
<h3><span class="header-section-number">12.2.1</span> Cr√©er et visualiser des s√©ries temporelles</h3>
<p>L‚Äôinformation consign√©e dans une s√©rie temporelle inclut n√©cessairement un indice temporel associ√© √† au moins une variable. En R, cette information est consign√©e dans un objet de type <code>ts</code>, pour <em>time series</em>. Prenons une mesure quelconque prise √† chaque trimestre de l‚Äôann√©e 2018.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="chapitre-temps.html#cb43-1"></a><span class="kw">set.seed</span>(<span class="dv">96683</span>)</span>
<span id="cb43-2"><a href="chapitre-temps.html#cb43-2"></a>date &lt;-<span class="st"> </span><span class="kw">ymd</span>(<span class="kw">c</span>(<span class="st">&quot;2018-01-01&quot;</span>, <span class="st">&quot;2018-04-01&quot;</span>, <span class="st">&quot;2018-07-01&quot;</span>, <span class="st">&quot;2018-10-01&quot;</span>))</span>
<span id="cb43-3"><a href="chapitre-temps.html#cb43-3"></a>mesure &lt;-<span class="st"> </span><span class="kw">runif</span>(<span class="kw">length</span>(date), <span class="dv">1</span>, <span class="dv">10</span>)</span>
<span id="cb43-4"><a href="chapitre-temps.html#cb43-4"></a>mesure_ts &lt;-<span class="st"> </span><span class="kw">ts</span>(mesure, <span class="dt">start =</span> date[<span class="dv">1</span>], <span class="dt">frequency =</span> <span class="dv">4</span>)</span>
<span id="cb43-5"><a href="chapitre-temps.html#cb43-5"></a>mesure_ts</span></code></pre></div>
<pre><code>##           Qtr1     Qtr2     Qtr3     Qtr4
## 17532 7.175836 3.646285 6.631606 8.648371</code></pre>
<p>L‚Äôargument <code>start</code> est la date de la premi√®re observation et <code>frequency</code> est le nombre d‚Äôobservations par unit√© temporelle, ici l‚Äôann√©e.</p>
<p>J‚Äôai auparavant recueilli des donn√©es m√©t√©o avec <strong><code>weathercan</code></strong> (dispobibles seulement depuis 1998) et fusionn√© avec le tableau <code>hydro</code>. Pour acc√©l√©rer la proc√©dure, j‚Äôai enregistr√© les donn√©es dans un fichier RData. De facto, ne gardons que les donn√©es disponibles entre 1998 et 2008, ainsi que les colonnes d√©signant la date, le d√©bit, les pr√©cipitations totales et la temp√©rature.</p>
<pre><code>## Rows: 3,653
## Columns: 4
## $ Date         &lt;date&gt; 1998-01-01, 1998-01-02, 1998-01-03, 1998-01-04, 1998-...
## $ D√©bit        &lt;dbl&gt; 15.70, 16.00, 17.40, 19.30, 23.20, 29.00, 58.85, 65.80...
## $ total_precip &lt;dbl&gt; 1.6, 2.8, 2.2, 0.0, 5.8, 11.8, 2.4, 19.2, 11.6, 2.6, 0...
## $ mean_temp    &lt;dbl&gt; -21.1, -8.9, 1.9, -3.2, -8.7, -8.0, -7.4, -6.3, -5.4, ...</code></pre>
<p>Pour cr√©er une s√©rie temporelle de type <code>ts</code>, j‚Äôenl√®ve la date, je d√©marre au premier √©v√©nement de 1998, et chaque incr√©ment a une fr√©quence de 1/365.25 unit√©s depuis 1998 (il y a en moyenne 365.25 jours par an).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="chapitre-temps.html#cb46-1"></a>hydrometeo_ts &lt;-<span class="st"> </span><span class="kw">ts</span>(hydrometeo <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Date),</span>
<span id="cb46-2"><a href="chapitre-temps.html#cb46-2"></a>                    <span class="dt">start =</span> <span class="kw">c</span>(hydrometeo<span class="op">$</span>Date[<span class="dv">1</span>] <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">year</span>(), <span class="dv">1</span>),</span>
<span id="cb46-3"><a href="chapitre-temps.html#cb46-3"></a>                    <span class="dt">frequency =</span> <span class="fl">365.25</span>)</span></code></pre></div>
<p>Le module <strong><code>ggplot2</code></strong> comprend la fonction <code>autoplot()</code>, pratique pour visualiser les s√©ries temporelles.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="chapitre-temps.html#cb47-1"></a><span class="kw">autoplot</span>(hydrometeo_ts, <span class="dt">facets =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb47-2"><a href="chapitre-temps.html#cb47-2"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="dv">1998</span><span class="op">:</span><span class="dv">2008</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hydrometeo-ts-plot-1.png" width="672" /></p>
<p>Il est possible de filtrer des s√©ries temporelles en mode tidyverse. Toutefois, il est plus simple d‚Äôutiliser la fonction de base <code>windows()</code>. Disons, les 10 premiers jours de l‚Äôan 2000.</p>
<pre><code>## Time Series:
## Start = 2000.00136892539 
## End = 2000.02600958248 
## Frequency = 365.25 
##          D√©bit total_precip mean_temp
## 2000.001 42.40          9.4      -5.6
## 2000.004 40.70          0.0      -5.5
## 2000.007 43.60         23.5      -0.9
## 2000.010 49.04          0.0      -8.8
## 2000.012 58.90          0.0     -12.9
## 2000.015 49.10          1.2      -4.6
## 2000.018 44.40          3.8     -10.5
## 2000.021 40.60          6.8      -4.9
## 2000.023 38.10          7.0      -2.3
## 2000.026 36.50         12.9      -0.3</code></pre>
<p>Voyons l‚Äô√©volution des d√©bits mensuelles.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="chapitre-temps.html#cb49-1"></a>hydrometeo_monthly &lt;-<span class="st"> </span>hydrometeo <span class="op">%&gt;%</span></span>
<span id="cb49-2"><a href="chapitre-temps.html#cb49-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Year =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">year</span>(),</span>
<span id="cb49-3"><a href="chapitre-temps.html#cb49-3"></a>         <span class="dt">Month =</span> Date <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">month</span>(),</span>
<span id="cb49-4"><a href="chapitre-temps.html#cb49-4"></a>         <span class="dt">YearMonth =</span> <span class="kw">ymd</span>(<span class="kw">paste0</span>(Year, <span class="st">&quot;-&quot;</span>, Month, <span class="st">&quot;-01&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb49-5"><a href="chapitre-temps.html#cb49-5"></a><span class="st">  </span><span class="kw">group_by</span>(Year, YearMonth) <span class="op">%&gt;%</span></span>
<span id="cb49-6"><a href="chapitre-temps.html#cb49-6"></a><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">summarise</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span> =<span class="st"> </span><span class="kw">mean</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</span>
<span id="cb49-7"><a href="chapitre-temps.html#cb49-7"></a>                   <span class="dt">total_precip =</span> <span class="kw">sum</span>(total_precip, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>), <span class="co"># somme</span></span>
<span id="cb49-8"><a href="chapitre-temps.html#cb49-8"></a>                   <span class="dt">mean_temp =</span> <span class="kw">mean</span>(mean_temp, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)) <span class="co"># moyenne</span></span>
<span id="cb49-9"><a href="chapitre-temps.html#cb49-9"></a>hydrometeo_monthly_ts &lt;-<span class="st"> </span><span class="kw">ts</span>(hydrometeo_monthly <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="st">`</span><span class="dt">D√©bit</span><span class="st">`</span>, total_precip, mean_temp), <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1998</span>, <span class="dv">1</span>), <span class="dt">frequency =</span> <span class="dv">12</span>)</span></code></pre></div>
<p>Contraignons la p√©riode gr√¢ce √† <code>window()</code>, puis visualisons les tendances cycliques avec <code>forecast::ggseasonplot()</code> et <code>forecast::ggsubseriesplot()</code>. Notez que j‚Äôutilise la fonction <code>cowplot::plot_grid()</code> pour arranger diff√©rents graphiques ggplot2 en une grille.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="chapitre-temps.html#cb50-1"></a><span class="kw">library</span>(<span class="st">&quot;cowplot&quot;</span>)</span></code></pre></div>
<pre><code>## 
## ********************************************************</code></pre>
<pre><code>## Note: As of version 1.0.0, cowplot does not change the</code></pre>
<pre><code>##   default ggplot2 theme anymore. To recover the previous</code></pre>
<pre><code>##   behavior, execute:
##   theme_set(theme_cowplot())</code></pre>
<pre><code>## ********************************************************</code></pre>
<pre><code>## 
## Attaching package: &#39;cowplot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:lubridate&#39;:
## 
##     stamp</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="chapitre-temps.html#cb58-1"></a>ggA &lt;-<span class="st"> </span><span class="kw">ggseasonplot</span>(<span class="kw">window</span>(hydrometeo_monthly_ts[, <span class="dv">1</span>], <span class="dv">1998</span>, <span class="dv">2004-1</span><span class="op">/</span><span class="fl">365.25</span>)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb58-2"><a href="chapitre-temps.html#cb58-2"></a>ggB &lt;-<span class="st"> </span><span class="kw">ggseasonplot</span>(<span class="kw">window</span>(hydrometeo_monthly_ts[, <span class="dv">1</span>], <span class="dv">1998</span>, <span class="dv">2004-1</span><span class="op">/</span><span class="fl">365.25</span>), <span class="dt">polar =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>)</span>
<span id="cb58-3"><a href="chapitre-temps.html#cb58-3"></a>ggC &lt;-<span class="st"> </span><span class="kw">ggsubseriesplot</span>(<span class="kw">window</span>(hydrometeo_monthly_ts[, <span class="dv">1</span>], <span class="dv">1998</span>, <span class="dv">2004-1</span><span class="op">/</span><span class="fl">365.25</span>), <span class="dt">polar =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Flow&quot;</span>)</span>
<span id="cb58-4"><a href="chapitre-temps.html#cb58-4"></a><span class="kw">plot_grid</span>(ggA, ggB, ggC, <span class="dt">ncol =</span> <span class="dv">3</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hydrometeo-cycles-viz-1.png" width="1440" /></p>
</div>
<div id="structures-dans-les-s√©ries-temporelles" class="section level3">
<h3><span class="header-section-number">12.2.2</span> Structures dans les s√©ries temporelles</h3>
<p>Les s√©ries temporelles sont susceptibles d‚Äô√™tre caract√©ris√©es par des structures commun√©ment observ√©es.</p>
<ul>
<li>La <strong>tendance</strong> est une structure d√©crivant la hausse ou la baisse √† <em>long terme</em> d‚Äôune variable num√©rique.</li>
<li>La <strong>fluctuation saisonni√®re</strong> est une structure p√©riodique, qui oscille autour de la tendance g√©n√©rale de mani√®re r√©guli√®re selon le calendrier.</li>
<li>La <strong>fluctuation cyclique</strong> est aussi une structure p√©riodique, mais irr√©guli√®re (par exemple, les oscillations peuvent durer parfois 2 ans, parfois 3). Les fluctuations cycliques sont souvent de plus longue fr√©quence que les fluctuations saisonni√®res, et leur irr√©gularit√© rend les pr√©dictions plus difficiles.</li>
</ul>
<p><strong>Note</strong>. Une tendance d√©tect√©e sur une p√©riode de temps trop courte peut s‚Äôav√©rer √™tre une fluctuation.</p>
<p>La figure <a href="#fig:trend"><strong>??</strong></a> montre diff√©rentes structures. La figure <a href="#fig:trend"><strong>??</strong></a>A montre une tendance croissante des d√©penses mensuelles en restauration en Australie, ainsi que des fluctuations saisonni√®res. La figure <a href="#fig:trend"><strong>??</strong></a>B montre des fluctuations saisonni√®res des temp√©ratures quotidiennes moyennes √† l‚ÄôUniversit√© Laval, sans pr√©senter de tendance claire. La figure <a href="#fig:trend"><strong>??</strong></a>C montre des fluctuations cycliques du nombre de lynx trapp√©s par ann√©e au Canada de 1821 √† 1934, sans non plus pr√©senter de tendance claire. Les cycles sont cons√©quents des m√©canismes de dynamique des populations (plus de proie entra√Æne plus de pr√©dateur, plus de pr√©dateur entra√Æne moins de proie, moins de proie entra√Æne moins de pr√©dateur, moins de pr√©dateur entra√Æne plus de proie, etc.), que nous couvrirons au chapitre <a href="chapitre-ode.html#chapitre-ode">14</a>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="chapitre-temps.html#cb59-1"></a><span class="kw">data</span>(<span class="st">&quot;lynx&quot;</span>)</span>
<span id="cb59-2"><a href="chapitre-temps.html#cb59-2"></a><span class="kw">plot_grid</span>(<span class="kw">autoplot</span>(auscafe),</span>
<span id="cb59-3"><a href="chapitre-temps.html#cb59-3"></a>          <span class="kw">autoplot</span>(hydrometeo_ts[, <span class="dv">3</span>]) <span class="op">+</span><span class="st"> </span><span class="kw">labs</span>(<span class="dt">y=</span><span class="st">&quot;Mean temperature&quot;</span>),</span>
<span id="cb59-4"><a href="chapitre-temps.html#cb59-4"></a>          <span class="kw">autoplot</span>(lynx),</span>
<span id="cb59-5"><a href="chapitre-temps.html#cb59-5"></a>          <span class="dt">ncol =</span> <span class="dv">3</span>,</span>
<span id="cb59-6"><a href="chapitre-temps.html#cb59-6"></a>          <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>))</span></code></pre></div>
<div class="figure"><span id="fig:ts-lynx-trend"></span>
<img src="_main_files/figure-html/ts-lynx-trend-1.png" alt="Identification des tendances et fluctuations dans des s√©ries temporelles" width="1152" />
<p class="caption">
Figure 12.3: Identification des tendances et fluctuations dans des s√©ries temporelles
</p>
</div>
<p>Il est possible que l‚Äôon retrouve une hi√©rarchie dans les fluctuations, c‚Äôest-√†-dire que de grandes fluctuations (saisonni√®res ou cycliques) peuvent contenir des fluctuations sur des incr√©ments de temps plus petits.</p>
</div>
<div id="lautocorr√©lation" class="section level3">
<h3><span class="header-section-number">12.2.3</span> L‚Äôautocorr√©lation</h3>
<p>Lorsque les donn√©es pr√©sentes des fluctuations (saisonni√®res ou cycliques), le graphique d‚Äôautocorr√©lation montrera un sommet aux √©tapes des cycles ou des saisons. Le graphique d‚Äôautocorr√©lation de donn√©es al√©atoires (aussi appel√©es <em>bruit blanc</em>) montera des sommets sans signification.</p>
<p>Un graphique de retardement (<em>lag plot</em>) met successivement en relation <span class="math inline">\(y_t\)</span> avec <span class="math inline">\(y_{t-p}\)</span>. Un graphique d‚Äôautocorr√©lation est la corr√©lation entre <span class="math inline">\(y_t\)</span>, <span class="math inline">\(y_{t-1}\)</span>, <span class="math inline">\(y_{t-2}\)</span>, etc. Une graphique de retardement donne un aper√ßu de la d√©pendance d‚Äôune variable selon ses valeurs pass√©es. Les graphiques de retardement de donn√©es ayant une forte tendance pr√©senteront des points pr√®s de la diagonale, tandis que ceux montrant des donn√©es fluctuantes de type sinuso√Ødal pr√©senteront des points dispos√©s de mani√®re circulaire. Des donn√©es al√©atoires, quant √† elles, ne pr√©senteront pas de structure de retardement facilement identifiable.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="chapitre-temps.html#cb60-1"></a><span class="kw">set.seed</span>(<span class="dv">64301</span>)</span>
<span id="cb60-2"><a href="chapitre-temps.html#cb60-2"></a>bruit_blanc &lt;-<span class="st"> </span><span class="kw">ts</span>(<span class="kw">runif</span>(<span class="dv">114</span>, <span class="dv">0</span>, <span class="dv">6000</span>), <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">1821</span>, <span class="dv">1</span>), <span class="dt">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb60-3"><a href="chapitre-temps.html#cb60-3"></a></span>
<span id="cb60-4"><a href="chapitre-temps.html#cb60-4"></a><span class="kw">plot_grid</span>(<span class="kw">autoplot</span>(lynx) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lynx: S√©rie temporelle&quot;</span>),</span>
<span id="cb60-5"><a href="chapitre-temps.html#cb60-5"></a>          <span class="kw">ggAcf</span>(lynx) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lynx: Autocorr√©lation&quot;</span>),</span>
<span id="cb60-6"><a href="chapitre-temps.html#cb60-6"></a>          <span class="kw">gglagplot</span>(lynx) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lynx: Lag plot&quot;</span>),</span>
<span id="cb60-7"><a href="chapitre-temps.html#cb60-7"></a>          <span class="kw">autoplot</span>(bruit_blanc) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bruit blanc: S√©rie temporelle&quot;</span>),</span>
<span id="cb60-8"><a href="chapitre-temps.html#cb60-8"></a>          <span class="kw">ggAcf</span>(bruit_blanc) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bruit blanc: Autocorr√©lation&quot;</span>),</span>
<span id="cb60-9"><a href="chapitre-temps.html#cb60-9"></a>          <span class="kw">gglagplot</span>(bruit_blanc) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Bruit blanc: Lag plot&quot;</span>),</span>
<span id="cb60-10"><a href="chapitre-temps.html#cb60-10"></a>          <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-auto-correlation-1.png" width="1440" /></p>
<p><strong>Exercice</strong>. Cr√©ez, puis interpr√©tez des graphiques <code>autoplot()</code>, <code>ggAcf()</code> et <code>gglagplot()</code> pour les donn√©es <code>auscafe</code>.</p>
<p><strong>Exercice</strong>. Trouvez le graphique d‚Äôautocorr√©lation et le graphique de retardement correspondant √† chaque s√©rie temporelle.</p>
<div class="figure" style="text-align: center"><span id="fig:ts-exercice-viz"></span>
<img src="images/09_exercice-plot.png" alt="Exercice: Trouvez le graphique d'autocorr√©lation et le graphique de retardement correspondant √† chaque s√©rie temporelle." width="100%" />
<p class="caption">
Figure 12.4: Exercice: Trouvez le graphique d‚Äôautocorr√©lation et le graphique de retardement correspondant √† chaque s√©rie temporelle.
</p>
</div>
<p>R√©ponse, voir <code>source("lib/09_exercice-hydrometeo.R")</code>:
- <code>D√©bit</code>: A-B-C
- <code>total_precip</code>: B-A-A
- <code>mean_temp</code>: C-C-B</p>
</div>
<div id="signification-statistique-dune-s√©rie-temporelle" class="section level3">
<h3><span class="header-section-number">12.2.4</span> Signification statistique d‚Äôune s√©rie temporelle</h3>
<p>J‚Äôai pr√©c√©demment introduit la notion de bruit blanc, qui est un signal ne contenant pas de structure, comme le gr√©sillement d‚Äôune radio mal syntonis√©e. Nous avons vu au chapitre <a href="chapitre-biostats.html#chapitre-biostats">6</a> que les tests d‚Äôhypoth√®se en statistiques fr√©quentielles visent entre autre √† d√©tecter la probabilit√© que les donn√©es soient g√©n√©r√©es par une distribution dont la tendance centrale est nulle. De m√™me, pour les s√©ries temporelles, il est possible de calculer la probabilit√© qu‚Äôun signal soit un bruit blanc. Deux outils peuvent nous aider √† effectuer ce test: l‚Äôun visuel, l‚Äôautre sous forme de calcul.</p>
<p>Le graphique d‚Äôautocorr√©lation est √† m√™me d‚Äôinclure des seuils pour lesquels la corr√©lation est significative (lignes pointill√©es bleues).</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="chapitre-temps.html#cb61-1"></a><span class="kw">ggAcf</span>(lynx, <span class="dt">ci =</span> <span class="fl">0.95</span>) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Lynx: Autocorr√©lation&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-lynx-signif-1.png" width="672" /></p>
<p>L‚Äôanalyse des seuils de signification de l‚Äôautocorr√©lation indique sur la possibilit√© de conduire la s√©rie temporelle vers un processus de mod√©lisation pr√©dictive. Dans l‚Äôexemple ci-dessus, on remarque qu‚Äôil existe des corr√©lations significatives pour un d√©calage de 4 √† 6 donn√©es, mais que les donn√©es situ√©es pr√®s les unes des autres pourraient √™tre plus difficiles √† mod√©liser.</p>
<p>Le test de Ljung-Box permet quant √† lui de tester si la s√©rie temporelle enti√®re peut √™tre diff√©renci√©e d‚Äôun bruit blanc.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="chapitre-temps.html#cb62-1"></a><span class="kw">Box.test</span>(lynx, <span class="dt">lag =</span> <span class="dv">20</span>, <span class="dt">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  lynx
## X-squared = 365.54, df = 20, p-value &lt; 2.2e-16</code></pre>
<p>La probabilit√© que la s√©rie soit un bruit blanc est presque nulle.</p>
<p>Notons que les tests statistiques sont aussi valides sur les d√©riv√©es des s√©ries temporelles. En outre, une d√©riv√©e premi√®re de la s√©rie temporelle sur les d√©penses devient une s√©rie temporelle de la variation des d√©penses en restauration.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="chapitre-temps.html#cb64-1"></a><span class="kw">plot_grid</span>(<span class="kw">autoplot</span>(<span class="kw">diff</span>(auscafe)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Restauration: S√©rie temporelle&quot;</span>),</span>
<span id="cb64-2"><a href="chapitre-temps.html#cb64-2"></a>          <span class="kw">ggAcf</span>(<span class="kw">diff</span>(auscafe)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Restauration: Autocorr√©lation&quot;</span>),</span>
<span id="cb64-3"><a href="chapitre-temps.html#cb64-3"></a>          <span class="kw">gglagplot</span>(<span class="kw">diff</span>(auscafe)) <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Restauration: Lag plot&quot;</span>),</span>
<span id="cb64-4"><a href="chapitre-temps.html#cb64-4"></a>          <span class="dt">ncol =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-diff-first-1.png" width="1440" /></p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="chapitre-temps.html#cb65-1"></a><span class="kw">Box.test</span>(<span class="kw">diff</span>(auscafe), <span class="dt">lag =</span> <span class="dv">16</span>, <span class="dt">type =</span> <span class="st">&quot;Ljung-Box&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Ljung test
## 
## data:  diff(auscafe)
## X-squared = 647.11, df = 16, p-value &lt; 2.2e-16</code></pre>
<p>Jusqu‚Äô√† pr√©sent, nous nous sommes content√©s d‚Äôobserver des s√©ries temporelles. Lan√ßons-nous maintenant dans un domaine plus excitant.</p>
<p><img src="https://media.giphy.com/media/U7r30sy3u73Og/giphy.gif" /></p>
<p>Source: Sc√®ne de Back to the future, Robert Zemeckis et and Bob Gale, 1985</p>
</div>
</div>
<div id="mod√©lisation-de-s√©ries-temporelles" class="section level2">
<h2><span class="header-section-number">12.3</span> Mod√©lisation de s√©ries temporelles</h2>
<p>L‚Äôobjectif g√©n√©ral de la mod√©lisation de s√©rie temporelle est la pr√©vision (<em>forecast</em>). La majorit√© des mod√®les se base sur des simulations de futurs possibles, desquels on pourra d√©duire une tendance centrale (<em>point forecast</em>) ainsi que des intervalles pr√©visionnels pour appr√©cier l‚Äôincertitude de la projection. Il est important d‚Äôinsister sur le fait que la tendance centrale ne signifie pas que les donn√©es futures suivront cette tendance, mais que, selon les donn√©es et le mod√®le, la moiti√© des donn√©es devrait se retrouver sous la ligne, et l‚Äôautre moiti√© au-dessus. De plus, la r√©gion de confiance d√©finie par les intervalles pr√©visionnels signifient que par exemple 95% des points devraient se situer dans cette r√©gion.</p>
<p>Une mani√®re d‚Äô√©valuer la performance d‚Äôune pr√©vision est de pr√©voir des donn√©es auparavant observ√©es √† partir des donn√©es qui les pr√©c√®dent. Ces valeurs sont dites <em>liss√©es</em>. Tout comme c‚Äôest le cas en r√©gression statistique, il est possible de d√©duire les r√©sidus du mod√®le. Pour les r√©gressions couvertes au chapitre <a href="chapitre-biostats.html#chapitre-biostats">6</a>, nous v√©rifions la validit√© du mod√®le en v√©rifiant si les r√©sidus √©taient distribu√©es normalement. Pour une s√©rie temporelle, on tend plut√¥t √† v√©rifier si les r√©sidus forment un bruit blanc, c‚Äôest-√†-dire qu‚Äôils ne sont pas corr√©l√©s. De plus, pour √©viter d‚Äô√™tre biais√©es, leur moyenne doit √™tre de 0. De mani√®re compl√©mentaire pour la validit√© des intervalles pr√©visionnels, mais non essentielle √† la validit√© du mod√®le, les r√©sidus devraient √™tre distribu√©s normalement et leur variance devrait √™tre constante (<a href="https://otexts.com/fpp2/">Hyndman et Athanasopoulos, 2018</a>).</p>
<p>Il est possible qu‚Äôun mod√®le remplisse toutes ces conditions, mais que sa pr√©vision soit m√©diocre. Comme nous le verrons √©galement au chapitre <a href="chapitre-ml.html#chapitre-ml">11</a>, une pr√©diction ou une pr√©vision issue d‚Äôun mod√®le ne peut pas √™tre √©valu√©e sur des donn√©es qui ont servies √† lisser le mod√®le. <strong>Pour v√©rifier une pr√©vision temporelle, il faut s√©parer les donn√©es en deux s√©ries: une s√©rie d‚Äôentra√Ænement et une s√©rie de test</strong> (figure <a href="chapitre-temps.html#fig:ts-train-test">12.5</a>).</p>
<div class="figure" style="text-align: center"><span id="fig:ts-train-test"></span>
<img src="https://otexts.com/fpp2/fpp_files/figure-html/traintest-1.png" alt="Les points bleus d√©signe la s√©rie d'entra√Ænement et les points rouges, la s√©rie de test. Source de l'image: [Hyndman et Athanasopoulos, 1998](https://otexts.com/fpp2/)." width="100%" />
<p class="caption">
Figure 12.5: Les points bleus d√©signe la s√©rie d‚Äôentra√Ænement et les points rouges, la s√©rie de test. Source de l‚Äôimage: <a href="https://otexts.com/fpp2/">Hyndman et Athanasopoulos, 1998</a>.
</p>
</div>
<p>La s√©paration dans le temps entre la s√©rie d‚Äôentra√Ænement et la s√©rie de test se fait √† votre convenance, selon la disponibilit√© des donn√©es. Vous aurez toutefois avantage √† conserver davantage de donn√©es en entra√Ænement (typiquement, 70%), et √† tout le moins, s√©parer au moins une fluctuation saisonni√®re ou cyclique. La s√©rie d‚Äôentra√Ænement servira √† lisser le mod√®le pour en d√©couvrir les possibles structures. La s√©rie de test servira √† √©valuer sa performance sur des donn√©es obtenues, mais inconnues du mod√®le pour v√©rifier les structures d√©couvertes par le mod√®le. L‚Äôerreur pr√©visionnelle est la diff√©rence entre une donn√©e observ√©e en test et sa pr√©vision (l‚Äô√©quivalent des r√©sidus, mais appliqu√©s sur des donn√©es ind√©pendantes du mod√®le). La performance d‚Äôune pr√©vision peut √™tre √©valu√©e de diff√©rentes mani√®res, mais l‚Äôerreur moyenne absolue √©chelonn√©e (<em>mean absolute scaled error</em>, MASE) est conseill√©e puisqu‚Äôelle ne d√©pend pas de la m√©trique de la quantit√© produite: plus la MASE se rapproche de z√©ro, meilleure est la pr√©vision.</p>
<p>La prudence est de mise pour que les mod√®les de pr√©diction dans l‚Äôespace (chapitre (#chapitre-geo)) ou dans diff√©rentes circonstances (chapitre (#chapitre-ml)) ne soient pas extrapol√©es pas au-del√† du nuage de points des donn√©es d‚Äôentra√Ænement. Mais pour les mod√®les pr√©visionnels, nous ne connaissons pas le futur: on travaille n√©cessairement en extrapolation. C‚Äôest la raison pour laquelle la s√©paration entre l‚Äôentra√Ænement et le test ne se fait pas au hasard comme pour les mod√®les d‚Äôautoapprentissage (chapitre (#chapitre-ml)). Puisque nous ne connaissons pas les donn√©es futures, la performance d‚Äôun mod√®le pr√©visionnel doit √™tre √©valu√©e pour sa capacit√© √† extrapoler, et non pas √† interpoler une ann√©e dont la mesure est inconnue entre un pass√© et un futur connus.</p>
<p>Plusieurs m√©thodes de pr√©vision sont possibles. Nous en couvrirons 3 dans ce chapitre: la m√©thode na√Øve, la m√©thode SES et la m√©thode ARIMA. Nous allons couvrir les diff√©rents aspects de la mod√©lisation des s√©ries temporelles √† travers l‚Äôutilisation de ces m√©thodes.</p>
<div id="m√©thode-na√Øve" class="section level3">
<h3><span class="header-section-number">12.3.1</span> M√©thode na√Øve</h3>
<p>La m√©thode na√Øve d√©finit la valeur suivante selon la valeur pr√©c√©dente (fonction <code>forecast::naive()</code>), ou la valeur de la saison pr√©c√©dente (fonction <code>forecast::snaive()</code>). Ces fonctions du module <strong><code>forecast</code></strong> incluent un composante al√©atoire pour simuler des occurrences futures selon des marches al√©atoires (<em>random walks</em>), o√π chaque valeur suivante est simul√©e al√©atoirement, consid√©rant la valeur pr√©c√©dente.</p>
<p>Nous tenterons de pr√©voir les d√©bits de la rivi√®re Chaudi√®re. Ceux-ci √©tant caract√©ris√© par des fluctuations saisonni√®res, mieux vaut utiliser <code>snaive()</code>. Mais auparavant, s√©parons la s√©rie en s√©rie d‚Äôentra√Ænement et s√©rie de test.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="chapitre-temps.html#cb67-1"></a>flow_ts &lt;-<span class="st"> </span>hydrometeo_monthly_ts[, <span class="dv">1</span>]</span>
<span id="cb67-2"><a href="chapitre-temps.html#cb67-2"></a>flow_ts_train &lt;-<span class="st"> </span><span class="kw">window</span>(flow_ts, <span class="dt">start =</span> <span class="dv">1998</span>, <span class="dt">end =</span> <span class="fl">2005.999</span>)</span>
<span id="cb67-3"><a href="chapitre-temps.html#cb67-3"></a>flow_ts_test &lt;-<span class="st"> </span><span class="kw">window</span>(flow_ts, <span class="dt">start =</span> <span class="dv">2006</span>)</span></code></pre></div>
<p>Lan√ßons la mod√©lisation sur les donn√©es d‚Äôentra√Ænement.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="chapitre-temps.html#cb68-1"></a>hm_naive &lt;-<span class="st"> </span><span class="kw">snaive</span>(flow_ts_train, <span class="dt">h =</span> <span class="dv">24</span>)</span>
<span id="cb68-2"><a href="chapitre-temps.html#cb68-2"></a><span class="kw">autoplot</span>(hm_naive) <span class="op">+</span></span>
<span id="cb68-3"><a href="chapitre-temps.html#cb68-3"></a><span class="st">  </span><span class="kw">autolayer</span>(<span class="kw">fitted</span>(hm_naive)) <span class="op">+</span></span>
<span id="cb68-4"><a href="chapitre-temps.html#cb68-4"></a><span class="st">  </span><span class="kw">autolayer</span>(flow_ts_test, <span class="dt">color =</span> <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.6</span>)) <span class="op">+</span></span>
<span id="cb68-5"><a href="chapitre-temps.html#cb68-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;Ann√©e&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;D√©bit&quot;</span>)</span></code></pre></div>
<pre><code>## Warning: Removed 12 row(s) containing missing values (geom_path).</code></pre>
<p><img src="_main_files/figure-html/ts-hm-naive-fit-1.png" width="672" /></p>
<p>Le graphique pr√©c√©dent montre que la pr√©vision na√Øve (en rose) prend bien la valeur observ√©e au cycle pr√©c√©dent (en noir). Les donn√©es de test sont en gris transparent. Notons que la pr√©sence de d√©bit n√©gatifs pourrait √™tre √©vit√©e en utilisant une transformation logarithmique du d√©bit pr√©alablement √† la mod√©lisation.</p>
<p>Voyons maintenant l‚Äôanalyse des r√©sidus avec la fonction <code>forecast::checkresiduals()</code>.</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="chapitre-temps.html#cb70-1"></a><span class="kw">checkresiduals</span>(hm_naive)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-naive-residuals-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from Seasonal naive method
## Q* = 34.903, df = 19, p-value = 0.01435
## 
## Model df: 0.   Total lags used: 19</code></pre>
<p>La <code>p-value</code> √©tant de 0.01546, il est peu probable que les r√©sidus forment un bruit blanc. Les r√©sidus contiennent de l‚Äôautocorr√©lation, ce qui devrait √™tre √©vit√©. Ceci est toutefois d√ª √† un seul point allant au-del√† du seuil de 0.05, que l‚Äôon peut observer sur le graphique d‚Äôautocorr√©lation. Le graphique de la distribution des r√©sidus montre des valeurs aberrantes, ainsi qu‚Äôune distribution plut√¥t pointue, qui donnerait un test de Kurtosis probablement √©lev√©.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="chapitre-temps.html#cb72-1"></a><span class="kw">shapiro.test</span>(<span class="kw">residuals</span>(hm_naive)) <span class="co"># non-normal si p-value &lt; seuil (0.05)</span></span></code></pre></div>
<pre><code>## 
##  Shapiro-Wilk normality test
## 
## data:  residuals(hm_naive)
## W = 0.93698, p-value = 0.0004733</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="chapitre-temps.html#cb74-1"></a><span class="kw">library</span>(<span class="st">&quot;e1071&quot;</span>)</span>
<span id="cb74-2"><a href="chapitre-temps.html#cb74-2"></a><span class="kw">kurtosis</span>(<span class="kw">residuals</span>(hm_naive), <span class="dt">na.rm =</span> <span class="ot">TRUE</span>) <span class="co"># le r√©sultat d&#39;un test de kurtosis sur une distribution normale devrait √™tre de 0.</span></span></code></pre></div>
<pre><code>## [1] 2.909277</code></pre>
<p>Pas de panique, les pr√©dictions peuvent n√©anmoins √™tre valides: seulement, les intervalles pr√©visionnels pourraient √™tre trop vagues ou trop restreintes: √† prendre avec des pincettes.</p>
<p>L‚Äô√©valuation du mod√®le peut √™tre effectu√©e avec la fonction <code>forecast::accuracy()</code>, qui d√©tecte automatiquement la s√©rie d‚Äôentra√Ænement et la s√©rie de test si on lui fournit la s√©rie enti√®re (ici l‚Äôobjet <code>flow_ts</code>).</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="chapitre-temps.html#cb76-1"></a><span class="kw">accuracy</span>(hm_naive, flow_ts)</span></code></pre></div>
<pre><code>##                      ME     RMSE      MAE        MPE     MAPE     MASE
## Training set  0.5952819 80.24256 54.53431 -57.045415 95.60936 1.000000
## Test set     -1.0165543 75.18877 57.10499  -2.645333 59.10844 1.047139
##                       ACF1 Theil&#39;s U
## Training set  0.1669526053        NA
## Test set     -0.0006850245 0.3877041</code></pre>
<p>La m√©thode na√Øve est rarement utilis√©e en pratique autrement que comme standard par rapport auquel la performance d‚Äôautres mod√®les est √©valu√©e.</p>
</div>
<div id="m√©thode-ses" class="section level3">
<h3><span class="header-section-number">12.3.2</span> M√©thode SES</h3>
<p>Alors que la m√©thode na√Øve donne une cr√©dibilit√© compl√®te √† la valeur pr√©c√©dente (ou au cycle pr√©c√©dent), la m√©thode SES (<em>simple exponential smoothing</em>) donne aux valeurs pr√©c√©dentes des poids exponentiellement d√©croissants selon leur anciennet√©. La pr√©vision par SES sera une moyenne pond√©r√©e des derni√®res observations, en donnant plus de poids sur les observations plus rapproch√©es.</p>
<p>Math√©matiquement, la m√©thode SES est d√©crite ainsi.</p>
<p><span class="math display">\[\hat{y}_{t + h|t} = \alpha y_t + \alpha\left( 1-\alpha \right) y_{t-1} + \alpha\left( 1-\alpha \right)^2 y_{t-2} + ...\]</span></p>
<p>o√π <span class="math inline">\(\hat{y}_{t + h|t}\)</span> est la pr√©vision de <span class="math inline">\(y\)</span> au temps <span class="math inline">\(t + h|t\)</span>, qui est le d√©calage de <span class="math inline">\(h\)</span> √† partir de la derni√®re mesure au temps <span class="math inline">\(t\)</span>. Le param√®tre <span class="math inline">\(\alpha\)</span> prend une valeur de 0 √† 1, et d√©crit la distribution des poids. Une valeur de <span class="math inline">\(\alpha\)</span> √©lev√© donnera davantage de poids aux √©v√©nements r√©cents. La somme de tous poids <span class="math inline">\(\alpha\)</span> tend vers 1 lorsque les pas de temps pr√©c√©dents tendent vers l‚Äô<span class="math inline">\(\infty\)</span>.</p>
<p><img src="_main_files/figure-html/ts-hm-ses-fit,%20ts-hm-naive-fit-1.png" width="672" /></p>
<p>Une autre mani√®re d‚Äôexprimer l‚Äô√©quation est de la segmenter en deux: une pour la pr√©vision en fonction du niveau (<em>level</em>, le mod√®le), une autre pour d√©crire comment le niveau change au fil du temps.</p>
<table>
<thead>
<tr class="header">
<th>Description</th>
<th>√âquation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pr√©vision</td>
<td><span class="math inline">\(\hat{y}_{t + h|t} = l_t\)</span></td>
</tr>
<tr class="even">
<td>Niveau</td>
<td><span class="math inline">\(l_t = \alpha y_t + \alpha\left( 1-\alpha \right) l_{t-1}\)</span></td>
</tr>
</tbody>
</table>
<p>Exprim√©e ainsi, la pr√©vision n‚Äôexprimera aucune tendance ni fluctuation. Il s‚Äôagira d‚Äôune projection jusqu‚Äô√† l‚Äôinfini de la moyenne des observations pr√©c√©dentes pond√©r√©e par leur d√©calage.</p>
<div id="ses-de-base" class="section level4">
<h4><span class="header-section-number">12.3.2.1</span> SES de base</h4>
<p>Prenons les <a href="https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt">donn√©es de la NASA</a> sur l‚Äôindice de temp√©rature terre-oc√©an, qui d√©crit un d√©calage par rapport √† la moyenne des temp√©ratures globales observ√©es entre de 1951 √† 1980. La m√©thode SES est appel√©e par la fonction <code>forecast::ses()</code>, de la m√™me mani√®re qu‚Äôon l‚Äôa fait pr√©c√©demment avec la m√©thode na√Øve.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="chapitre-temps.html#cb78-1"></a>loti_ts &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;data/09_nasa.csv&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">pull</span>(LOTI) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ts</span>(., <span class="dt">start =</span> <span class="dv">1880</span>, <span class="dt">frequency =</span> <span class="dv">1</span>)</span>
<span id="cb78-2"><a href="chapitre-temps.html#cb78-2"></a><span class="co">#loti_ts &lt;- window(loti_ts, start = 1950)</span></span>
<span id="cb78-3"><a href="chapitre-temps.html#cb78-3"></a>loti_ts_tr &lt;-<span class="st"> </span><span class="kw">window</span>(loti_ts, <span class="dt">end =</span> <span class="dv">2004</span>)</span>
<span id="cb78-4"><a href="chapitre-temps.html#cb78-4"></a>loti_ses &lt;-<span class="st"> </span><span class="kw">ses</span>(loti_ts_tr, <span class="dt">h =</span> <span class="dv">20</span>, <span class="dt">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb78-5"><a href="chapitre-temps.html#cb78-5"></a><span class="kw">autoplot</span>(loti_ses) <span class="op">+</span><span class="st"> </span><span class="kw">autolayer</span>(<span class="kw">fitted</span>(loti_ses))</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-nasa-ses-fit-1.png" width="672" /></p>
<blockquote>
<p><strong>Note</strong>. Les pr√©visions climatiques sont effectu√©es par des mod√®les bien plus complexes que ce que nous voyons ici. Les pr√©visions du GIEC agr√®gent des tendances localis√©es et incluent une batterie de covariables, dont la plus √©vidente est la concentration en CO2 dans l‚Äôatmosph√®re. Il s‚Äôagit seulement d‚Äôun exemple d‚Äôapplication.</p>
</blockquote>
</div>
<div id="ses-avec-tendance" class="section level4">
<h4><span class="header-section-number">12.3.2.2</span> SES avec tendance</h4>
<p>La pr√©vision a peu d‚Äôint√©r√™t, √©tant donn√©e qu‚Äôelle n‚Äôinclut pas de tendance. Or, nous pouvons en ajouter une √† l‚Äô√©quation. Ainsi exprim√©e, la tendance changera aussi au fil du temps.</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Description</th>
<th>√âquation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pr√©vision</td>
<td><span class="math inline">\(\hat{y}_{t + h|t} = l_t + \left( \phi + \phi^2 + ... + \phi^h \right) \times b_t\)</span></td>
</tr>
<tr class="even">
<td>Niveau</td>
<td>$l_t = y_t + ( 1-) ( l_{t-1} + b_{t-1} ) $</td>
</tr>
<tr class="odd">
<td>Tendance</td>
<td><span class="math inline">\(b_t = \beta^* \left( l_t - l_{t-1} \right) + (1-\beta^*) \phi b_{t-1}\)</span></td>
</tr>
</tbody>
</table>
<p>Le param√®tre <span class="math inline">\(\beta^*\)</span> d√©crit la vitesse √† laquelle la tendance peut changer, de 0 o√π la pente ne change pas √† 1 o√π la pente change rapidement. Le param√®tre <span class="math inline">\(\phi\)</span> adouci la pente en s‚Äô√©loignant de la derni√®re mesure. Un tendant vers 0 g√©n√©rera un fort adoucissement, alors qu‚Äôun tendant vers 1 ne g√©n√©rera pas d‚Äôadoucissement. Il peut √™tre difficile de d√©terminer les param√®tres de lissage <span class="math inline">\(\alpha\)</span>, <span class="math inline">\(\beta^*\)</span> et <span class="math inline">\(\phi\)</span>, ainsi que les param√®tres d‚Äô√©tat <span class="math inline">\(l_0\)</span> et <span class="math inline">\(b_0\)</span>. La fonction de <code>forecast::holt()</code> permet de les estimer automatiquement.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="chapitre-temps.html#cb79-1"></a>loti_holt_dF &lt;-<span class="st"> </span><span class="kw">holt</span>(loti_ts_tr, <span class="dt">damped =</span> <span class="ot">FALSE</span>, <span class="dt">h =</span> <span class="dv">100</span>)</span>
<span id="cb79-2"><a href="chapitre-temps.html#cb79-2"></a>loti_holt_dT &lt;-<span class="st"> </span><span class="kw">holt</span>(loti_ts_tr, <span class="dt">damped =</span> <span class="ot">TRUE</span>, <span class="dt">h =</span> <span class="dv">100</span>)</span>
<span id="cb79-3"><a href="chapitre-temps.html#cb79-3"></a><span class="kw">plot_grid</span>(<span class="kw">autoplot</span>(loti_holt_dF), <span class="kw">autoplot</span>(loti_holt_dT))</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-nasa-holt-fit-1.png" width="960" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="chapitre-temps.html#cb80-1"></a>loti_holt_dF<span class="op">$</span>model<span class="op">$</span>par</span></code></pre></div>
<pre><code>##         alpha          beta             l             b 
##  0.4052862918  0.0001000051 -0.2170967540  0.0052550677</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="chapitre-temps.html#cb82-1"></a>loti_holt_dT<span class="op">$</span>model<span class="op">$</span>par</span></code></pre></div>
<pre><code>##         alpha          beta           phi             l             b 
##  0.4843654438  0.0001000061  0.8286096396 -0.1096315698 -0.0332523695</code></pre>
<p>Dans ce cas, l‚Äôoptimisation de <span class="math inline">\(\phi\)</span> lui donne une valeur de 0.8, une valeur suffisamment faible pour que l‚Äôadoucissement soit fort. Vous obtiendrez une valeur de <span class="math inline">\(\phi\)</span> plus √©lev√©e en ne consid√©rant que les donn√©es obtenues depuis 1950 (en d√©commentant <code>loti_ts &lt;- window(loti_ts, start = 1950)</code>, plus haut).</p>
</div>
<div id="ses-avec-fluctuation-saisonni√®re" class="section level4">
<h4><span class="header-section-number">12.3.2.3</span> SES avec fluctuation saisonni√®re</h4>
<p>D‚Äôautres param√®tres peuvent √™tre ajout√©s pour de tenir compte des fluctuations saisonni√®res (les fluctuations cycliques sont plus difficiles √† mod√©liser) de mani√®re additive ou multiplicative. Voici la modification apport√©e pour la mod√©lisation additive, en laissant tomber l‚Äôadoucissement.</p>
<table>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th>Description</th>
<th>√âquation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Pr√©vision</td>
<td><span class="math inline">\(\hat{y}_{t + h|t} = l_t + h \times b_t + s_{t-m+h_m^+}\)</span></td>
</tr>
<tr class="even">
<td>Niveau</td>
<td><span class="math inline">\(l_t = \alpha \left(y_t - s_{t-m} \right) + \alpha\left( 1-\alpha \right) \left( l_{t-1} + b_{t-1} \right)\)</span></td>
</tr>
<tr class="odd">
<td>Tendance</td>
<td><span class="math inline">\(b_t = \beta^* \left( l_t - l_{t-1} \right) + (1-\beta^*) b_{t-1}\)</span></td>
</tr>
<tr class="even">
<td>Saison</td>
<td><span class="math inline">\(s_t = \gamma \left( y_t - l_{t-1} - b_{t-1} \right) + (1-\gamma) s_{t-m}\)</span></td>
</tr>
</tbody>
</table>
<p>o√π <span class="math inline">\(m\)</span> est la p√©riodicit√© des fluctuations saisonni√®re, par exemple 4 pour quatre saisons annuelles et <span class="math inline">\(\gamma\)</span> est un param√®tre de la portion saisonni√®re, qui, tout comme un effet al√©atoire en biostatistiques, fluctue autour de z√©ro. La variante multiplicative multiplie la pr√©vision par un facteur plut√¥t que d‚Äôimposer un d√©calage. La math√©matique n‚Äôest pas pr√©sent√©e ici pour plus de simplicit√© (consulter <a href="https://otexts.com/fpp2/holt-winters.html">Hyndman et Athanasopoulos (2018), chapitre 7.3</a> pour plus de d√©tails). Dans le cas multiplicatif, l‚Äôeffet saisonnier fluctue autour de 1. Si l‚Äôamplitude de la fluctuation s‚Äôaccro√Æt au fil de la s√©rie temporelle, la m√©thode multiplicative donnera probablement de meilleurs r√©sultats.</p>
<p>La fonction que nous utiliserons pour les SES-saisonniers est <code>forecast::hw()</code>. Les donn√©es de la NASA ne sont pas saisonni√®res (<code>frequency(loti_ts)</code> donne 1).</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="chapitre-temps.html#cb84-1"></a>flow_hw &lt;-<span class="st"> </span><span class="kw">hw</span>(flow_ts_train, <span class="dt">damped =</span> <span class="ot">TRUE</span>, <span class="dt">h =</span> <span class="dv">12</span><span class="op">*</span><span class="dv">3</span>, <span class="dt">seasonal =</span> <span class="st">&quot;additive&quot;</span>)</span>
<span id="cb84-2"><a href="chapitre-temps.html#cb84-2"></a><span class="kw">autoplot</span>(flow_hw) <span class="op">+</span><span class="st"> </span><span class="kw">autolayer</span>(<span class="kw">fitted</span>(flow_hw))</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-hw-fit-1.png" width="672" /></p>
</div>
<div id="automatiser-la-pr√©vision-avec-les-ses" class="section level4">
<h4><span class="header-section-number">12.3.2.4</span> Automatiser la pr√©vision avec les SES</h4>
<p>L‚Äôerreur du mod√®le peut aussi √™tre calcul√©e de sorte qu‚Äôelle soit constante ou augmente selon le niveau (ou d√©calage). Nous avons donc plusieurs types de mod√®les de la famille SES.</p>
<ul>
<li>Tendance: [sans tendance, tendance additive, tendance adoucie]</li>
<li>Saison: [sans saison, saison additive, saison multiplicative]</li>
<li>Erreur: [erreur additive, erreur multiplicative]</li>
</ul>
<p>Lequel choisir? Encore une fois, on peut laisser R optimiser notre choix avec un mod√®le ETS (<em>error, tend and seasonnal</em>). L‚Äôoptimisation est lanc√©e avec la fonction <code>forecast::ets()</code>.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="chapitre-temps.html#cb85-1"></a>flow_model &lt;-<span class="st"> </span><span class="kw">ets</span>(flow_ts_train)</span>
<span id="cb85-2"><a href="chapitre-temps.html#cb85-2"></a>flow_model</span></code></pre></div>
<pre><code>## ETS(M,N,M) 
## 
## Call:
##  ets(y = flow_ts_train) 
## 
##   Smoothing parameters:
##     alpha = 0.0104 
##     gamma = 1e-04 
## 
##   Initial states:
##     l = 127.508 
##     s = 0.6511 0.9399 0.7981 0.4272 0.6253 0.8872
##            0.6594 1.2741 3.7317 1.5211 0.1878 0.2971
## 
##   sigma:  0.6065
## 
##      AIC     AICc      BIC 
## 1222.469 1228.469 1260.935</code></pre>
<p>Le mod√®le retenu est un <code>ETS(M,N,M)</code>, d√©finissant dans l‚Äôordre le type d‚Äôerreur, de tendance et de saison selon <code>A</code> pour additif, <code>M</code> pour multiplicatif et <code>N</code> pour l‚Äôabsence. Nous avons une erreur de type <code>M</code> (multiplicative), une tendance de type <code>N</code> (sans tendance) et une saison de type <code>M</code> (multiplicative). L‚Äôabsence de valeur pour <code>phi</code> indique que l‚Äôadoucissement n‚Äôest probablement pas n√©cessaire.</p>
<p>Nous pouvons visualiser l‚Äô√©volution des diff√©rentes composantes.</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="chapitre-temps.html#cb87-1"></a><span class="kw">autoplot</span>(flow_model)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-ets-plot-1.png" width="672" /></p>
<p>Dans un mod√®le sans tendance, avec saisonnalit√© multiplicative, les donn√©es <em>levels</em> sont multipli√©es par les donn√©es <em>season</em> pour obtenir la pr√©vision. Malgr√© l‚Äôabsence de tendance dans le mod√®le, il semble que le d√©bit a diminu√© de 2000 √† 2003 entre deux √©tats stables de 1998 √† 2000 et de 2003 √† 2006.</p>
<p>La fonction <code>forecast::ets()</code> g√©n√®re un mod√®le, mais pas de pr√©diction. Pour obtenir une pr√©diction, nous devons utiliser la fonction <code>forecast::forecast()</code>, que j‚Äôutiliserai ici en mode <em>tidyverse</em>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="chapitre-temps.html#cb88-1"></a>flow_ets &lt;-<span class="st"> </span>flow_ts_train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">ets</span>()</span>
<span id="cb88-2"><a href="chapitre-temps.html#cb88-2"></a>flow_fc &lt;-<span class="st"> </span>flow_ets <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>()</span>
<span id="cb88-3"><a href="chapitre-temps.html#cb88-3"></a>flow_fc <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-ets-pred-1.png" width="672" /></p>
<p>L‚Äôanalyse d‚Äôexactitude et celle des r√©sidus sont toutes aussi pertinentes. La premi√®re est effectu√©e sur la pr√©vision, et la seconde sur le mod√®le.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="chapitre-temps.html#cb89-1"></a><span class="kw">accuracy</span>(flow_fc, flow_ts)</span></code></pre></div>
<pre><code>##                      ME     RMSE      MAE       MPE      MAPE      MASE
## Training set -13.346098 59.33195 44.55719 -90.26010 110.68741 0.8170487
## Test set       3.768712 69.95479 55.55668 -24.65164  62.94846 1.0187472
##                   ACF1 Theil&#39;s U
## Training set 0.1612394        NA
## Test set     0.2452020 0.6990499</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="chapitre-temps.html#cb91-1"></a><span class="kw">checkresiduals</span>(flow_ets)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-ets-accuracy-1.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from ETS(M,N,M)
## Q* = 27.068, df = 5, p-value = 5.533e-05
## 
## Model df: 14.   Total lags used: 19</code></pre>
<p>Il est peu probable que les r√©sidus aient √©t√© g√©n√©r√©s par un bruit blanc, indiquant qu‚Äôil existe une structure dans les donn√©es qui n‚Äôa pas √©t√© captur√©e par le mod√®le.</p>
<p><strong>Exercice</strong>. Mod√©liser la s√©rie temporelle <code>lynx</code> avec <code>forecast::ets()</code>. Que se passe-t-il?</p>
</div>
<div id="pr√©traitement-des-donn√©es-1" class="section level4">
<h4><span class="header-section-number">12.3.2.5</span> Pr√©traitement des donn√©es</h4>
<p>J‚Äôai sp√©cifi√© plus haut que les donn√©es de d√©bit pourraient avantageusement √™tre transform√©es avec un logarithme pour √©viter les pr√©dictions de d√©bits n√©gatifs. D‚Äôautres types de transformation peuvent √™tre utilis√©es, comme la racine carr√©e ou cubique, l‚Äôoppos√©e de l‚Äôinverse (<span class="math inline">\(-1/x\)</span>) ou les transformations compositionnelles (chapitre <a href="chapitre-explorer.html#chapitre-explorer">8</a>). La transformation Box-Cox est aussi largement utilis√©e pour sa polyvalence.</p>
<p><span class="math display">\[
w =
\begin{cases}
ln(y_t) &amp;\text{if } \lambda = 0 \\
\frac{y_t - 1}{\lambda} &amp;\text{if } \lambda \neq 0
\end{cases}
\]</span></p>
<p><span class="math inline">\(\lambda = 1\)</span>: pas de transformation
<span class="math inline">\(\lambda = 1/2\)</span>: ressemble √† <span class="math inline">\(\sqrt{y_t}\)</span>
<span class="math inline">\(\lambda = 1/3\)</span>: ressemble √† <span class="math inline">\(\sqrt[3]{y_t}\)</span>
<span class="math inline">\(\lambda = 0\)</span>: log naturel
<span class="math inline">\(\lambda = -1\)</span>: ressemble √† <span class="math inline">\(1/y_t\)</span></p>
<p>La fonction <code>forecast::BoxCox.lambda()</code> estime la valeur optimale de <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="chapitre-temps.html#cb93-1"></a><span class="kw">BoxCox.lambda</span>(flow_ts_train)</span></code></pre></div>
<pre><code>## [1] 0.784101</code></pre>
<p>Cette valeur peut √™tre imput√©e √† l‚Äôargument <code>lambda</code> de la fonction <code>forecast::ets()</code>. Dans notre cas, nous d√©sirions plut√¥t une transformation logarithmique. Cons√©quemment, nous utilisons <code>lambda = 0</code>.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="chapitre-temps.html#cb95-1"></a>flow_ts_train <span class="op">%&gt;%</span></span>
<span id="cb95-2"><a href="chapitre-temps.html#cb95-2"></a><span class="st">  </span><span class="kw">ets</span>(<span class="dt">lambda =</span> <span class="dv">0</span>) <span class="op">%&gt;%</span></span>
<span id="cb95-3"><a href="chapitre-temps.html#cb95-3"></a><span class="st">  </span><span class="kw">forecast</span>() <span class="op">%&gt;%</span></span>
<span id="cb95-4"><a href="chapitre-temps.html#cb95-4"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-boxcox-ets-1.png" width="672" /></p>
<p>Les erreurs ne franchissent pas le 0, mais sont vraisemblablement surestim√©es lors des sommets. Notez que R s‚Äôoccupe de la transformation retour.</p>
<p>La <strong>diff√©renciation</strong> est aussi une forme de pr√©traitement. La diff√©renciation (fonction <code>base::diff()</code>) consiste en la soustraction de la valeur pr√©c√©dente √† la valeur suivante. La valeur pr√©c√©dente peut √™tre d√©cal√©e √† la valeur de la p√©riode de l‚Äôunit√© temporelle pr√©c√©dente, par exemple le mois de mars de l‚Äôann√©e pr√©c√©dente. Un objectif de la diff√©renciation est de rendre la s√©rie temporelle stationnaire en termes de tendance et de fluctuation saisonni√®re, de sorte que la s√©rie diff√©renci√©e se comporte comme un bruit blanc.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="chapitre-temps.html#cb96-1"></a><span class="kw">plot_grid</span>(flow_ts_train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;D√©bit&quot;</span>),</span>
<span id="cb96-2"><a href="chapitre-temps.html#cb96-2"></a>          loti_ts_tr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;LOTI&quot;</span>),</span>
<span id="cb96-3"><a href="chapitre-temps.html#cb96-3"></a>          flow_ts_train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>(., <span class="dt">lag =</span> <span class="dv">12</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;D√©bit avec diff√©renciation saisonni√®re&quot;</span>),</span>
<span id="cb96-4"><a href="chapitre-temps.html#cb96-4"></a>          loti_ts_tr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">diff</span>(., <span class="dt">lag =</span> <span class="dv">1</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;LOTI avec diff√©renciation d&#39;ordre 1&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-preprocess-grid-1.png" width="672" /></p>
</div>
</div>
<div id="la-m√©thode-arima" class="section level3">
<h3><span class="header-section-number">12.3.3</span> La m√©thode ARIMA</h3>
<p>Un mod√®le ARIMA, l‚Äôacronyme de l‚Äôanglais <em>auto-regressive integrated moving average</em>, est une combinaison de trois parties: AR-I-MA. L‚Äô<strong>autor√©gression</strong> consiste en une r√©gression lin√©aire dont la variable r√©ponse <span class="math inline">\(y_t\)</span> est la variable √† l‚Äôinstant <span class="math inline">\(t\)</span> et les variables explicatives sont les variables aux instants pr√©c√©dents. Pour un nombre <span class="math inline">\(p\)</span> de p√©riodes pr√©c√©dentes, nous obtenons une r√©gression lin√©aire typique.</p>
<p><span class="math display">\[y_t = c + \phi_1 y_{t-1} + \phi_2 y_{t-2} + ... + \phi_p y_{t-p} + \epsilon_t\]</span>
o√π <span class="math inline">\(\epsilon_t\)</span> est l‚Äôerreur sur la pr√©diction.</p>
<p>La partie concernant la <strong>moyenne mobile</strong> est une r√©gression non pas sur les observations, mais sur les erreurs. Consid√©rant les <span class="math inline">\(q\)</span> erreurs pr√©c√©dentes, nous obtenons</p>
<p><span class="math display">\[y_t = c + \theta_1 \epsilon_{t-1} + \theta_2 \epsilon_{t-2} + ... + \theta_q \epsilon_{t-q} + \epsilon_t\]</span></p>
<p>La somme de l‚Äôautor√©gression et de la moyenne mobile donne un mod√®le ARMA. Le I de ARIMA, mis pour <em>integrated</em>, est le contraire de la diff√©renciation, que j‚Äôai pr√©sent√© √† la fin de la section sur les SES. Puisque la s√©rie temporelle doit √™tre stationnaire pour effectuer l‚ÄôARMA, nous devons diff√©rencier la s√©rie un nom <span class="math inline">\(d\)</span> de fois avant de proc√©der √† l‚Äôautor√©gression et au calcul de la moyenne mobile.</p>
<p>Nous obtenons ainsi une ARIMA d‚Äôordres <span class="math inline">\(p\)</span>, <span class="math inline">\(d\)</span> et <span class="math inline">\(q\)</span>, not√©e <span class="math inline">\(ARIMA(p,d,q)\)</span>. Nous devons aussi statuer si <span class="math inline">\(c\)</span> (l‚Äôintercept ou le <em>drift</em>) doit √™tre ou non consid√©r√© come nul. Ces ordres peuvent √™tre sp√©cifi√©s dans la fonction telle que <code>forecast::Arima(order = c(0, 1, 1), include.constant = TRUE)</code>. Toutefois, il est possible de les optimiser gr√¢ce √† la fonction <code>forecast::auto.arima()</code>. Tout comme les sorties de <code>forecast::ets()</code>, <code>forecast::auto.arima()</code> fourni le mod√®le, mais pas les pr√©dictions: la fonction <code>forecast::forecast()</code> doit √™tre lanc√©e pour obteir la pr√©diction.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="chapitre-temps.html#cb97-1"></a>loti_arima &lt;-<span class="st"> </span>loti_ts_tr <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">auto.arima</span>()</span>
<span id="cb97-2"><a href="chapitre-temps.html#cb97-2"></a>loti_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">30</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-nasa-arima-fit-1.png" width="672" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="chapitre-temps.html#cb98-1"></a><span class="kw">summary</span>(loti_arima)</span></code></pre></div>
<pre><code>## Series: . 
## ARIMA(1,1,3) with drift 
## 
## Coefficients:
##           ar1     ma1      ma2      ma3   drift
##       -0.9405  0.6260  -0.6019  -0.3716  0.0060
## s.e.   0.0522  0.0976   0.0847   0.0846  0.0031
## 
## sigma^2 estimated as 0.01036:  log likelihood=109.53
## AIC=-207.06   AICc=-206.35   BIC=-190.14
## 
## Training set error measures:
##                         ME       RMSE       MAE      MPE     MAPE      MASE
## Training set -0.0007946749 0.09932376 0.0824145 22.62973 65.41129 0.8925238
##                    ACF1
## Training set -0.0221428</code></pre>
<p>Le sommaire du mod√®le sp√©cifie une <span class="math inline">\(ARIMA(1,1,3)\)</span> en utilisant l‚Äôintercept <span class="math inline">\(c\)</span> (<em>with drift</em>).</p>
<p>Lorsque l‚Äôon compte pr√©dire des s√©ries saisonni√®res, nous devons ajouter un nouveau jeu d‚Äôordres <span class="math inline">\((P,D,Q)m\)</span>, o√π <span class="math inline">\(P\)</span>, <span class="math inline">\(D\)</span> et <span class="math inline">\(Q\)</span> sont √©quivalents √† leurs minuscules, mais portent sur des d√©calages saisonniers et non pas des d√©calages d‚Äôunit√©s de temps. L‚Äôordre <span class="math inline">\(m\)</span> est le nombre de p√©riodes √† consid√©rer par unit√© temporelle, par exemple 12 mois par an. Bonne nouvelle: <code>forecast::auto.arima()</code> automatise le tout. Nous pouvons utiliser <code>lambda = 0</code> pour effectuer une transformation logarithmique.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="chapitre-temps.html#cb100-1"></a>flow_arima &lt;-<span class="st"> </span>flow_ts_train <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">auto.arima</span>(<span class="dt">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb100-2"><a href="chapitre-temps.html#cb100-2"></a>flow_arima <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>(<span class="dt">h =</span> <span class="dv">36</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-arima-fit-1.png" width="672" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="chapitre-temps.html#cb101-1"></a><span class="kw">summary</span>(flow_arima)</span></code></pre></div>
<pre><code>## Series: . 
## ARIMA(1,0,0)(2,1,0)[12] 
## Box Cox transformation: lambda= 0 
## 
## Coefficients:
##          ar1     sar1     sar2
##       0.3029  -0.4913  -0.2687
## s.e.  0.1074   0.1196   0.1186
## 
## sigma^2 estimated as 0.6561:  log likelihood=-101.88
## AIC=211.77   AICc=212.27   BIC=221.49
## 
## Training set error measures:
##                    ME     RMSE      MAE       MPE     MAPE      MASE      ACF1
## Training set 9.038871 71.47444 40.46425 -34.75027 64.84495 0.7419962 -0.182341</code></pre>
<p>Le sommaire du mod√®le, <code>ARIMA(1,0,0)(2,1,0)[12]</code> sous le format <span class="math inline">\(ARIMA(p,d,q)(P,D,Q)m\)</span>, retourne automatiquement une p√©riode de 12 mois avec une diff√©renciation saisonni√®re mais sans diff√©renciation ordinaire, excluant la moyenne mobile dans les deux cas.</p>
<p><strong>Exercice</strong>. Il est toujours pertinent d‚Äôeffectuer l‚Äôanalyse des r√©sidus‚Ä¶</p>
</div>
<div id="les-mod√®les-dynamiques" class="section level3">
<h3><span class="header-section-number">12.3.4</span> Les mod√®les dynamiques</h3>
<p>J‚Äôai not√© pr√©c√©demment que l‚Äô√©volution du climat tient compte d‚Äôune s√©rie de covariables explicatives. De m√™me, le d√©bit dans la rivi√®re Chaudi√®re n‚Äôest pas un effet de la saison, mais de son environnement (climat, changements dans la morphologie du paysage, utilisation de l‚Äôeau, etc.). La pr√©vision du d√©bit aura avantage √† consid√©rer ces covariables. L‚ÄôARIMA peut accueillir des covariables en mod√©lisant le terme d‚Äôerreur, <span class="math inline">\(\epsilon_t\)</span> en fonction de s√©ries temporelles conjointes.</p>
<p>Le d√©bit mensuel de la rivi√®re Chaudi√®re peut √™tre mod√©lis√© en fonction de la temp√©rature moyenne mensuelle et des pr√©cipitations totales mensuelles en ajoutant l‚Äôargument <code>xreg</code> √† la fonction <code>forecast::auto.arima()</code>. L‚Äôargument consiste en la matrice temporelle des variables explicatives. Notez que <code>forecast::auto.arima()</code> ne fonctionne pas (encore?) avec l‚Äôinterface-formule de R, mais que l‚Äôon peut se d√©brouiller en transformant en s√©rie temporelle la sortie de la fonction <code>base::model.matrix()</code>, qui elle peut accueillir une formule.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="chapitre-temps.html#cb103-1"></a>hm_tr &lt;-<span class="st"> </span><span class="kw">window</span>(hydrometeo_monthly_ts, <span class="dt">end =</span> <span class="kw">c</span>(<span class="dv">2004</span>, <span class="dv">12</span>))</span>
<span id="cb103-2"><a href="chapitre-temps.html#cb103-2"></a>hm_te &lt;-<span class="st"> </span><span class="kw">window</span>(hydrometeo_monthly_ts, <span class="dt">start =</span> <span class="kw">c</span>(<span class="dv">2005</span>, <span class="dv">1</span>))</span>
<span id="cb103-3"><a href="chapitre-temps.html#cb103-3"></a>flow_darima &lt;-<span class="st"> </span><span class="kw">auto.arima</span>(<span class="dt">y =</span> hm_tr[, <span class="st">&quot;D√©bit&quot;</span>],</span>
<span id="cb103-4"><a href="chapitre-temps.html#cb103-4"></a>                          <span class="dt">xreg =</span> hm_tr[, <span class="kw">c</span>(<span class="st">&quot;total_precip&quot;</span>, <span class="st">&quot;mean_temp&quot;</span>)],</span>
<span id="cb103-5"><a href="chapitre-temps.html#cb103-5"></a>                          <span class="dt">lambda =</span> <span class="dv">0</span>)</span>
<span id="cb103-6"><a href="chapitre-temps.html#cb103-6"></a><span class="kw">summary</span>(flow_darima)</span></code></pre></div>
<pre><code>## Series: hm_tr[, &quot;D√©bit&quot;] 
## Regression with ARIMA(1,0,0)(0,1,1)[12] errors 
## Box Cox transformation: lambda= 0 
## 
## Coefficients:
##          ar1     sma1  total_precip  mean_temp
##       0.3213  -0.6236        0.0028    -0.0215
## s.e.  0.1148   0.1828        0.0017     0.0451
## 
## sigma^2 estimated as 0.5392:  log likelihood=-80.87
## AIC=171.74   AICc=172.65   BIC=183.12
## 
## Training set error measures:
##                    ME     RMSE      MAE       MPE    MAPE      MASE       ACF1
## Training set 3.046006 64.76333 37.60995 -31.06861 57.3032 0.7149168 -0.3068227</code></pre>
<blockquote>
<p><strong>Note</strong>. Pour obtenir des r√©sultats plus pr√©cis, mais dont les r√©sultats seront plus longs √† venir, sp√©cifiez l‚Äôargument <code>stepwise = FALSE</code> dans la fonction <code>forecast::auto.arima()</code>.</p>
</blockquote>
<p>Les coefficients sur les covariables sont interpr√©tables <em>dans l‚Äô√©chelle de la pr√©vision transform√©e</em>. Ainsi, 1 mm de pr√©cipitation par mois augmentera le logarithme naturel du d√©bit augmente de 0.0028. De m√™me, 1 ¬∞C de temp√©rature moyenne diminuera le logarithme naturel du d√©bit augmente de 0.0215: notez que l‚Äôerreur standard sur ce coefficient √©tant tr√®s √©lev√©e, le coefficient n‚Äôest √† premi√®re vue pas diff√©rent de 0. La temp√©rature moyenne aurait avantage √† √™tre remplac√©e par un meilleur indicateur incluant les p√©riodes d‚Äôaccumulation de neige et de leur fonte. Pas mal doc?</p>
<p><img src="https://media.giphy.com/media/kk1zu1tVwuecM/giphy.gif" /></p>
<p>Source: Sc√®ne de Back to the future, Robert Zemeckis et and Bob Gale, 1985</p>
<p>La pr√©vision d‚Äôun mod√®le dynamique demandera les s√©ries temporelles des covariables, qui peuvent elles-m√™mes √™tre mod√©lis√©es ou √™tre issues de simulations. Dans notre cas, nous pouvons utiliser la s√©rie de test.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="chapitre-temps.html#cb105-1"></a>flow_darima <span class="op">%&gt;%</span></span>
<span id="cb105-2"><a href="chapitre-temps.html#cb105-2"></a><span class="st">  </span><span class="kw">forecast</span>(<span class="dt">xreg =</span> hm_te[, <span class="kw">c</span>(<span class="st">&quot;total_precip&quot;</span>, <span class="st">&quot;mean_temp&quot;</span>)]) <span class="op">%&gt;%</span></span>
<span id="cb105-3"><a href="chapitre-temps.html#cb105-3"></a><span class="st">  </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-arimacov-fit-1.png" width="672" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="chapitre-temps.html#cb106-1"></a><span class="kw">checkresiduals</span>(flow_darima)</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-hm-arimacov-fit-2.png" width="672" /></p>
<pre><code>## 
##  Ljung-Box test
## 
## data:  Residuals from Regression with ARIMA(1,0,0)(0,1,1)[12] errors
## Q* = 16.853, df = 13, p-value = 0.2061
## 
## Model df: 4.   Total lags used: 17</code></pre>
</div>
<div id="les-mod√®les-tbats" class="section level3">
<h3><span class="header-section-number">12.3.5</span> Les mod√®les TBATS</h3>
<p>Les mod√®les TBATS (<a href="https://otexts.com/fpp2/complexseasonality.html">Hyndman et Athanasopoulos, 2018</a>) combinent tout ce que l‚Äôon a vu jusqu‚Äô√† pr√©sent, <em>√† l‚Äôexception notable des covariables</em>, dans une interface automatis√©e. L‚Äôautomatisation a l‚Äôavantage d‚Äôune utilisation rapide, mais donne parfois des pr√©dictions erron√©es.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="chapitre-temps.html#cb108-1"></a>lynx_tbats &lt;-<span class="st"> </span>lynx <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tbats</span>()</span>
<span id="cb108-2"><a href="chapitre-temps.html#cb108-2"></a>lynx_tbats_f &lt;-<span class="st"> </span>lynx_tbats <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">forecast</span>()</span>
<span id="cb108-3"><a href="chapitre-temps.html#cb108-3"></a>lynx_tbats_f <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">autoplot</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/ts-lynx-tbats-fit-1.png" width="672" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="chapitre-temps.html#cb109-1"></a><span class="kw">summary</span>(lynx_tbats_f)</span></code></pre></div>
<pre><code>## 
## Forecast method: BATS(0.159, {5,1}, 0.833, -)
## 
## Model Information:
## BATS(0.159, {5,1}, 0.833, -)
## 
## Call: tbats(y = .)
## 
## Parameters
##   Lambda: 0.159431
##   Alpha: 0.4096962
##   Beta: 0.06308072
##   Damping Parameter: 0.833291
##   AR coefficients: 1.166918 -0.79967 0.178396 -0.165326 -0.174982
##   MA coefficients: -0.391172
## 
## Seed States:
##            [,1]
## [1,] 15.0399753
## [2,]  0.4123534
## [3,]  0.0000000
## [4,]  0.0000000
## [5,]  0.0000000
## [6,]  0.0000000
## [7,]  0.0000000
## [8,]  0.0000000
## attr(,&quot;lambda&quot;)
## [1] 0.1594313
## 
## Sigma: 1.542751
## AIC: 1956.137
## 
## Error measures:
##                    ME    RMSE      MAE       MPE     MAPE      MASE        ACF1
## Training set 52.88873 827.169 496.3222 -21.21278 50.42654 0.5973607 -0.04569254
## 
## Forecasts:
##      Point Forecast     Lo 80    Hi 80      Lo 95     Hi 95
## 1935      3144.2286 1772.9365 5314.924 1279.84707  6900.473
## 1936      2272.7187  842.6749 5351.691  464.08249  8064.647
## 1937      1466.3925  410.3827 4224.271  185.16011  6932.120
## 1938       981.1883  227.2540 3210.040   88.86649  5547.989
## 1939       807.6476  170.9933 2800.598   62.30711  4954.037
## 1940       902.9068  196.5571 3075.407   73.22121  5401.634
## 1941      1286.8205  307.5223 4124.040  123.20099  7068.774
## 1942      1964.6976  520.9678 5872.628  225.83614  9784.659
## 1943      2722.5747  765.2794 7819.328  346.39977 12815.672
## 1944      3100.2748  837.7743 9148.331  368.32463 15162.079</code></pre>
<p>Le sommaire du mod√®le le type de mod√®le s√©lectionn√© ainsi que ses param√®tres. Le titre du graphique en donne aussi un aper√ßu: <code>BATS(0.159, {5,1}, 0.833, -)</code>:</p>
<ul>
<li>Le coefficient lambda utilis√© est 0.159.</li>
<li>Le {5, 1} signifie que p = 5 et et q = 1.</li>
<li>L‚Äôadoucissement est de 0.833</li>
<li>Aucune p√©riode n‚Äôest incluse</li>
</ul>
<p>L‚Äôapproche TBATS performe bien pour les donn√©es √† fluctuations cycliques. Toutefois, les intervalles pr√©visionnels son souvent trop larges et l‚Äôoptimisation peut √™tre longue.</p>
</div>
</div>
<div id="pour-terminer" class="section level2">
<h2><span class="header-section-number">12.4</span> Pour terminer‚Ä¶</h2>
<p>Nous avons vu comment manipuler des s√©ries temporelles avec <strong><code>dplyr</code></strong> et le format de base <code>ts</code>, puis comment mod√©liser avec <strong><code>forecast</code></strong>. Bien que cette approche est tout √† fait valide, les d√©veloppeurs de <strong><code>forecast</code></strong> ont compl√®tement revu leur approche pour d√©velopper <strong><code>fable</code></strong> et <strong><code>tsibble</code></strong>. Le nouveau format de s√©rie temporelle du module <a href="https://tsibble.tidyverts.org/"><strong><code>tsibble</code></strong></a> permet des manipulations dans un flux de travail plus conforme au <em>tidyverse</em>. De m√™me, <a href="https://fable.tidyverts.org/"><strong><code>fable</code></strong></a>, r√©√©crite vers l‚Äôapproche <em>tidyverse</em>, offre des fonctions permettant notamment une hi√©rarchisation dans les fluctuations saisonni√®res, par exemple des cycles journaliers ench√¢ss√©s dans des cycles hebdomadaires, ench√¢ss√©s dans des cycles trimestriels. Le module <a href="https://facebook.github.io/prophet/"><strong><code>prophet</code></strong></a>, distribu√© par Facebook en mode open source, gagne en popularit√© et est inclus dans <strong><code>fable</code></strong>. Les nouveaux modules sont couverts dans <a href="https://otexts.com/fpp3/">Hyndman et Athanasopoulos (2019)</a>. Ces notes de cours seront mises √† jour vers les nouvelles versions d√®s que possible. √Ä vous de pr√©dire quand! ;)</p>
<p>Car maintenant, le futur vous appartient.</p>
<p><img src="https://media.giphy.com/media/3o7aCRBQC8u5GaW092/giphy.gif" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="chapitre-ml.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="chapitre-geo.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
