---
title: "Science ouverte et reproductibilitÃ©"
author: "Serge-Ã‰tienne Parent"
date: "`r format(Sys.Date())`"
output: github_document
---

# Science ouverte et reproductibilitÃ© {#chapitre-git}

***
ï¸\ **Objectifs spÃ©cifiques**:

Ã€ la fin de ce chapitre, vous

- saurez exprimer l'importance et les enjeux de la science ouverte
- saurez arranger vos donnÃ©es (format csv) et votre code (format notebook) afin de rendre vos recherches reproductibles
- saurez comment crÃ©er un dÃ©pÃ´t sur GitHub, puis administrer son dÃ©veloppement

***

La science ouverte favorise la diffusion des connaissance Ã  travers plusieurs aspects. 

- **MÃ©thodologie ouverte**. Ce n'est pas pour rien que les revues scientifiques demandent de la minutie dans la description de la mÃ©thodologie: c'est pour s'assurer de bien comprendre la signification des donnÃ©es collectÃ©es et faire en sorte que vos donnÃ©es puissent Ãªtre Ã©chantillonnÃ©es de la mÃªme maniÃ¨re dans une potentielle expÃ©rience subsÃ©quente. Ã€ ce titre, la revue *Nature* a crÃ©Ã© le site de publication de protocoles expÃ©rimentaux [Protocol exchange](https://www.nature.com/protocolexchange/), "oÃ¹ la communautÃ© scientifique met en commun son savoir-faire expÃ©rimental pour accÃ©lÃ©rer la recherche" (ma traduction).
- **DonnÃ©es ouvertes**. En redant nos donnÃ©es publiques, on permet Ã  la postÃ©ritÃ© de les utiliser pour amÃ©liorer les connaissances, dÃ©couvrir des structures qui nous avaient Ã©chappÃ©es, etc. Dans certains cas, l'ouverture des donnÃ©es peut Ãªtre contrainte par des enjeux lÃ©gaux (donnÃ©es privÃ©es) ou Ã©thiques (donnÃ©es pouvant Ãªtre utilisÃ©es Ã  mauvais escient). Dans la plupart des cas, les avantages surpassent largement les risques encourus par la publication des donnÃ©es, et les informations personnelles peuvent Ãªtre retirÃ©es. Des journaux comme Plos [exigent](https://blogs.plos.org/everyone/2014/02/24/plos-new-data-policy-public-access-data-2/) que les donnÃ©es minimales Ã  la reproduction de l'expÃ©rience soient fournies en tant que matÃ©riel supplÃ©mentaire.
- **Code source ouvert**. Les logiciels *open source*, comme R, sont gratuits pour la plupart. Cela permet Ã  quiconque de les utiliser, pourvu que l'on possÃ¨de le support matÃ©riel (un ordinateur) et une connection internet. De la mÃªme maniÃ¨re, le code R qui vous a permi de gÃ©nÃ©rer des rÃ©sultats Ã  partir de vos donnÃ©es peut Ãªtre rendu public sous toutes sortes de licenses *open source* peu restrictive (GPL, BSD, MIT, etc.). Avec les donnÃ©es et le code, vos travaux pourront Ãªtre reproduits.
- **RÃ©vision ouverte**. La rÃ©vision est un travail essentiel en science. Traditionellement, les publications scientifiques sont rÃ©visÃ©s de maniÃ¨re anonyme, le but Ã©tant d'Ã©viter les conflits. RÃ©cemment, des revues comme [Frontiers](https://www.frontiersin.org/about/review-system) ont dÃ©ployÃ© des modes de rÃ©vision ouverts, permettant (1) des Ã©changes plus constructifs entre auteurs et rÃ©viseurs et (2) de remercier ouvertement la contribution des rÃ©viseurs Ã  l'article final.
- **AccÃ¨s ouvert**. Les Ã©diteurs scientifiques sont [largement critiquÃ©s](https://www.nature.com/articles/d41586-019-00492-4) pour demander des frais usuraires aux bibliothÃ¨ques et pour la consultation Ã  la piÃ¨ce, ainsi que des frais de publication dÃ©mesurÃ©s. En rÃ©action Ã  cela, le site [Sci-Hub](https://fr.wikipedia.org/wiki/Sci-Hub) dÃ©bloque gratuitement des millions d'articles scientifiques. Aussi, des journaux sÃ©rieux comme Plos et Frontiers publient *de facto* les articles sur leur site internet, de sorte qu'ils peuvent Ãªtre librement tÃ©lÃ©chargÃ©s.

Le manque d'ouverture dans la science a menÃ© plusieurs scientifique Ã  parler d'une crise de la reproductibilitÃ© ([Baker, 2016](https://www.nature.com/news/1-500-scientists-lift-the-lid-on-reproducibility-1.19970)). Dans ce chapitre, nous verrons quelques astuces pour que R devienne un outil favorisant la science ouverte. Ã€ la fin de ce chapitre, vous devriez Ãªtre en mesure de dÃ©ployer votre code sur une archive en ligne, comme ceci.

```{r github-exemple, fig.align='center', fig.cap="Exemple d'un dossier de code et de donnÃ©es ouvertes, ([Jeanne et al. 2019]())", echo = FALSE}
knitr::include_graphics('images/10_github_exemple.png')
```

## Un code reproductible

```{r repre-code-bes, out.width='50%', fig.align='center', fig.cap="A Guide to Reproducible Code in Ecology and Evolution, [BES 2017](https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf)", echo = FALSE}
knitr::include_graphics('images/10_bes_frontpage.png')
```

La *British ecological society* offre des lignes guide pour crÃ©er un flux de travail reproductible ([BES, 2017](https://www.britishecologicalsociety.org/wp-content/uploads/2017/12/guide-to-reproducible-code.pdf)). En outre, les principes suivants doivent Ãªtre respectÃ©s (ma traduction).

- Commencez votre analyse Ã  partir d'une copie des donnÃ©es brutes.
- Toute opÃ©ration sur les donnÃ©es, que ce soit du nettoyage, des fusion, des transformations, etc. devrait Ãªtre effectuÃ©e avec du code, non pas manuellement.
- SÃ©parez vos opÃ©rations en unitÃ©s logiques thÃ©matiques. Par exemple, vous pourriez sÃ©parer votre code en parties: (i) charger, fusionner et nettoyer les donnÃ©es, (ii) analyser les donnÃ©es, (iii) crÃ©er des fichiers comme des tableaux et des figures.
- Ã‰liminez la duplication du code en crÃ©ant des fonctions personnalisÃ©es. Assurez-vous de commenter vos fonctions en dÃ©tails, expliquez ce qui est attendu comme entrÃ©es et comme sorties, ce qu'elles font et pourquoi.
- Documentez votre code et vos donnÃ©es Ã  mÃªme les feuilles de calcul ou dans un fichier de documentation sÃ©parÃ©.
- Tout fichier intermÃ©diaire devrait Ãªtre sÃ©parÃ© de vos donnÃ©es brutes.

### Structure d'un projet

Un projet de calcul devrait Ãªtre contenu en un seul dossier. Si vous n'avez que quelques projets, il est assez facile de garder l'info en mÃ©moire. Toutefois, en particulier en milieu d'entreprise, il se pourrait fort bien que vous ayez Ã  mener plusieurs projets de front. Certaines entreprises crÃ©ent des numÃ©ros de projet: vous aurez avantage Ã  nommer vos dossiers avec ces numÃ©ros, incluant une brÃ¨ve description. Pour ma part, j'ordonne mes projets chronologiquement par annÃ©e, avec un descriptif.

```
ğŸ“ 2019_abeille-canneberge
```

Notez que je n'utilise ni espace, ni caractÃ¨re spÃ©cial dans le nom du fichier, pour Ã©viter les erreurs potentielles avec des logiciels capricieux.

Ã€ l'intÃ©rieur du dossier racine du projet, j'inclus l'information gÃ©nÃ©rale: donnÃ©es source (souvent des fichiers Excel), manuscrit (mÃ©moire, thÃ¨se, article, etc.) documentation particuliÃ¨re (pour les articles, j'utilise Zotero, un gestionnaire de rÃ©fÃ©rence), photos et, Ã©videmment, mon dossier de code (par exemple `rstats`).

```

ğŸ“ 2019_abeille-canneberge
|-ğŸ“ documentation
|-ğŸ“ manuscrit
|-ğŸ“ photos
|-ğŸ“ rstats
|-ğŸ“ source

```

Si vous rÃ©digez votre manuscrit Ã  mÃªme votre code (en Latex, markdown ou R markdown - nous verrons cela plus loin), vous pouvez trÃ¨s bien l'inclure dans votre fichier de calcul.

Ã€ l'intÃ©rieur du fichier de calcul, vous aurez votre projet RStudio et vos feuilles de calcul sÃ©quencÃ©es. J'utilise `01-`, et non pas `1-` pour Ã©viter que le `10-` suive le `1-` dans le classement en ordre alpha-numÃ©rique au cas oÃ¹ j'aurais plus de 10 feuilles de calcul. J'inclus un fichier `README.md` (extension md pour markdown), qui contient les informations gÃ©nÃ©rales de mes calculs. Les donnÃ©es brutes (`csv`) sont placÃ©es dans un dossier `data`, mes graphiques sont exportÃ©s dans un dossier `image`, mes tableaux sont exportÃ©s dans un dossier `tables` et mes fonctions externes sont exportÃ©es dans un dossier `lib`.

```

ğŸ“ rstats
|-ğŸ“ data
|-ğŸ“ images
|-ğŸ“ lib
|-ğŸ“ tables
ğŸ“„ bees.Rproj
ğŸ“„ 01_clean-data.R
ğŸ“„ 02_data-mining.R
ğŸ“„ 03_data-analysis.R
ğŸ“„ 04_data-modeling.R
ğŸ“„ README.md

```

Je dÃ©cris les noms de fichiers dans la langue de communication utile pour le rendu final du projet, souvent en anglais lors de publications acadÃ©miques. J'Ã©vite les noms de fichier qui ne sont pas informatifs, par exemeple `01.R` ou `Rplot1.png`, ainsi que les majuscules, les caractÃ¨res spÃ©ciaux et les espaces comme dans `DeuxiÃ¨me essai.R` (le `README.md` est une exception).

Pour partager un dossier de projet sur R, on n'a qu'Ã  le compresser (*zip*), puis l'envoyer. Pour que le code fonctionne sur un auter ordinateur, les liens vers les fichers de donnÃ©es Ã  importer ou les graphiques exportÃ©s doivent Ãªtre relatifs.



### Le format [R markdown](https://rmarkdown.rstudio.com/)

Un code reproductible est un code bien dÃ©crit. La structure de projet prÃ©sentÃ©e prÃ©cÃ©demment propose de segmenter le code en plusieurs fichiers R. Cette maniÃ¨re de procÃ©der est optionnelle. Si le fichier de calcul n'est pas trop encombrant, on pourra n'en utiliser qu'un seul, par exemple `stats.R`.


RStudio permet aujourd'hui 

Le langage [*markdown*](https://daringfireball.net/projects/markdown/basics) permet de formater un texte avec un minimum de balises. Ce livre est par 


```{r r-md-cs, out.width='100%', fig.align='center', fig.cap="[Aide-mÃ©moire pour R Markdown, Source:  RStudio](https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf)", echo = FALSE}
knitr::include_graphics('https://www.rstudio.com/wp-content/uploads/2018/08/rmarkdown-2.0-600x464.png')
```


## Introduction Ã  Pakrat




## Introduction Ã  GitHub

Le system de suivi de version `git` a Ã©tÃ© crÃ©Ã© par Linus Torvalds, aussi connu pour avoir crÃ©Ã© Linux. Il existe plusieurs vÃ©hicules pour rendre `git` disponible en ligne, mais GitHub est dÃ©finitivement le plus utilisÃ© d'entre tous. La plateforme GitHub, maintenant la propriÃ©tÃ© de Microsoft, n'est en soi pas open source. Si cela vous pose problÃ¨me, je vous redirige vers GitLab, qui fonctionne Ã  peu prÃ¨s de la mÃªme maniÃ¨re que GitHub (alors que la plateforme GitHub sera fort probablement toujours vivante dans plusieurs annÃ©es, on en est moins sÃ»r pour GitLab, c'est pourquoi j'archive plutÃ´t mes calculs sur GitHub).


http://ohshitgit.com/

...

